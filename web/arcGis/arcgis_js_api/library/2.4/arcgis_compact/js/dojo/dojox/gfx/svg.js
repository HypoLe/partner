/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

if(!dojo._hasResource["dojox.gfx.shape"]){dojo._hasResource["dojox.gfx.shape"]=true;dojo.provide("dojox.gfx.shape");dojo.declare("dojox.gfx.shape.Shape",null,{constructor:function(){this.rawNode=null;this.shape=null;this.matrix=null;this.fillStyle=null;this.strokeStyle=null;this.bbox=null;this.parent=null;this.parentMatrix=null;},getNode:function(){return this.rawNode;},getShape:function(){return this.shape;},getTransform:function(){return this.matrix;},getFill:function(){return this.fillStyle;},getStroke:function(){return this.strokeStyle;},getParent:function(){return this.parent;},getBoundingBox:function(){return this.bbox;},getTransformedBoundingBox:function(){var b=this.getBoundingBox();if(!b){return null;}var m=this._getRealMatrix();gm=dojox.gfx.matrix;return [gm.multiplyPoint(m,b.x,b.y),gm.multiplyPoint(m,b.x+b.width,b.y),gm.multiplyPoint(m,b.x+b.width,b.y+b.height),gm.multiplyPoint(m,b.x,b.y+b.height)];},getEventSource:function(){return this.rawNode;},setShape:function(_1){this.shape=dojox.gfx.makeParameters(this.shape,_1);this.bbox=null;return this;},setFill:function(_2){if(!_2){this.fillStyle=null;return this;}var f=null;if(typeof (_2)=="object"&&"type" in _2){switch(_2.type){case "linear":f=dojox.gfx.makeParameters(dojox.gfx.defaultLinearGradient,_2);break;case "radial":f=dojox.gfx.makeParameters(dojox.gfx.defaultRadialGradient,_2);break;case "pattern":f=dojox.gfx.makeParameters(dojox.gfx.defaultPattern,_2);break;}}else{f=dojox.gfx.normalizeColor(_2);}this.fillStyle=f;return this;},setStroke:function(_3){if(!_3){this.strokeStyle=null;return this;}if(typeof _3=="string"||dojo.isArray(_3)||_3 instanceof dojo.Color){_3={color:_3};}var s=this.strokeStyle=dojox.gfx.makeParameters(dojox.gfx.defaultStroke,_3);s.color=dojox.gfx.normalizeColor(s.color);return this;},setTransform:function(_4){this.matrix=dojox.gfx.matrix.clone(_4?dojox.gfx.matrix.normalize(_4):dojox.gfx.matrix.identity);return this._applyTransform();},_applyTransform:function(){return this;},moveToFront:function(){var p=this.getParent();if(p){p._moveChildToFront(this);this._moveToFront();}return this;},moveToBack:function(){var p=this.getParent();if(p){p._moveChildToBack(this);this._moveToBack();}return this;},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(_5){return _5?this.setTransform([this.matrix,_5]):this;},applyLeftTransform:function(_6){return _6?this.setTransform([_6,this.matrix]):this;},applyTransform:function(_7){return _7?this.setTransform([this.matrix,_7]):this;},removeShape:function(_8){if(this.parent){this.parent.remove(this,_8);}return this;},_setParent:function(_9,_a){this.parent=_9;return this._updateParentMatrix(_a);},_updateParentMatrix:function(_b){this.parentMatrix=_b?dojox.gfx.matrix.clone(_b):null;return this._applyTransform();},_getRealMatrix:function(){var m=this.matrix;var p=this.parent;while(p){if(p.matrix){m=dojox.gfx.matrix.multiply(p.matrix,m);}p=p.parent;}return m;}});dojox.gfx.shape._eventsProcessing={connect:function(_c,_d,_e){return arguments.length>2?dojo.connect(this.getEventSource(),_c,_d,_e):dojo.connect(this.getEventSource(),_c,_d);},disconnect:function(_f){dojo.disconnect(_f);}};dojo.extend(dojox.gfx.shape.Shape,dojox.gfx.shape._eventsProcessing);dojox.gfx.shape.Container={_init:function(){this.children=[];},openBatch:function(){},closeBatch:function(){},add:function(_10){var _11=_10.getParent();if(_11){_11.remove(_10,true);}this.children.push(_10);return _10._setParent(this,this._getRealMatrix());},remove:function(_12,_13){for(var i=0;i<this.children.length;++i){if(this.children[i]==_12){if(_13){}else{_12.parent=null;_12.parentMatrix=null;}this.children.splice(i,1);break;}}return this;},clear:function(){this.children=[];return this;},_moveChildToFront:function(_14){for(var i=0;i<this.children.length;++i){if(this.children[i]==_14){this.children.splice(i,1);this.children.push(_14);break;}}return this;},_moveChildToBack:function(_15){for(var i=0;i<this.children.length;++i){if(this.children[i]==_15){this.children.splice(i,1);this.children.unshift(_15);break;}}return this;}};dojo.declare("dojox.gfx.shape.Surface",null,{constructor:function(){this.rawNode=null;this._parent=null;this._nodes=[];this._events=[];},destroy:function(){dojo.forEach(this._nodes,dojo.destroy);this._nodes=[];dojo.forEach(this._events,dojo.disconnect);this._events=[];this.rawNode=null;if(dojo.isIE){while(this._parent.lastChild){dojo.destroy(this._parent.lastChild);}}else{this._parent.innerHTML="";}this._parent=null;},getEventSource:function(){return this.rawNode;},_getRealMatrix:function(){return null;},isLoaded:true,onLoad:function(_16){},whenLoaded:function(_17,_18){var f=dojo.hitch(_17,_18);if(this.isLoaded){f(this);}else{var h=dojo.connect(this,"onLoad",function(_19){dojo.disconnect(h);f(_19);});}}});dojo.extend(dojox.gfx.shape.Surface,dojox.gfx.shape._eventsProcessing);dojo.declare("dojox.gfx.Point",null,{});dojo.declare("dojox.gfx.Rectangle",null,{});dojo.declare("dojox.gfx.shape.Rect",dojox.gfx.shape.Shape,{constructor:function(_1a){this.shape=dojox.gfx.getDefault("Rect");this.rawNode=_1a;},getBoundingBox:function(){return this.shape;}});dojo.declare("dojox.gfx.shape.Ellipse",dojox.gfx.shape.Shape,{constructor:function(_1b){this.shape=dojox.gfx.getDefault("Ellipse");this.rawNode=_1b;},getBoundingBox:function(){if(!this.bbox){var _1c=this.shape;this.bbox={x:_1c.cx-_1c.rx,y:_1c.cy-_1c.ry,width:2*_1c.rx,height:2*_1c.ry};}return this.bbox;}});dojo.declare("dojox.gfx.shape.Circle",dojox.gfx.shape.Shape,{constructor:function(_1d){this.shape=dojox.gfx.getDefault("Circle");this.rawNode=_1d;},getBoundingBox:function(){if(!this.bbox){var _1e=this.shape;this.bbox={x:_1e.cx-_1e.r,y:_1e.cy-_1e.r,width:2*_1e.r,height:2*_1e.r};}return this.bbox;}});dojo.declare("dojox.gfx.shape.Line",dojox.gfx.shape.Shape,{constructor:function(_1f){this.shape=dojox.gfx.getDefault("Line");this.rawNode=_1f;},getBoundingBox:function(){if(!this.bbox){var _20=this.shape;this.bbox={x:Math.min(_20.x1,_20.x2),y:Math.min(_20.y1,_20.y2),width:Math.abs(_20.x2-_20.x1),height:Math.abs(_20.y2-_20.y1)};}return this.bbox;}});dojo.declare("dojox.gfx.shape.Polyline",dojox.gfx.shape.Shape,{constructor:function(_21){this.shape=dojox.gfx.getDefault("Polyline");this.rawNode=_21;},setShape:function(_22,_23){if(_22&&_22 instanceof Array){this.inherited(arguments,[{points:_22}]);if(_23&&this.shape.points.length){this.shape.points.push(this.shape.points[0]);}}else{this.inherited(arguments,[_22]);}return this;},_normalizePoints:function(){var p=this.shape.points,l=p&&p.length;if(l&&typeof p[0]=="number"){var _24=[];for(var i=0;i<l;i+=2){_24.push({x:p[i],y:p[i+1]});}this.shape.points=_24;}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){var p=this.shape.points;var l=p.length;var t=p[0];var _25={l:t.x,t:t.y,r:t.x,b:t.y};for(var i=1;i<l;++i){t=p[i];if(_25.l>t.x){_25.l=t.x;}if(_25.r<t.x){_25.r=t.x;}if(_25.t>t.y){_25.t=t.y;}if(_25.b<t.y){_25.b=t.y;}}this.bbox={x:_25.l,y:_25.t,width:_25.r-_25.l,height:_25.b-_25.t};}return this.bbox;}});dojo.declare("dojox.gfx.shape.Image",dojox.gfx.shape.Shape,{constructor:function(_26){this.shape=dojox.gfx.getDefault("Image");this.rawNode=_26;},getBoundingBox:function(){return this.shape;},setStroke:function(){return this;},setFill:function(){return this;}});dojo.declare("dojox.gfx.shape.Text",dojox.gfx.shape.Shape,{constructor:function(_27){this.fontStyle=null;this.shape=dojox.gfx.getDefault("Text");this.rawNode=_27;},getFont:function(){return this.fontStyle;},setFont:function(_28){this.fontStyle=typeof _28=="string"?dojox.gfx.splitFontString(_28):dojox.gfx.makeParameters(dojox.gfx.defaultFont,_28);this._setFont();return this;}});dojox.gfx.shape.Creator={createShape:function(_29){var gfx=dojox.gfx;switch(_29.type){case gfx.defaultPath.type:return this.createPath(_29);case gfx.defaultRect.type:return this.createRect(_29);case gfx.defaultCircle.type:return this.createCircle(_29);case gfx.defaultEllipse.type:return this.createEllipse(_29);case gfx.defaultLine.type:return this.createLine(_29);case gfx.defaultPolyline.type:return this.createPolyline(_29);case gfx.defaultImage.type:return this.createImage(_29);case gfx.defaultText.type:return this.createText(_29);case gfx.defaultTextPath.type:return this.createTextPath(_29);}return null;},createGroup:function(){return this.createObject(dojox.gfx.Group);},createRect:function(_2a){return this.createObject(dojox.gfx.Rect,_2a);},createEllipse:function(_2b){return this.createObject(dojox.gfx.Ellipse,_2b);},createCircle:function(_2c){return this.createObject(dojox.gfx.Circle,_2c);},createLine:function(_2d){return this.createObject(dojox.gfx.Line,_2d);},createPolyline:function(_2e){return this.createObject(dojox.gfx.Polyline,_2e);},createImage:function(_2f){return this.createObject(dojox.gfx.Image,_2f);},createText:function(_30){return this.createObject(dojox.gfx.Text,_30);},createPath:function(_31){return this.createObject(dojox.gfx.Path,_31);},createTextPath:function(_32){return this.createObject(dojox.gfx.TextPath,{}).setText(_32);},createObject:function(_33,_34){return null;}};}if(!dojo._hasResource["dojox.gfx.path"]){dojo._hasResource["dojox.gfx.path"]=true;dojo.provide("dojox.gfx.path");dojo.declare("dojox.gfx.path.Path",dojox.gfx.shape.Shape,{constructor:function(_35){this.shape=dojo.clone(dojox.gfx.defaultPath);this.segments=[];this.tbbox=null;this.absolute=true;this.last={};this.rawNode=_35;this.segmented=false;},setAbsoluteMode:function(_36){this._confirmSegmented();this.absolute=typeof _36=="string"?(_36=="absolute"):_36;return this;},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute;},getBoundingBox:function(){this._confirmSegmented();return (this.bbox&&("l" in this.bbox))?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null;},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox){return this.tbbox;}var _37=this.bbox,_38=this._getRealMatrix();this.bbox=null;for(var i=0,len=this.segments.length;i<len;++i){this._updateWithSegment(this.segments[i],_38);}var t=this.bbox;this.bbox=_37;this.tbbox=t?[{x:t.l,y:t.t},{x:t.r,y:t.t},{x:t.r,y:t.b},{x:t.l,y:t.b}]:null;return this.tbbox;},getLastPosition:function(){this._confirmSegmented();return "x" in this.last?this.last:null;},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments);},_updateBBox:function(x,y,_39){if(_39){var t=dojox.gfx.matrix.multiplyPoint(_39,x,y);x=t.x;y=t.y;}if(this.bbox&&("l" in this.bbox)){if(this.bbox.l>x){this.bbox.l=x;}if(this.bbox.r<x){this.bbox.r=x;}if(this.bbox.t>y){this.bbox.t=y;}if(this.bbox.b<y){this.bbox.b=y;}}else{this.bbox={l:x,b:y,r:x,t:y};}},_updateWithSegment:function(_3a,_3b){var n=_3a.args,l=n.length;switch(_3a.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(var i=0;i<l;i+=2){this._updateBBox(n[i],n[i+1],_3b);}this.last.x=n[l-2];this.last.y=n[l-1];this.absolute=true;break;case "H":for(var i=0;i<l;++i){this._updateBBox(n[i],this.last.y,_3b);}this.last.x=n[l-1];this.absolute=true;break;case "V":for(var i=0;i<l;++i){this._updateBBox(this.last.x,n[i],_3b);}this.last.y=n[l-1];this.absolute=true;break;case "m":var _3c=0;if(!("x" in this.last)){this._updateBBox(this.last.x=n[0],this.last.y=n[1],_3b);_3c=2;}for(var i=_3c;i<l;i+=2){this._updateBBox(this.last.x+=n[i],this.last.y+=n[i+1],_3b);}this.absolute=false;break;case "l":case "t":for(var i=0;i<l;i+=2){this._updateBBox(this.last.x+=n[i],this.last.y+=n[i+1],_3b);}this.absolute=false;break;case "h":for(var i=0;i<l;++i){this._updateBBox(this.last.x+=n[i],this.last.y,_3b);}this.absolute=false;break;case "v":for(var i=0;i<l;++i){this._updateBBox(this.last.x,this.last.y+=n[i],_3b);}this.absolute=false;break;case "c":for(var i=0;i<l;i+=6){this._updateBBox(this.last.x+n[i],this.last.y+n[i+1],_3b);this._updateBBox(this.last.x+n[i+2],this.last.y+n[i+3],_3b);this._updateBBox(this.last.x+=n[i+4],this.last.y+=n[i+5],_3b);}this.absolute=false;break;case "s":case "q":for(var i=0;i<l;i+=4){this._updateBBox(this.last.x+n[i],this.last.y+n[i+1],_3b);this._updateBBox(this.last.x+=n[i+2],this.last.y+=n[i+3],_3b);}this.absolute=false;break;case "A":for(var i=0;i<l;i+=7){this._updateBBox(n[i+5],n[i+6],_3b);}this.last.x=n[l-2];this.last.y=n[l-1];this.absolute=true;break;case "a":for(var i=0;i<l;i+=7){this._updateBBox(this.last.x+=n[i+5],this.last.y+=n[i+6],_3b);}this.absolute=false;break;}var _3d=[_3a.action];for(var i=0;i<l;++i){_3d.push(dojox.gfx.formatNumber(n[i],true));}if(typeof this.shape.path=="string"){this.shape.path+=_3d.join("");}else{Array.prototype.push.apply(this.shape.path,_3d);}},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(_3e,_3f){this.tbbox=null;var _40=this._validSegments[_3e.toLowerCase()];if(typeof _40=="number"){if(_40){if(_3f.length>=_40){var _41={action:_3e,args:_3f.slice(0,_3f.length-_3f.length%_40)};this.segments.push(_41);this._updateWithSegment(_41);}}else{var _41={action:_3e,args:[]};this.segments.push(_41);this._updateWithSegment(_41);}}},_collectArgs:function(_42,_43){for(var i=0;i<_43.length;++i){var t=_43[i];if(typeof t=="boolean"){_42.push(t?1:0);}else{if(typeof t=="number"){_42.push(t);}else{if(t instanceof Array){this._collectArgs(_42,t);}else{if("x" in t&&"y" in t){_42.push(t.x,t.y);}}}}}},moveTo:function(){this._confirmSegmented();var _44=[];this._collectArgs(_44,arguments);this._pushSegment(this.absolute?"M":"m",_44);return this;},lineTo:function(){this._confirmSegmented();var _45=[];this._collectArgs(_45,arguments);this._pushSegment(this.absolute?"L":"l",_45);return this;},hLineTo:function(){this._confirmSegmented();var _46=[];this._collectArgs(_46,arguments);this._pushSegment(this.absolute?"H":"h",_46);return this;},vLineTo:function(){this._confirmSegmented();var _47=[];this._collectArgs(_47,arguments);this._pushSegment(this.absolute?"V":"v",_47);return this;},curveTo:function(){this._confirmSegmented();var _48=[];this._collectArgs(_48,arguments);this._pushSegment(this.absolute?"C":"c",_48);return this;},smoothCurveTo:function(){this._confirmSegmented();var _49=[];this._collectArgs(_49,arguments);this._pushSegment(this.absolute?"S":"s",_49);return this;},qCurveTo:function(){this._confirmSegmented();var _4a=[];this._collectArgs(_4a,arguments);this._pushSegment(this.absolute?"Q":"q",_4a);return this;},qSmoothCurveTo:function(){this._confirmSegmented();var _4b=[];this._collectArgs(_4b,arguments);this._pushSegment(this.absolute?"T":"t",_4b);return this;},arcTo:function(){this._confirmSegmented();var _4c=[];this._collectArgs(_4c,arguments);this._pushSegment(this.absolute?"A":"a",_4c);return this;},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this;},_confirmSegmented:function(){if(!this.segmented){var _4d=this.shape.path;this.shape.path=[];this._setPath(_4d);this.shape.path=this.shape.path.join("");this.segmented=true;}},_setPath:function(_4e){var p=dojo.isArray(_4e)?_4e:_4e.match(dojox.gfx.pathSvgRegExp);this.segments=[];this.absolute=true;this.bbox={};this.last={};if(!p){return;}var _4f="",_50=[],l=p.length;for(var i=0;i<l;++i){var t=p[i],x=parseFloat(t);if(isNaN(x)){if(_4f){this._pushSegment(_4f,_50);}_50=[];_4f=t;}else{_50.push(x);}}this._pushSegment(_4f,_50);},setShape:function(_51){this.inherited(arguments,[typeof _51=="string"?{path:_51}:_51]);this.segmented=false;this.segments=[];if(!dojox.gfx.lazyPathSegmentation){this._confirmSegmented();}return this;},_2PI:Math.PI*2});dojo.declare("dojox.gfx.path.TextPath",dojox.gfx.path.Path,{constructor:function(_52){if(!("text" in this)){this.text=dojo.clone(dojox.gfx.defaultTextPath);}if(!("fontStyle" in this)){this.fontStyle=dojo.clone(dojox.gfx.defaultFont);}},getText:function(){return this.text;},setText:function(_53){this.text=dojox.gfx.makeParameters(this.text,typeof _53=="string"?{text:_53}:_53);this._setText();return this;},getFont:function(){return this.fontStyle;},setFont:function(_54){this.fontStyle=typeof _54=="string"?dojox.gfx.splitFontString(_54):dojox.gfx.makeParameters(dojox.gfx.defaultFont,_54);this._setFont();return this;}});}if(!dojo._hasResource["dojox.gfx.svg"]){dojo._hasResource["dojox.gfx.svg"]=true;dojo.provide("dojox.gfx.svg");(function(){var d=dojo,g=dojox.gfx,gs=g.shape,svg=g.svg;svg.useSvgWeb=(typeof window.svgweb!="undefined");function _55(ns,_56){if(dojo.doc.createElementNS){return dojo.doc.createElementNS(ns,_56);}else{return dojo.doc.createElement(_56);}};function _57(_58){if(svg.useSvgWeb){return dojo.doc.createTextNode(_58,true);}else{return dojo.doc.createTextNode(_58);}};function _59(){if(svg.useSvgWeb){return dojo.doc.createDocumentFragment(true);}else{return dojo.doc.createDocumentFragment();}};svg.xmlns={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"};svg.getRef=function(_5a){if(!_5a||_5a=="none"){return null;}if(_5a.match(/^url\(#.+\)$/)){return d.byId(_5a.slice(5,-1));}if(_5a.match(/^#dojoUnique\d+$/)){return d.byId(_5a.slice(1));}return null;};svg.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};d.declare("dojox.gfx.svg.Shape",gs.Shape,{setFill:function(_5b){if(!_5b){this.fillStyle=null;this.rawNode.setAttribute("fill","none");this.rawNode.setAttribute("fill-opacity",0);return this;}var f;var _5c=function(x){this.setAttribute(x,f[x].toFixed(8));};if(typeof (_5b)=="object"&&"type" in _5b){switch(_5b.type){case "linear":f=g.makeParameters(g.defaultLinearGradient,_5b);var _5d=this._setFillObject(f,"linearGradient");d.forEach(["x1","y1","x2","y2"],_5c,_5d);break;case "radial":f=g.makeParameters(g.defaultRadialGradient,_5b);var _5d=this._setFillObject(f,"radialGradient");d.forEach(["cx","cy","r"],_5c,_5d);break;case "pattern":f=g.makeParameters(g.defaultPattern,_5b);var _5e=this._setFillObject(f,"pattern");d.forEach(["x","y","width","height"],_5c,_5e);break;}this.fillStyle=f;return this;}var f=g.normalizeColor(_5b);this.fillStyle=f;this.rawNode.setAttribute("fill",f.toCss());this.rawNode.setAttribute("fill-opacity",f.a);this.rawNode.setAttribute("fill-rule","evenodd");return this;},setStroke:function(_5f){var rn=this.rawNode;if(!_5f){this.strokeStyle=null;rn.setAttribute("stroke","none");rn.setAttribute("stroke-opacity",0);return this;}if(typeof _5f=="string"||d.isArray(_5f)||_5f instanceof d.Color){_5f={color:_5f};}var s=this.strokeStyle=g.makeParameters(g.defaultStroke,_5f);s.color=g.normalizeColor(s.color);if(s){rn.setAttribute("stroke",s.color.toCss());rn.setAttribute("stroke-opacity",s.color.a);rn.setAttribute("stroke-width",s.width);rn.setAttribute("stroke-linecap",s.cap);if(typeof s.join=="number"){rn.setAttribute("stroke-linejoin","miter");rn.setAttribute("stroke-miterlimit",s.join);}else{rn.setAttribute("stroke-linejoin",s.join);}var da=s.style.toLowerCase();if(da in svg.dasharray){da=svg.dasharray[da];}if(da instanceof Array){da=d._toArray(da);for(var i=0;i<da.length;++i){da[i]*=s.width;}if(s.cap!="butt"){for(var i=0;i<da.length;i+=2){da[i]-=s.width;if(da[i]<1){da[i]=1;}}for(var i=1;i<da.length;i+=2){da[i]+=s.width;}}da=da.join(",");}rn.setAttribute("stroke-dasharray",da);rn.setAttribute("dojoGfxStrokeStyle",s.style);}return this;},_getParentSurface:function(){var _60=this.parent;for(;_60&&!(_60 instanceof g.Surface);_60=_60.parent){}return _60;},_setFillObject:function(f,_61){var _62=svg.xmlns.svg;this.fillStyle=f;var _63=this._getParentSurface(),_64=_63.defNode,_65=this.rawNode.getAttribute("fill"),ref=svg.getRef(_65);if(ref){_65=ref;if(_65.tagName.toLowerCase()!=_61.toLowerCase()){var id=_65.id;_65.parentNode.removeChild(_65);_65=_55(_62,_61);_65.setAttribute("id",id);_64.appendChild(_65);}else{while(_65.childNodes.length){_65.removeChild(_65.lastChild);}}}else{_65=_55(_62,_61);_65.setAttribute("id",g._base._getUniqueId());_64.appendChild(_65);}if(_61=="pattern"){_65.setAttribute("patternUnits","userSpaceOnUse");var img=_55(_62,"image");img.setAttribute("x",0);img.setAttribute("y",0);img.setAttribute("width",f.width.toFixed(8));img.setAttribute("height",f.height.toFixed(8));img.setAttributeNS(svg.xmlns.xlink,"xlink:href",f.src);_65.appendChild(img);}else{_65.setAttribute("gradientUnits","userSpaceOnUse");for(var i=0;i<f.colors.length;++i){var c=f.colors[i],t=_55(_62,"stop"),cc=c.color=g.normalizeColor(c.color);t.setAttribute("offset",c.offset.toFixed(8));t.setAttribute("stop-color",cc.toCss());t.setAttribute("stop-opacity",cc.a);_65.appendChild(t);}}this.rawNode.setAttribute("fill","url(#"+_65.getAttribute("id")+")");this.rawNode.removeAttribute("fill-opacity");this.rawNode.setAttribute("fill-rule","evenodd");return _65;},_applyTransform:function(){var _66=this.matrix;if(_66){var tm=this.matrix;this.rawNode.setAttribute("transform","matrix("+tm.xx.toFixed(8)+","+tm.yx.toFixed(8)+","+tm.xy.toFixed(8)+","+tm.yy.toFixed(8)+","+tm.dx.toFixed(8)+","+tm.dy.toFixed(8)+")");}else{this.rawNode.removeAttribute("transform");}return this;},setRawNode:function(_67){var r=this.rawNode=_67;if(this.shape.type!="image"){r.setAttribute("fill","none");}r.setAttribute("fill-opacity",0);r.setAttribute("stroke","none");r.setAttribute("stroke-opacity",0);r.setAttribute("stroke-width",1);r.setAttribute("stroke-linecap","butt");r.setAttribute("stroke-linejoin","miter");r.setAttribute("stroke-miterlimit",4);},setShape:function(_68){this.shape=g.makeParameters(this.shape,_68);for(var i in this.shape){if(i!="type"){this.rawNode.setAttribute(i,this.shape[i]);}}this.bbox=null;return this;},_moveToFront:function(){this.rawNode.parentNode.appendChild(this.rawNode);return this;},_moveToBack:function(){this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild);return this;}});dojo.declare("dojox.gfx.svg.Group",svg.Shape,{constructor:function(){gs.Container._init.call(this);},setRawNode:function(_69){this.rawNode=_69;}});svg.Group.nodeType="g";dojo.declare("dojox.gfx.svg.Rect",[svg.Shape,gs.Rect],{setShape:function(_6a){this.shape=g.makeParameters(this.shape,_6a);this.bbox=null;for(var i in this.shape){if(i!="type"&&i!="r"){this.rawNode.setAttribute(i,this.shape[i]);}}if(this.shape.r){this.rawNode.setAttribute("ry",this.shape.r);this.rawNode.setAttribute("rx",this.shape.r);}return this;}});svg.Rect.nodeType="rect";dojo.declare("dojox.gfx.svg.Ellipse",[svg.Shape,gs.Ellipse],{});svg.Ellipse.nodeType="ellipse";dojo.declare("dojox.gfx.svg.Circle",[svg.Shape,gs.Circle],{});svg.Circle.nodeType="circle";dojo.declare("dojox.gfx.svg.Line",[svg.Shape,gs.Line],{});svg.Line.nodeType="line";dojo.declare("dojox.gfx.svg.Polyline",[svg.Shape,gs.Polyline],{setShape:function(_6b,_6c){if(_6b&&_6b instanceof Array){this.shape=g.makeParameters(this.shape,{points:_6b});if(_6c&&this.shape.points.length){this.shape.points.push(this.shape.points[0]);}}else{this.shape=g.makeParameters(this.shape,_6b);}this.bbox=null;this._normalizePoints();var _6d=[],p=this.shape.points;for(var i=0;i<p.length;++i){_6d.push(p[i].x.toFixed(8),p[i].y.toFixed(8));}this.rawNode.setAttribute("points",_6d.join(" "));return this;}});svg.Polyline.nodeType="polyline";dojo.declare("dojox.gfx.svg.Image",[svg.Shape,gs.Image],{setShape:function(_6e){this.shape=g.makeParameters(this.shape,_6e);this.bbox=null;var _6f=this.rawNode;for(var i in this.shape){if(i!="type"&&i!="src"){_6f.setAttribute(i,this.shape[i]);}}_6f.setAttribute("preserveAspectRatio","none");_6f.setAttributeNS(svg.xmlns.xlink,"xlink:href",this.shape.src);return this;}});svg.Image.nodeType="image";dojo.declare("dojox.gfx.svg.Text",[svg.Shape,gs.Text],{setShape:function(_70){this.shape=g.makeParameters(this.shape,_70);this.bbox=null;var r=this.rawNode,s=this.shape;r.setAttribute("x",s.x);r.setAttribute("y",s.y);r.setAttribute("text-anchor",s.align);r.setAttribute("text-decoration",s.decoration);r.setAttribute("rotate",s.rotated?90:0);r.setAttribute("kerning",s.kerning?"auto":0);r.setAttribute("text-rendering","optimizeLegibility");if(r.firstChild){r.firstChild.nodeValue=s.text;}else{r.appendChild(_57(s.text));}return this;},getTextWidth:function(){var _71=this.rawNode,_72=_71.parentNode,_73=_71.cloneNode(true);_73.style.visibility="hidden";var _74=0,_75=_73.firstChild.nodeValue;_72.appendChild(_73);if(_75!=""){while(!_74){if(_73.getBBox){_74=parseInt(_73.getBBox().width);}else{_74=68;}}}_72.removeChild(_73);return _74;}});svg.Text.nodeType="text";dojo.declare("dojox.gfx.svg.Path",[svg.Shape,g.path.Path],{_updateWithSegment:function(_76){this.inherited(arguments);if(typeof (this.shape.path)=="string"){this.rawNode.setAttribute("d",this.shape.path);}},setShape:function(_77){this.inherited(arguments);if(this.shape.path){this.rawNode.setAttribute("d",this.shape.path);}else{this.rawNode.removeAttribute("d");}return this;}});svg.Path.nodeType="path";dojo.declare("dojox.gfx.svg.TextPath",[svg.Shape,g.path.TextPath],{_updateWithSegment:function(_78){this.inherited(arguments);this._setTextPath();},setShape:function(_79){this.inherited(arguments);this._setTextPath();return this;},_setTextPath:function(){if(typeof this.shape.path!="string"){return;}var r=this.rawNode;if(!r.firstChild){var tp=_55(svg.xmlns.svg,"textPath"),tx=_57("");tp.appendChild(tx);r.appendChild(tp);}var ref=r.firstChild.getAttributeNS(svg.xmlns.xlink,"href"),_7a=ref&&svg.getRef(ref);if(!_7a){var _7b=this._getParentSurface();if(_7b){var _7c=_7b.defNode;_7a=_55(svg.xmlns.svg,"path");var id=g._base._getUniqueId();_7a.setAttribute("id",id);_7c.appendChild(_7a);r.firstChild.setAttributeNS(svg.xmlns.xlink,"xlink:href","#"+id);}}if(_7a){_7a.setAttribute("d",this.shape.path);}},_setText:function(){var r=this.rawNode;if(!r.firstChild){var tp=_55(svg.xmlns.svg,"textPath"),tx=_57("");tp.appendChild(tx);r.appendChild(tp);}r=r.firstChild;var t=this.text;r.setAttribute("alignment-baseline","middle");switch(t.align){case "middle":r.setAttribute("text-anchor","middle");r.setAttribute("startOffset","50%");break;case "end":r.setAttribute("text-anchor","end");r.setAttribute("startOffset","100%");break;default:r.setAttribute("text-anchor","start");r.setAttribute("startOffset","0%");break;}r.setAttribute("baseline-shift","0.5ex");r.setAttribute("text-decoration",t.decoration);r.setAttribute("rotate",t.rotated?90:0);r.setAttribute("kerning",t.kerning?"auto":0);r.firstChild.data=t.text;}});svg.TextPath.nodeType="text";dojo.declare("dojox.gfx.svg.Surface",gs.Surface,{constructor:function(){gs.Container._init.call(this);},destroy:function(){this.defNode=null;this.inherited(arguments);},setDimensions:function(_7d,_7e){if(!this.rawNode){return this;}this.rawNode.setAttribute("width",_7d);this.rawNode.setAttribute("height",_7e);return this;},getDimensions:function(){var t=this.rawNode?{width:g.normalizedLength(this.rawNode.getAttribute("width")),height:g.normalizedLength(this.rawNode.getAttribute("height"))}:null;return t;}});svg.createSurface=function(_7f,_80,_81){var s=new svg.Surface();s.rawNode=_55(svg.xmlns.svg,"svg");if(_80){s.rawNode.setAttribute("width",_80);}if(_81){s.rawNode.setAttribute("height",_81);}var _82=_55(svg.xmlns.svg,"defs");s.rawNode.appendChild(_82);s.defNode=_82;s._parent=d.byId(_7f);s._parent.appendChild(s.rawNode);return s;};var _83={_setFont:function(){var f=this.fontStyle;this.rawNode.setAttribute("font-style",f.style);this.rawNode.setAttribute("font-variant",f.variant);this.rawNode.setAttribute("font-weight",f.weight);this.rawNode.setAttribute("font-size",f.size);this.rawNode.setAttribute("font-family",f.family);}};var C=gs.Container,_84={openBatch:function(){this.fragment=_59();},closeBatch:function(){if(this.fragment){this.rawNode.appendChild(this.fragment);delete this.fragment;}},add:function(_85){if(this!=_85.getParent()){if(this.fragment){this.fragment.appendChild(_85.rawNode);}else{this.rawNode.appendChild(_85.rawNode);}C.add.apply(this,arguments);}return this;},remove:function(_86,_87){if(this==_86.getParent()){if(this.rawNode==_86.rawNode.parentNode){this.rawNode.removeChild(_86.rawNode);}if(this.fragment&&this.fragment==_86.rawNode.parentNode){this.fragment.removeChild(_86.rawNode);}C.remove.apply(this,arguments);}return this;},clear:function(){var r=this.rawNode;while(r.lastChild){r.removeChild(r.lastChild);}var _88=this.defNode;if(_88){while(_88.lastChild){_88.removeChild(_88.lastChild);}r.appendChild(_88);}return C.clear.apply(this,arguments);},_moveChildToFront:C._moveChildToFront,_moveChildToBack:C._moveChildToBack};var _89={createObject:function(_8a,_8b){if(!this.rawNode){return null;}var _8c=new _8a(),_8d=_55(svg.xmlns.svg,_8a.nodeType);_8c.setRawNode(_8d);_8c.setShape(_8b);this.add(_8c);return _8c;}};d.extend(svg.Text,_83);d.extend(svg.TextPath,_83);d.extend(svg.Group,_84);d.extend(svg.Group,gs.Creator);d.extend(svg.Group,_89);d.extend(svg.Surface,_84);d.extend(svg.Surface,gs.Creator);d.extend(svg.Surface,_89);if(svg.useSvgWeb){svg.createSurface=function(_8e,_8f,_90){var s=new svg.Surface();if(!_8f||!_90){var pos=d.position(_8e);_8f=_8f||pos.w;_90=_90||pos.h;}_8e=d.byId(_8e);var id=_8e.id?_8e.id+"_svgweb":g._base._getUniqueId();var _91=_55(svg.xmlns.svg,"svg");_91.id=id;_91.setAttribute("width",_8f);_91.setAttribute("height",_90);svgweb.appendChild(_91,_8e);_91.addEventListener("SVGLoad",function(){s.rawNode=this;s.isLoaded=true;var _92=_55(svg.xmlns.svg,"defs");s.rawNode.appendChild(_92);s.defNode=_92;if(s.onLoad){s.onLoad(s);}},false);s.isLoaded=false;return s;};svg.Surface.extend({destroy:function(){var _93=this.rawNode;svgweb.removeChild(_93,_93.parentNode);}});var _94={connect:function(_95,_96,_97){if(_95.substring(0,2)==="on"){_95=_95.substring(2);}if(arguments.length==2){_97=_96;}else{_97=d.hitch(_96,_97);}this.getEventSource().addEventListener(_95,_97,false);return [this,_95,_97];},disconnect:function(_98){this.getEventSource().removeEventListener(_98[1],_98[2],false);delete _98[0];}};dojo.extend(svg.Shape,_94);dojo.extend(svg.Surface,_94);}if(g.loadAndSwitch==="svg"){g.switchTo("svg");delete g.loadAndSwitch;}})();}
