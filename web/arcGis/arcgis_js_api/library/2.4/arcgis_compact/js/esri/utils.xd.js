/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */

window[esri._dojoScopeName||"dojo"]._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","esri.utils"],["require","dojo.io.script"],["require","esri.graphic"],["requireLocalization","esri","jsapi",null,"ROOT,ar,de,es,fr,it,ja,ru,zh","ROOT,ar,de,es,fr,it,ja,ru,zh"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["esri.utils"]){_4._hasResource["esri.utils"]=true;_4.provide("esri.utils");_4.require("dojo.io.script");_4.require("esri.graphic");_4.addOnLoad(function(){esri.bundle=_4.i18n.getLocalization("esri","jsapi");});esri.show=function(_7){_7.style.display="block";};esri.hide=function(_8){_8.style.display="none";};esri.toggle=function(_9){_9.style.display=_9.style.display==="none"?"block":"none";};esri.valueOf=function(_a,_b){for(var i in _a){if(_a[i]==_b){return i;}}return null;};esri.substitute=(function(){var _c="${*}",_d=["NumberFormat","DateString","DateFormat"];function _e(_f){return esri._isDefined(_f)?_f:"";};function _10(key,_11,_12){var _13=_12.match(/([^\(]+)(\([^\)]+\))?/i);var _14=_4.trim(_13[1]);var _15=_4.fromJson((_13[2]?_4.trim(_13[2]):"()").replace(/^\(/,"({").replace(/\)$/,"})"));var _16=_11[key];if(_4.indexOf(_d,_14)===-1){var ref=_4.getObject(_14);if(_4.isFunction(ref)){_16=ref(_16,key,_11);}}else{if(typeof _16==="number"||(typeof _16==="string"&&_16&&!isNaN(Number(_16)))){_16=Number(_16);switch(_14){case "NumberFormat":if(_4.getObject("dojo.number.format")){return _4.number.format(_16,_15);}break;case "DateString":var _17=new Date(_16);if(_15.local||_15.systemLocale){if(_15.systemLocale){return _17.toLocaleDateString()+(_15.hideTime?"":(" "+_17.toLocaleTimeString()));}else{return _17.toDateString()+(_15.hideTime?"":(" "+_17.toTimeString()));}}else{_17=_17.toUTCString();if(_15.hideTime){_17=_17.replace(/\s+\d\d\:\d\d\:\d\d\s+(utc|gmt)/i,"");}return _17;}break;case "DateFormat":if(_4.getObject("dojo.date.locale.format")){return _4.date.locale.format(new Date(_16),_15);}break;}}}return _e(_16);};return function(_18,_19,_1a){var _1b,_1c,_1d;if(esri._isDefined(_1a)){if(_4.isObject(_1a)){_1b=_1a.first;_1c=_1a.dateFormat;_1d=_1a.numberFormat;}else{_1b=_1a;}}if(!_19||_19===_c){var s=[],val;for(var i in _18){val=_18[i];if(_1c&&_4.indexOf(_1c.properties||"",i)!==-1){val=_10(i,_18,_1c.formatter||"DateString");}else{if(_1d&&_4.indexOf(_1d.properties||"",i)!==-1){val=_10(i,_18,_1d.formatter||"NumberFormat");}}s.push(i+" = "+_e(val)+"<br/>");if(_1b){break;}}return s.join("");}else{return _4.replace(_19,_4.hitch({obj:_18},function(_1e,key){var _1f=key.split(":");if(_1f.length>1){key=_1f[0];_1f.shift();return _10(key,this.obj,_1f.join(":"));}else{if(_1c&&_4.indexOf(_1c.properties||"",key)!==-1){return _10(key,this.obj,_1c.formatter||"DateString");}if(_1d&&_4.indexOf(_1d.properties||"",key)!==-1){return _10(key,this.obj,_1d.formatter||"NumberFormat");}}return _e(this.obj[key]);}),/\$\{([^\}]+)\}/g);}};}());esri.documentBox=_4.isIE?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:window.innerWidth,h:window.innerHeight};esri.urlToObject=function(url){var iq=url.indexOf("?");if(iq===-1){return {path:url,query:null};}else{return {path:url.substring(0,iq),query:_4.queryToObject(url.substring(iq+1))};}};esri._getProxyUrl=function(){var _20=esri.config.defaults.io.proxyUrl;if(!_20){console.log(esri.bundle.io.proxyNotSet);throw new Error(esri.bundle.io.proxyNotSet);}return esri.urlToObject(_20);};esri._getProxiedUrl=function(url){if(esri.config.defaults.io.alwaysUseProxy){var _21=esri._getProxyUrl(),_22=esri.urlToObject(url);url=_21.path+"?"+_22.path;var _23=_4.objectToQuery(_4.mixin(_21.query||{},_22.query));if(_23){url+=("?"+_23);}}return url;};esri._hasSameOrigin=function(_24,_25){_24=new _4._Url(_24);_25=new _4._Url(_25);return (_24.scheme===_25.scheme&&_24.host===_25.host&&_24.port===_25.port);};esri.request=function(_26,_27){var _28=false,_29=false;if(esri._isDefined(_27)){if(_4.isObject(_27)){_28=!!_27.useProxy;_29=!!_27.usePost;}else{_28=!!_27;}}var _2a=_26.content,_2b=_26.url,_2c=_26.load,_2d=_26.error,_2e=esri.config.defaults.io;_26.load=function(_2f,io){_26.load=_2c;if(_2f&&_2f.error){_26.error(_2f.error,io);}else{if(_2c){_2c(_2f,io);}}};_26.error=function(_30,io){if(io&&io.xhr){io.xhr.abort();}if(!(_30 instanceof Error)){_30=_4.mixin(new Error(),_30);}_26.error=_2d;_2e.errorHandler(_30,io);if(_2d){_2d(_30,io);}};var len=0;if(_2a&&_2b){len=_4.objectToQuery(_2a).length+_2b.length+1;}_26.timeout=_26.timeout||_2e.timeout;_26.handleAs=_26.handleAs||"json";try{var _31=esri._reqPreCallback,_32=(_29||len>_2e.postLength)?true:false,_33=(_26.handleAs.indexOf("json")!==-1&&_26.callbackParamName)?true:false,_34=(_2e.alwaysUseProxy||_28||((!_33||_32)&&!esri._hasSameOrigin(_26.url,window.location.href)))?true:false;if(_34){var _35=esri._getProxyUrl();if(!_32&&(_35.path.length+1+len)>_2e.postLength){_32=true;}_26=_4.mixin({},_26);_26.url=_35.path+"?"+_2b;if(_32){_26.content=_4.mixin(_35.query||{},_2a);}else{var _36=_4.objectToQuery(_4.mixin(_35.query||{},_2a));if(_36){_26.url+=("?"+_36);}_26.content=null;}}if(_33&&!_32){if(!esri._isDefined(_26.isAsync)&&_4.isFF<4){_26.isAsync=true;}return _4.io.script.get(_31?_31(_26):_26);}else{_26=_31?_31(_26):_26;if(_32){return _4.rawXhrPost(_26);}else{return _4.xhrGet(_26);}}}catch(e){_26.error(e);}};esri.setRequestPreCallback=function(_37){esri._reqPreCallback=_37;};esri._getParts=function(arr,obj,cb){return [_4.isString(arr)?arr.split(""):arr,obj||_4.global,_4.isString(cb)?new Function("item","index","array",cb):cb];};esri.filter=function(arr,_38,_39){var _3a=esri._getParts(arr,_39,_38),_3b={};arr=_3a[0];for(var i in arr){if(_3a[2].call(_3a[i],arr[i],i,arr)){_3b[i]=arr[i];}}return _3b;};esri.TileUtils=(function(){function _3c(map,ti,_3d){var wd=map.width,ht=map.height,ew=_3d.xmax-_3d.xmin,eh=_3d.ymax-_3d.ymin,ed=-1,_3e=ti.lods,abs=Math.abs,lod,cl,ced;for(var i=0,il=_3e.length;i<il;i++){cl=_3e[i];ced=ew>eh?abs(eh-(ht*cl.resolution)):abs(ew-(wd*cl.resolution));if(ed<0||ced<=ed){lod=cl;ed=ced;}else{break;}}return lod;};function _3f(map,_40,lod){var res=lod.resolution,cx=(_40.xmin+_40.xmax)/2,cy=(_40.ymin+_40.ymax)/2,_41=(map.width/2)*res,_42=(map.height/2)*res;return new esri.geometry.Extent(cx-(_41),cy-(_42),cx+(_41),cy+(_42),_40.spatialReference);};function _43(map,ti,_44,lod){var res=lod.resolution,tw=ti.width,th=ti.height,to=ti.origin,mv=map.__visibleDelta,_45=Math.floor,tmw=tw*res,tmh=th*res,tr=_45((to.y-_44.y)/tmh),tc=_45((_44.x-to.x)/tmw),_46=to.x+(tc*tmw),_47=to.y-(tr*tmh),oX=_45(Math.abs((_44.x-_46)*tw/tmw))+mv.x,oY=_45(Math.abs((_44.y-_47)*th/tmh))+mv.y;return {point:_44,coords:{row:tr,col:tc},offsets:{x:oX,y:oY}};};return {_addFrameInfo:function(_48,_49){var _4a,_4b,_4c=2*_49.origin[1],_4d=_49.origin[0],_4e=_48.origin.x,_4f=_48.width,_50;_4.forEach(_48.lods,function(lod){_4a=Math.round(_4c/lod.resolution);_4b=Math.ceil(_4a/_4f);_50=Math.floor((_4d-_4e)/(_4f*lod.resolution));if(!lod._frameInfo){lod._frameInfo=[_4b,_50,_50+_4b-1,_4a];}});},getContainingTileCoords:function(ti,_51,lod){var to=ti.origin,res=lod.resolution,tmw=ti.width*res,tmh=ti.height*res,tc=Math.floor((_51.x-to.x)/tmw),tr=Math.floor((to.y-_51.y)/tmh);return {row:tr,col:tc};},getCandidateTileInfo:function(map,ti,_52){var lod=_3c(map,ti,_52),adj=_3f(map,_52,lod),ct=_43(map,ti,new esri.geometry.Point(adj.xmin,adj.ymax,_52.spatialReference),lod);return {tile:ct,lod:lod,extent:adj};},getTileExtent:function(ti,_53,row,col){var to=ti.origin,lod=ti.lods[_53],res=lod.resolution,tw=ti.width,th=ti.height;return new esri.geometry.Extent(((col*res)*tw)+to.x,to.y-((row+1)*res)*th,(((col+1)*res)*tw)+to.x,to.y-((row*res)*th),ti.spatialReference);}};}());esri.graphicsExtent=function(_54){var g=_54[0].geometry,_55=g.getExtent(),ext;if(_55===null){_55=new esri.geometry.Extent(g.x,g.y,g.x,g.y,g.spatialReference);}for(var i=1,il=_54.length;i<il;i++){ext=(g=_54[i].geometry).getExtent();if(ext===null){ext=new esri.geometry.Extent(g.x,g.y,g.x,g.y,g.spatialReference);}_55=_55.union(ext);}if(_55.getWidth()<=0&&_55.getHeight()<=0){return null;}return _55;};esri.getGeometries=function(_56){return _4.map(_56,function(_57){return _57.geometry;});};esri._encodeGraphics=function(_58,_59){var _5a=[],_5b,enc,_5c;_4.forEach(_58,function(g,i){_5b=g.toJson();enc={};if(_5b.geometry){_5c=_59&&_59[i];enc.geometry=_5c&&_5c.toJson()||_5b.geometry;}if(_5b.attributes){enc.attributes=_5b.attributes;}_5a[i]=enc;});return _5a;};esri._serializeLayerDefinitions=function(_5d){var _5e=[],_5f=false,re=/[:;]/;if(_5d){_4.forEach(_5d,function(_60,i){if(_60){_5e.push([i,_60]);if(!_5f&&re.test(_60)){_5f=true;}}});if(_5e.length>0){var _61;if(_5f){_61={};_4.forEach(_5e,function(_62){_61[_62[0]]=_62[1];});_61=_4.toJson(_61);}else{_61=[];_4.forEach(_5e,function(_63){_61.push(_63[0]+":"+_63[1]);});_61=_61.join(";");}return _61;}}return null;};esri._serializeTimeOptions=function(_64,ids){if(!_64){return;}var _65=[];_4.forEach(_64,function(_66,i){if(_66){var _67=_66.toJson();if(ids&&_4.indexOf(ids,i)!==-1){_67.useTime=false;}_65.push("\""+i+"\":"+_4.toJson(_67));}});if(_65.length){return "{"+_65.join(",")+"}";}};esri._isDefined=function(_68){return (_68!==undefined)&&(_68!==null);};esri._sanitize=function(obj){for(var _69 in obj){if(obj.hasOwnProperty(_69)){if(obj[_69]===undefined){delete obj[_69];}}}return obj;};esri._dfdCanceller=function(dfd){dfd.canceled=true;var _6a=dfd._pendingDfd;if(dfd.fired===-1&&_6a&&_6a.fired===-1){_6a.cancel();}dfd._pendingDfd=null;};esri._fixDfd=function(dfd){var _6b=dfd.then;dfd.then=function(_6c,b,c){if(_6c){var _6d=_6c;_6c=function(_6e){if(_6e&&_6e._argsArray){return _6d.apply(null,_6e);}return _6d(_6e);};}return _6b.call(this,_6c,b,c);};return dfd;};esri._resDfd=function(dfd,_6f,_70){var _71=_6f.length;if(_71===1){if(_70){dfd.errback(_6f[0]);}else{dfd.callback(_6f[0]);}}else{if(_71>1){_6f._argsArray=true;dfd.callback(_6f);}else{dfd.callback();}}};esri._createWrappers=function(_72){var _73=_4.getObject(_72+".prototype");_4.forEach(_73.__msigns,function(sig){var _74=_73[sig.n];_73[sig.n]=function(){var _75=this,_76=[],_77=new _4.Deferred(esri._dfdCanceller);if(sig.f){esri._fixDfd(_77);}for(var i=0;i<sig.c;i++){_76[i]=arguments[i];}var _78={dfd:_77};_76.push(_78);var _79,_7a=[],_7b;if(_75.normalization&&!_75._isTable){_79=esri._disassemble(_76,sig.a);_4.forEach(_79,function(_7c){_7a=_7a.concat(_7c.value);});if(_7a.length){var sr=_7a[0].spatialReference;if(sr&&sr._isWrappable()){_7b=esri.geometry.normalizeCentralMeridian(_7a,esri.config.defaults.geometryService);}}}if(_7b){_77._pendingDfd=_7b;_7b.addCallbacks(function(_7d){if(_77.canceled){return;}_78.assembly=esri._reassemble(_7d,_79);_77._pendingDfd=_74.apply(_75,_76);},function(err){var _7e=_75.declaredClass;if(_7e&&_7e.indexOf("FeatureLayer")!==-1){_75._resolve([err],null,_76[sig.e],_77,true);}else{_75._errorHandler(err,_76[sig.e],_77);}});}else{_77._pendingDfd=_74.apply(_75,_76);}return _77;};});};esri._disassemble=function(_7f,_80){var _81=[];_4.forEach(_80,function(_82){var _83=_82.i,arg=_7f[_83],_84=_82.p;if(!_4.isObject(arg)||!arg){return;}if(_84){if(_84[0]==="*"){for(var _85 in arg){if(arg.hasOwnProperty(_85)){esri._addToBucket(arg[_85],_81,_83,_85);}}}else{_4.forEach(_84,function(_86){esri._addToBucket(_4.getObject(_86,false,arg),_81,_83,_86);});}}else{esri._addToBucket(arg,_81,_83);}});return _81;};esri._addToBucket=function(_87,_88,_89,_8a){var _8b=false,_8c;if(_4.isObject(_87)&&_87){if(_4.isArray(_87)){if(_87.length){_8c=_87[0]&&_87[0].declaredClass;if(_8c&&_8c.indexOf("Graphic")!==-1){_87=_4.map(_87,function(_8d){return _8d.geometry;});_87=_4.filter(_87,esri._isDefined);_8b=_87.length?true:false;}else{if(_8c&&_8c.indexOf("esri.geometry.")!==-1){_8b=true;}}}}else{_8c=_87.declaredClass;if(_8c&&_8c.indexOf("FeatureSet")!==-1){_87=_4.map(_87.features||[],function(_8e){return _8e.geometry;});_87=_4.filter(_87,esri._isDefined);_8b=_87.length?true:false;}else{if(_8c&&_8c.indexOf("esri.geometry.")!==-1){_8b=true;}}}}if(_8b){_88.push({index:_89,property:_8a,value:_87});}};esri._reassemble=function(_8f,_90){var idx=0,_91={};_4.forEach(_90,function(_92){var _93=_92.index,_94=_92.property,_95=_92.value,len=_95.length||1;var _96=_8f.slice(idx,idx+len);if(!_4.isArray(_95)){_96=_96[0];}idx+=len;delete _92.value;if(_94){_91[_93]=_91[_93]||{};_91[_93][_94]=_96;}else{_91[_93]=_96;}});return _91;};esri.setScrollable=function(_97){var _98=0,_99=0,_9a=0,_9b=0,_9c=0,_9d=0;return [_4.connect(_97,"ontouchstart",function(evt){_98=evt.touches[0].screenX;_99=evt.touches[0].screenY;_9a=_97.scrollWidth;_9b=_97.scrollHeight;_9c=_97.clientWidth;_9d=_97.clientHeight;}),_4.connect(_97,"ontouchmove",function(evt){evt.preventDefault();var _9e=_97.firstChild,_9f=_9e._currentX||0,_a0=_9e._currentY||0;_9f+=(evt.touches[0].screenX-_98);if(_9f>0){_9f=0;}else{if(_9f<0&&(Math.abs(_9f)+_9c)>_9a){_9f=-1*(_9a-_9c);}}_9e._currentX=_9f;_a0+=(evt.touches[0].screenY-_99);if(_a0>0){_a0=0;}else{if(_a0<0&&(Math.abs(_a0)+_9d)>_9b){_a0=-1*(_9b-_9d);}}_9e._currentY=_a0;_4.style(_9e,{"-webkit-transition-property":"-webkit-transform","-webkit-transform":"translate("+_9f+"px, "+_a0+"px)"});_98=evt.touches[0].screenX;_99=evt.touches[0].screenY;})];};}}};});