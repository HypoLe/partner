/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

if(!dojo._hasResource["esri.layers.osm"]){dojo._hasResource["esri.layers.osm"]=true;dojo.provide("esri.layers.osm");dojo.declare("esri.layers.OpenStreetMapLayer",esri.layers.TiledMapServiceLayer,{constructor:function(_1){this.spatialReference=new esri.SpatialReference({wkid:102100});this.tileInfo=new esri.layers.TileInfo({rows:256,cols:256,dpi:96,format:"PNG8",compressionQuality:0,origin:{x:-20037508.342787,y:20037508.342787},spatialReference:{wkid:102100},lods:[{level:0,scale:591657527.591555,resolution:156543.033928},{level:1,scale:295828763.795777,resolution:78271.5169639999},{level:2,scale:147914381.897889,resolution:39135.7584820001},{level:3,scale:73957190.948944,resolution:19567.8792409999},{level:4,scale:36978595.474472,resolution:9783.93962049996},{level:5,scale:18489297.737236,resolution:4891.96981024998},{level:6,scale:9244648.868618,resolution:2445.98490512499},{level:7,scale:4622324.434309,resolution:1222.99245256249},{level:8,scale:2311162.217155,resolution:611.49622628138},{level:9,scale:1155581.108577,resolution:305.748113140558},{level:10,scale:577790.554289,resolution:152.874056570411},{level:11,scale:288895.277144,resolution:76.4370282850732},{level:12,scale:144447.638572,resolution:38.2185141425366},{level:13,scale:72223.819286,resolution:19.1092570712683},{level:14,scale:36111.909643,resolution:9.55462853563415},{level:15,scale:18055.954822,resolution:4.77731426794937},{level:16,scale:9027.977411,resolution:2.38865713397468},{level:17,scale:4513.988705,resolution:1.19432856685505},{level:18,scale:2256.994353,resolution:0.597164283559817}]});this.fullExtent=new esri.geometry.Extent({xmin:-20037508.34,ymin:-20037508.34,xmax:20037508.34,ymax:20037508.34,spatialReference:{wkid:102100}});this.initialExtent=new esri.geometry.Extent({xmin:-20037508.34,ymin:-20037508.34,xmax:20037508.34,ymax:20037508.34,spatialReference:{wkid:102100}});this.tileServers=(_1&&_1.tileServers)||["http://a.tile.openstreetmap.org/","http://b.tile.openstreetmap.org/","http://c.tile.openstreetmap.org/"];this.serversLength=this.tileServers.length;this.serverIndex=0;this._displayLevels=_1?_1.displayLevels:null;this.loaded=true;this.onLoad(this);var _2=_1&&_1.loadCallback;if(_2){_2(this);}},getTileUrl:function(_3,_4,_5){return esri._getProxiedUrl(this.tileServers[this.serverIndex++%this.serversLength]+"/"+_3+"/"+_5+"/"+_4+".png");}});}if(!dojo._hasResource["dojo.io.iframe"]){dojo._hasResource["dojo.io.iframe"]=true;dojo.provide("dojo.io.iframe");dojo.getObject("io",true,dojo);dojo.io.iframe={create:function(_6,_7,_8){if(window[_6]){return window[_6];}if(window.frames[_6]){return window.frames[_6];}var _9=null;var _a=_8;if(!_a){if(dojo.config["useXDomain"]&&!dojo.config["dojoBlankHtmlUrl"]){console.warn("dojo.io.iframe.create: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");}_a=(dojo.config["dojoBlankHtmlUrl"]||dojo.moduleUrl("dojo","resources/blank.html"));}var _9=dojo.place("<iframe id=\""+_6+"\" name=\""+_6+"\" src=\""+_a+"\" onload=\""+_7+"\" style=\"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden\">",dojo.body());window[_6]=_9;return _9;},setSrc:function(_b,_c,_d){try{if(!_d){if(dojo.isWebKit){_b.location=_c;}else{frames[_b.name].location=_c;}}else{var _e;if(dojo.isIE||dojo.isWebKit){_e=_b.contentWindow.document;}else{_e=_b.contentWindow;}if(!_e){_b.location=_c;return;}else{_e.location.replace(_c);}}}catch(e){console.log("dojo.io.iframe.setSrc: ",e);}},doc:function(_f){var doc=_f.contentDocument||(((_f.name)&&(_f.document)&&(dojo.doc.getElementsByTagName("iframe")[_f.name].contentWindow)&&(dojo.doc.getElementsByTagName("iframe")[_f.name].contentWindow.document)))||((_f.name)&&(dojo.doc.frames[_f.name])&&(dojo.doc.frames[_f.name].document))||null;return doc;},send:function(_10){if(!this["_frame"]){this._frame=this.create(this._iframeName,dojo._scopeName+".io.iframe._iframeOnload();");}var dfd=dojo._ioSetArgs(_10,function(dfd){dfd.canceled=true;dfd.ioArgs._callNext();},function(dfd){var _11=null;try{var _12=dfd.ioArgs;var dii=dojo.io.iframe;var ifd=dii.doc(dii._frame);var _13=_12.handleAs;_11=ifd;if(_13!="html"){if(_13=="xml"){if(dojo.isIE<9||(dojo.isIE&&dojo.isQuirks)){dojo.query("a",dii._frame.contentWindow.document.documentElement).orphan();var _14=(dii._frame.contentWindow.document).documentElement.innerText;_14=_14.replace(/>\s+</g,"><");_14=dojo.trim(_14);var _15={responseText:_14};_11=dojo._contentHandlers["xml"](_15);}}else{_11=ifd.getElementsByTagName("textarea")[0].value;if(_13=="json"){_11=dojo.fromJson(_11);}else{if(_13=="javascript"){_11=dojo.eval(_11);}}}}}catch(e){_11=e;}finally{_12._callNext();}return _11;},function(_16,dfd){dfd.ioArgs._hasError=true;dfd.ioArgs._callNext();return _16;});dfd.ioArgs._callNext=function(){if(!this["_calledNext"]){this._calledNext=true;dojo.io.iframe._currentDfd=null;dojo.io.iframe._fireNextRequest();}};this._dfdQueue.push(dfd);this._fireNextRequest();dojo._ioWatch(dfd,function(dfd){return !dfd.ioArgs["_hasError"];},function(dfd){return (!!dfd.ioArgs["_finished"]);},function(dfd){if(dfd.ioArgs._finished){dfd.callback(dfd);}else{dfd.errback(new Error("Invalid dojo.io.iframe request state"));}});return dfd;},_currentDfd:null,_dfdQueue:[],_iframeName:dojo._scopeName+"IoIframe",_fireNextRequest:function(){try{if((this._currentDfd)||(this._dfdQueue.length==0)){return;}do{var dfd=this._currentDfd=this._dfdQueue.shift();}while(dfd&&dfd.canceled&&this._dfdQueue.length);if(!dfd||dfd.canceled){this._currentDfd=null;return;}var _17=dfd.ioArgs;var _18=_17.args;_17._contentToClean=[];var fn=dojo.byId(_18["form"]);var _19=_18["content"]||{};if(fn){if(_19){var _1a=function(_1b,_1c){dojo.create("input",{type:"hidden",name:_1b,value:_1c},fn);_17._contentToClean.push(_1b);};for(var x in _19){var val=_19[x];if(dojo.isArray(val)&&val.length>1){var i;for(i=0;i<val.length;i++){_1a(x,val[i]);}}else{if(!fn[x]){_1a(x,val);}else{fn[x].value=val;}}}}var _1d=fn.getAttributeNode("action");var _1e=fn.getAttributeNode("method");var _1f=fn.getAttributeNode("target");if(_18["url"]){_17._originalAction=_1d?_1d.value:null;if(_1d){_1d.value=_18.url;}else{fn.setAttribute("action",_18.url);}}if(!_1e||!_1e.value){if(_1e){_1e.value=(_18["method"])?_18["method"]:"post";}else{fn.setAttribute("method",(_18["method"])?_18["method"]:"post");}}_17._originalTarget=_1f?_1f.value:null;if(_1f){_1f.value=this._iframeName;}else{fn.setAttribute("target",this._iframeName);}fn.target=this._iframeName;dojo._ioNotifyStart(dfd);fn.submit();}else{var _20=_18.url+(_18.url.indexOf("?")>-1?"&":"?")+_17.query;dojo._ioNotifyStart(dfd);this.setSrc(this._frame,_20,true);}}catch(e){dfd.errback(e);}},_iframeOnload:function(){var dfd=this._currentDfd;if(!dfd){this._fireNextRequest();return;}var _21=dfd.ioArgs;var _22=_21.args;var _23=dojo.byId(_22.form);if(_23){var _24=_21._contentToClean;for(var i=0;i<_24.length;i++){var key=_24[i];for(var j=0;j<_23.childNodes.length;j++){var _25=_23.childNodes[j];if(_25.name==key){dojo.destroy(_25);break;}}}if(_21["_originalAction"]){_23.setAttribute("action",_21._originalAction);}if(_21["_originalTarget"]){_23.setAttribute("target",_21._originalTarget);_23.target=_21._originalTarget;}}_21._finished=true;}};}if(!dojo._hasResource["esri.layers.FeatureLayer"]){dojo._hasResource["esri.layers.FeatureLayer"]=true;dojo.provide("esri.layers.FeatureLayer");dojo.declare("esri.layers.FeatureLayer",esri.layers.GraphicsLayer,{constructor:function(url,_26){this._outFields=_26&&_26.outFields;this._loadCallback=_26&&_26.loadCallback;var _27=_26&&_26._usePatch;this._usePatch=(_27===null||_27===undefined)?true:_27;this._trackIdField=_26&&_26.trackIdField;this.objectIdField=_26&&_26.objectIdField;this._maxOffset=_26&&_26.maxAllowableOffset;this._optEditable=_26&&_26.editable;this.useMapTime=(_26&&_26.hasOwnProperty("useMapTime"))?(!!_26.useMapTime):true;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var _28=this.constructor,_29=this.mode=(esri._isDefined(_26&&_26.mode)?_26.mode:_28.MODE_ONDEMAND);switch(_29){case _28.MODE_SNAPSHOT:this._mode=new esri.layers._SnapshotMode(this);this._isSnapshot=true;break;case _28.MODE_ONDEMAND:this._tileWidth=(_26&&_26.tileWidth)||512;this._tileHeight=(_26&&_26.tileHeight)||512;this._mode=new esri.layers._OnDemandMode(this);break;case _28.MODE_SELECTION:this._mode=new esri.layers._SelectionMode(this);this._isSelOnly=true;break;}this._initLayer=dojo.hitch(this,this._initLayer);this._selectHandler=dojo.hitch(this,this._selectHandler);if(dojo.isObject(url)&&url.layerDefinition){var _2a=url;this._collection=true;this._editable=true;this.mode=_28.MODE_SNAPSHOT;this._initLayer(_2a);return this;}this._task=new esri.tasks.QueryTask(this.url);var _2b=this._url.path;this._editable=this._fserver=false;if(_2b.search(/\/FeatureServer\//i)!==-1){this._fserver=true;}var _2c=_26&&_26.resourceInfo;if(_2c){this._initLayer(_2c);}else{esri.request({url:_2b,content:dojo.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});}},_initLayer:function(_2d,io){if(_2d||io){this._json=_2d;if(this._collection){this._mode=new esri.layers._SnapshotMode(this);this._isSnapshot=true;this._featureSet=_2d.featureSet;this._nextId=_2d.nextObjectId;_2d=_2d.layerDefinition;}else{if(_2d.hasOwnProperty("capabilities")){var _2e=(this.capabilities=_2d.capabilities);if(_2e&&_2e.toLowerCase().indexOf("editing")!==-1){this._editable=true;}}else{this._editable=this._fserver;}}if(esri._isDefined(this._optEditable)){this._editable=this._optEditable;delete this._optEditable;}this._json=dojo.toJson(this._json);if(this._editable){delete this._maxOffset;}this.minScale=_2d.minScale||0;this.maxScale=_2d.maxScale||0;this.layerId=_2d.id;this.name=_2d.name;this.description=_2d.description;this.copyright=_2d.copyrightText;this.type=_2d.type;this.geometryType=_2d.geometryType;this.displayField=_2d.displayField;this.defaultDefinitionExpression=_2d.definitionExpression;this.fullExtent=new esri.geometry.Extent(_2d.extent);this._isTable=(this.type==="Table");var _2f=this.fields=[];var _30=_2d.fields;for(var i=0;i<_30.length;i++){_2f.push(new esri.layers.Field(_30[i]));}if(!this.objectIdField){this.objectIdField=_2d.objectIdField;if(!this.objectIdField){var _30=_2d.fields;for(var i=0;i<_30.length;i++){var _31=_30[i];if(_31.type==="esriFieldTypeOID"){this.objectIdField=_31.name;break;}}}if(!this.objectIdField){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url},esri.bundle.layers.FeatureLayer.noOIDField));}}if(!esri._isDefined(this._nextId)){var _32=this.objectIdField,_33=-1;if(this._collection&&_32){var _34=this._featureSet,_35=_34&&_34.features,i,il,oid,_36;for(i=0,il=_35?_35.length:0;i<il;i++){_36=_35[i].attributes;oid=_36&&_36[_32];if(oid>_33){_33=oid;}}}this._nextId=(_33+1);}this.globalIdField=_2d.globalIdField;this.typeIdField=_2d.typeIdField;this.visibilityField=_2d.visibilityField;var _37=_2d.defaultSymbol;if(_37){this.defaultSymbol=esri.symbol.fromJson(_37);}var _38=this.types=[];var _39=_2d.types;if(_39){for(var i=0;i<_39.length;i++){_38.push(new esri.layers.FeatureType(_39[i]));}}var _3a=_2d.templates;var _3b=this.templates=[];if(_3a){for(var i=0;i<_3a.length;i++){_3b.push(new esri.layers.FeatureTemplate(_3a[i]));}}var _3c=_2d.timeInfo;if(_3c){this.timeInfo=new esri.layers.TimeInfo(_3c);this._startTimeField=_3c.startTimeField;this._endTimeField=_3c.endTimeField;if(this._startTimeField&&this._endTimeField){this._twoTimeFields=true;}if(this._trackIdField){_3c.trackIdField=this._trackIdField;}else{this._trackIdField=_3c.trackIdField;}}this.relationships=_2d.relationships;this.hasAttachments=(!this._collection&&_2d.hasAttachments)?true:false;this.htmlPopupType=_2d.htmlPopupType;var _3d=_2d.drawingInfo;if(!this.renderer){if(_3d&&_3d.renderer){var _3e=_3d.renderer;this.setRenderer(esri.renderer.fromJson(_3e));if(_3e.type==="classBreaks"){this.renderer._setMaxInclusiveness(true);}if(!this._collection){var _3f=_3e.type,_3e=this.renderer,_40=[];switch(_3f){case "simple":_40.push(_3e.symbol);break;case "uniqueValue":case "classBreaks":_40.push(_3e.defaultSymbol);_40=_40.concat(dojo.map(_3e.infos,function(_41){return _41.symbol;}));break;}_40=dojo.filter(_40,esri._isDefined);var _42=this._url.path+"/images/",_43=this._getToken();dojo.forEach(_40,function(sym){var url=sym.url;if(url){if((url.search(/https?\:/)===-1)&&(url.indexOf("data:")===-1)){sym.url=_42+url;}if(_43&&sym.url.search(/https?\:/)!==-1){sym.url+=("?token="+_43);}}});}}else{if(_37){var _39=this.types,_3e;if(_39.length>0){_3e=new esri.renderer.UniqueValueRenderer(this.defaultSymbol,this.typeIdField);dojo.forEach(_39,function(_44){_3e.addValue(_44.id,_44.symbol);});}else{_3e=new esri.renderer.SimpleRenderer(this.defaultSymbol);}this.setRenderer(_3e);}else{if(!this._isTable){var _45;switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":_45=new esri.symbol.SimpleMarkerSymbol();break;case "esriGeometryPolyline":_45=new esri.symbol.SimpleLineSymbol();break;case "esriGeometryPolygon":_45=new esri.symbol.SimpleFillSymbol();break;}this.setRenderer(_45?new esri.renderer.SimpleRenderer(_45):null);}}}}var _46=(_3d&&_3d.transparency)||0;if(!esri._isDefined(this.opacity)&&_46>0){this.opacity=1-(_46/100);}this.version=_2d.currentVersion;if(!this.version){var ver;if("capabilities" in _2d||"drawingInfo" in _2d||"hasAttachments" in _2d||"htmlPopupType" in _2d||"relationships" in _2d||"timeInfo" in _2d||"typeIdField" in _2d||"types" in _2d){ver=10;}else{ver=9.3;}this.version=ver;}if((dojo.isIE||dojo.isSafari)&&this._editable&&this.version<10.02){this._ts=true;}this.loaded=true;this._fixRendererFields();this._checkFields();if(this._collection){this._fireUpdateStart();var _34=this._featureSet;delete this._featureSet;this._mode._drawFeatures(new esri.tasks.FeatureSet(_34));this._fcAdded=true;}this.onLoad(this);var _47=this._loadCallback;if(_47){delete this._loadCallback;_47(this);}}},setRenderer:function(ren){this.inherited("setRenderer",arguments);var _48=this.renderer;if(_48){this._ager=(_48.declaredClass.indexOf("TemporalRenderer")!==-1&&_48.observationAger&&_48.observationRenderer);var _49=dojo.filter([_48,_48.observationRenderer,_48.latestObservationRenderer,_48.trackRenderer],esri._isDefined);var _4a=[];dojo.forEach(_49,function(rnd){_4a.push(rnd.attributeField);_4a.push(rnd.attributeField2);_4a.push(rnd.attributeField3);},this);this._rendererFields=dojo.filter(_4a,esri._isDefined);}else{this._ager=false;this._rendererFields=[];}if(this.loaded&&this._rendererFields.length>0){this._fixRendererFields();this._checkFields(this._rendererFields);}if(this.loaded&&this._collection){this._typesDirty=true;}},_setMap:function(map,_4b){this._map=map;this._toggleTime(true);var div=this.inherited("_setMap",arguments);this.clearSelection();var _4c=this.renderer;if(this.timeInfo){if(this._trackIdField||(_4c&&(_4c.latestObservationRenderer||_4c.trackRenderer))){this._trackManager=new esri.layers._TrackManager(this);this._trackManager.initialize(map);}}if(this.minScale!==0||this.maxScale!==0){this._zoomConnect=dojo.connect(map,"onZoomEnd",this,this._updateStatus);}var _4d=this._mode;if(_4d){_4d.initialize(map);}return div;},_unsetMap:function(map,_4e){var _4f=this._mode;if(_4f){_4f.destroy();this._mode=null;}if(this._trackManager){this._trackManager.destroy();this._trackManager=null;}dojo.disconnect(this._zoomConnect);this._toggleTime(false);this.inherited("_unsetMap",arguments);},refresh:function(){var _50=this._mode;if(_50){_50.refresh();}},isEditable:function(){return this._editable;},setMaxAllowableOffset:function(_51){if(!this._editable){this._maxOffset=_51;}return this;},setDefinitionExpression:function(_52){this._defnExpr=_52;var _53=this._mode;if(_53){_53.propertyChangeHandler(1);}return this;},getDefinitionExpression:function(){return this._defnExpr;},setTimeDefinition:function(_54){if(this._isSnapshot){this._timeDefn=_54;var _55=this._mode;if(_55){_55.propertyChangeHandler(2);}}return this;},getTimeDefinition:function(){return this._timeDefn;},setTimeOffset:function(_56,_57){this._timeOffset=_56;this._timeOffsetUnits=_57;var _58=this._mode;if(_58){_58.propertyChangeHandler(0);}return this;},setUseMapTime:function(use){this.useMapTime=use;this._toggleTime(!this._suspended);var _59=this._mode;if(_59){_59.propertyChangeHandler(0);}},selectFeatures:function(_5a,_5b,_5c,_5d){_5b=_5b||this.constructor.SELECTION_NEW;var _5e=this._getShallowClone(_5a),map=this._map,dfd=esri._fixDfd(new dojo.Deferred(esri._dfdCanceller));_5e.outFields=this._getOutFields();_5e.returnGeometry=true;if(map){_5e.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());}if(!this._applyQueryFilters(_5e)){var _5f={features:[]};this._selectHandler(_5f,_5b,_5c,_5d,dfd);return dfd;}var _60=this._canDoClientSideQuery(_5e);if(_60){var _5f={features:this._doQuery(_5e,_60)};this._selectHandler(_5f,_5b,_5c,_5d,dfd);return dfd;}else{if(this._collection){var err=new Error("FeatureLayer::selectFeatures - "+esri.bundle.layers.FeatureLayer.invalidParams);this._resolve([err],null,_5d,dfd,true);return dfd;}var _61=this;if(this._ts){_5e._ts=(new Date()).getTime();}var _62=dfd._pendingDfd=this._task.execute(_5e);_62.addCallbacks(function(_63){_61._selectHandler(_63,_5b,_5c,_5d,dfd);},function(err){_61._resolve([err],null,_5d,dfd,true);});return dfd;}},getSelectedFeatures:function(){var _64=this._selectedFeatures,_65=[];for(var _66 in _64){if(_64.hasOwnProperty(_66)){_65.push(_64[_66]);}}return _65;},clearSelection:function(_67){var _68=this._selectedFeatures,_69=this._mode;for(var _6a in _68){if(_68.hasOwnProperty(_6a)){this._unSelectFeatureIIf(_6a,_69);_69._removeFeatureIIf(_6a);}}this._selectedFeatures={};if(this._isSelOnly){_69._applyTimeFilter(true);}if(!_67){this.onSelectionClear();}return this;},setSelectionSymbol:function(_6b){this._selectionSymbol=_6b;if(_6b){var _6c=this._selectedFeatures;for(var _6d in _6c){if(_6c.hasOwnProperty(_6d)){_6c[_6d].setSymbol(_6b);}}}return this;},getSelectionSymbol:function(){return this._selectionSymbol;},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(_6e,_6f,_70,_71,_72,_73){var _74=_73.assembly,dfd=_73.dfd;this._applyNormalized(_6e,_74&&_74[0]);this._applyNormalized(_6f,_74&&_74[1]);this.onBeforeApplyEdits(_6e,_6f,_70);var _75={},_76=this.objectIdField,_77={f:"json"},_78=false;if(this._collection){var _79={};_79.addResults=_6e?dojo.map(_6e,function(){_78=true;return {objectId:this._nextId++,success:true};},this):null;_79.updateResults=_6f?dojo.map(_6f,function(_7a){_78=true;var oid=_7a.attributes[_76];_75[oid]=_7a;return {objectId:oid,success:true};},this):null;_79.deleteResults=_70?dojo.map(_70,function(_7b){_78=true;return {objectId:_7b.attributes[_76],success:true};},this):null;if(_78){this._editHandler(_79,_6e,_75,_71,_72,dfd);}return;}if(_6e&&_6e.length>0){_77.adds=this._convertFeaturesToJson(_6e);_78=true;}if(_6f&&_6f.length>0){for(var i=0;i<_6f.length;i++){var _7c=_6f[i];_75[_7c.attributes[_76]]=_7c;}_77.updates=this._convertFeaturesToJson(_6f);_78=true;}if(_70&&_70.length>0){var ids=[];for(var i=0;i<_70.length;i++){ids.push(_70[i].attributes[_76]);}_77.deletes=ids.join(",");_78=true;}if(_78){var _7d=this;return esri.request({url:this._url.path+"/applyEdits",content:dojo.mixin(_77,this._url.query),callbackParamName:"callback",load:function(_7e){_7d._editHandler(_7e,_6e,_75,_71,_72,dfd);},error:function(err){_7d._resolve([err],null,_72,dfd,true);}},{usePost:true});}},queryFeatures:function(_7f,_80,_81){return this._query("execute","onQueryFeaturesComplete",_7f,_80,_81);},queryRelatedFeatures:function(_82,_83,_84){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",_82,_83,_84);},queryIds:function(_85,_86,_87){return this._query("executeForIds","onQueryIdsComplete",_85,_86,_87);},queryCount:function(_88,_89,_8a){return this._query("executeForCount","onQueryCountComplete",_88,_89,_8a);},queryAttachmentInfos:function(_8b,_8c,_8d){var url=this._url.path+"/"+_8b+"/attachments",dfd=new dojo.Deferred(esri._dfdCanceller),_8e=this;dfd._pendingDfd=esri.request({url:url,content:dojo.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(_8f){var _90=_8f.attachmentInfos;dojo.forEach(_90,function(_91){_91.url=url+"/"+_91.id;_91.objectId=_8b;});_8e._resolve([_90],"onQueryAttachmentInfosComplete",_8c,dfd);},error:function(err){_8e._resolve([err],null,_8d,dfd,true);}});return dfd;},addAttachment:function(_92,_93,_94,_95){return this._sendAttachment("add",_92,_93,_94,_95);},updateAttachment:function(_96,_97,_98,_99,_9a){_98.appendChild(dojo.create("input",{type:"hidden",name:"attachmentId",value:_97}));return this._sendAttachment("update",_96,_98,_99,_9a);},deleteAttachments:function(_9b,_9c,_9d,_9e){var url=this._url.path+"/"+_9b+"/deleteAttachments",dfd=new dojo.Deferred(esri._dfdCanceller),_9f=this,_a0={f:"json",attachmentIds:_9c.join(",")};dfd._pendingDfd=esri.request({url:url,content:dojo.mixin(_a0,this._url.query),callbackParamName:"callback",load:dojo.hitch(this,function(_a1){var _a2=_a1.deleteAttachmentResults;_a2=dojo.map(_a2,function(_a3){var res=new esri.layers.FeatureEditResult(_a3);res.attachmentId=res.objectId;res.objectId=_9b;return res;});_9f._resolve([_a2],"onDeleteAttachmentsComplete",_9d,dfd);}),error:function(err){_9f._resolve([err],null,_9e,dfd,true);}},{usePost:true});return dfd;},addType:function(_a4){if(!this._collection){return false;}var _a5=this.types;if(_a5){var _a6=dojo.some(_a5,function(_a7,_a8){if(_a7.id==_a4.id){return true;}return false;});if(_a6){return false;}else{_a5.push(_a4);}}else{this.types=[_a4];}this._typesDirty=true;return true;},deleteType:function(_a9){if(!this._collection){return;}var _aa=this.types;if(_aa){var _ab=-1;dojo.some(_aa,function(_ac,_ad){if(_ac.id==_a9){_ab=_ad;return true;}return false;});if(_ab>-1){this._typesDirty=true;return _aa.splice(_ab,1)[0];}}},toJson:function(){var _ae=this._json,_af=dojo.isString(_ae)?dojo.fromJson(_ae):dojo.clone(_ae);if(!_af){return;}_af=_af.layerDefinition?_af:{layerDefinition:_af};var _b0=_af.layerDefinition,_b1=this._collection;if(_b1&&this._typesDirty){_b0.types=dojo.map(this.types||[],function(_b2){return _b2.toJson();});var _b3=this.renderer,_b4=_b0.drawingInfo;if(_b4&&_b3&&_b3.declaredClass.indexOf("TemporalRenderer")===-1){_b4.renderer=_b3.toJson();}}var _b5=null;if(!(_b1&&!this._fcAdded)){_b5={geometryType:_b0.geometryType,features:this._convertFeaturesToJson(this.graphics,true)};}_af.featureSet=dojo.mixin({},_af.featureSet||{},_b5);if(_b1){_af.nextObjectId=this._nextId;}return _af;},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},_counter:{value:0},_getUniqueId:function(){return this._counter.value++;},_getDesiredStatus:function(){return this.visible&&this._isMapAtVisibleScale();},_isMapAtVisibleScale:function(){var _b6=esri.geometry.getScale(this._map);var _b7=this.minScale,_b8=this.maxScale,_b9=!_b7,_ba=!_b8;if(!_b9&&_b6<=_b7){_b9=true;}if(!_ba&&_b6>=_b8){_ba=true;}return (_b9&&_ba)?true:false;},_suspend:function(){this.inherited("_suspend",arguments);this._toggleTime(false);var _bb=this._mode;if(_bb){_bb.suspend();}},_resume:function(){this.inherited("_resume",arguments);this._toggleTime(true);var _bc=this._mode;if(_bc){_bc.resume();}},_toggleTime:function(_bd){var map=this._map;if(_bd&&this.timeInfo&&this.useMapTime&&map){this._mapTimeExtent=map.timeExtent;if(!this._timeConnect){this._timeConnect=dojo.connect(map,"onTimeExtentChange",this,this._timeChangeHandler);}}else{this._mapTimeExtent=null;dojo.disconnect(this._timeConnect);this._timeConnect=null;}},_timeChangeHandler:function(_be){this._mapTimeExtent=_be;var _bf=this._mode;if(_bf){_bf.propertyChangeHandler(0);}},_getOffsettedTE:function(_c0){var _c1=this._timeOffset,_c2=this._timeOffsetUnits;return (_c0&&_c1&&_c2)?_c0.offset(-1*_c1,_c2):_c0;},_getTimeOverlap:function(_c3,_c4){if(_c3&&_c4){return _c3.intersection(_c4);}else{return _c3||_c4;}},_getTimeFilter:function(_c5){var _c6=this.getTimeDefinition(),_c7=null,_c8;if(_c6||_c7){_c8=this._getTimeOverlap(_c6,_c7);if(!_c8){return [false];}}if(_c5){_c5=_c8?this._getTimeOverlap(_c5,_c8):_c5;if(!_c5){return [false];}}else{_c5=_c8;}return [true,_c5];},_getAttributeFilter:function(_c9){var _ca=this.getDefinitionExpression();if(_c9){_c9=_ca?"("+_ca+") AND ("+_c9+")":_c9;}else{_c9=_ca;}return _c9;},_applyQueryFilters:function(_cb){_cb.where=this._getAttributeFilter(_cb.where);_cb.maxAllowableOffset=this._maxOffset;if(this.timeInfo){var _cc=this._getTimeFilter(_cb.timeExtent);if(!_cc[0]){return false;}else{_cb.timeExtent=_cc[1];}}return true;},_isNew:function(_cd){var _ce=dojo.indexOf(this._newFeatures,_cd);return _ce===-1?false:true;},_isDeleted:function(_cf){var _d0=_cf.attributes,_d1=this.objectIdField,oid=_d0[_d1];return this._deletedFeatures[oid]?true:false;},_add:function(_d2){var _d3=this._selectionSymbol,_d4=_d2.attributes,_d5=this.visibilityField;if(_d3&&this._isSelOnly){_d2.setSymbol(_d3);}if(_d5&&_d4&&_d4.hasOwnProperty(_d5)){_d2[_d4[_d5]?"show":"hide"]();}return this.add.apply(this,arguments);},_remove:function(){return this.remove.apply(this,arguments);},_canDoClientSideQuery:function(_d6){var _d7=[],map=this._map;if(this._isTable||!map){return;}if(_d6.text||(_d6.where&&_d6.where!==this.getDefinitionExpression())){return;}var _d8=this._isSnapshot,_d9=this._isSelOnly;var _da=_d6.geometry;if(_da){if(!_d9&&_d6.spatialRelationship===esri.tasks.Query.SPATIAL_REL_INTERSECTS&&(_da.type==="extent"&&(_d8||map.extent.contains(_da)))){_d7.push(1);}else{return;}}var ids=_d6.objectIds;if(ids){if(_d8){_d7.push(2);}else{var len=ids.length,_db=this._mode,_dc=0;for(var i=0;i<len;i++){if(_db._getFeature(ids[i])){_dc++;}}if(_dc===len){_d7.push(2);}else{return;}}}if(this.timeInfo){var _dd=_d6.timeExtent,_de=this._mapTimeExtent;if(_d8){if(_dd){_d7.push(3);}}else{if(_d9){if(_dd){return;}}else{if(_de){if(dojo.indexOf(_d7,2)!==-1){if(_dd){_d7.push(3);}}else{return;}}else{if(_d7.length>0){if(_dd){_d7.push(3);}}else{if(_dd){return;}}}}}}return _d7.length>0?_d7:null;},_doQuery:function(_df,_e0,_e1){var _e2=[],_e3=this._mode,_e4=this.objectIdField;if(dojo.indexOf(_e0,2)!==-1){_e2=[];var ids=_df.objectIds,len=ids.length;for(var i=0;i<len;i++){var obj=_e3._getFeature(ids[i]);if(obj){_e2.push(obj);}}if(_e2.length===0){return [];}}if(dojo.indexOf(_e0,1)!==-1){var _e5=_e2.length>0?_e2:this.graphics,len=_e5.length,_e6=_df.geometry._normalize(null,true);_e2=[];for(var i=0;i<len;i++){var _e7=_e5[i],_e8=_e7.geometry;if(this.normalization&&_e6.length){if(_e6[0].intersects(_e8)||_e6[1].intersects(_e8)){_e2.push(_e7);}}else{if(_e6.intersects(_e8)){_e2.push(_e7);}}}if(_e2.length===0){return [];}}if(dojo.indexOf(_e0,3)!==-1){if(this.timeInfo){var _e5=_e2.length>0?_e2:this.graphics,_e9=_df.timeExtent;var _ea=this._filterByTime(_e5,_e9.startTime,_e9.endTime);_e2=_ea.match;}}if(_e1){return dojo.map(_e2,function(obj){return obj.attributes[_e4];},this);}else{return _e2;}},_filterByTime:function(_eb,_ec,_ed){var _ee=this._startTimeField,_ef=this._endTimeField,_f0;if(!this._twoTimeFields){_f0=_ee||_ef;}var _f1=esri._isDefined,yea=[],nay=[];_ec=_ec?_ec.getTime():-Infinity;_ed=_ed?_ed.getTime():Infinity;if(_f0){for(var i=0,len=_eb.length;i<len;i++){var _f2=_eb[i],_f3=_f2.attributes;var _f4=_f3[_f0];if(_f4>=_ec&&_f4<=_ed){yea.push(_f2);}else{nay.push(_f2);}}}else{for(var i=0,len=_eb.length;i<len;i++){var _f2=_eb[i],_f3=_f2.attributes;var _f5=_f3[_ee],end=_f3[_ef];_f5=_f1(_f5)?_f5:-Infinity;end=_f1(end)?end:Infinity;if((_f5>=_ec&&_f5<=_ed)||(end>=_ec&&end<=_ed)){yea.push(_f2);}else{nay.push(_f2);}}}return {match:yea,noMatch:nay};},_resolve:function(_f6,_f7,_f8,dfd,_f9){if(_f7){this[_f7].apply(this,_f6);}if(_f8){_f8.apply(null,_f6);}if(dfd){esri._resDfd(dfd,_f6,_f9);}},_getShallowClone:function(_fa){var _fb=new esri.tasks.Query();for(var _fc in _fa){if(_fa.hasOwnProperty(_fc)){_fb[_fc]=_fa[_fc];}}return _fb;},_query:function(_fd,_fe,_ff,_100,_101){var that=this,dfd=new dojo.Deferred(esri._dfdCanceller);var _102=function(_103,_104){if(!_104&&_fd==="execute"&&!that._isTable){var _105=_103.features,mode=that._mode,_106=that.objectIdField;for(var il=_105.length,i=il-1;i>=0;i--){var oid=_105[i].attributes[_106];var _107=mode._getFeature(oid);if(_107){_105.splice(i,1,_107);}}}that._resolve([_103],_fe,_100,dfd);};if(_fd!=="executeRelationshipQuery"){_ff=this._getShallowClone(_ff);_ff.outFields=this._getOutFields();_ff.returnGeometry=true;var map=this._map;if(map){_ff.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());}if(!this._applyQueryFilters(_ff)){var _108;switch(_fd){case "execute":_108=new esri.tasks.FeatureSet({features:[]});break;case "executeForIds":_108=[];break;case "executeForCount":_108=0;break;}_102(_108,true);return dfd;}var _109=this._canDoClientSideQuery(_ff);if(_109){var _10a=this._doQuery(_ff,_109,(_fd==="executeForIds"||_fd==="executeForCount"));var _108;switch(_fd){case "execute":_108=new esri.tasks.FeatureSet();_108.features=_10a;break;case "executeForIds":_108=_10a;break;case "executeForCount":_108=_10a.length;break;}_102(_108,true);return dfd;}}if(this._collection){var err=new Error("FeatureLayer::_query - "+esri.bundle.layers.FeatureLayer.invalidParams);this._resolve([err],null,_101,dfd,true);return dfd;}if(this._ts){_ff._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task[_fd](_ff);temp.addCallbacks(_102,function(err){that._resolve([err],null,_101,dfd,true);});return dfd;},_convertFeaturesToJson:function(_10b,_10c){var json=[],_10d=this._selectionSymbol,_10e=this.visibilityField;for(var i=0;i<_10b.length;i++){var _10f=_10b[i],_110={},_111=_10f.geometry,attr=_10f.attributes,_112=_10f.symbol;if(_111){_110.geometry=_111.toJson();}if(_10e){_110.attributes=attr=dojo.mixin({},attr);attr[_10e]=_10f.visible?1:0;}else{if(attr){_110.attributes=dojo.mixin({},attr);}}if(_112&&(_112!==_10d)){_110.symbol=_112.toJson();}json.push(_110);}return _10c?json:dojo.toJson(json);},_selectHandler:function(_113,_114,_115,_116,dfd){var _117,ctor=this.constructor;switch(_114){case ctor.SELECTION_NEW:this.clearSelection(true);_117=true;break;case ctor.SELECTION_ADD:_117=true;break;case ctor.SELECTION_SUBTRACT:_117=false;break;}var _118=_113.features,mode=this._mode,_119=[],_11a=this.objectIdField;if(_117){for(var i=0;i<_118.length;i++){var _11b=_118[i];var oid=_11b.attributes[_11a];var _11c=mode._addFeatureIIf(oid,_11b);_119.push(_11c);this._selectFeatureIIf(oid,_11c,mode);}}else{for(var i=0;i<_118.length;i++){var _11b=_118[i];var oid=_11b.attributes[_11a];this._unSelectFeatureIIf(oid,mode);var _11d=mode._removeFeatureIIf(oid);_119.push(_11d||_11b);}}if(this._isSelOnly){mode._applyTimeFilter(true);}this._resolve([_119,_114],"onSelectionComplete",_115,dfd);},_selectFeatureIIf:function(oid,_11e,mode){var _11f=this._selectedFeatures,_120=_11f[oid];if(!_120){mode._incRefCount(oid);_11f[oid]=_11e;if(!this._isTable){this._setSelectSymbol(_11e);}}return _120||_11e;},_unSelectFeatureIIf:function(oid,mode){var _121=this._selectedFeatures[oid];if(_121){mode._decRefCount(oid);delete this._selectedFeatures[oid];if(!this._isTable){this._setUnSelectSymbol(_121);}}return _121;},_isSelected:function(_122){},_setSelectSymbol:function(_123){var _124=this._selectionSymbol;if(_124&&!this._isSelOnly){_123.setSymbol(_124);}},_setUnSelectSymbol:function(_125){var _126=this._selectionSymbol;if(_126&&!this._isSelOnly){if(_126===_125.symbol){_125.setSymbol(null,true);}}},_getOutFields:function(){var _127=dojo.filter([this.objectIdField,this.typeIdField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields),function(_128,_129,arr){return !!_128&&(dojo.indexOf(arr,_128)===_129);});var _12a=dojo.clone(this._outFields);if(_12a){if(dojo.indexOf(_12a,"*")!==-1){return _12a;}dojo.forEach(_127,function(_12b){if(dojo.indexOf(_12a,_12b)===-1){_12a.push(_12b);}});return _12a;}else{return _127;}},_checkFields:function(_12c){var _12d=_12c||this._getOutFields();dojo.forEach(_12d,function(_12e){if(_12e==="*"){return;}if(!this._getField(_12e)){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url,field:_12e},esri.bundle.layers.FeatureLayer.fieldNotFound));}},this);if(!_12c&&!this._isTable&&!this._fserver&&!this._collection){var _12f=dojo.some(this.fields,function(_130){return (_130&&_130.type==="esriFieldTypeGeometry")?true:false;});if(!_12f){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url},esri.bundle.layers.FeatureLayer.noGeometryField));}}},_fixRendererFields:function(){var _131=this.renderer;if(_131&&this.fields.length>0){var _132=dojo.filter([_131,_131.observationRenderer,_131.latestObservationRenderer,_131.trackRenderer],esri._isDefined);var _133=[];dojo.forEach(_132,function(rnd){var _134,_135;_135=rnd.attributeField;if(_135){_134=!this._getField(_135)&&this._getField(_135,true);if(_134){rnd.attributeField=_134.name;}}_135=rnd.attributeField2;if(_135){_134=!this._getField(_135)&&this._getField(_135,true);if(_134){rnd.attributeField2=_134.name;}}_135=rnd.attributeField3;if(_135){_134=!this._getField(_135)&&this._getField(_135,true);if(_134){rnd.attributeField3=_134.name;}}_133.push(rnd.attributeField);_133.push(rnd.attributeField2);_133.push(rnd.attributeField3);},this);this._rendererFields=dojo.filter(_133,esri._isDefined);}},_getField:function(_136,_137){var _138=this.fields;if(_138.length===0){return null;}var _139;if(_137){_136=_136.toLowerCase();}dojo.some(_138,function(_13a){var _13b=false;if(_137){_13b=(_13a&&_13a.name.toLowerCase()===_136)?true:false;}else{_13b=(_13a&&_13a.name===_136)?true:false;}if(_13b){_139=_13a;}return _13b;});return _139;},_getDateOpts:function(){if(!this._dtOpts){var _13c=dojo.map(dojo.filter(this.fields,function(_13d){return !!(_13d&&_13d.type==="esriFieldTypeDate");}),function(_13e){return _13e.name;});this._dtOpts={properties:_13c};}return this._dtOpts;},_applyNormalized:function(_13f,_140){if(_13f&&_140){dojo.forEach(_13f,function(_141,_142){if(_141&&_140[_142]){_141.setGeometry(_140[_142]);}});}},_editHandler:function(_143,adds,_144,_145,_146,dfd){var _147=_143.addResults,_148=_143.updateResults,_149=_143.deleteResults;var mode=this._mode;var _14a=this._isTable;if(_147){for(var i=0;i<_147.length;i++){_147[i]=new esri.layers.FeatureEditResult(_147[i]);if(_14a){continue;}var _14b=_147[i];if(_14b.success){var oid=_14b.objectId,_14c=adds[i],gl=_14c._graphicsLayer;if(gl&&gl!==this){gl.remove(_14c);}var attr=_14c.attributes||{},_14d=this.objectIdField;attr[_14d]=oid;_14c.setAttributes(attr);mode.drawFeature(_14c);}}}if(_148){for(var i=0;i<_148.length;i++){_148[i]=new esri.layers.FeatureEditResult(_148[i]);if(_14a){continue;}var _14b=_148[i];if(_14b.success){var oid=_14b.objectId;var _14c=_144[oid];var _14e=mode._getFeature(oid);if(_14e){if(_14e.geometry!==_14c.geometry){_14e.setGeometry(esri.geometry.fromJson(_14c.geometry.toJson()));}this._repaint(_14e,oid);}}}}if(_149){var _14f=[];for(var i=0;i<_149.length;i++){_149[i]=new esri.layers.FeatureEditResult(_149[i]);if(_14a){continue;}var _14b=_149[i];if(_14b.success){var oid=_14b.objectId;var _14c=mode._getFeature(oid);if(_14c){if(this._unSelectFeatureIIf(oid,mode)){_14f.push(_14c);}_14c._count=0;mode._removeFeatureIIf(oid);}}}if(_14f.length>0){this.onSelectionComplete(_14f,this.constructor.SELECTION_SUBTRACT);}}this._resolve([_147,_148,_149],"onEditsComplete",_145,dfd);},_sendAttachment:function(type,_150,_151,_152,_153){var _154=(type==="add")?"addAttachment":"updateAttachment";var url=this._url.path+"/"+_150+"/"+_154;_151.enctype="multipart/form-data";if(dojo.isIE<9){_151.encoding="multipart/form-data";}_151.method="post";var _155=_151.elements;if(!dojo.some(_155,function(el){return el.name==="f";})){_151.appendChild(dojo.create("input",{type:"hidden",name:"f",value:"json"}));}if(!dojo.some(_155,function(el){return el.name==="callback.html";})){_151.appendChild(dojo.create("input",{type:"hidden",name:"callback.html",value:"textarea"}));}var _156=this._getToken();if(_156&&!dojo.some(_155,function(el){return el.name==="token";})){_151.appendChild(dojo.create("input",{type:"hidden",name:"token",value:_156}));}var dfd=new dojo.Deferred(esri._dfdCanceller),self=this,_157=function(_158){if(!(_158 instanceof Error)){_158=dojo.mixin(new Error(),_158);}self._resolve([_158],null,_153,dfd,true);},_159=(esri.config.defaults.io.alwaysUseProxy||!esri._hasSameOrigin(url,window.location.href))?esri._getProxyUrl():null;dfd._pendingDfd=dojo.io.iframe.send({url:(_159?(_159.path+"?"):"")+url+"?callback.html=textarea",form:_151,handleAs:"json",load:dojo.hitch(this,function(_15a,io){var _15b=_15a.error;if(_15b){_157(_15b);return;}var _15c=(type==="add")?"addAttachmentResult":"updateAttachmentResult";var _15d=(type==="add")?"onAddAttachmentComplete":"onUpdateAttachmentComplete";var _15e=new esri.layers.FeatureEditResult(_15a[_15c]);_15e.attachmentId=_15e.objectId;_15e.objectId=_150;self._resolve([_15e],_15d,_152,dfd);}),error:_157});return dfd;},_repaint:function(_15f,oid,_160){oid=esri._isDefined(oid)?oid:_15f.attributes[this.objectIdField];if(!(oid in this._selectedFeatures)||!this._selectionSymbol){_15f.setSymbol(_15f.symbol,_160);}},_getKind:function(_161){var _162=this._trackManager;if(_162){return _162.isLatestObservation(_161)?1:0;}return 0;}});dojo.mixin(esri.layers.FeatureLayer,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});esri._createWrappers("esri.layers.FeatureLayer");dojo.declare("esri.layers.FeatureType",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.id=json.id;this.name=json.name;var _163=json.symbol;if(_163){this.symbol=esri.symbol.fromJson(_163);}var _164=json.domains;var _165=this.domains={};for(var _166 in _164){if(_164.hasOwnProperty(_166)){var _167=_164[_166];switch(_167.type){case "range":_165[_166]=new esri.layers.RangeDomain(_167);break;case "codedValue":_165[_166]=new esri.layers.CodedValueDomain(_167);break;case "inherited":_165[_166]=new esri.layers.InheritedDomain(_167);break;}}}var _168=json.templates;if(_168){var _169=this.templates=[];for(var i=0;i<_168.length;i++){_169.push(new esri.layers.FeatureTemplate(_168[i]));}}}},toJson:function(){var json={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()};var _16a=this.domains,_16b=this.templates,_16c=esri._sanitize;if(_16a){var _16d=json.domains={};for(var _16e in _16a){if(_16a.hasOwnProperty(_16e)){_16d[_16e]=_16a[_16e]&&_16a[_16e].toJson();}}_16c(_16d);}if(_16b){json.templates=dojo.map(_16b,function(_16f){return _16f.toJson();});}return _16c(json);}});dojo.declare("esri.layers.FeatureTemplate",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.name=json.name;this.description=json.description;this.drawingTool=json.drawingTool;var _170=json.prototype;this.prototype=new esri.Graphic(_170.geometry,null,_170.attributes);}},toJson:function(){return esri._sanitize({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJson()});}});dojo.mixin(esri.layers.FeatureTemplate,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});dojo.declare("esri.layers.FeatureEditResult",null,{constructor:function(json){if(json&&dojo.isObject(json)){this.objectId=json.objectId;this.success=json.success;if(!json.success){var err=json.error;this.error=new Error();this.error.code=err.code;this.error.message=err.description;}}}});dojo.declare("esri.layers._RenderMode",null,{constructor:function(){this._prefix="jsonp_"+(dojo._scopeName||"dojo")+"IoScript";},initialize:function(map){},propertyChangeHandler:function(type){},destroy:function(){},drawFeature:function(_171){},suspend:function(){},resume:function(){},refresh:function(){},_incRefCount:function(oid){var _172=this._featureMap[oid];if(_172){_172._count++;}},_decRefCount:function(oid){var _173=this._featureMap[oid];if(_173){_173._count--;}},_getFeature:function(oid){return this._featureMap[oid];},_addFeatureIIf:function(oid,_174){var fmap=this._featureMap,_175=fmap[oid],_176=this.featureLayer;if(!_175){fmap[oid]=_174;_176._add(_174);_174._count=0;}return _175||_174;},_removeFeatureIIf:function(oid){var _177=this._featureMap[oid],_178=this.featureLayer;if(_177){if(_177._count){return;}delete this._featureMap[oid];_178._remove(_177);}return _177;},_clearIIf:function(){var _179=this.featureLayer,_17a=_179.graphics,_17b=_179._selectedFeatures,_17c=_179.objectIdField;for(var i=_17a.length-1;i>=0;i--){var _17d=_17a[i];var oid=_17d.attributes[_17c];if(oid in _17b){_17d._count=1;continue;}_17d._count=0;this._removeFeatureIIf(oid);}},_isPending:function(id){var dfd=dojo.io.script[this._prefix+id];return dfd?true:false;},_cancelPendingRequest:function(dfd,id){dfd=dfd||dojo.io.script[this._prefix+id];if(dfd){try{dfd.cancel();dojo.io.script._validCheck(dfd);}catch(e){}}},_purgeRequests:function(){dojo.io.script._validCheck(null);},_toggleVisibility:function(show){var _17e=this.featureLayer,_17f=_17e.graphics,_180=show?"show":"hide";show=show&&_17e._ager;for(var i=0,len=_17f.length;i<len;i++){var _181=_17f[i];_181[_180]();if(show){_17e._repaint(_181);}}},_applyTimeFilter:function(_182){var _183=this.featureLayer;if(!_183.timeInfo||_183._suspended){return;}if(!_182){_183._fireUpdateStart();}var _184=_183._trackManager;if(_184){_184.clearTracks();}var defn=_183.getTimeDefinition(),_185=_183._getOffsettedTE(_183._mapTimeExtent);if(_185){_185=_183._getTimeOverlap(defn,_185);if(_185){var _186=_183._filterByTime(_183.graphics,_185.startTime,_185.endTime);if(_184){_184.addFeatures(_186.match);}dojo.forEach(_186.match,function(_187){var _188=_187._shape;if(!_187.visible){_187.show();_188=_187._shape;_188&&_188._moveToFront();}if(_183._ager&&_188){_183._repaint(_187);}});dojo.forEach(_186.noMatch,function(_189){if(_189.visible){_189.hide();}});}else{this._toggleVisibility(false);}}else{if(_184){_184.addFeatures(_183.graphics);}this._toggleVisibility(true);}if(_184){_184.moveLatestToFront();_184.drawTracks();}if(!_182){_183._fireUpdateEnd();}}});dojo.declare("esri.layers._SelectionMode",[esri.layers._RenderMode],{constructor:function(_18a){this.featureLayer=_18a;this._featureMap={};},initialize:function(map){this.map=map;this._init=true;},propertyChangeHandler:function(type){if(this._init&&type===0){this._applyTimeFilter();}},destroy:function(){this._init=false;},resume:function(){this.propertyChangeHandler(0);}});dojo.declare("esri.layers._SnapshotMode",[esri.layers._RenderMode],{constructor:function(_18b){this.featureLayer=_18b;this._featureMap={};this._drawFeatures=dojo.hitch(this,this._drawFeatures);this._queryErrorHandler=dojo.hitch(this,this._queryErrorHandler);},initialize:function(map){this.map=map;var _18c=this.featureLayer;if(_18c._collection){this._applyTimeFilter();}else{this._fetchAll();}this._init=true;},propertyChangeHandler:function(type){if(this._init){if(type){this._fetchAll();}else{this._applyTimeFilter();}}},destroy:function(){this._init=false;},drawFeature:function(_18d){var _18e=this.featureLayer,_18f=_18e.objectIdField,oid=_18d.attributes[_18f];if(!_18e._isDeleted(_18d)){this._addFeatureIIf(oid,_18d);this._incRefCount(oid);}},resume:function(){this.propertyChangeHandler(0);},refresh:function(){var _190=this.featureLayer;if(_190._collection){_190._fireUpdateStart();_190._refresh(true);_190._fireUpdateEnd();}else{this._fetchAll();}},_getRequestId:function(_191){var id="_"+_191.name+_191.layerId+_191._ulid;return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_fetchAll:function(){var _192=this.featureLayer;if(_192._collection){return;}_192._fireUpdateStart();this._clearIIf();this._sendRequest();},_sendRequest:function(){var map=this.map,_193=this.featureLayer,_194=_193.getDefinitionExpression();var _195=new esri.tasks.Query();_195.outFields=_193._getOutFields();_195.where=_194||"1=1";_195.returnGeometry=true;_195.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());_195.timeExtent=_193.getTimeDefinition();_195.maxAllowableOffset=_193._maxOffset;if(_193._ts){_195._ts=(new Date()).getTime();}var _196;if(_193._usePatch){_196=this._getRequestId(_193);this._cancelPendingRequest(null,_196);}_193._task.execute(_195,this._drawFeatures,this._queryErrorHandler,_196);},_drawFeatures:function(_197){this._purgeRequests();var _198=_197.features,_199=this.featureLayer,_19a=_199.objectIdField;for(var i=0,len=_198.length;i<len;i++){var _19b=_198[i];var oid=_19b.attributes[_19a];if(!_199._isDeleted(_19b)){this._addFeatureIIf(oid,_19b);this._incRefCount(oid);}}this._applyTimeFilter(true);_199._fireUpdateEnd();},_queryErrorHandler:function(err){this._purgeRequests();var _19c=this.featureLayer;_19c._errorHandler(err);_19c._fireUpdateEnd(err);}});dojo.declare("esri.layers._OnDemandMode",[esri.layers._RenderMode],{constructor:function(_19d){this.featureLayer=_19d;this._featureMap={};this._queryErrorHandler=dojo.hitch(this,this._queryErrorHandler);},initialize:function(map){this.map=map;this._initialize();this._init=true;},propertyChangeHandler:function(type){if(this._init){if(type<2){this._zoomHandler();}}},destroy:function(){this._disableConnectors();this._init=false;},drawFeature:function(_19e){var _19f=this._gridLayer,geom=_19e.geometry,type=geom.type,_1a0=[];switch(type){case "point":_1a0=_19f.getCellsInExtent({xmin:geom.x,ymin:geom.y,xmax:geom.x,ymax:geom.y}).cells;break;default:_1a0=_19f.getCellsInExtent(geom.getExtent()).cells;break;}var _1a1=this._cellMap,_1a2=this.featureLayer,_1a3=_1a2.objectIdField;for(var i=0;i<_1a0.length;i++){var cell=_1a0[i];var oid=_19e.attributes[_1a3];if(!_1a2._isDeleted(_19e)){_1a1[cell.row][cell.col].features.push(_19e);this._addFeatureIIf(oid,_19e);this._incRefCount(oid);}}},suspend:function(){if(!this._init){return;}this._disableConnectors();},resume:function(){if(!this._init){return;}this._enableConnectors();this._zoomHandler();},refresh:function(){this._zoomHandler();},_initialize:function(){var map=this.map,_1a4=this.featureLayer;var _1a5=_1a4._wrap&&_1a4._srInfo;this._gridLayer=new esri.layers._GridLayout(new esri.geometry.Point(_1a5?_1a5.valid[0]:map.extent.xmin,map.extent.ymax,map.spatialReference),{width:_1a4._tileWidth,height:_1a4._tileHeight},{width:map.width,height:map.height},_1a5);this._ioQueue=[];if(!_1a4._suspended){this._zoomHandler();this._enableConnectors();}},_enableConnectors:function(){var map=this.map;this._zoomConnect=dojo.connect(map,"onZoomEnd",this,this._zoomHandler);this._panConnect=dojo.connect(map,"onPanEnd",this,this._panHandler);},_disableConnectors:function(){dojo.disconnect(this._zoomConnect);dojo.disconnect(this._panConnect);},_zoomHandler:function(){this._processIOQueue(true);var _1a6=this.featureLayer;if(_1a6._suspended){return;}_1a6._fireUpdateStart();this._clearIIf();var _1a7=_1a6._trackManager;if(_1a7){_1a7.clearTracks();}this._cellMap={};this._gridLayer.setResolution(this.map.extent);this._sendRequest();},_panHandler:function(){this.featureLayer._fireUpdateStart();this._sendRequest();},_getRequestId:function(_1a8,cell){var id="_"+_1a8.name+_1a8.layerId+_1a8._ulid+"_"+cell.resolution+"_"+cell.row+"_"+cell.col;return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_sendRequest:function(){var _1a9=this.featureLayer,map=this.map,_1aa=map.extent;var _1ab=this._gridLayer.getCellsInExtent(_1aa),_1ac=_1ab.cells;if(!_1a9._editable){var _1ad=this._cellMap;_1ac=dojo.filter(_1ac,function(cell){if(_1ad[cell.row]&&_1ad[cell.row][cell.col]){return false;}return true;});}var _1ae=_1a9._getOutFields();var _1af=_1a9.getDefinitionExpression();var time=_1a9._getOffsettedTE(_1a9._mapTimeExtent);var _1b0=_1a9._usePatch,_1b1=this._ioQueue;this._pending=this._pending||0;for(var i=0;i<_1ac.length;i++){var cell=_1ac[i];var _1b2=new esri.tasks.Query();_1b2.geometry=cell.extent;_1b2.outFields=_1ae;_1b2.where=_1af;_1b2.returnGeometry=true;_1b2.timeExtent=time;_1b2.maxAllowableOffset=_1a9._maxOffset;if(_1a9._ts){_1b2._ts=(new Date()).getTime();}var _1b3;if(_1b0){_1b3=this._getRequestId(_1a9,cell);if(this._isPending(_1b3)){continue;}}var self=this,func=this._drawFeatures;this._pending++;_1b1.push(_1a9._task.execute(_1b2,function(){var _1b4=cell;return function(_1b5){func.apply(self,[_1b5,_1b4]);};}.call(this),this._queryErrorHandler,_1b3));}this._removeOldCells(_1aa);this._endCheck();},_drawFeatures:function(_1b6,cell){this._finalizeIO();var _1b7=this.featureLayer,map=this.map,_1b8=map.extent,_1b9=cell.extent,row=cell.row,col=cell.col,_1ba=_1b7.objectIdField;var _1bb=_1b6.features,_1bc=this._gridLayer;var _1bd=this._cellMap;var _1be=_1bd[row]&&_1bd[row][col];if((cell.resolution!=this._gridLayer._resolution)||(!_1bc.intersects(_1b9,_1b8))){if(_1be){this._removeCell(row,col);}}else{if(_1be){this._updateCell(_1be,_1bb);}else{cell.features=_1bb;_1bd[row]=_1bd[row]||{};_1bd[row][col]=cell;for(var i=0,len=_1bb.length;i<len;i++){var _1bf=_1bb[i];var oid=_1bf.attributes[_1ba];if(!_1b7._isDeleted(_1bf)){this._addFeatureIIf(oid,_1bf);this._incRefCount(oid);}}}}this._endCheck();},_queryErrorHandler:function(err){this._finalizeIO();this.featureLayer._errorHandler(err);this._endCheck(true);},_finalizeIO:function(){this._purgeRequests();this._pending--;},_endCheck:function(_1c0){if(this._pending===0){this._processIOQueue();var _1c1=this.featureLayer,_1c2=_1c1._trackManager;if(_1c2){_1c2.clearTracks();_1c2.addFeatures(_1c1.graphics);if(_1c1._ager){dojo.forEach(_1c1.graphics,function(_1c3){if(_1c3._shape){_1c1._repaint(_1c3);}});}_1c2.moveLatestToFront();_1c2.drawTracks();}this.featureLayer._fireUpdateEnd(_1c0&&new Error("FeatureLayer: "+esri.bundle.layers.FeatureLayer.updateError));}},_processIOQueue:function(_1c4){this._ioQueue=dojo.filter(this._ioQueue,function(dfd){var keep=dfd.fired>-1?false:true;return keep;});if(_1c4){dojo.forEach(this._ioQueue,this._cancelPendingRequest);}},_removeOldCells:function(_1c5){var _1c6=this._cellMap,_1c7=this._gridLayer;for(var _1c8 in _1c6){if(_1c6[_1c8]){var row=_1c6[_1c8];var _1c9=0,_1ca=0;for(var _1cb in row){if(row[_1cb]){_1c9++;var _1cc=row[_1cb].extent;if(!_1c7.intersects(_1cc,_1c5)){this._removeCell(_1c8,_1cb);_1ca++;}}}if(_1ca===_1c9){delete _1c6[_1c8];}}}},_updateCell:function(cell,_1cd){var _1ce=this.featureLayer,_1cf=_1ce.objectIdField,_1d0=_1ce._selectedFeatures;cell.features=cell.features||[];for(var i=0,len=_1cd.length;i<len;i++){var _1d1=_1cd[i];var oid=_1d1.attributes[_1cf];var _1d2=this._addFeatureIIf(oid,_1d1);if(_1d2===_1d1){this._incRefCount(oid);cell.features.push(_1d2);}else{if(!(oid in _1d0)){_1d2.setGeometry(_1d1.geometry);_1d2.setAttributes(_1d1.attributes);}}}},_removeCell:function(row,col){var _1d3=this._cellMap,_1d4=this.featureLayer,_1d5=_1d4.objectIdField;var cell=_1d3[row]&&_1d3[row][col];if(cell){delete _1d3[row][col];var _1d6=cell.features;for(var i=0;i<_1d6.length;i++){var _1d7=_1d6[i];var oid=_1d7.attributes[_1d5];this._decRefCount(oid);if(oid in _1d4._selectedFeatures){continue;}this._removeFeatureIIf(oid);}}}});dojo.declare("esri.layers._GridLayout",null,{constructor:function(_1d8,_1d9,_1da,_1db){this.origin=_1d8;this.cellWidth=_1d9.width;this.cellHeight=_1d9.height;this.mapWidth=_1da.width;this.mapHeight=_1da.height;this.srInfo=_1db;},setResolution:function(_1dc){this._resolution=(_1dc.xmax-_1dc.xmin)/this.mapWidth;if(this.srInfo){var _1dd=Math.round((2*this.srInfo.valid[1])/this._resolution),_1de=Math.round(_1dd/this.cellWidth);this._frameStats=[_1de,0,_1de-1];}},getCellCoordinates:function(_1df){var res=this._resolution,_1e0=this.origin;return {row:Math.floor((_1e0.y-_1df.y)/(this.cellHeight*res)),col:Math.floor((_1df.x-_1e0.x)/(this.cellWidth*res))};},normalize:function(col){var _1e1=this._frameStats;if(_1e1){var _1e2=_1e1[0],m180=_1e1[1],p180=_1e1[2];if(col<m180){col=col%_1e2;col=col<m180?col+_1e2:col;}else{if(col>p180){col=col%_1e2;}}}return col;},intersects:function(_1e3,_1e4){var _1e5=this.srInfo;if(_1e5){return dojo.some(_1e4._getParts(_1e5),function(_1e6){return _1e3.intersects(_1e6.extent);});}else{return _1e3.intersects(_1e4);}},getCellExtent:function(row,col){var res=this._resolution,_1e7=this.origin,_1e8=this.cellWidth,_1e9=this.cellHeight;return new esri.geometry.Extent((col*_1e8*res)+_1e7.x,_1e7.y-((row+1)*_1e9*res),((col+1)*_1e8*res)+_1e7.x,_1e7.y-(row*_1e9*res),new esri.SpatialReference(_1e7.spatialReference.toJson()));},getCellsInExtent:function(_1ea){var _1eb=this.getCellCoordinates({x:_1ea.xmin,y:_1ea.ymax}),_1ec=this.getCellCoordinates({x:_1ea.xmax,y:_1ea.ymin}),_1ed=_1eb.row,_1ee=_1ec.row,_1ef=_1eb.col,_1f0=_1ec.col,_1f1=[],i,j,nj;for(i=_1ed;i<=_1ee;i++){for(j=_1ef;j<=_1f0;j++){nj=this.normalize(j);_1f1.push({row:i,col:nj,extent:this.getCellExtent(i,nj),resolution:this._resolution});}}return {minRow:_1ed,maxRow:_1ee,minCol:_1ef,maxCol:_1f0,cells:_1f1};}});dojo.declare("esri.layers._TrackManager",null,{constructor:function(_1f2){this.layer=_1f2;this.trackMap={};},initialize:function(map){this.map=map;var _1f3=this.layer,_1f4=_1f3.renderer.trackRenderer;if(_1f4&&(_1f3.geometryType==="esriGeometryPoint")){var _1f5=(this.container=new esri.layers._GraphicsLayer({id:_1f3.id+"_tracks"}));_1f5._onPanHandler=function(){};_1f5._setMap(map,_1f3._div);_1f5.setRenderer(_1f4);}},addFeatures:function(_1f6){var _1f7=this.trackMap,_1f8=this.layer,_1f9=_1f8._trackIdField;dojo.forEach(_1f6,function(_1fa){var _1fb=_1fa.attributes,tkid=_1fb[_1f9];var ary=(_1f7[tkid]=(_1f7[tkid]||[]));ary.push(_1fa);});var _1fc=_1f8._startTimeField,_1fd=_1f8.objectIdField;var _1fe=function(a,b){var _1ff=a.attributes[_1fc],_200=b.attributes[_1fc];if(_1ff===_200){return (a.attributes[_1fd]<b.attributes[_1fd])?-1:1;}else{return (_1ff<_200)?-1:1;}};for(var tkid in _1f7){_1f7[tkid].sort(_1fe);}},drawTracks:function(){var _201=this.container;if(!_201){return;}var _202=this.trackMap,sr=this.map.spatialReference;var _203=function(_204){var _205=_204.geometry;return [_205.x,_205.y];};for(var tkid in _202){var path=dojo.map(_202[tkid],_203);_201.add(new esri.Graphic(new esri.geometry.Polyline({paths:[path],spatialReference:sr})));}},moveLatestToFront:function(){dojo.forEach(this.getLatestObservations(),function(_206){var _207=_206._shape;_207&&_207._moveToFront();this._repaint(_206,null,true);},this.layer);},getLatestObservations:function(){var _208=[];if(!this.layer.renderer.latestObservationRenderer){return _208;}var _209=this.trackMap;for(var tkid in _209){var ary=_209[tkid];_208.push(ary[ary.length-1]);}return _208;},clearTracks:function(){var _20a=this.getLatestObservations();this.trackMap={};var _20b=this.container;if(_20b){_20b.clear();}dojo.forEach(_20a,function(_20c){this._repaint(_20c,null,true);},this.layer);},isLatestObservation:function(_20d){var _20e=this.layer._trackIdField;var _20f=this.trackMap[_20d.attributes[_20e]];if(_20f){return (_20f[_20f.length-1]===_20d);}return false;},destroy:function(){var _210=this.container;if(_210){_210.clear();_210._unsetMap(this.map,this.layer._div);this.container=null;}this.map=null;this.layer=null;this.trackMap=null;}});}if(!dojo._hasResource["esri.layers.MapImageLayer"]){dojo._hasResource["esri.layers.MapImageLayer"]=true;dojo.provide("esri.layers.MapImageLayer");dojo.declare("esri.layers.MapImageLayer",[esri.layers.Layer],{"-chains-":{constructor:"manual"},constructor:function(_211){this.inherited(arguments,[null,_211]);this._mapImages=[];var _212=dojo.hitch;this._panStart=_212(this,this._panStart);this._pan=_212(this,this._pan);this._extentChange=_212(this,this._extentChange);this._zoom=_212(this,this._zoom);this.loaded=true;this.onLoad(this);},opacity:1,setOpacity:function(_213){if(this.opacity!=_213){this.onOpacityChange(this.opacity=_213);}},onOpacityChange:function(_214){if(this._div){dojo.style(this._div,"opacity",_214);}},_transform:esri._getDOMAccessor("transform"),addImage:function(_215){var _216=this._mapImages.push(_215);_216=_216-1;_215._idx=_216;_215._layer=this;if(this._div){this._createImage(_215,_216);}},removeImage:function(_217){if(_217){var idx=_217._idx,_218=this._mapImages;if(_218[idx]===_217){delete _218[idx];var node=_217._node;if(node){this._clearEvents(node);node.e_idx=node.e_bl=node.e_tr=node.e_l=node.e_t=node.e_w=node.e_h=null;var div=this._div;if(div){div.removeChild(node);dojo.destroy(node);}}_217._node=_217._idx=_217._layer=null;}}},removeAllImages:function(){var _219=this._mapImages,i,len=_219.length;for(i=0;i<len;i++){var _21a=_219[i];if(_21a){this.removeImage(_21a);}}this._mapImages=[];},getImages:function(){var _21b=this._mapImages,_21c=[],i,len=_21b.length;for(i=0;i<len;i++){if(_21b[i]){_21c.push(_21b[i]);}}return _21c;},_createImage:function(_21d,idx){var node=dojo.create("img");dojo.style(node,{position:"absolute",left:"0px",top:"0px"});if(_21d.rotation){var _21e="rotate("+(360-_21d.rotation)+"deg)";if(dojo.isIE<9){}else{dojo.style(node,this._transform,_21e);dojo.style(node,"transform",_21e);}}_21d._node=node;node.e_idx=idx;node.e_layer=this;node.e_load=dojo.connect(node,"onload",esri.layers.MapImageLayer.prototype._imageLoaded);node.e_error=dojo.connect(node,"onerror",esri.layers.MapImageLayer.prototype._imageError);node.e_abort=dojo.connect(node,"onabort",esri.layers.MapImageLayer.prototype._imageError);node.src=_21d.href;},_imageLoaded:function(evt){var node=evt.target||evt.currentTarget,self=node.e_layer,_21f=self._mapImages[node.e_idx];self._clearEvents(node);if(!_21f||_21f._node!==node){return;}if(self._map){self._attach(_21f);}},_imageError:function(evt){var node=evt.target||evt.currentTarget,self=node.e_layer,_220=self._mapImages[node.e_idx];self._clearEvents(node);if(_220){_220._node=null;}},_clearEvents:function(node){var _221=dojo.disconnect;_221(node.e_load);_221(node.e_error);_221(node.e_abort);node.e_load=node.e_error=node.e_abort=node.e_layer=null;},_attach:function(_222){var _223=_222.extent,_224=_223.spatialReference,_225=this._sr,_226=_224.wkid||4326,div=this._div,node=_222._node,_227=new esri.geometry.Point({x:_223.xmin,y:_223.ymin}),_228=new esri.geometry.Point({x:_223.xmax,y:_223.ymax});if(_224&&(_226!==_225.wkid)){if(_226===4326&&_225._isWebMercator()){node.e_bl=esri.geometry.geographicToWebMercator(_227);node.e_tr=esri.geometry.geographicToWebMercator(_228);}else{if(_224._isWebMercator()&&_225.wkid===4326){node.e_bl=esri.geometry.webMercatorToGeographic(_227);node.e_tr=esri.geometry.webMercatorToGeographic(_228);}}}else{node.e_bl=_227;node.e_tr=_228;}if(_222.visible){this._setPos(node,dojo.style(div,"left"),dojo.style(div,"top"));div.appendChild(node);}},_setPos:function(node,_229,_22a){var _22b=node.e_bl,_22c=node.e_tr,map=this._map;_22b=map.toScreen(_22b);_22c=map.toScreen(_22c);var left=_22b.x-_229,top=_22c.y-_22a,_22d=Math.abs(_22c.x-_22b.x),_22e=Math.abs(_22b.y-_22c.y);dojo.style(node,{left:left+"px",top:top+"px",width:_22d+"px",height:_22e+"px"});node.e_l=left;node.e_t=top;node.e_w=_22d;node.e_h=_22e;},_setMap:function(map,_22f){this._map=map;this._sr=map.spatialReference;var div=this._div=dojo.create("div",null,_22f);dojo.style(div,"position","absolute");dojo.style(div,"opacity",this.opacity);var _230=this._mapImages,i,len=_230.length;for(i=0;i<len;i++){var _231=_230[i],node=_231._node;if(!node){this._createImage(_231,_231._idx);}}this.onVisibilityChange(this.visible);return div;},_unsetMap:function(map,_232){this._disconnect();var div=this._div;if(div){var _233=this._mapImages,i,len=_233.length;for(i=0;i<len;i++){var _234=_233[i];if(_234){var node=_234._node;if(node){this._clearEvents(node);node.e_idx=node.e_bl=node.e_tr=node.e_l=node.e_t=node.e_w=node.e_h=null;}_234._node=null;}}_232.removeChild(div);dojo.destroy(div);}this._map=this._div=this._sr=null;},onVisibilityChange:function(_235){var div=this._div;if(div){if(_235){this._redraw();this._connect(this._map);esri.show(div);}else{this._disconnect();esri.hide(div);}}},_connect:function(map){if(!this._connections){var _236=dojo.connect;this._connections=[_236(map,"onPanStart",this._panStart),_236(map,"onPan",this._pan),_236(map,"onExtentChange",this._extentChange),_236(map,"onZoom",this._zoom)];}},_disconnect:function(){if(this._connections){dojo.forEach(this._connections,dojo.disconnect);this._connections=null;}},_panStart:function(){this._panL=dojo.style(this._div,"left");this._panT=dojo.style(this._div,"top");},_pan:function(_237,_238){dojo.style(this._div,{left:this._panL+_238.x+"px",top:this._panT+_238.y+"px"});},_extentChange:function(_239,_23a,_23b){if(_23b){this._redraw();}else{if(_23a){dojo.style(this._div,{left:this._panL+_23a.x+"px",top:this._panT+_23a.y+"px"});}}},_redraw:function(){var div=this._div,_23c=dojo.style(div,"left"),_23d=dojo.style(div,"top"),i,len=div.childNodes.length,node;for(i=0;i<len;i++){node=div.childNodes[i];this._setPos(node,_23c,_23d);}},_zoom:function(_23e,_23f,_240){var div=this._div,_241=dojo.style(div,"left"),_242=dojo.style(div,"top"),i,len=div.childNodes.length,node;for(i=0;i<len;i++){node=div.childNodes[i];var _243=node.e_w*_23f,_244=node.e_h*_23f,_245=(_240.x-_241-node.e_l)*(_243-node.e_w)/node.e_w,_246=(_240.y-_242-node.e_t)*(_244-node.e_h)/node.e_h;_245=isNaN(_245)?0:_245;_246=isNaN(_246)?0:_246;dojo.style(node,{left:(node.e_l-_245)+"px",top:(node.e_t-_246)+"px",width:_243+"px",height:_244+"px"});}}});dojo.extend(esri.layers.MapImage,{visible:true,getLayer:function(){return this._layer;},getNode:function(){return this._node;},show:function(){if(!this.visible){this.visible=true;var node=this._node,_247=this._layer;if(node){if(_247&&_247._div){_247._setPos(node,dojo.style(_247._div,"left"),dojo.style(_247._div,"top"));_247._div.appendChild(node);}esri.show(node);}}},hide:function(){if(this.visible){this.visible=false;var node=this._node,_248=this._layer;if(node){esri.hide(node);_248&&_248._div&&_248._div.removeChild(node);}}}});}if(!dojo._hasResource["esri.PopupBase"]){dojo._hasResource["esri.PopupBase"]=true;dojo.provide("esri.PopupBase");dojo.declare("esri.PopupBase",null,{onSetFeatures:function(){},onClearFeatures:function(){},onSelectionChange:function(){},onDfdComplete:function(){},initialize:function(){this.count=0;this.selectedIndex=-1;},cleanup:function(){this.features=this.deferreds=null;},setFeatures:function(arg){if(!arg||!arg.length){return;}this.clearFeatures();var _249,_24a;if(arg[0] instanceof dojo.Deferred){_24a=arg;}else{_249=arg;}if(_249){this._updateFeatures(null,_249);}else{this.deferreds=_24a;_24a=_24a.slice(0);dojo.forEach(_24a,function(dfd){dfd.addBoth(dojo.hitch(this,this._updateFeatures,dfd));},this);}},clearFeatures:function(){this.features=this.deferreds=null;this.count=0;var _24b=this.selectedIndex;this.selectedIndex=-1;if(_24b>-1){this.onSelectionChange();}this.onClearFeatures();},getSelectedFeature:function(){var _24c=this.features;if(_24c){return _24c[this.selectedIndex];}},select:function(_24d){if(_24d<0||_24d>=this.count){return;}this.selectedIndex=_24d;this.onSelectionChange();},enableHighlight:function(map){this._highlighted=map.graphics.add(new esri.Graphic(new esri.geometry.Point(0,0,map.spatialReference)));this._highlighted.hide();var ESYM=esri.symbol;if(!this.markerSymbol){var _24e=(this.markerSymbol=new ESYM.SimpleMarkerSymbol());_24e.setStyle(ESYM.SimpleMarkerSymbol.STYLE_TARGET);_24e._setDim(16,16,7);_24e.setOutline(new ESYM.CartographicLineSymbol(ESYM.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,255,255]),2,ESYM.CartographicLineSymbol.CAP_ROUND,ESYM.CartographicLineSymbol.JOIN_ROUND));_24e.setColor(new dojo.Color([0,0,0,0]));}if(!this.lineSymbol){this.lineSymbol=new ESYM.SimpleLineSymbol(ESYM.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,255,255]),2);}if(!this.fillSymbol){this.fillSymbol=new ESYM.SimpleFillSymbol(ESYM.SimpleFillSymbol.STYLE_NULL,new ESYM.SimpleLineSymbol(ESYM.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([0,255,255]),2),new dojo.Color([0,0,0,0]));}},disableHighlight:function(map){var _24f=this._highlighted;if(_24f){_24f.hide();map.graphics.remove(_24f);delete this._highlighted;}this.markerSymbol=this.lineSymbol=this.fillSymbol=null;},showHighlight:function(){if(this._highlighted&&this.features&&this.features[this.selectedIndex]){this._highlighted.show();}},hideHighlight:function(){if(this._highlighted){this._highlighted.hide();}},updateHighlight:function(map,_250){var _251=_250.geometry,_252=this._highlighted;if(!_251||!_252){return;}_252.hide();if(!_252.getLayer()&&map){map.graphics.add(_252);}_252.setGeometry(esri.geometry.fromJson(_251.toJson()));var _253;switch(_251.type){case "point":case "multipoint":_253=this.markerSymbol;_253.setOffset(0,0);_253.setAngle(0);var lyr=_250.getLayer();if(lyr){var _254=lyr._getSymbol(_250),_255,_256,xoff=0,yoff=0,_257=0;if(_254){switch(_254.type){case "simplemarkersymbol":_255=_256=(_254.size||0);break;case "picturemarkersymbol":_255=(_254.width||0);_256=(_254.height||0);break;}xoff=_254.xoffset||0;yoff=_254.yoffset||0;_257=_254.angle||0;}if(_255&&_256){_253._setDim(_255+1,_256+1,7);}_253.setOffset(xoff,yoff);_253.setAngle(_257);}break;case "polyline":_253=this.lineSymbol;break;case "polygon":_253=this.fillSymbol;break;}_252.setSymbol(_253);},_unbind:function(dfd){var _258=dojo.indexOf(this.deferreds,dfd);if(_258===-1){return;}this.deferreds.splice(_258,1);if(!this.deferreds.length){this.deferreds=null;return 2;}return 1;},_updateFeatures:function(dfd,_259){if(dfd){if(this.deferreds){var res=this._unbind(dfd);if(!res){return;}if(_259&&_259 instanceof Error){this.onDfdComplete(_259);if(res===2){this.onSetFeatures();}return;}if(_259&&_259.length){if(!this.features){this.features=_259;this.count=_259.length;this.selectedIndex=0;this.onDfdComplete();if(res===2){this.onSetFeatures();}this.select(0);}else{var _25a=dojo.filter(_259,function(_25b){return dojo.indexOf(this.features,_25b)===-1;},this);this.features=this.features.concat(_25a);this.count=this.features.length;this.onDfdComplete();if(res===2){this.onSetFeatures();}}}else{this.onDfdComplete();if(res===2){this.onSetFeatures();}}}}else{this.features=_259;this.count=_259.length;this.selectedIndex=0;this.onSetFeatures();this.select(0);}}});dojo.declare("esri.PopupInfoTemplate",[esri.InfoTemplate],{"-chains-":{constructor:"manual"},initialize:function(json){if(!json){return;}this.info=json;this.title=this.getTitle;this.content=this.getContent;var _25c=(this._fieldLabels={}),_25d=(this._fieldsMap={});if(json.fieldInfos){dojo.forEach(json.fieldInfos,function(_25e){_25c[_25e.fieldName]=_25e.label;_25d[_25e.fieldName]=_25e;});}},toJson:function(){return dojo.fromJson(dojo.toJson(this.info));},getTitle:function(){},getContent:function(){},getComponents:function(_25f){var _260=this.info,_261=_25f.getLayer(),_262=dojo.clone(_25f.attributes)||{},_263=dojo.clone(_262),_264=_260.fieldInfos,_265="",_266="",_267,_268,_269,_26a=_261&&_261._getDateOpts&&_261._getDateOpts().properties,_26b={dateFormat:{properties:_26a,formatter:"DateFormat"+this._dateFormats["shortDateShortTime"]}};if(_264){dojo.forEach(_264,function(_26c){var _26d=_26c.fieldName,val=_263[_26d];_263[_26d]=this._formatValue(val,_26d,_26b);if(_26a&&_26c.format&&_26c.format.dateFormat){var pos=dojo.indexOf(_26a,_26d);if(pos>-1){_26a.splice(pos,1);}}},this);}if(_261){var _26e=_261.types,_26f=_261.typeIdField,_270=_26f&&_262[_26f];for(_268 in _262){_269=_262[_268];if(esri._isDefined(_269)){var _271=this._getDomainName(_261,_26e,_270,_268,_269);if(esri._isDefined(_271)){_263[_268]=_271;}else{if(_268===_26f){var _272=this._getTypeName(_261,_269);if(esri._isDefined(_272)){_263[_268]=_272;}}}}}}if(_260.title){_265=dojo.trim(esri.substitute(_263,this._fixTokens(_260.title),_26b)||"");}if(_260.description){_266=dojo.trim(esri.substitute(_263,this._fixTokens(_260.description),_26b)||"");}if(_264){_267=[];dojo.forEach(_264,function(_273){_268=_273.fieldName;if(_268&&_273.visible){_267.push([_273.label||_268,esri.substitute(_263,"${"+_268+"}",_26b)||""]);}});}var _274,_275;if(_260.mediaInfos){_274=[];dojo.forEach(_260.mediaInfos,function(_276){_275=0;_269=_276.value;switch(_276.type){case "image":var url=_269.sourceURL;url=url&&dojo.trim(esri.substitute(_262,this._fixTokens(url)));_275=!!url;break;case "piechart":case "linechart":case "columnchart":case "barchart":_275=dojo.some(_269.fields,function(_277){return esri._isDefined(_262[_277]);});break;default:return;}if(_275){_276=dojo.clone(_276);_269=_276.value;_276.title=_276.title?dojo.trim(esri.substitute(_263,this._fixTokens(_276.title),_26b)||""):"";_276.caption=_276.caption?dojo.trim(esri.substitute(_263,this._fixTokens(_276.caption),_26b)||""):"";if(_276.type==="image"){_269.sourceURL=esri.substitute(_262,this._fixTokens(_269.sourceURL));if(_269.linkURL){_269.linkURL=dojo.trim(esri.substitute(_262,this._fixTokens(_269.linkURL))||"");}}else{var _278=_262[_269.normalizeField]||0;_269.fields=dojo.map(_269.fields,function(_279){var data=_262[_279];data=(data===undefined)?null:data;if(data&&_278){data=data/_278;}return {y:data,tooltip:(this._fieldLabels[_279]||_279)+":<br/>"+this._formatValue(data,_279,_26b)};},this);}_274.push(_276);}},this);}return {title:_265,description:_266,fields:(_267&&_267.length)?_267:null,mediaInfos:(_274&&_274.length)?_274:null,formatted:_263};},getAttachments:function(_27a){var _27b=_27a.getLayer(),_27c=_27a.attributes;if(this.info.showAttachments&&_27b&&_27b.hasAttachments&&_27b.objectIdField){var oid=_27c&&_27c[_27b.objectIdField];if(oid){return _27b.queryAttachmentInfos(oid);}}},_dateFormats:{"shortDate":"(datePattern: 'M/d/y', selector: 'date')","longMonthDayYear":"(datePattern: 'MMMM d, y', selector: 'date')","dayShortMonthYear":"(datePattern: 'd MMM y', selector: 'date')","longDate":"(datePattern: 'EEEE, MMMM d, y', selector: 'date')","shortDateShortTime":"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')","shortDateShortTime24":"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')","longMonthYear":"(datePattern: 'MMMM y', selector: 'date')","shortMonthYear":"(datePattern: 'MMM y', selector: 'date')","year":"(datePattern: 'y', selector: 'date')"},_fixTokens:function(_27d){return _27d.replace(/(\{[^\{\r\n]+\})/g,"$$$1");},_formatValue:function(val,_27e,_27f){var _280=this._fieldsMap[_27e],fmt=_280&&_280.format;if(!esri._isDefined(val)||!_280||!esri._isDefined(fmt)){return val;}var _281="",_282=[],_283=fmt.hasOwnProperty("places")||fmt.hasOwnProperty("digitSeparator"),_284=fmt.hasOwnProperty("digitSeparator")?fmt.digitSeparator:true;if(_283){_281="NumberFormat";_282.push("places: "+(esri._isDefined(fmt.places)?Number(fmt.places):"Infinity"));if(_282.length){_281+=("("+_282.join(",")+")");}}else{if(fmt.dateFormat){_281="DateFormat"+(this._dateFormats[fmt.dateFormat]||this._dateFormats["shortDateShortTime"]);}else{return val;}}var _285=esri.substitute({"myKey":val},"${myKey:"+_281+"}",_27f)||"";if(_283&&!_284){var _286=dojo.i18n.getLocalization("dojo.cldr","number");if(_286.group){_285=_285.replace(new RegExp("\\"+_286.group,"g"),"");}}return _285;},_getDomainName:function(_287,_288,_289,_28a,_28b){var _28c,stop;if(_288&&esri._isDefined(_289)){dojo.some(_288,function(_28d){if(_28d.id==_289){_28c=_28d.domains&&_28d.domains[_28a];if(_28c&&_28c.type==="inherited"){_28c=this._getLayerDomain(_287,_28a);stop=true;}return true;}return false;},this);}if(!stop&&!_28c){_28c=this._getLayerDomain(_287,_28a);}if(_28c&&_28c.codedValues){var _28e;dojo.some(_28c.codedValues,function(_28f){if(_28f.code==_28b){_28e=_28f.name;return true;}return false;});return _28e;}},_getLayerDomain:function(_290,_291){var _292=_290.fields;if(_292){var _293;dojo.some(_292,function(_294){if(_294.name===_291){_293=_294.domain;return true;}return false;});return _293;}},_getTypeName:function(_295,id){var _296=_295.types;if(_296){var _297;dojo.some(_296,function(_298){if(_298.id==id){_297=_298.name;return true;}return false;});return _297;}}});}if(!dojo._hasResource["dojox.charting.scaler.common"]){dojo._hasResource["dojox.charting.scaler.common"]=true;dojo.provide("dojox.charting.scaler.common");(function(){var eq=function(a,b){return Math.abs(a-b)<=0.000001*(Math.abs(a)+Math.abs(b));};dojo.mixin(dojox.charting.scaler.common,{findString:function(val,text){val=val.toLowerCase();for(var i=0;i<text.length;++i){if(val==text[i]){return true;}}return false;},getNumericLabel:function(_299,_29a,_29b){var def="";if(dojo.number){def=(_29b.fixed?dojo.number.format(_299,{places:_29a<0?-_29a:0}):dojo.number.format(_299))||"";}else{def=_29b.fixed?_299.toFixed(_29a<0?-_29a:0):_299.toString();}if(_29b.labelFunc){var r=_29b.labelFunc(def,_299,_29a);if(r){return r;}}if(_29b.labels){var l=_29b.labels,lo=0,hi=l.length;while(lo<hi){var mid=Math.floor((lo+hi)/2),val=l[mid].value;if(val<_299){lo=mid+1;}else{hi=mid;}}if(lo<l.length&&eq(l[lo].value,_299)){return l[lo].text;}--lo;if(lo>=0&&lo<l.length&&eq(l[lo].value,_299)){return l[lo].text;}lo+=2;if(lo<l.length&&eq(l[lo].value,_299)){return l[lo].text;}}return def;}});})();}if(!dojo._hasResource["dojox.charting.scaler.linear"]){dojo._hasResource["dojox.charting.scaler.linear"]=true;dojo.provide("dojox.charting.scaler.linear");(function(){var _29c=3,dc=dojox.charting,dcs=dc.scaler,dcsc=dcs.common,_29d=dcsc.findString,_29e=dcsc.getNumericLabel;var _29f=function(min,max,_2a0,_2a1,_2a2,_2a3,span){_2a0=dojo.delegate(_2a0);if(!_2a1){if(_2a0.fixUpper=="major"){_2a0.fixUpper="minor";}if(_2a0.fixLower=="major"){_2a0.fixLower="minor";}}if(!_2a2){if(_2a0.fixUpper=="minor"){_2a0.fixUpper="micro";}if(_2a0.fixLower=="minor"){_2a0.fixLower="micro";}}if(!_2a3){if(_2a0.fixUpper=="micro"){_2a0.fixUpper="none";}if(_2a0.fixLower=="micro"){_2a0.fixLower="none";}}var _2a4=_29d(_2a0.fixLower,["major"])?Math.floor(_2a0.min/_2a1)*_2a1:_29d(_2a0.fixLower,["minor"])?Math.floor(_2a0.min/_2a2)*_2a2:_29d(_2a0.fixLower,["micro"])?Math.floor(_2a0.min/_2a3)*_2a3:_2a0.min,_2a5=_29d(_2a0.fixUpper,["major"])?Math.ceil(_2a0.max/_2a1)*_2a1:_29d(_2a0.fixUpper,["minor"])?Math.ceil(_2a0.max/_2a2)*_2a2:_29d(_2a0.fixUpper,["micro"])?Math.ceil(_2a0.max/_2a3)*_2a3:_2a0.max;if(_2a0.useMin){min=_2a4;}if(_2a0.useMax){max=_2a5;}var _2a6=(!_2a1||_2a0.useMin&&_29d(_2a0.fixLower,["major"]))?min:Math.ceil(min/_2a1)*_2a1,_2a7=(!_2a2||_2a0.useMin&&_29d(_2a0.fixLower,["major","minor"]))?min:Math.ceil(min/_2a2)*_2a2,_2a8=(!_2a3||_2a0.useMin&&_29d(_2a0.fixLower,["major","minor","micro"]))?min:Math.ceil(min/_2a3)*_2a3,_2a9=!_2a1?0:(_2a0.useMax&&_29d(_2a0.fixUpper,["major"])?Math.round((max-_2a6)/_2a1):Math.floor((max-_2a6)/_2a1))+1,_2aa=!_2a2?0:(_2a0.useMax&&_29d(_2a0.fixUpper,["major","minor"])?Math.round((max-_2a7)/_2a2):Math.floor((max-_2a7)/_2a2))+1,_2ab=!_2a3?0:(_2a0.useMax&&_29d(_2a0.fixUpper,["major","minor","micro"])?Math.round((max-_2a8)/_2a3):Math.floor((max-_2a8)/_2a3))+1,_2ac=_2a2?Math.round(_2a1/_2a2):0,_2ad=_2a3?Math.round(_2a2/_2a3):0,_2ae=_2a1?Math.floor(Math.log(_2a1)/Math.LN10):0,_2af=_2a2?Math.floor(Math.log(_2a2)/Math.LN10):0,_2b0=span/(max-min);if(!isFinite(_2b0)){_2b0=1;}return {bounds:{lower:_2a4,upper:_2a5,from:min,to:max,scale:_2b0,span:span},major:{tick:_2a1,start:_2a6,count:_2a9,prec:_2ae},minor:{tick:_2a2,start:_2a7,count:_2aa,prec:_2af},micro:{tick:_2a3,start:_2a8,count:_2ab,prec:0},minorPerMajor:_2ac,microPerMinor:_2ad,scaler:dcs.linear};};dojo.mixin(dojox.charting.scaler.linear,{buildScaler:function(min,max,span,_2b1){var h={fixUpper:"none",fixLower:"none",natural:false};if(_2b1){if("fixUpper" in _2b1){h.fixUpper=String(_2b1.fixUpper);}if("fixLower" in _2b1){h.fixLower=String(_2b1.fixLower);}if("natural" in _2b1){h.natural=Boolean(_2b1.natural);}}if("min" in _2b1){min=_2b1.min;}if("max" in _2b1){max=_2b1.max;}if(_2b1.includeZero){if(min>0){min=0;}if(max<0){max=0;}}h.min=min;h.useMin=true;h.max=max;h.useMax=true;if("from" in _2b1){min=_2b1.from;h.useMin=false;}if("to" in _2b1){max=_2b1.to;h.useMax=false;}if(max<=min){return _29f(min,max,h,0,0,0,span);}var mag=Math.floor(Math.log(max-min)/Math.LN10),_2b2=_2b1&&("majorTickStep" in _2b1)?_2b1.majorTickStep:Math.pow(10,mag),_2b3=0,_2b4=0,_2b5;if(_2b1&&("minorTickStep" in _2b1)){_2b3=_2b1.minorTickStep;}else{do{_2b3=_2b2/10;if(!h.natural||_2b3>0.9){_2b5=_29f(min,max,h,_2b2,_2b3,0,span);if(_2b5.bounds.scale*_2b5.minor.tick>_29c){break;}}_2b3=_2b2/5;if(!h.natural||_2b3>0.9){_2b5=_29f(min,max,h,_2b2,_2b3,0,span);if(_2b5.bounds.scale*_2b5.minor.tick>_29c){break;}}_2b3=_2b2/2;if(!h.natural||_2b3>0.9){_2b5=_29f(min,max,h,_2b2,_2b3,0,span);if(_2b5.bounds.scale*_2b5.minor.tick>_29c){break;}}return _29f(min,max,h,_2b2,0,0,span);}while(false);}if(_2b1&&("microTickStep" in _2b1)){_2b4=_2b1.microTickStep;_2b5=_29f(min,max,h,_2b2,_2b3,_2b4,span);}else{do{_2b4=_2b3/10;if(!h.natural||_2b4>0.9){_2b5=_29f(min,max,h,_2b2,_2b3,_2b4,span);if(_2b5.bounds.scale*_2b5.micro.tick>_29c){break;}}_2b4=_2b3/5;if(!h.natural||_2b4>0.9){_2b5=_29f(min,max,h,_2b2,_2b3,_2b4,span);if(_2b5.bounds.scale*_2b5.micro.tick>_29c){break;}}_2b4=_2b3/2;if(!h.natural||_2b4>0.9){_2b5=_29f(min,max,h,_2b2,_2b3,_2b4,span);if(_2b5.bounds.scale*_2b5.micro.tick>_29c){break;}}_2b4=0;}while(false);}return _2b4?_2b5:_29f(min,max,h,_2b2,_2b3,0,span);},buildTicks:function(_2b6,_2b7){var step,next,tick,_2b8=_2b6.major.start,_2b9=_2b6.minor.start,_2ba=_2b6.micro.start;if(_2b7.microTicks&&_2b6.micro.tick){step=_2b6.micro.tick,next=_2ba;}else{if(_2b7.minorTicks&&_2b6.minor.tick){step=_2b6.minor.tick,next=_2b9;}else{if(_2b6.major.tick){step=_2b6.major.tick,next=_2b8;}else{return null;}}}var _2bb=1/_2b6.bounds.scale;if(_2b6.bounds.to<=_2b6.bounds.from||isNaN(_2bb)||!isFinite(_2bb)||step<=0||isNaN(step)||!isFinite(step)){return null;}var _2bc=[],_2bd=[],_2be=[];while(next<=_2b6.bounds.to+_2bb){if(Math.abs(_2b8-next)<step/2){tick={value:_2b8};if(_2b7.majorLabels){tick.label=_29e(_2b8,_2b6.major.prec,_2b7);}_2bc.push(tick);_2b8+=_2b6.major.tick;_2b9+=_2b6.minor.tick;_2ba+=_2b6.micro.tick;}else{if(Math.abs(_2b9-next)<step/2){if(_2b7.minorTicks){tick={value:_2b9};if(_2b7.minorLabels&&(_2b6.minMinorStep<=_2b6.minor.tick*_2b6.bounds.scale)){tick.label=_29e(_2b9,_2b6.minor.prec,_2b7);}_2bd.push(tick);}_2b9+=_2b6.minor.tick;_2ba+=_2b6.micro.tick;}else{if(_2b7.microTicks){_2be.push({value:_2ba});}_2ba+=_2b6.micro.tick;}}next+=step;}return {major:_2bc,minor:_2bd,micro:_2be};},getTransformerFromModel:function(_2bf){var _2c0=_2bf.bounds.from,_2c1=_2bf.bounds.scale;return function(x){return (x-_2c0)*_2c1;};},getTransformerFromPlot:function(_2c2){var _2c3=_2c2.bounds.from,_2c4=_2c2.bounds.scale;return function(x){return x/_2c4+_2c3;};}});})();}if(!dojo._hasResource["dojox.charting.axis2d.common"]){dojo._hasResource["dojox.charting.axis2d.common"]=true;dojo.provide("dojox.charting.axis2d.common");(function(){var g=dojox.gfx;var _2c5=function(s){s.marginLeft="0px";s.marginTop="0px";s.marginRight="0px";s.marginBottom="0px";s.paddingLeft="0px";s.paddingTop="0px";s.paddingRight="0px";s.paddingBottom="0px";s.borderLeftWidth="0px";s.borderTopWidth="0px";s.borderRightWidth="0px";s.borderBottomWidth="0px";};var _2c6=function(n){if(n["getBoundingClientRect"]){var bcr=n.getBoundingClientRect();return bcr.width||(bcr.right-bcr.left);}else{return dojo.marginBox(n).w;}};dojo.mixin(dojox.charting.axis2d.common,{createText:{gfx:function(_2c7,_2c8,x,y,_2c9,text,font,_2ca){return _2c8.createText({x:x,y:y,text:text,align:_2c9}).setFont(font).setFill(_2ca);},html:function(_2cb,_2cc,x,y,_2cd,text,font,_2ce,_2cf){var p=dojo.doc.createElement("div"),s=p.style,_2d0;_2c5(s);s.font=font;p.innerHTML=String(text).replace(/\s/g,"&nbsp;");s.color=_2ce;s.position="absolute";s.left="-10000px";dojo.body().appendChild(p);var size=g.normalizedLength(g.splitFontString(font).size);if(!_2cf){_2d0=_2c6(p);}dojo.body().removeChild(p);s.position="relative";if(_2cf){s.width=_2cf+"px";switch(_2cd){case "middle":s.textAlign="center";s.left=(x-_2cf/2)+"px";break;case "end":s.textAlign="right";s.left=(x-_2cf)+"px";break;default:s.left=x+"px";s.textAlign="left";break;}}else{switch(_2cd){case "middle":s.left=Math.floor(x-_2d0/2)+"px";break;case "end":s.left=Math.floor(x-_2d0)+"px";break;default:s.left=Math.floor(x)+"px";break;}}s.top=Math.floor(y-size)+"px";s.whiteSpace="nowrap";var wrap=dojo.doc.createElement("div"),w=wrap.style;_2c5(w);w.width="0px";w.height="0px";wrap.appendChild(p);_2cb.node.insertBefore(wrap,_2cb.node.firstChild);return wrap;}}});})();}if(!dojo._hasResource["dojox.charting.Element"]){dojo._hasResource["dojox.charting.Element"]=true;dojo.provide("dojox.charting.Element");dojo.declare("dojox.charting.Element",null,{chart:null,group:null,htmlElements:null,dirty:true,constructor:function(_2d1){this.chart=_2d1;this.group=null;this.htmlElements=[];this.dirty=true;this.trailingSymbol="...";this._events=[];},createGroup:function(_2d2){if(!_2d2){_2d2=this.chart.surface;}if(!this.group){this.group=_2d2.createGroup();}return this;},purgeGroup:function(){this.destroyHtmlElements();if(this.group){this.group.clear();this.group.removeShape();this.group=null;}this.dirty=true;if(this._events.length){dojo.forEach(this._events,function(item){item.shape.disconnect(item.handle);});this._events=[];}return this;},cleanGroup:function(_2d3){this.destroyHtmlElements();if(!_2d3){_2d3=this.chart.surface;}if(this.group){this.group.clear();}else{this.group=_2d3.createGroup();}this.dirty=true;return this;},destroyHtmlElements:function(){if(this.htmlElements.length){dojo.forEach(this.htmlElements,dojo.destroy);this.htmlElements=[];}},destroy:function(){this.purgeGroup();},getTextWidth:function(s,font){return dojox.gfx._base._getTextBox(s,{font:font}).w||0;},getTextWithLimitLength:function(s,font,_2d4,_2d5){if(!s||s.length<=0){return {text:"",truncated:_2d5||false};}if(!_2d4||_2d4<=0){return {text:s,truncated:_2d5||false};}var _2d6=2,_2d7=0.618,_2d8=s.substring(0,1)+this.trailingSymbol,_2d9=this.getTextWidth(_2d8,font);if(_2d4<=_2d9){return {text:_2d8,truncated:true};}var _2da=this.getTextWidth(s,font);if(_2da<=_2d4){return {text:s,truncated:_2d5||false};}else{var _2db=0,end=s.length;while(_2db<end){if(end-_2db<=_2d6){while(this.getTextWidth(s.substring(0,_2db)+this.trailingSymbol,font)>_2d4){_2db-=1;}return {text:(s.substring(0,_2db)+this.trailingSymbol),truncated:true};}var _2dc=_2db+Math.round((end-_2db)*_2d7),_2dd=this.getTextWidth(s.substring(0,_2dc),font);if(_2dd<_2d4){_2db=_2dc;end=end;}else{_2db=_2db;end=_2dc;}}}},getTextWithLimitCharCount:function(s,font,_2de,_2df){if(!s||s.length<=0){return {text:"",truncated:_2df||false};}if(!_2de||_2de<=0||s.length<=_2de){return {text:s,truncated:_2df||false};}return {text:s.substring(0,_2de)+this.trailingSymbol,truncated:true};},_plotFill:function(fill,dim,_2e0){if(!fill||!fill.type||!fill.space){return fill;}var _2e1=fill.space;switch(fill.type){case "linear":if(_2e1==="plot"||_2e1==="shapeX"||_2e1==="shapeY"){fill=dojox.gfx.makeParameters(dojox.gfx.defaultLinearGradient,fill);fill.space=_2e1;if(_2e1==="plot"||_2e1==="shapeX"){var span=dim.height-_2e0.t-_2e0.b;fill.y1=_2e0.t+span*fill.y1/100;fill.y2=_2e0.t+span*fill.y2/100;}if(_2e1==="plot"||_2e1==="shapeY"){var span=dim.width-_2e0.l-_2e0.r;fill.x1=_2e0.l+span*fill.x1/100;fill.x2=_2e0.l+span*fill.x2/100;}}break;case "radial":if(_2e1==="plot"){fill=dojox.gfx.makeParameters(dojox.gfx.defaultRadialGradient,fill);fill.space=_2e1;var _2e2=dim.width-_2e0.l-_2e0.r,_2e3=dim.height-_2e0.t-_2e0.b;fill.cx=_2e0.l+_2e2*fill.cx/100;fill.cy=_2e0.t+_2e3*fill.cy/100;fill.r=fill.r*Math.sqrt(_2e2*_2e2+_2e3*_2e3)/200;}break;case "pattern":if(_2e1==="plot"||_2e1==="shapeX"||_2e1==="shapeY"){fill=dojox.gfx.makeParameters(dojox.gfx.defaultPattern,fill);fill.space=_2e1;if(_2e1==="plot"||_2e1==="shapeX"){var span=dim.height-_2e0.t-_2e0.b;fill.y=_2e0.t+span*fill.y/100;fill.height=span*fill.height/100;}if(_2e1==="plot"||_2e1==="shapeY"){var span=dim.width-_2e0.l-_2e0.r;fill.x=_2e0.l+span*fill.x/100;fill.width=span*fill.width/100;}}break;}return fill;},_shapeFill:function(fill,bbox){if(!fill||!fill.space){return fill;}var _2e4=fill.space;switch(fill.type){case "linear":if(_2e4==="shape"||_2e4==="shapeX"||_2e4==="shapeY"){fill=dojox.gfx.makeParameters(dojox.gfx.defaultLinearGradient,fill);fill.space=_2e4;if(_2e4==="shape"||_2e4==="shapeX"){var span=bbox.width;fill.x1=bbox.x+span*fill.x1/100;fill.x2=bbox.x+span*fill.x2/100;}if(_2e4==="shape"||_2e4==="shapeY"){var span=bbox.height;fill.y1=bbox.y+span*fill.y1/100;fill.y2=bbox.y+span*fill.y2/100;}}break;case "radial":if(_2e4==="shape"){fill=dojox.gfx.makeParameters(dojox.gfx.defaultRadialGradient,fill);fill.space=_2e4;fill.cx=bbox.x+bbox.width/2;fill.cy=bbox.y+bbox.height/2;fill.r=fill.r*bbox.width/200;}break;case "pattern":if(_2e4==="shape"||_2e4==="shapeX"||_2e4==="shapeY"){fill=dojox.gfx.makeParameters(dojox.gfx.defaultPattern,fill);fill.space=_2e4;if(_2e4==="shape"||_2e4==="shapeX"){var span=bbox.width;fill.x=bbox.x+span*fill.x/100;fill.width=span*fill.width/100;}if(_2e4==="shape"||_2e4==="shapeY"){var span=bbox.height;fill.y=bbox.y+span*fill.y/100;fill.height=span*fill.height/100;}}break;}return fill;},_pseudoRadialFill:function(fill,_2e5,_2e6,_2e7,end){if(!fill||fill.type!=="radial"||fill.space!=="shape"){return fill;}var _2e8=fill.space;fill=dojox.gfx.makeParameters(dojox.gfx.defaultRadialGradient,fill);fill.space=_2e8;if(arguments.length<4){fill.cx=_2e5.x;fill.cy=_2e5.y;fill.r=fill.r*_2e6/100;return fill;}var _2e9=arguments.length<5?_2e7:(end+_2e7)/2;return {type:"linear",x1:_2e5.x,y1:_2e5.y,x2:_2e5.x+fill.r*_2e6*Math.cos(_2e9)/100,y2:_2e5.y+fill.r*_2e6*Math.sin(_2e9)/100,colors:fill.colors};return fill;}});}if(!dojo._hasResource["dojox.charting.axis2d.Base"]){dojo._hasResource["dojox.charting.axis2d.Base"]=true;dojo.provide("dojox.charting.axis2d.Base");dojo.declare("dojox.charting.axis2d.Base",dojox.charting.Element,{constructor:function(_2ea,_2eb){this.vertical=_2eb&&_2eb.vertical;},clear:function(){return this;},initialized:function(){return false;},calculate:function(min,max,span){return this;},getScaler:function(){return null;},getTicks:function(){return null;},getOffsets:function(){return {l:0,r:0,t:0,b:0};},render:function(dim,_2ec){this.dirty=false;return this;}});}if(!dojo._hasResource["dojox.lang.functional.lambda"]){dojo._hasResource["dojox.lang.functional.lambda"]=true;dojo.provide("dojox.lang.functional.lambda");(function(){var df=dojox.lang.functional,_2ed={};var _2ee="ab".split(/a*/).length>1?String.prototype.split:function(sep){var r=this.split.call(this,sep),m=sep.exec(this);if(m&&m.index==0){r.unshift("");}return r;};var _2ef=function(s){var args=[],_2f0=_2ee.call(s,/\s*->\s*/m);if(_2f0.length>1){while(_2f0.length){s=_2f0.pop();args=_2f0.pop().split(/\s*,\s*|\s+/m);if(_2f0.length){_2f0.push("(function("+args+"){return ("+s+")})");}}}else{if(s.match(/\b_\b/)){args=["_"];}else{var l=s.match(/^\s*(?:[+*\/%&|\^\.=<>]|!=)/m),r=s.match(/[+\-*\/%&|\^\.=<>!]\s*$/m);if(l||r){if(l){args.push("$1");s="$1"+s;}if(r){args.push("$2");s=s+"$2";}}else{var vars=s.replace(/(?:\b[A-Z]|\.[a-zA-Z_$])[a-zA-Z_$\d]*|[a-zA-Z_$][a-zA-Z_$\d]*:|this|true|false|null|undefined|typeof|instanceof|in|delete|new|void|arguments|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|escape|eval|isFinite|isNaN|parseFloat|parseInt|unescape|dojo|dijit|dojox|window|document|'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"/g,"").match(/([a-z_$][a-z_$\d]*)/gi)||[],t={};dojo.forEach(vars,function(v){if(!(v in t)){args.push(v);t[v]=1;}});}}}return {args:args,body:s};};var _2f1=function(a){return a.length?function(){var i=a.length-1,x=df.lambda(a[i]).apply(this,arguments);for(--i;i>=0;--i){x=df.lambda(a[i]).call(this,x);}return x;}:function(x){return x;};};dojo.mixin(df,{rawLambda:function(s){return _2ef(s);},buildLambda:function(s){s=_2ef(s);return "function("+s.args.join(",")+"){return ("+s.body+");}";},lambda:function(s){if(typeof s=="function"){return s;}if(s instanceof Array){return _2f1(s);}if(s in _2ed){return _2ed[s];}s=_2ef(s);return _2ed[s]=new Function(s.args,"return ("+s.body+");");},clearLambdaCache:function(){_2ed={};}});})();}if(!dojo._hasResource["dojox.lang.functional.array"]){dojo._hasResource["dojox.lang.functional.array"]=true;dojo.provide("dojox.lang.functional.array");(function(){var d=dojo,df=dojox.lang.functional,_2f2={};d.mixin(df,{filter:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var t=[],v,i,n;if(d.isArray(a)){for(i=0,n=a.length;i<n;++i){v=a[i];if(f.call(o,v,i,a)){t.push(v);}}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();){v=a.next();if(f.call(o,v,i++,a)){t.push(v);}}}else{for(i in a){if(!(i in _2f2)){v=a[i];if(f.call(o,v,i,a)){t.push(v);}}}}}return t;},forEach:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var i,n;if(d.isArray(a)){for(i=0,n=a.length;i<n;f.call(o,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();f.call(o,a.next(),i++,a)){}}else{for(i in a){if(!(i in _2f2)){f.call(o,a[i],i,a);}}}}return o;},map:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var t,n,i;if(d.isArray(a)){t=new Array(n=a.length);for(i=0;i<n;t[i]=f.call(o,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){t=[];for(i=0;a.hasNext();t.push(f.call(o,a.next(),i++,a))){}}else{t=[];for(i in a){if(!(i in _2f2)){t.push(f.call(o,a[i],i,a));}}}}return t;},every:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var i,n;if(d.isArray(a)){for(i=0,n=a.length;i<n;++i){if(!f.call(o,a[i],i,a)){return false;}}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();){if(!f.call(o,a.next(),i++,a)){return false;}}}else{for(i in a){if(!(i in _2f2)){if(!f.call(o,a[i],i,a)){return false;}}}}}return true;},some:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var i,n;if(d.isArray(a)){for(i=0,n=a.length;i<n;++i){if(f.call(o,a[i],i,a)){return true;}}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();){if(f.call(o,a.next(),i++,a)){return true;}}}else{for(i in a){if(!(i in _2f2)){if(f.call(o,a[i],i,a)){return true;}}}}}return false;}});})();}if(!dojo._hasResource["dojox.lang.functional.object"]){dojo._hasResource["dojox.lang.functional.object"]=true;dojo.provide("dojox.lang.functional.object");(function(){var d=dojo,df=dojox.lang.functional,_2f3={};d.mixin(df,{keys:function(obj){var t=[];for(var i in obj){if(!(i in _2f3)){t.push(i);}}return t;},values:function(obj){var t=[];for(var i in obj){if(!(i in _2f3)){t.push(obj[i]);}}return t;},filterIn:function(obj,f,o){o=o||d.global;f=df.lambda(f);var t={},v,i;for(i in obj){if(!(i in _2f3)){v=obj[i];if(f.call(o,v,i,obj)){t[i]=v;}}}return t;},forIn:function(obj,f,o){o=o||d.global;f=df.lambda(f);for(var i in obj){if(!(i in _2f3)){f.call(o,obj[i],i,obj);}}return o;},mapIn:function(obj,f,o){o=o||d.global;f=df.lambda(f);var t={},i;for(i in obj){if(!(i in _2f3)){t[i]=f.call(o,obj[i],i,obj);}}return t;}});})();}if(!dojo._hasResource["dojox.lang.functional"]){dojo._hasResource["dojox.lang.functional"]=true;dojo.provide("dojox.lang.functional");}if(!dojo._hasResource["dojox.lang.utils"]){dojo._hasResource["dojox.lang.utils"]=true;dojo.provide("dojox.lang.utils");(function(){var _2f4={},du=dojox.lang.utils,opts=Object.prototype.toString;var _2f5=function(o){if(o){switch(opts.call(o)){case "[object Array]":return o.slice(0);case "[object Object]":return dojo.delegate(o);}}return o;};dojo.mixin(du,{coerceType:function(_2f6,_2f7){switch(typeof _2f6){case "number":return Number(eval("("+_2f7+")"));case "string":return String(_2f7);case "boolean":return Boolean(eval("("+_2f7+")"));}return eval("("+_2f7+")");},updateWithObject:function(_2f8,_2f9,conv){if(!_2f9){return _2f8;}for(var x in _2f8){if(x in _2f9&&!(x in _2f4)){var t=_2f8[x];if(t&&typeof t=="object"){du.updateWithObject(t,_2f9[x],conv);}else{_2f8[x]=conv?du.coerceType(t,_2f9[x]):_2f5(_2f9[x]);}}}return _2f8;},updateWithPattern:function(_2fa,_2fb,_2fc,conv){if(!_2fb||!_2fc){return _2fa;}for(var x in _2fc){if(x in _2fb&&!(x in _2f4)){_2fa[x]=conv?du.coerceType(_2fc[x],_2fb[x]):_2f5(_2fb[x]);}}return _2fa;},merge:function(_2fd,_2fe){if(_2fe){var _2ff=opts.call(_2fd),_300=opts.call(_2fe),t,i,l,m;switch(_300){case "[object Array]":if(_300==_2ff){t=new Array(Math.max(_2fd.length,_2fe.length));for(i=0,l=t.length;i<l;++i){t[i]=du.merge(_2fd[i],_2fe[i]);}return t;}return _2fe.slice(0);case "[object Object]":if(_300==_2ff&&_2fd){t=dojo.delegate(_2fd);for(i in _2fe){if(i in _2fd){l=_2fd[i];m=_2fe[i];if(m!==l){t[i]=du.merge(l,m);}}else{t[i]=dojo.clone(_2fe[i]);}}return t;}return dojo.clone(_2fe);}}return _2fe;}});})();}if(!dojo._hasResource["dojox.charting.axis2d.Invisible"]){dojo._hasResource["dojox.charting.axis2d.Invisible"]=true;dojo.provide("dojox.charting.axis2d.Invisible");(function(){var dc=dojox.charting,df=dojox.lang.functional,du=dojox.lang.utils,g=dojox.gfx,lin=dc.scaler.linear,_301=du.merge,_302=4,_303=45;dojo.declare("dojox.charting.axis2d.Invisible",dojox.charting.axis2d.Base,{defaultParams:{vertical:false,fixUpper:"none",fixLower:"none",natural:false,leftBottom:true,includeZero:false,fixed:true,majorLabels:true,minorTicks:true,minorLabels:true,microTicks:false,rotation:0},optionalParams:{min:0,max:1,from:0,to:1,majorTickStep:4,minorTickStep:2,microTickStep:1,labels:[],labelFunc:null,maxLabelSize:0,maxLabelCharCount:0,trailingSymbol:null},constructor:function(_304,_305){this.opt=dojo.clone(this.defaultParams);du.updateWithObject(this.opt,_305);du.updateWithPattern(this.opt,_305,this.optionalParams);},dependOnData:function(){return !("min" in this.opt)||!("max" in this.opt);},clear:function(){delete this.scaler;delete this.ticks;this.dirty=true;return this;},initialized:function(){return "scaler" in this&&!(this.dirty&&this.dependOnData());},setWindow:function(_306,_307){this.scale=_306;this.offset=_307;return this.clear();},getWindowScale:function(){return "scale" in this?this.scale:1;},getWindowOffset:function(){return "offset" in this?this.offset:0;},_groupLabelWidth:function(_308,font,_309){if(!_308.length){return 0;}if(dojo.isObject(_308[0])){_308=df.map(_308,function(_30a){return _30a.text;});}if(_309){_308=df.map(_308,function(_30b){return dojo.trim(_30b).length==0?"":_30b.substring(0,_309)+this.trailingSymbol;},this);}var s=_308.join("<br>");return dojox.gfx._base._getTextBox(s,{font:font}).w||0;},calculate:function(min,max,span,_30c){if(this.initialized()){return this;}var o=this.opt;this.labels="labels" in o?o.labels:_30c;this.scaler=lin.buildScaler(min,max,span,o);var tsb=this.scaler.bounds;if("scale" in this){o.from=tsb.lower+this.offset;o.to=(tsb.upper-tsb.lower)/this.scale+o.from;if(!isFinite(o.from)||isNaN(o.from)||!isFinite(o.to)||isNaN(o.to)||o.to-o.from>=tsb.upper-tsb.lower){delete o.from;delete o.to;delete this.scale;delete this.offset;}else{if(o.from<tsb.lower){o.to+=tsb.lower-o.from;o.from=tsb.lower;}else{if(o.to>tsb.upper){o.from+=tsb.upper-o.to;o.to=tsb.upper;}}this.offset=o.from-tsb.lower;}this.scaler=lin.buildScaler(min,max,span,o);tsb=this.scaler.bounds;if(this.scale==1&&this.offset==0){delete this.scale;delete this.offset;}}var ta=this.chart.theme.axis,_30d=0,_30e=o.rotation%360,_30f=o.font||(ta.majorTick&&ta.majorTick.font)||(ta.tick&&ta.tick.font),size=_30f?g.normalizedLength(g.splitFontString(_30f).size):0,cosr=Math.abs(Math.cos(_30e*Math.PI/180)),sinr=Math.abs(Math.sin(_30e*Math.PI/180));if(_30e<0){_30e+=360;}if(size){if(this.vertical?_30e!=0&&_30e!=180:_30e!=90&&_30e!=270){if(this.labels){_30d=this._groupLabelWidth(this.labels,_30f,o.maxLabelCharCount);}else{var _310=Math.ceil(Math.log(Math.max(Math.abs(tsb.from),Math.abs(tsb.to)))/Math.LN10),t=[];if(tsb.from<0||tsb.to<0){t.push("-");}t.push(dojo.string.rep("9",_310));var _311=Math.floor(Math.log(tsb.to-tsb.from)/Math.LN10);if(_311>0){t.push(".");t.push(dojo.string.rep("9",_311));}_30d=dojox.gfx._base._getTextBox(t.join(""),{font:_30f}).w;}_30d=o.maxLabelSize?Math.min(o.maxLabelSize,_30d):_30d;}else{_30d=size;}switch(_30e){case 0:case 90:case 180:case 270:break;default:var gap1=Math.sqrt(_30d*_30d+size*size),gap2=this.vertical?size*cosr+_30d*sinr:_30d*cosr+size*sinr;_30d=Math.min(gap1,gap2);break;}}this.scaler.minMinorStep=_30d+_302;this.ticks=lin.buildTicks(this.scaler,o);return this;},getScaler:function(){return this.scaler;},getTicks:function(){return this.ticks;}});})();}if(!dojo._hasResource["dojo.colors"]){dojo._hasResource["dojo.colors"]=true;dojo.provide("dojo.colors");dojo.getObject("colors",true,dojo);(function(){var _312=function(m1,m2,h){if(h<0){++h;}if(h>1){--h;}var h6=6*h;if(h6<1){return m1+(m2-m1)*h6;}if(2*h<1){return m2;}if(3*h<2){return m1+(m2-m1)*(2/3-h)*6;}return m1;};dojo.colorFromRgb=function(_313,obj){var m=_313.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(m){var c=m[2].split(/\s*,\s*/),l=c.length,t=m[1],a;if((t=="rgb"&&l==3)||(t=="rgba"&&l==4)){var r=c[0];if(r.charAt(r.length-1)=="%"){a=dojo.map(c,function(x){return parseFloat(x)*2.56;});if(l==4){a[3]=c[3];}return dojo.colorFromArray(a,obj);}return dojo.colorFromArray(c,obj);}if((t=="hsl"&&l==3)||(t=="hsla"&&l==4)){var H=((parseFloat(c[0])%360)+360)%360/360,S=parseFloat(c[1])/100,L=parseFloat(c[2])/100,m2=L<=0.5?L*(S+1):L+S-L*S,m1=2*L-m2;a=[_312(m1,m2,H+1/3)*256,_312(m1,m2,H)*256,_312(m1,m2,H-1/3)*256,1];if(l==4){a[3]=c[3];}return dojo.colorFromArray(a,obj);}}return null;};var _314=function(c,low,high){c=Number(c);return isNaN(c)?high:c<low?low:c>high?high:c;};dojo.Color.prototype.sanitize=function(){var t=this;t.r=Math.round(_314(t.r,0,255));t.g=Math.round(_314(t.g,0,255));t.b=Math.round(_314(t.b,0,255));t.a=_314(t.a,0,1);return this;};})();dojo.colors.makeGrey=function(g,a){return dojo.colorFromArray([g,g,g,a]);};dojo.mixin(dojo.Color.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],transparent:[0,0,0,0],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});}if(!dojo._hasResource["dojox.charting.axis2d.Default"]){dojo._hasResource["dojox.charting.axis2d.Default"]=true;dojo.provide("dojox.charting.axis2d.Default");(function(){var dc=dojox.charting,du=dojox.lang.utils,g=dojox.gfx,lin=dc.scaler.linear,_315=4,_316=45;dojo.declare("dojox.charting.axis2d.Default",dojox.charting.axis2d.Invisible,{defaultParams:{vertical:false,fixUpper:"none",fixLower:"none",natural:false,leftBottom:true,includeZero:false,fixed:true,majorLabels:true,minorTicks:true,minorLabels:true,microTicks:false,rotation:0,htmlLabels:true},optionalParams:{min:0,max:1,from:0,to:1,majorTickStep:4,minorTickStep:2,microTickStep:1,labels:[],labelFunc:null,maxLabelSize:0,maxLabelCharCount:0,trailingSymbol:null,stroke:{},majorTick:{},minorTick:{},microTick:{},tick:{},font:"",fontColor:"",title:"",titleGap:0,titleFont:"",titleFontColor:"",titleOrientation:""},constructor:function(_317,_318){this.opt=dojo.clone(this.defaultParams);du.updateWithObject(this.opt,_318);du.updateWithPattern(this.opt,_318,this.optionalParams);},getOffsets:function(){var s=this.scaler,_319={l:0,r:0,t:0,b:0};if(!s){return _319;}var o=this.opt,_31a=0,a,b,c,d,gl=dc.scaler.common.getNumericLabel,_31b=0,ma=s.major,mi=s.minor,ta=this.chart.theme.axis,_31c=o.font||(ta.majorTick&&ta.majorTick.font)||(ta.tick&&ta.tick.font),_31d=o.titleFont||(ta.tick&&ta.tick.titleFont),_31e=(o.titleGap==0)?0:o.titleGap||(ta.tick&&ta.tick.titleGap)||15,_31f=this.chart.theme.getTick("major",o),_320=this.chart.theme.getTick("minor",o),size=_31c?g.normalizedLength(g.splitFontString(_31c).size):0,_321=_31d?g.normalizedLength(g.splitFontString(_31d).size):0,_322=o.rotation%360,_323=o.leftBottom,cosr=Math.abs(Math.cos(_322*Math.PI/180)),sinr=Math.abs(Math.sin(_322*Math.PI/180));this.trailingSymbol=(o.trailingSymbol===undefined||o.trailingSymbol===null)?this.trailingSymbol:o.trailingSymbol;if(_322<0){_322+=360;}if(size){if(this.labels){_31a=this._groupLabelWidth(this.labels,_31c,o.maxLabelCharCount);}else{_31a=this._groupLabelWidth([gl(ma.start,ma.prec,o),gl(ma.start+ma.count*ma.tick,ma.prec,o),gl(mi.start,mi.prec,o),gl(mi.start+mi.count*mi.tick,mi.prec,o)],_31c,o.maxLabelCharCount);}_31a=o.maxLabelSize?Math.min(o.maxLabelSize,_31a):_31a;if(this.vertical){var side=_323?"l":"r";switch(_322){case 0:case 180:_319[side]=_31a;_319.t=_319.b=size/2;break;case 90:case 270:_319[side]=size;_319.t=_319.b=_31a/2;break;default:if(_322<=_316||(180<_322&&_322<=(180+_316))){_319[side]=size*sinr/2+_31a*cosr;_319[_323?"t":"b"]=size*cosr/2+_31a*sinr;_319[_323?"b":"t"]=size*cosr/2;}else{if(_322>(360-_316)||(180>_322&&_322>(180-_316))){_319[side]=size*sinr/2+_31a*cosr;_319[_323?"b":"t"]=size*cosr/2+_31a*sinr;_319[_323?"t":"b"]=size*cosr/2;}else{if(_322<90||(180<_322&&_322<270)){_319[side]=size*sinr+_31a*cosr;_319[_323?"t":"b"]=size*cosr+_31a*sinr;}else{_319[side]=size*sinr+_31a*cosr;_319[_323?"b":"t"]=size*cosr+_31a*sinr;}}}break;}_319[side]+=_315+Math.max(_31f.length,_320.length)+(o.title?(_321+_31e):0);}else{var side=_323?"b":"t";switch(_322){case 0:case 180:_319[side]=size;_319.l=_319.r=_31a/2;break;case 90:case 270:_319[side]=_31a;_319.l=_319.r=size/2;break;default:if((90-_316)<=_322&&_322<=90||(270-_316)<=_322&&_322<=270){_319[side]=size*sinr/2+_31a*cosr;_319[_323?"r":"l"]=size*cosr/2+_31a*sinr;_319[_323?"l":"r"]=size*cosr/2;}else{if(90<=_322&&_322<=(90+_316)||270<=_322&&_322<=(270+_316)){_319[side]=size*sinr/2+_31a*cosr;_319[_323?"l":"r"]=size*cosr/2+_31a*sinr;_319[_323?"r":"l"]=size*cosr/2;}else{if(_322<_316||(180<_322&&_322<(180-_316))){_319[side]=size*sinr+_31a*cosr;_319[_323?"r":"l"]=size*cosr+_31a*sinr;}else{_319[side]=size*sinr+_31a*cosr;_319[_323?"l":"r"]=size*cosr+_31a*sinr;}}}break;}_319[side]+=_315+Math.max(_31f.length,_320.length)+(o.title?(_321+_31e):0);}}if(_31a){this._cachedLabelWidth=_31a;}return _319;},render:function(dim,_324){if(!this.dirty){return this;}var o=this.opt,ta=this.chart.theme.axis,_325=o.leftBottom,_326=o.rotation%360,_327,stop,_328,_329=0,_32a,_32b,_32c,_32d,_32e,_32f,_330=o.font||(ta.majorTick&&ta.majorTick.font)||(ta.tick&&ta.tick.font),_331=o.titleFont||(ta.tick&&ta.tick.titleFont),_332=o.fontColor||(ta.majorTick&&ta.majorTick.fontColor)||(ta.tick&&ta.tick.fontColor)||"black",_333=o.titleFontColor||(ta.tick&&ta.tick.titleFontColor)||"black",_334=(o.titleGap==0)?0:o.titleGap||(ta.tick&&ta.tick.titleGap)||15,_335=o.titleOrientation||(ta.tick&&ta.tick.titleOrientation)||"axis",_336=this.chart.theme.getTick("major",o),_337=this.chart.theme.getTick("minor",o),_338=this.chart.theme.getTick("micro",o),_339=Math.max(_336.length,_337.length,_338.length),_33a="stroke" in o?o.stroke:ta.stroke,size=_330?g.normalizedLength(g.splitFontString(_330).size):0,cosr=Math.abs(Math.cos(_326*Math.PI/180)),sinr=Math.abs(Math.sin(_326*Math.PI/180)),_33b=_331?g.normalizedLength(g.splitFontString(_331).size):0;if(_326<0){_326+=360;}if(this.vertical){_327={y:dim.height-_324.b};stop={y:_324.t};_328={y:(dim.height-_324.b+_324.t)/2};_32a=size*sinr+(this._cachedLabelWidth||0)*cosr+_315+Math.max(_336.length,_337.length)+_33b+_334;_32b={x:0,y:-1};_32e={x:0,y:0};_32c={x:1,y:0};_32d={x:_315,y:0};switch(_326){case 0:_32f="end";_32e.y=size*0.4;break;case 90:_32f="middle";_32e.x=-size;break;case 180:_32f="start";_32e.y=-size*0.4;break;case 270:_32f="middle";break;default:if(_326<_316){_32f="end";_32e.y=size*0.4;}else{if(_326<90){_32f="end";_32e.y=size*0.4;}else{if(_326<(180-_316)){_32f="start";}else{if(_326<(180+_316)){_32f="start";_32e.y=-size*0.4;}else{if(_326<270){_32f="start";_32e.x=_325?0:size*0.4;}else{if(_326<(360-_316)){_32f="end";_32e.x=_325?0:size*0.4;}else{_32f="end";_32e.y=size*0.4;}}}}}}}if(_325){_327.x=stop.x=_324.l;_329=(_335&&_335=="away")?90:270;_328.x=_324.l-_32a+(_329==270?_33b:0);_32c.x=-1;_32d.x=-_32d.x;}else{_327.x=stop.x=dim.width-_324.r;_329=(_335&&_335=="axis")?90:270;_328.x=dim.width-_324.r+_32a-(_329==270?0:_33b);switch(_32f){case "start":_32f="end";break;case "end":_32f="start";break;case "middle":_32e.x+=size;break;}}}else{_327={x:_324.l};stop={x:dim.width-_324.r};_328={x:(dim.width-_324.r+_324.l)/2};_32a=size*cosr+(this._cachedLabelWidth||0)*sinr+_315+Math.max(_336.length,_337.length)+_33b+_334;_32b={x:1,y:0};_32e={x:0,y:0};_32c={x:0,y:1};_32d={x:0,y:_315};switch(_326){case 0:_32f="middle";_32e.y=size;break;case 90:_32f="start";_32e.x=-size*0.4;break;case 180:_32f="middle";break;case 270:_32f="end";_32e.x=size*0.4;break;default:if(_326<(90-_316)){_32f="start";_32e.y=_325?size:0;}else{if(_326<(90+_316)){_32f="start";_32e.x=-size*0.4;}else{if(_326<180){_32f="start";_32e.y=_325?0:-size;}else{if(_326<(270-_316)){_32f="end";_32e.y=_325?0:-size;}else{if(_326<(270+_316)){_32f="end";_32e.y=_325?size*0.4:0;}else{_32f="end";_32e.y=_325?size:0;}}}}}}if(_325){_327.y=stop.y=dim.height-_324.b;_329=(_335&&_335=="axis")?180:0;_328.y=dim.height-_324.b+_32a-(_329?_33b:0);}else{_327.y=stop.y=_324.t;_329=(_335&&_335=="away")?180:0;_328.y=_324.t-_32a+(_329?0:_33b);_32c.y=-1;_32d.y=-_32d.y;switch(_32f){case "start":_32f="end";break;case "end":_32f="start";break;case "middle":_32e.y-=size;break;}}}this.cleanGroup();try{var s=this.group,c=this.scaler,t=this.ticks,_33c,f=lin.getTransformerFromModel(this.scaler),_33d=!_329&&!_326&&this.opt.htmlLabels&&!dojo.isIE&&!dojo.isOpera?"html":"gfx",dx=_32c.x*_336.length,dy=_32c.y*_336.length;s.createLine({x1:_327.x,y1:_327.y,x2:stop.x,y2:stop.y}).setStroke(_33a);if(o.title){var _33e=dc.axis2d.common.createText[_33d](this.chart,s,_328.x,_328.y,"middle",o.title,_331,_333);if(_33d=="html"){this.htmlElements.push(_33e);}else{_33e.setTransform(g.matrix.rotategAt(_329,_328.x,_328.y));}}dojo.forEach(t.major,function(tick){var _33f=f(tick.value),elem,x=_327.x+_32b.x*_33f,y=_327.y+_32b.y*_33f;s.createLine({x1:x,y1:y,x2:x+dx,y2:y+dy}).setStroke(_336);if(tick.label){var _340=o.maxLabelCharCount?this.getTextWithLimitCharCount(tick.label,_330,o.maxLabelCharCount):{text:tick.label,truncated:false};_340=o.maxLabelSize?this.getTextWithLimitLength(_340.text,_330,o.maxLabelSize,_340.truncated):_340;elem=dc.axis2d.common.createText[_33d](this.chart,s,x+dx+_32d.x+(_326?0:_32e.x),y+dy+_32d.y+(_326?0:_32e.y),_32f,_340.text,_330,_332);_340.truncated&&this.labelTooltip(elem,this.chart,tick.label,_340.text,_330,_33d);if(_33d=="html"){this.htmlElements.push(elem);}else{if(_326){elem.setTransform([{dx:_32e.x,dy:_32e.y},g.matrix.rotategAt(_326,x+dx+_32d.x,y+dy+_32d.y)]);}}}},this);dx=_32c.x*_337.length;dy=_32c.y*_337.length;_33c=c.minMinorStep<=c.minor.tick*c.bounds.scale;dojo.forEach(t.minor,function(tick){var _341=f(tick.value),elem,x=_327.x+_32b.x*_341,y=_327.y+_32b.y*_341;s.createLine({x1:x,y1:y,x2:x+dx,y2:y+dy}).setStroke(_337);if(_33c&&tick.label){var _342=o.maxLabelCharCount?this.getTextWithLimitCharCount(tick.label,_330,o.maxLabelCharCount):{text:tick.label,truncated:false};_342=o.maxLabelSize?this.getTextWithLimitLength(_342.text,_330,o.maxLabelSize,_342.truncated):_342;elem=dc.axis2d.common.createText[_33d](this.chart,s,x+dx+_32d.x+(_326?0:_32e.x),y+dy+_32d.y+(_326?0:_32e.y),_32f,_342.text,_330,_332);_342.truncated&&this.labelTooltip(elem,this.chart,tick.label,_342.text,_330,_33d);if(_33d=="html"){this.htmlElements.push(elem);}else{if(_326){elem.setTransform([{dx:_32e.x,dy:_32e.y},g.matrix.rotategAt(_326,x+dx+_32d.x,y+dy+_32d.y)]);}}}},this);dx=_32c.x*_338.length;dy=_32c.y*_338.length;dojo.forEach(t.micro,function(tick){var _343=f(tick.value),elem,x=_327.x+_32b.x*_343,y=_327.y+_32b.y*_343;s.createLine({x1:x,y1:y,x2:x+dx,y2:y+dy}).setStroke(_338);},this);}catch(e){}this.dirty=false;return this;},labelTooltip:function(elem,_344,_345,_346,font,_347){if(!dijit||!dijit.Tooltip){return;}var _348={type:"rect"},_349=["above","below"],_34a=dojox.gfx._base._getTextBox(_346,{font:font}).w||0;fontHeight=font?g.normalizedLength(g.splitFontString(font).size):0;if(_347=="html"){dojo.mixin(_348,dojo.coords(elem.firstChild,true));_348.width=Math.ceil(_34a);_348.height=Math.ceil(fontHeight);this._events.push({shape:dojo,handle:dojo.connect(elem.firstChild,"onmouseover",this,function(e){dijit.showTooltip(_345,_348,_349);})});this._events.push({shape:dojo,handle:dojo.connect(elem.firstChild,"onmouseout",this,function(e){dijit.hideTooltip(_348);})});}else{var shp=elem.getShape(),lt=dojo.coords(_344.node,true);_348=dojo.mixin(_348,{x:shp.x-_34a/2,y:shp.y});_348.x+=lt.x;_348.y+=lt.y;_348.x=Math.round(_348.x);_348.y=Math.round(_348.y);_348.width=Math.ceil(_34a);_348.height=Math.ceil(fontHeight);this._events.push({shape:elem,handle:elem.connect("onmouseenter",this,function(e){dijit.showTooltip(_345,_348,_349);})});this._events.push({shape:elem,handle:elem.connect("onmouseleave",this,function(e){dijit.hideTooltip(_348);})});}}});})();}if(!dojo._hasResource["dojox.charting.plot2d.common"]){dojo._hasResource["dojox.charting.plot2d.common"]=true;dojo.provide("dojox.charting.plot2d.common");(function(){var df=dojox.lang.functional,dc=dojox.charting.plot2d.common;dojo.mixin(dojox.charting.plot2d.common,{makeStroke:function(_34b){if(!_34b){return _34b;}if(typeof _34b=="string"||_34b instanceof dojo.Color){_34b={color:_34b};}return dojox.gfx.makeParameters(dojox.gfx.defaultStroke,_34b);},augmentColor:function(_34c,_34d){var t=new dojo.Color(_34c),c=new dojo.Color(_34d);c.a=t.a;return c;},augmentStroke:function(_34e,_34f){var s=dc.makeStroke(_34e);if(s){s.color=dc.augmentColor(s.color,_34f);}return s;},augmentFill:function(fill,_350){var fc,c=new dojo.Color(_350);if(typeof fill=="string"||fill instanceof dojo.Color){return dc.augmentColor(fill,_350);}return fill;},defaultStats:{vmin:Number.POSITIVE_INFINITY,vmax:Number.NEGATIVE_INFINITY,hmin:Number.POSITIVE_INFINITY,hmax:Number.NEGATIVE_INFINITY},collectSimpleStats:function(_351){var _352=dojo.delegate(dc.defaultStats);for(var i=0;i<_351.length;++i){var run=_351[i];for(var j=0;j<run.data.length;j++){if(run.data[j]!==null){if(typeof run.data[j]=="number"){var _353=_352.vmin,_354=_352.vmax;if(!("ymin" in run)||!("ymax" in run)){dojo.forEach(run.data,function(val,i){if(val!==null){var x=i+1,y=val;if(isNaN(y)){y=0;}_352.hmin=Math.min(_352.hmin,x);_352.hmax=Math.max(_352.hmax,x);_352.vmin=Math.min(_352.vmin,y);_352.vmax=Math.max(_352.vmax,y);}});}if("ymin" in run){_352.vmin=Math.min(_353,run.ymin);}if("ymax" in run){_352.vmax=Math.max(_354,run.ymax);}}else{var _355=_352.hmin,_356=_352.hmax,_353=_352.vmin,_354=_352.vmax;if(!("xmin" in run)||!("xmax" in run)||!("ymin" in run)||!("ymax" in run)){dojo.forEach(run.data,function(val,i){if(val!==null){var x="x" in val?val.x:i+1,y=val.y;if(isNaN(x)){x=0;}if(isNaN(y)){y=0;}_352.hmin=Math.min(_352.hmin,x);_352.hmax=Math.max(_352.hmax,x);_352.vmin=Math.min(_352.vmin,y);_352.vmax=Math.max(_352.vmax,y);}});}if("xmin" in run){_352.hmin=Math.min(_355,run.xmin);}if("xmax" in run){_352.hmax=Math.max(_356,run.xmax);}if("ymin" in run){_352.vmin=Math.min(_353,run.ymin);}if("ymax" in run){_352.vmax=Math.max(_354,run.ymax);}}break;}}}return _352;},calculateBarSize:function(_357,opt,_358){if(!_358){_358=1;}var gap=opt.gap,size=(_357-2*gap)/_358;if("minBarSize" in opt){size=Math.max(size,opt.minBarSize);}if("maxBarSize" in opt){size=Math.min(size,opt.maxBarSize);}size=Math.max(size,1);gap=(_357-size*_358)/2;return {size:size,gap:gap};},collectStackedStats:function(_359){var _35a=dojo.clone(dc.defaultStats);if(_359.length){_35a.hmin=Math.min(_35a.hmin,1);_35a.hmax=df.foldl(_359,"seed, run -> Math.max(seed, run.data.length)",_35a.hmax);for(var i=0;i<_35a.hmax;++i){var v=_359[0].data[i];v=v&&(typeof v=="number"?v:v.y);if(isNaN(v)){v=0;}_35a.vmin=Math.min(_35a.vmin,v);for(var j=1;j<_359.length;++j){var t=_359[j].data[i];t=t&&(typeof t=="number"?t:t.y);if(isNaN(t)){t=0;}v+=t;}_35a.vmax=Math.max(_35a.vmax,v);}}return _35a;},curve:function(a,_35b){var arr=a.slice(0);if(_35b=="x"){arr[arr.length]=arr[0];}var p=dojo.map(arr,function(item,i){if(i==0){return "M"+item.x+","+item.y;}if(!isNaN(_35b)){var dx=item.x-arr[i-1].x,dy=arr[i-1].y;return "C"+(item.x-(_35b-1)*(dx/_35b))+","+dy+" "+(item.x-(dx/_35b))+","+item.y+" "+item.x+","+item.y;}else{if(_35b=="X"||_35b=="x"||_35b=="S"){var p0,p1=arr[i-1],p2=arr[i],p3;var bz1x,bz1y,bz2x,bz2y;var f=1/6;if(i==1){if(_35b=="x"){p0=arr[arr.length-2];}else{p0=p1;}f=1/3;}else{p0=arr[i-2];}if(i==(arr.length-1)){if(_35b=="x"){p3=arr[1];}else{p3=p2;}f=1/3;}else{p3=arr[i+1];}var p1p2=Math.sqrt((p2.x-p1.x)*(p2.x-p1.x)+(p2.y-p1.y)*(p2.y-p1.y));var p0p2=Math.sqrt((p2.x-p0.x)*(p2.x-p0.x)+(p2.y-p0.y)*(p2.y-p0.y));var p1p3=Math.sqrt((p3.x-p1.x)*(p3.x-p1.x)+(p3.y-p1.y)*(p3.y-p1.y));var _35c=p0p2*f;var _35d=p1p3*f;if(_35c>p1p2/2&&_35d>p1p2/2){_35c=p1p2/2;_35d=p1p2/2;}else{if(_35c>p1p2/2){_35c=p1p2/2;_35d=p1p2/2*p1p3/p0p2;}else{if(_35d>p1p2/2){_35d=p1p2/2;_35c=p1p2/2*p0p2/p1p3;}}}if(_35b=="S"){if(p0==p1){_35c=0;}if(p2==p3){_35d=0;}}bz1x=p1.x+_35c*(p2.x-p0.x)/p0p2;bz1y=p1.y+_35c*(p2.y-p0.y)/p0p2;bz2x=p2.x-_35d*(p3.x-p1.x)/p1p3;bz2y=p2.y-_35d*(p3.y-p1.y)/p1p3;}}return "C"+(bz1x+","+bz1y+" "+bz2x+","+bz2y+" "+p2.x+","+p2.y);});return p.join(" ");},getLabel:function(_35e,_35f,_360){if(dojo.number){return (_35f?dojo.number.format(_35e,{places:_360}):dojo.number.format(_35e))||"";}return _35f?_35e.toFixed(_360):_35e.toString();}});})();}if(!dojo._hasResource["dojox.charting.scaler.primitive"]){dojo._hasResource["dojox.charting.scaler.primitive"]=true;dojo.provide("dojox.charting.scaler.primitive");dojox.charting.scaler.primitive={buildScaler:function(min,max,span,_361){if(min==max){min-=0.5;max+=0.5;}return {bounds:{lower:min,upper:max,from:min,to:max,scale:span/(max-min),span:span},scaler:dojox.charting.scaler.primitive};},buildTicks:function(_362,_363){return {major:[],minor:[],micro:[]};},getTransformerFromModel:function(_364){var _365=_364.bounds.from,_366=_364.bounds.scale;return function(x){return (x-_365)*_366;};},getTransformerFromPlot:function(_367){var _368=_367.bounds.from,_369=_367.bounds.scale;return function(x){return x/_369+_368;};}};}if(!dojo._hasResource["dojox.charting.plot2d._PlotEvents"]){dojo._hasResource["dojox.charting.plot2d._PlotEvents"]=true;dojo.provide("dojox.charting.plot2d._PlotEvents");dojo.declare("dojox.charting.plot2d._PlotEvents",null,{constructor:function(){this._shapeEvents=[];this._eventSeries={};},destroy:function(){this.resetEvents();this.inherited(arguments);},plotEvent:function(o){},raiseEvent:function(o){this.plotEvent(o);var t=dojo.delegate(o);t.originalEvent=o.type;t.originalPlot=o.plot;t.type="onindirect";dojo.forEach(this.chart.stack,function(plot){if(plot!==this&&plot.plotEvent){t.plot=plot;plot.plotEvent(t);}},this);},connect:function(_36a,_36b){this.dirty=true;return dojo.connect(this,"plotEvent",_36a,_36b);},events:function(){var ls=this.plotEvent._listeners;if(!ls||!ls.length){return false;}for(var i in ls){if(!(i in Array.prototype)){return true;}}return false;},resetEvents:function(){if(this._shapeEvents.length){dojo.forEach(this._shapeEvents,function(item){item.shape.disconnect(item.handle);});this._shapeEvents=[];}this.raiseEvent({type:"onplotreset",plot:this});},_connectSingleEvent:function(o,_36c){this._shapeEvents.push({shape:o.eventMask,handle:o.eventMask.connect(_36c,this,function(e){o.type=_36c;o.event=e;this.raiseEvent(o);o.event=null;})});},_connectEvents:function(o){if(o){o.chart=this.chart;o.plot=this;o.hAxis=this.hAxis||null;o.vAxis=this.vAxis||null;o.eventMask=o.eventMask||o.shape;this._connectSingleEvent(o,"onmouseover");this._connectSingleEvent(o,"onmouseout");this._connectSingleEvent(o,"onclick");}},_reconnectEvents:function(_36d){var a=this._eventSeries[_36d];if(a){dojo.forEach(a,this._connectEvents,this);}},fireEvent:function(_36e,_36f,_370,_371){var s=this._eventSeries[_36e];if(s&&s.length&&_370<s.length){var o=s[_370];o.type=_36f;o.event=_371||null;this.raiseEvent(o);o.event=null;}}});}if(!dojo._hasResource["dojox.charting.plot2d.Base"]){dojo._hasResource["dojox.charting.plot2d.Base"]=true;dojo.provide("dojox.charting.plot2d.Base");dojo.declare("dojox.charting.plot2d.Base",[dojox.charting.Element,dojox.charting.plot2d._PlotEvents],{constructor:function(_372,_373){this.zoom=null,this.zoomQueue=[];this.lastWindow={vscale:1,hscale:1,xoffset:0,yoffset:0};},clear:function(){this.series=[];this._hAxis=null;this._vAxis=null;this.dirty=true;return this;},setAxis:function(axis){if(axis){this[axis.vertical?"_vAxis":"_hAxis"]=axis;}return this;},addSeries:function(run){this.series.push(run);return this;},getSeriesStats:function(){return dojox.charting.plot2d.common.collectSimpleStats(this.series);},calculateAxes:function(dim){this.initializeScalers(dim,this.getSeriesStats());return this;},isDirty:function(){return this.dirty||this._hAxis&&this._hAxis.dirty||this._vAxis&&this._vAxis.dirty;},isDataDirty:function(){return dojo.some(this.series,function(item){return item.dirty;});},performZoom:function(dim,_374){var vs=this._vAxis.scale||1,hs=this._hAxis.scale||1,_375=dim.height-_374.b,_376=this._hScaler.bounds,_377=(_376.from-_376.lower)*_376.scale,_378=this._vScaler.bounds,_379=(_378.from-_378.lower)*_378.scale;rVScale=vs/this.lastWindow.vscale,rHScale=hs/this.lastWindow.hscale,rXOffset=(this.lastWindow.xoffset-_377)/((this.lastWindow.hscale==1)?hs:this.lastWindow.hscale),rYOffset=(_379-this.lastWindow.yoffset)/((this.lastWindow.vscale==1)?vs:this.lastWindow.vscale),shape=this.group,anim=dojox.gfx.fx.animateTransform(dojo.delegate({shape:shape,duration:1200,transform:[{name:"translate",start:[0,0],end:[_374.l*(1-rHScale),_375*(1-rVScale)]},{name:"scale",start:[1,1],end:[rHScale,rVScale]},{name:"original"},{name:"translate",start:[0,0],end:[rXOffset,rYOffset]}]},this.zoom));dojo.mixin(this.lastWindow,{vscale:vs,hscale:hs,xoffset:_377,yoffset:_379});this.zoomQueue.push(anim);dojo.connect(anim,"onEnd",this,function(){this.zoom=null;this.zoomQueue.shift();if(this.zoomQueue.length>0){this.zoomQueue[0].play();}});if(this.zoomQueue.length==1){this.zoomQueue[0].play();}return this;},render:function(dim,_37a){return this;},getRequiredColors:function(){return this.series.length;},initializeScalers:function(dim,_37b){if(this._hAxis){if(!this._hAxis.initialized()){this._hAxis.calculate(_37b.hmin,_37b.hmax,dim.width);}this._hScaler=this._hAxis.getScaler();}else{this._hScaler=dojox.charting.scaler.primitive.buildScaler(_37b.hmin,_37b.hmax,dim.width);}if(this._vAxis){if(!this._vAxis.initialized()){this._vAxis.calculate(_37b.vmin,_37b.vmax,dim.height);}this._vScaler=this._vAxis.getScaler();}else{this._vScaler=dojox.charting.scaler.primitive.buildScaler(_37b.vmin,_37b.vmax,dim.height);}return this;}});}if(!dojo._hasResource["dojox.lang.functional.reversed"]){dojo._hasResource["dojox.lang.functional.reversed"]=true;dojo.provide("dojox.lang.functional.reversed");(function(){var d=dojo,df=dojox.lang.functional;d.mixin(df,{filterRev:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var t=[],v,i=a.length-1;for(;i>=0;--i){v=a[i];if(f.call(o,v,i,a)){t.push(v);}}return t;},forEachRev:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);for(var i=a.length-1;i>=0;f.call(o,a[i],i,a),--i){}},mapRev:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var n=a.length,t=new Array(n),i=n-1,j=0;for(;i>=0;t[j++]=f.call(o,a[i],i,a),--i){}return t;},everyRev:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);for(var i=a.length-1;i>=0;--i){if(!f.call(o,a[i],i,a)){return false;}}return true;},someRev:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);for(var i=a.length-1;i>=0;--i){if(f.call(o,a[i],i,a)){return true;}}return false;}});})();}if(!dojo._hasResource["dojox.gfx.fx"]){dojo._hasResource["dojox.gfx.fx"]=true;dojo.provide("dojox.gfx.fx");(function(){var d=dojo,g=dojox.gfx,m=g.matrix;function _37c(_37d,end){this.start=_37d,this.end=end;};_37c.prototype.getValue=function(r){return (this.end-this.start)*r+this.start;};function _37e(_37f,end,_380){this.start=_37f,this.end=end;this.units=_380;};_37e.prototype.getValue=function(r){return (this.end-this.start)*r+this.start+this.units;};function _381(_382,end){this.start=_382,this.end=end;this.temp=new dojo.Color();};_381.prototype.getValue=function(r){return d.blendColors(this.start,this.end,r,this.temp);};function _383(_384){this.values=_384;this.length=_384.length;};_383.prototype.getValue=function(r){return this.values[Math.min(Math.floor(r*this.length),this.length-1)];};function _385(_386,def){this.values=_386;this.def=def?def:{};};_385.prototype.getValue=function(r){var ret=dojo.clone(this.def);for(var i in this.values){ret[i]=this.values[i].getValue(r);}return ret;};function _387(_388,_389){this.stack=_388;this.original=_389;};_387.prototype.getValue=function(r){var ret=[];dojo.forEach(this.stack,function(t){if(t instanceof m.Matrix2D){ret.push(t);return;}if(t.name=="original"&&this.original){ret.push(this.original);return;}if(!(t.name in m)){return;}var f=m[t.name];if(typeof f!="function"){ret.push(f);return;}var val=dojo.map(t.start,function(v,i){return (t.end[i]-v)*r+v;}),_38a=f.apply(m,val);if(_38a instanceof m.Matrix2D){ret.push(_38a);}},this);return ret;};var _38b=new d.Color(0,0,0,0);function _38c(prop,obj,name,def){if(prop.values){return new _383(prop.values);}var _38d,_38e,end;if(prop.start){_38e=g.normalizeColor(prop.start);}else{_38e=_38d=obj?(name?obj[name]:obj):def;}if(prop.end){end=g.normalizeColor(prop.end);}else{if(!_38d){_38d=obj?(name?obj[name]:obj):def;}end=_38d;}return new _381(_38e,end);};function _38f(prop,obj,name,def){if(prop.values){return new _383(prop.values);}var _390,_391,end;if(prop.start){_391=prop.start;}else{_391=_390=obj?obj[name]:def;}if(prop.end){end=prop.end;}else{if(typeof _390!="number"){_390=obj?obj[name]:def;}end=_390;}return new _37c(_391,end);};g.fx.animateStroke=function(args){if(!args.easing){args.easing=d._defaultEasing;}var anim=new d.Animation(args),_392=args.shape,_393;d.connect(anim,"beforeBegin",anim,function(){_393=_392.getStroke();var prop=args.color,_394={},_395,_396,end;if(prop){_394.color=_38c(prop,_393,"color",_38b);}prop=args.style;if(prop&&prop.values){_394.style=new _383(prop.values);}prop=args.width;if(prop){_394.width=_38f(prop,_393,"width",1);}prop=args.cap;if(prop&&prop.values){_394.cap=new _383(prop.values);}prop=args.join;if(prop){if(prop.values){_394.join=new _383(prop.values);}else{_396=prop.start?prop.start:(_393&&_393.join||0);end=prop.end?prop.end:(_393&&_393.join||0);if(typeof _396=="number"&&typeof end=="number"){_394.join=new _37c(_396,end);}}}this.curve=new _385(_394,_393);});d.connect(anim,"onAnimate",_392,"setStroke");return anim;};g.fx.animateFill=function(args){if(!args.easing){args.easing=d._defaultEasing;}var anim=new d.Animation(args),_397=args.shape,fill;d.connect(anim,"beforeBegin",anim,function(){fill=_397.getFill();var prop=args.color,_398={};if(prop){this.curve=_38c(prop,fill,"",_38b);}});d.connect(anim,"onAnimate",_397,"setFill");return anim;};g.fx.animateFont=function(args){if(!args.easing){args.easing=d._defaultEasing;}var anim=new d.Animation(args),_399=args.shape,font;d.connect(anim,"beforeBegin",anim,function(){font=_399.getFont();var prop=args.style,_39a={},_39b,_39c,end;if(prop&&prop.values){_39a.style=new _383(prop.values);}prop=args.variant;if(prop&&prop.values){_39a.variant=new _383(prop.values);}prop=args.weight;if(prop&&prop.values){_39a.weight=new _383(prop.values);}prop=args.family;if(prop&&prop.values){_39a.family=new _383(prop.values);}prop=args.size;if(prop&&prop.units){_39c=parseFloat(prop.start?prop.start:(_399.font&&_399.font.size||"0"));end=parseFloat(prop.end?prop.end:(_399.font&&_399.font.size||"0"));_39a.size=new _37e(_39c,end,prop.units);}this.curve=new _385(_39a,font);});d.connect(anim,"onAnimate",_399,"setFont");return anim;};g.fx.animateTransform=function(args){if(!args.easing){args.easing=d._defaultEasing;}var anim=new d.Animation(args),_39d=args.shape,_39e;d.connect(anim,"beforeBegin",anim,function(){_39e=_39d.getTransform();this.curve=new _387(args.transform,_39e);});d.connect(anim,"onAnimate",_39d,"setTransform");return anim;};})();}if(!dojo._hasResource["dojox.charting.plot2d.Default"]){dojo._hasResource["dojox.charting.plot2d.Default"]=true;dojo.provide("dojox.charting.plot2d.Default");(function(){var df=dojox.lang.functional,du=dojox.lang.utils,dc=dojox.charting.plot2d.common,_39f=df.lambda("item.purgeGroup()");var _3a0=1200;dojo.declare("dojox.charting.plot2d.Default",dojox.charting.plot2d.Base,{defaultParams:{hAxis:"x",vAxis:"y",lines:true,areas:false,markers:false,tension:"",animate:false},optionalParams:{stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:"",markerStroke:{},markerOutline:{},markerShadow:{},markerFill:{},markerFont:"",markerFontColor:""},constructor:function(_3a1,_3a2){this.opt=dojo.clone(this.defaultParams);du.updateWithObject(this.opt,_3a2);du.updateWithPattern(this.opt,_3a2,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},render:function(dim,_3a3){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_3a3);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){dojo.forEach(this.series,_39f);this._eventSeries={};this.cleanGroup();this.group.setTransform(null);var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,_3a4,_3a5,_3a6,_3a7=this.events();for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();if(!run.data.length){run.dirty=false;t.skip();continue;}var _3a8=t.next(this.opt.areas?"area":"line",[this.opt,run],true),s=run.group,_3a9=[],_3aa=[],rseg=null,_3ab,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_3ac=this._eventSeries[run.name]=new Array(run.data.length);for(var j=0;j<run.data.length;j++){if(run.data[j]!=null){if(!rseg){rseg=[];_3aa.push(j);_3a9.push(rseg);}rseg.push(run.data[j]);}else{rseg=null;}}for(var seg=0;seg<_3a9.length;seg++){if(typeof _3a9[seg][0]=="number"){_3ab=dojo.map(_3a9[seg],function(v,i){return {x:ht(i+_3aa[seg]+1)+_3a3.l,y:dim.height-_3a3.b-vt(v)};},this);}else{_3ab=dojo.map(_3a9[seg],function(v,i){return {x:ht(v.x)+_3a3.l,y:dim.height-_3a3.b-vt(v.y)};},this);}var _3ad=this.opt.tension?dc.curve(_3ab,this.opt.tension):"";if(this.opt.areas&&_3ab.length>1){var fill=_3a8.series.fill;var _3ae=dojo.clone(_3ab);if(this.opt.tension){var _3af="L"+_3ae[_3ae.length-1].x+","+(dim.height-_3a3.b)+" L"+_3ae[0].x+","+(dim.height-_3a3.b)+" L"+_3ae[0].x+","+_3ae[0].y;run.dyn.fill=s.createPath(_3ad+" "+_3af).setFill(fill).getFill();}else{_3ae.push({x:_3ab[_3ab.length-1].x,y:dim.height-_3a3.b});_3ae.push({x:_3ab[0].x,y:dim.height-_3a3.b});_3ae.push(_3ab[0]);run.dyn.fill=s.createPolyline(_3ae).setFill(fill).getFill();}}if(this.opt.lines||this.opt.markers){_3a4=_3a8.series.stroke;if(_3a8.series.outline){_3a5=run.dyn.outline=dc.makeStroke(_3a8.series.outline);_3a5.width=2*_3a5.width+_3a4.width;}}if(this.opt.markers){run.dyn.marker=_3a8.symbol;}var _3b0=null,_3b1=null,_3b2=null;if(_3a4&&_3a8.series.shadow&&_3ab.length>1){var _3b3=_3a8.series.shadow,_3b4=dojo.map(_3ab,function(c){return {x:c.x+_3b3.dx,y:c.y+_3b3.dy};});if(this.opt.lines){if(this.opt.tension){run.dyn.shadow=s.createPath(dc.curve(_3b4,this.opt.tension)).setStroke(_3b3).getStroke();}else{run.dyn.shadow=s.createPolyline(_3b4).setStroke(_3b3).getStroke();}}if(this.opt.markers&&_3a8.marker.shadow){_3b3=_3a8.marker.shadow;_3b2=dojo.map(_3b4,function(c){return s.createPath("M"+c.x+" "+c.y+" "+_3a8.symbol).setStroke(_3b3).setFill(_3b3.color);},this);}}if(this.opt.lines&&_3ab.length>1){if(_3a5){if(this.opt.tension){run.dyn.outline=s.createPath(_3ad).setStroke(_3a5).getStroke();}else{run.dyn.outline=s.createPolyline(_3ab).setStroke(_3a5).getStroke();}}if(this.opt.tension){run.dyn.stroke=s.createPath(_3ad).setStroke(_3a4).getStroke();}else{run.dyn.stroke=s.createPolyline(_3ab).setStroke(_3a4).getStroke();}}if(this.opt.markers){_3b0=new Array(_3ab.length);_3b1=new Array(_3ab.length);_3a5=null;if(_3a8.marker.outline){_3a5=dc.makeStroke(_3a8.marker.outline);_3a5.width=2*_3a5.width+(_3a8.marker.stroke?_3a8.marker.stroke.width:0);}dojo.forEach(_3ab,function(c,i){var path="M"+c.x+" "+c.y+" "+_3a8.symbol;if(_3a5){_3b1[i]=s.createPath(path).setStroke(_3a5);}_3b0[i]=s.createPath(path).setStroke(_3a8.marker.stroke).setFill(_3a8.marker.fill);},this);run.dyn.markerFill=_3a8.marker.fill;run.dyn.markerStroke=_3a8.marker.stroke;if(_3a7){dojo.forEach(_3b0,function(s,i){var o={element:"marker",index:i+_3aa[seg],run:run,shape:s,outline:_3b1[i]||null,shadow:_3b2&&_3b2[i]||null,cx:_3ab[i].x,cy:_3ab[i].y};if(typeof _3a9[seg][0]=="number"){o.x=i+_3aa[seg]+1;o.y=_3a9[seg][i];}else{o.x=_3a9[seg][i].x;o.y=_3a9[seg][i].y;}this._connectEvents(o);_3ac[i+_3aa[seg]]=o;},this);}else{delete this._eventSeries[run.name];}}}run.dirty=false;}if(this.animate){var _3b5=this.group;dojox.gfx.fx.animateTransform(dojo.delegate({shape:_3b5,duration:_3a0,transform:[{name:"translate",start:[0,dim.height-_3a3.b],end:[0,0]},{name:"scale",start:[1,0],end:[1,1]},{name:"original"}]},this.animate)).play();}this.dirty=false;return this;}});})();}if(!dojo._hasResource["dojox.charting.plot2d.Lines"]){dojo._hasResource["dojox.charting.plot2d.Lines"]=true;dojo.provide("dojox.charting.plot2d.Lines");dojo.declare("dojox.charting.plot2d.Lines",dojox.charting.plot2d.Default,{constructor:function(){this.opt.lines=true;}});}if(!dojo._hasResource["dojox.charting.plot2d.Areas"]){dojo._hasResource["dojox.charting.plot2d.Areas"]=true;dojo.provide("dojox.charting.plot2d.Areas");dojo.declare("dojox.charting.plot2d.Areas",dojox.charting.plot2d.Default,{constructor:function(){this.opt.lines=true;this.opt.areas=true;}});}if(!dojo._hasResource["dojox.charting.plot2d.Markers"]){dojo._hasResource["dojox.charting.plot2d.Markers"]=true;dojo.provide("dojox.charting.plot2d.Markers");dojo.declare("dojox.charting.plot2d.Markers",dojox.charting.plot2d.Default,{constructor:function(){this.opt.markers=true;}});}if(!dojo._hasResource["dojox.charting.plot2d.MarkersOnly"]){dojo._hasResource["dojox.charting.plot2d.MarkersOnly"]=true;dojo.provide("dojox.charting.plot2d.MarkersOnly");dojo.declare("dojox.charting.plot2d.MarkersOnly",dojox.charting.plot2d.Default,{constructor:function(){this.opt.lines=false;this.opt.markers=true;}});}if(!dojo._hasResource["dojox.gfx.gradutils"]){dojo._hasResource["dojox.gfx.gradutils"]=true;dojo.provide("dojox.gfx.gradutils");(function(){var d=dojo,m=dojox.gfx.matrix,C=d.Color;function _3b6(o,c){if(o<=0){return c[0].color;}var len=c.length;if(o>=1){return c[len-1].color;}for(var i=0;i<len;++i){var stop=c[i];if(stop.offset>=o){if(i){var prev=c[i-1];return d.blendColors(new C(prev.color),new C(stop.color),(o-prev.offset)/(stop.offset-prev.offset));}return stop.color;}}return c[len-1].color;};dojox.gfx.gradutils.getColor=function(fill,pt){var o;if(fill){switch(fill.type){case "linear":var _3b7=Math.atan2(fill.y2-fill.y1,fill.x2-fill.x1),_3b8=m.rotate(-_3b7),_3b9=m.project(fill.x2-fill.x1,fill.y2-fill.y1),p=m.multiplyPoint(_3b9,pt),pf1=m.multiplyPoint(_3b9,fill.x1,fill.y1),pf2=m.multiplyPoint(_3b9,fill.x2,fill.y2),_3ba=m.multiplyPoint(_3b8,pf2.x-pf1.x,pf2.y-pf1.y).x,o=m.multiplyPoint(_3b8,p.x-pf1.x,p.y-pf1.y).x/_3ba;break;case "radial":var dx=pt.x-fill.cx,dy=pt.y-fill.cy,o=Math.sqrt(dx*dx+dy*dy)/fill.r;break;}return _3b6(o,fill.colors);}return new C(fill||[0,0,0,0]);};dojox.gfx.gradutils.reverse=function(fill){if(fill){switch(fill.type){case "linear":case "radial":fill=dojo.delegate(fill);if(fill.colors){var c=fill.colors,l=c.length,i=0,stop,n=fill.colors=new Array(c.length);for(;i<l;++i){stop=c[i];n[i]={offset:1-stop.offset,color:stop.color};}n.sort(function(a,b){return a.offset-b.offset;});}break;}}return fill;};})();}if(!dojo._hasResource["dojox.charting.plot2d.Scatter"]){dojo._hasResource["dojox.charting.plot2d.Scatter"]=true;dojo.provide("dojox.charting.plot2d.Scatter");(function(){var df=dojox.lang.functional,du=dojox.lang.utils,dc=dojox.charting.plot2d.common,_3bb=df.lambda("item.purgeGroup()");dojo.declare("dojox.charting.plot2d.Scatter",dojox.charting.plot2d.Base,{defaultParams:{hAxis:"x",vAxis:"y",shadows:null,animate:null},optionalParams:{markerStroke:{},markerOutline:{},markerShadow:{},markerFill:{},markerFont:"",markerFontColor:""},constructor:function(_3bc,_3bd){this.opt=dojo.clone(this.defaultParams);du.updateWithObject(this.opt,_3bd);du.updateWithPattern(this.opt,_3bd,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},render:function(dim,_3be){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_3be);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){dojo.forEach(this.series,_3bb);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,_3bf=this.events();for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();if(!run.data.length){run.dirty=false;t.skip();continue;}var _3c0=t.next("marker",[this.opt,run]),s=run.group,_3c1,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler);if(typeof run.data[0]=="number"){_3c1=dojo.map(run.data,function(v,i){return {x:ht(i+1)+_3be.l,y:dim.height-_3be.b-vt(v)};},this);}else{_3c1=dojo.map(run.data,function(v,i){return {x:ht(v.x)+_3be.l,y:dim.height-_3be.b-vt(v.y)};},this);}var _3c2=new Array(_3c1.length),_3c3=new Array(_3c1.length),_3c4=new Array(_3c1.length);dojo.forEach(_3c1,function(c,i){var _3c5=typeof run.data[i]=="number"?t.post(_3c0,"marker"):t.addMixin(_3c0,"marker",run.data[i],true),path="M"+c.x+" "+c.y+" "+_3c5.symbol;if(_3c5.marker.shadow){_3c2[i]=s.createPath("M"+(c.x+_3c5.marker.shadow.dx)+" "+(c.y+_3c5.marker.shadow.dy)+" "+_3c5.symbol).setStroke(_3c5.marker.shadow).setFill(_3c5.marker.shadow.color);if(this.animate){this._animateScatter(_3c2[i],dim.height-_3be.b);}}if(_3c5.marker.outline){var _3c6=dc.makeStroke(_3c5.marker.outline);_3c6.width=2*_3c6.width+_3c5.marker.stroke.width;_3c4[i]=s.createPath(path).setStroke(_3c6);if(this.animate){this._animateScatter(_3c4[i],dim.height-_3be.b);}}var _3c7=dc.makeStroke(_3c5.marker.stroke),fill=this._plotFill(_3c5.marker.fill,dim,_3be);if(fill&&(fill.type==="linear"||fill.type=="radial")){var _3c8=dojox.gfx.gradutils.getColor(fill,{x:c.x,y:c.y});if(_3c7){_3c7.color=_3c8;}_3c3[i]=s.createPath(path).setStroke(_3c7).setFill(_3c8);}else{_3c3[i]=s.createPath(path).setStroke(_3c7).setFill(fill);}if(this.animate){this._animateScatter(_3c3[i],dim.height-_3be.b);}},this);if(_3c3.length){run.dyn.stroke=_3c3[_3c3.length-1].getStroke();run.dyn.fill=_3c3[_3c3.length-1].getFill();}if(_3bf){var _3c9=new Array(_3c3.length);dojo.forEach(_3c3,function(s,i){var o={element:"marker",index:i,run:run,shape:s,outline:_3c4&&_3c4[i]||null,shadow:_3c2&&_3c2[i]||null,cx:_3c1[i].x,cy:_3c1[i].y};if(typeof run.data[0]=="number"){o.x=i+1;o.y=run.data[i];}else{o.x=run.data[i].x;o.y=run.data[i].y;}this._connectEvents(o);_3c9[i]=o;},this);this._eventSeries[run.name]=_3c9;}else{delete this._eventSeries[run.name];}run.dirty=false;}this.dirty=false;return this;},_animateScatter:function(_3ca,_3cb){dojox.gfx.fx.animateTransform(dojo.delegate({shape:_3ca,duration:1200,transform:[{name:"translate",start:[0,_3cb],end:[0,0]},{name:"scale",start:[0,0],end:[1,1]},{name:"original"}]},this.animate)).play();}});})();}if(!dojo._hasResource["dojox.lang.functional.sequence"]){dojo._hasResource["dojox.lang.functional.sequence"]=true;dojo.provide("dojox.lang.functional.sequence");(function(){var d=dojo,df=dojox.lang.functional;d.mixin(df,{repeat:function(n,f,z,o){o=o||d.global;f=df.lambda(f);var t=new Array(n),i=1;t[0]=z;for(;i<n;t[i]=z=f.call(o,z),++i){}return t;},until:function(pr,f,z,o){o=o||d.global;f=df.lambda(f);pr=df.lambda(pr);var t=[];for(;!pr.call(o,z);t.push(z),z=f.call(o,z)){}return t;}});})();}if(!dojo._hasResource["dojox.charting.plot2d.Stacked"]){dojo._hasResource["dojox.charting.plot2d.Stacked"]=true;dojo.provide("dojox.charting.plot2d.Stacked");(function(){var df=dojox.lang.functional,dc=dojox.charting.plot2d.common,_3cc=df.lambda("item.purgeGroup()");dojo.declare("dojox.charting.plot2d.Stacked",dojox.charting.plot2d.Default,{getSeriesStats:function(){var _3cd=dc.collectStackedStats(this.series);this._maxRunLength=_3cd.hmax;return _3cd;},render:function(dim,_3ce){if(this._maxRunLength<=0){return this;}var acc=df.repeat(this._maxRunLength,"-> 0",0);for(var i=0;i<this.series.length;++i){var run=this.series[i];for(var j=0;j<run.data.length;++j){var v=run.data[j];if(v!==null){if(isNaN(v)){v=0;}acc[j]+=v;}}}if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_3ce);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){dojo.forEach(this.series,_3cc);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,_3cf=this.events(),ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler);for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _3d0=t.next(this.opt.areas?"area":"line",[this.opt,run],true),s=run.group,_3d1,_3d2=dojo.map(acc,function(v,i){return {x:ht(i+1)+_3ce.l,y:dim.height-_3ce.b-vt(v)};},this);var _3d3=this.opt.tension?dc.curve(_3d2,this.opt.tension):"";if(this.opt.areas){var _3d4=dojo.clone(_3d2);if(this.opt.tension){var p=dc.curve(_3d4,this.opt.tension);p+=" L"+_3d2[_3d2.length-1].x+","+(dim.height-_3ce.b)+" L"+_3d2[0].x+","+(dim.height-_3ce.b)+" L"+_3d2[0].x+","+_3d2[0].y;run.dyn.fill=s.createPath(p).setFill(_3d0.series.fill).getFill();}else{_3d4.push({x:_3d2[_3d2.length-1].x,y:dim.height-_3ce.b});_3d4.push({x:_3d2[0].x,y:dim.height-_3ce.b});_3d4.push(_3d2[0]);run.dyn.fill=s.createPolyline(_3d4).setFill(_3d0.series.fill).getFill();}}if(this.opt.lines||this.opt.markers){if(_3d0.series.outline){_3d1=dc.makeStroke(_3d0.series.outline);_3d1.width=2*_3d1.width+_3d0.series.stroke.width;}}if(this.opt.markers){run.dyn.marker=_3d0.symbol;}var _3d5,_3d6,_3d7;if(_3d0.series.shadow&&_3d0.series.stroke){var _3d8=_3d0.series.shadow,_3d9=dojo.map(_3d2,function(c){return {x:c.x+_3d8.dx,y:c.y+_3d8.dy};});if(this.opt.lines){if(this.opt.tension){run.dyn.shadow=s.createPath(dc.curve(_3d9,this.opt.tension)).setStroke(_3d8).getStroke();}else{run.dyn.shadow=s.createPolyline(_3d9).setStroke(_3d8).getStroke();}}if(this.opt.markers){_3d8=_3d0.marker.shadow;_3d7=dojo.map(_3d9,function(c){return s.createPath("M"+c.x+" "+c.y+" "+_3d0.symbol).setStroke(_3d8).setFill(_3d8.color);},this);}}if(this.opt.lines){if(_3d1){if(this.opt.tension){run.dyn.outline=s.createPath(_3d3).setStroke(_3d1).getStroke();}else{run.dyn.outline=s.createPolyline(_3d2).setStroke(_3d1).getStroke();}}if(this.opt.tension){run.dyn.stroke=s.createPath(_3d3).setStroke(_3d0.series.stroke).getStroke();}else{run.dyn.stroke=s.createPolyline(_3d2).setStroke(_3d0.series.stroke).getStroke();}}if(this.opt.markers){_3d5=new Array(_3d2.length);_3d6=new Array(_3d2.length);_3d1=null;if(_3d0.marker.outline){_3d1=dc.makeStroke(_3d0.marker.outline);_3d1.width=2*_3d1.width+(_3d0.marker.stroke?_3d0.marker.stroke.width:0);}dojo.forEach(_3d2,function(c,i){var path="M"+c.x+" "+c.y+" "+_3d0.symbol;if(_3d1){_3d6[i]=s.createPath(path).setStroke(_3d1);}_3d5[i]=s.createPath(path).setStroke(_3d0.marker.stroke).setFill(_3d0.marker.fill);},this);if(_3cf){var _3da=new Array(_3d5.length);dojo.forEach(_3d5,function(s,i){var o={element:"marker",index:i,run:run,shape:s,outline:_3d6[i]||null,shadow:_3d7&&_3d7[i]||null,cx:_3d2[i].x,cy:_3d2[i].y,x:i+1,y:run.data[i]};this._connectEvents(o);_3da[i]=o;},this);this._eventSeries[run.name]=_3da;}else{delete this._eventSeries[run.name];}}run.dirty=false;for(var j=0;j<run.data.length;++j){var v=run.data[j];if(v!==null){if(isNaN(v)){v=0;}acc[j]-=v;}}}this.dirty=false;return this;}});})();}if(!dojo._hasResource["dojox.charting.plot2d.StackedLines"]){dojo._hasResource["dojox.charting.plot2d.StackedLines"]=true;dojo.provide("dojox.charting.plot2d.StackedLines");dojo.declare("dojox.charting.plot2d.StackedLines",dojox.charting.plot2d.Stacked,{constructor:function(){this.opt.lines=true;}});}if(!dojo._hasResource["dojox.charting.plot2d.StackedAreas"]){dojo._hasResource["dojox.charting.plot2d.StackedAreas"]=true;dojo.provide("dojox.charting.plot2d.StackedAreas");dojo.declare("dojox.charting.plot2d.StackedAreas",dojox.charting.plot2d.Stacked,{constructor:function(){this.opt.lines=true;this.opt.areas=true;}});}if(!dojo._hasResource["dojox.charting.plot2d.Columns"]){dojo._hasResource["dojox.charting.plot2d.Columns"]=true;dojo.provide("dojox.charting.plot2d.Columns");(function(){var df=dojox.lang.functional,du=dojox.lang.utils,dc=dojox.charting.plot2d.common,_3db=df.lambda("item.purgeGroup()");dojo.declare("dojox.charting.plot2d.Columns",dojox.charting.plot2d.Base,{defaultParams:{hAxis:"x",vAxis:"y",gap:0,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(_3dc,_3dd){this.opt=dojo.clone(this.defaultParams);du.updateWithObject(this.opt,_3dd);du.updateWithPattern(this.opt,_3dd,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},getSeriesStats:function(){var _3de=dc.collectSimpleStats(this.series);_3de.hmin-=0.5;_3de.hmax+=0.5;return _3de;},render:function(dim,_3df){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_3df);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){dojo.forEach(this.series,_3db);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_3e0,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_3e1=Math.max(0,this._vScaler.bounds.lower),_3e2=vt(_3e1),_3e3=this.events();f=dc.calculateBarSize(this._hScaler.bounds.scale,this.opt);gap=f.gap;_3e0=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _3e4=t.next("column",[this.opt,run]),s=run.group,_3e5=new Array(run.data.length);for(var j=0;j<run.data.length;++j){var _3e6=run.data[j];if(_3e6!==null){var v=typeof _3e6=="number"?_3e6:_3e6.y,vv=vt(v),_3e7=vv-_3e2,h=Math.abs(_3e7),_3e8=typeof _3e6!="number"?t.addMixin(_3e4,"column",_3e6,true):t.post(_3e4,"column");if(_3e0>=1&&h>=1){var rect={x:_3df.l+ht(j+0.5)+gap,y:dim.height-_3df.b-(v>_3e1?vv:_3e2),width:_3e0,height:h};var _3e9=this._plotFill(_3e8.series.fill,dim,_3df);_3e9=this._shapeFill(_3e9,rect);var _3ea=s.createRect(rect).setFill(_3e9).setStroke(_3e8.series.stroke);run.dyn.fill=_3ea.getFill();run.dyn.stroke=_3ea.getStroke();if(_3e3){var o={element:"column",index:j,run:run,shape:_3ea,x:j+0.5,y:v};this._connectEvents(o);_3e5[j]=o;}if(this.animate){this._animateColumn(_3ea,dim.height-_3df.b-_3e2,h);}}}}this._eventSeries[run.name]=_3e5;run.dirty=false;}this.dirty=false;return this;},_animateColumn:function(_3eb,_3ec,_3ed){dojox.gfx.fx.animateTransform(dojo.delegate({shape:_3eb,duration:1200,transform:[{name:"translate",start:[0,_3ec-(_3ec/_3ed)],end:[0,0]},{name:"scale",start:[1,1/_3ed],end:[1,1]},{name:"original"}]},this.animate)).play();}});})();}if(!dojo._hasResource["dojox.charting.plot2d.StackedColumns"]){dojo._hasResource["dojox.charting.plot2d.StackedColumns"]=true;dojo.provide("dojox.charting.plot2d.StackedColumns");(function(){var df=dojox.lang.functional,dc=dojox.charting.plot2d.common,_3ee=df.lambda("item.purgeGroup()");dojo.declare("dojox.charting.plot2d.StackedColumns",dojox.charting.plot2d.Columns,{getSeriesStats:function(){var _3ef=dc.collectStackedStats(this.series);this._maxRunLength=_3ef.hmax;_3ef.hmin-=0.5;_3ef.hmax+=0.5;return _3ef;},render:function(dim,_3f0){if(this._maxRunLength<=0){return this;}var acc=df.repeat(this._maxRunLength,"-> 0",0);for(var i=0;i<this.series.length;++i){var run=this.series[i];for(var j=0;j<run.data.length;++j){var _3f1=run.data[j];if(_3f1!==null){var v=typeof _3f1=="number"?_3f1:_3f1.y;if(isNaN(v)){v=0;}acc[j]+=v;}}}if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_3f0);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){dojo.forEach(this.series,_3ee);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_3f2,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_3f3=this.events();f=dc.calculateBarSize(this._hScaler.bounds.scale,this.opt);gap=f.gap;_3f2=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _3f4=t.next("column",[this.opt,run]),s=run.group,_3f5=new Array(acc.length);for(var j=0;j<acc.length;++j){var _3f1=run.data[j];if(_3f1!==null){var v=acc[j],_3f6=vt(v),_3f7=typeof _3f1!="number"?t.addMixin(_3f4,"column",_3f1,true):t.post(_3f4,"column");if(_3f2>=1&&_3f6>=1){var rect={x:_3f0.l+ht(j+0.5)+gap,y:dim.height-_3f0.b-vt(v),width:_3f2,height:_3f6};var _3f8=this._plotFill(_3f7.series.fill,dim,_3f0);_3f8=this._shapeFill(_3f8,rect);var _3f9=s.createRect(rect).setFill(_3f8).setStroke(_3f7.series.stroke);run.dyn.fill=_3f9.getFill();run.dyn.stroke=_3f9.getStroke();if(_3f3){var o={element:"column",index:j,run:run,shape:_3f9,x:j+0.5,y:v};this._connectEvents(o);_3f5[j]=o;}if(this.animate){this._animateColumn(_3f9,dim.height-_3f0.b,_3f6);}}}}this._eventSeries[run.name]=_3f5;run.dirty=false;for(var j=0;j<run.data.length;++j){var _3f1=run.data[j];if(_3f1!==null){var v=typeof _3f1=="number"?_3f1:_3f1.y;if(isNaN(v)){v=0;}acc[j]-=v;}}}this.dirty=false;return this;}});})();}if(!dojo._hasResource["dojox.charting.plot2d.ClusteredColumns"]){dojo._hasResource["dojox.charting.plot2d.ClusteredColumns"]=true;dojo.provide("dojox.charting.plot2d.ClusteredColumns");(function(){var df=dojox.lang.functional,dc=dojox.charting.plot2d.common,_3fa=df.lambda("item.purgeGroup()");dojo.declare("dojox.charting.plot2d.ClusteredColumns",dojox.charting.plot2d.Columns,{render:function(dim,_3fb){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_3fb);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){dojo.forEach(this.series,_3fa);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_3fc,_3fd,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_3fe=Math.max(0,this._vScaler.bounds.lower),_3ff=vt(_3fe),_400=this.events();f=dc.calculateBarSize(this._hScaler.bounds.scale,this.opt,this.series.length);gap=f.gap;_3fc=_3fd=f.size;for(var i=0;i<this.series.length;++i){var run=this.series[i],_401=_3fd*i;if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _402=t.next("column",[this.opt,run]),s=run.group,_403=new Array(run.data.length);for(var j=0;j<run.data.length;++j){var _404=run.data[j];if(_404!==null){var v=typeof _404=="number"?_404:_404.y,vv=vt(v),_405=vv-_3ff,h=Math.abs(_405),_406=typeof _404!="number"?t.addMixin(_402,"column",_404,true):t.post(_402,"column");if(_3fc>=1&&h>=1){var rect={x:_3fb.l+ht(j+0.5)+gap+_401,y:dim.height-_3fb.b-(v>_3fe?vv:_3ff),width:_3fc,height:h};var _407=this._plotFill(_406.series.fill,dim,_3fb);_407=this._shapeFill(_407,rect);var _408=s.createRect(rect).setFill(_407).setStroke(_406.series.stroke);run.dyn.fill=_408.getFill();run.dyn.stroke=_408.getStroke();if(_400){var o={element:"column",index:j,run:run,shape:_408,x:j+0.5,y:v};this._connectEvents(o);_403[j]=o;}if(this.animate){this._animateColumn(_408,dim.height-_3fb.b-_3ff,h);}}}}this._eventSeries[run.name]=_403;run.dirty=false;}this.dirty=false;return this;}});})();}if(!dojo._hasResource["dojox.charting.plot2d.Bars"]){dojo._hasResource["dojox.charting.plot2d.Bars"]=true;dojo.provide("dojox.charting.plot2d.Bars");(function(){var df=dojox.lang.functional,du=dojox.lang.utils,dc=dojox.charting.plot2d.common,_409=df.lambda("item.purgeGroup()");dojo.declare("dojox.charting.plot2d.Bars",dojox.charting.plot2d.Base,{defaultParams:{hAxis:"x",vAxis:"y",gap:0,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(_40a,_40b){this.opt=dojo.clone(this.defaultParams);du.updateWithObject(this.opt,_40b);du.updateWithPattern(this.opt,_40b,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},getSeriesStats:function(){var _40c=dc.collectSimpleStats(this.series),t;_40c.hmin-=0.5;_40c.hmax+=0.5;t=_40c.hmin,_40c.hmin=_40c.vmin,_40c.vmin=t;t=_40c.hmax,_40c.hmax=_40c.vmax,_40c.vmax=t;return _40c;},render:function(dim,_40d){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_40d);}this.dirty=this.isDirty();this.resetEvents();if(this.dirty){dojo.forEach(this.series,_409);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_40e,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_40f=Math.max(0,this._hScaler.bounds.lower),_410=ht(_40f),_411=this.events();f=dc.calculateBarSize(this._vScaler.bounds.scale,this.opt);gap=f.gap;_40e=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _412=t.next("bar",[this.opt,run]),s=run.group,_413=new Array(run.data.length);for(var j=0;j<run.data.length;++j){var _414=run.data[j];if(_414!==null){var v=typeof _414=="number"?_414:_414.y,hv=ht(v),_415=hv-_410,w=Math.abs(_415),_416=typeof _414!="number"?t.addMixin(_412,"bar",_414,true):t.post(_412,"bar");if(w>=1&&_40e>=1){var rect={x:_40d.l+(v<_40f?hv:_410),y:dim.height-_40d.b-vt(j+1.5)+gap,width:w,height:_40e};var _417=this._plotFill(_416.series.fill,dim,_40d);_417=this._shapeFill(_417,rect);var _418=s.createRect(rect).setFill(_417).setStroke(_416.series.stroke);run.dyn.fill=_418.getFill();run.dyn.stroke=_418.getStroke();if(_411){var o={element:"bar",index:j,run:run,shape:_418,x:v,y:j+1.5};this._connectEvents(o);_413[j]=o;}if(this.animate){this._animateBar(_418,_40d.l+_410,-w);}}}}this._eventSeries[run.name]=_413;run.dirty=false;}this.dirty=false;return this;},_animateBar:function(_419,_41a,_41b){dojox.gfx.fx.animateTransform(dojo.delegate({shape:_419,duration:1200,transform:[{name:"translate",start:[_41a-(_41a/_41b),0],end:[0,0]},{name:"scale",start:[1/_41b,1],end:[1,1]},{name:"original"}]},this.animate)).play();}});})();}if(!dojo._hasResource["dojox.charting.plot2d.StackedBars"]){dojo._hasResource["dojox.charting.plot2d.StackedBars"]=true;dojo.provide("dojox.charting.plot2d.StackedBars");(function(){var df=dojox.lang.functional,dc=dojox.charting.plot2d.common,_41c=df.lambda("item.purgeGroup()");dojo.declare("dojox.charting.plot2d.StackedBars",dojox.charting.plot2d.Bars,{getSeriesStats:function(){var _41d=dc.collectStackedStats(this.series),t;this._maxRunLength=_41d.hmax;_41d.hmin-=0.5;_41d.hmax+=0.5;t=_41d.hmin,_41d.hmin=_41d.vmin,_41d.vmin=t;t=_41d.hmax,_41d.hmax=_41d.vmax,_41d.vmax=t;return _41d;},render:function(dim,_41e){if(this._maxRunLength<=0){return this;}var acc=df.repeat(this._maxRunLength,"-> 0",0);for(var i=0;i<this.series.length;++i){var run=this.series[i];for(var j=0;j<run.data.length;++j){var _41f=run.data[j];if(_41f!==null){var v=typeof _41f=="number"?_41f:_41f.y;if(isNaN(v)){v=0;}acc[j]+=v;}}}if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_41e);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){dojo.forEach(this.series,_41c);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_420,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_421=this.events();f=dc.calculateBarSize(this._vScaler.bounds.scale,this.opt);gap=f.gap;_420=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _422=t.next("bar",[this.opt,run]),s=run.group,_423=new Array(acc.length);for(var j=0;j<acc.length;++j){var _41f=run.data[j];if(_41f!==null){var v=acc[j],_424=ht(v),_425=typeof _41f!="number"?t.addMixin(_422,"bar",_41f,true):t.post(_422,"bar");if(_424>=1&&_420>=1){var rect={x:_41e.l,y:dim.height-_41e.b-vt(j+1.5)+gap,width:_424,height:_420};var _426=this._plotFill(_425.series.fill,dim,_41e);_426=this._shapeFill(_426,rect);var _427=s.createRect(rect).setFill(_426).setStroke(_425.series.stroke);run.dyn.fill=_427.getFill();run.dyn.stroke=_427.getStroke();if(_421){var o={element:"bar",index:j,run:run,shape:_427,x:v,y:j+1.5};this._connectEvents(o);_423[j]=o;}if(this.animate){this._animateBar(_427,_41e.l,-_424);}}}}this._eventSeries[run.name]=_423;run.dirty=false;for(var j=0;j<run.data.length;++j){var _41f=run.data[j];if(_41f!==null){var v=typeof _41f=="number"?_41f:_41f.y;if(isNaN(v)){v=0;}acc[j]-=v;}}}this.dirty=false;return this;}});})();}if(!dojo._hasResource["dojox.charting.plot2d.ClusteredBars"]){dojo._hasResource["dojox.charting.plot2d.ClusteredBars"]=true;dojo.provide("dojox.charting.plot2d.ClusteredBars");(function(){var df=dojox.lang.functional,dc=dojox.charting.plot2d.common,_428=df.lambda("item.purgeGroup()");dojo.declare("dojox.charting.plot2d.ClusteredBars",dojox.charting.plot2d.Bars,{render:function(dim,_429){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_429);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){dojo.forEach(this.series,_428);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_42a,_42b,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_42c=Math.max(0,this._hScaler.bounds.lower),_42d=ht(_42c),_42e=this.events();f=dc.calculateBarSize(this._vScaler.bounds.scale,this.opt,this.series.length);gap=f.gap;_42a=_42b=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i],_42f=_42b*(this.series.length-i-1);if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _430=t.next("bar",[this.opt,run]),s=run.group,_431=new Array(run.data.length);for(var j=0;j<run.data.length;++j){var _432=run.data[j];if(_432!==null){var v=typeof _432=="number"?_432:_432.y,hv=ht(v),_433=hv-_42d,w=Math.abs(_433),_434=typeof _432!="number"?t.addMixin(_430,"bar",_432,true):t.post(_430,"bar");if(w>=1&&_42a>=1){var rect={x:_429.l+(v<_42c?hv:_42d),y:dim.height-_429.b-vt(j+1.5)+gap+_42f,width:w,height:_42a};var _435=this._plotFill(_434.series.fill,dim,_429);_435=this._shapeFill(_435,rect);var _436=s.createRect(rect).setFill(_435).setStroke(_434.series.stroke);run.dyn.fill=_436.getFill();run.dyn.stroke=_436.getStroke();if(_42e){var o={element:"bar",index:j,run:run,shape:_436,x:v,y:j+1.5};this._connectEvents(o);_431[j]=o;}if(this.animate){this._animateBar(_436,_429.l+_42d,-_433);}}}}this._eventSeries[run.name]=_431;run.dirty=false;}this.dirty=false;return this;}});})();}if(!dojo._hasResource["dojox.charting.plot2d.Grid"]){dojo._hasResource["dojox.charting.plot2d.Grid"]=true;dojo.provide("dojox.charting.plot2d.Grid");(function(){var du=dojox.lang.utils,dc=dojox.charting.plot2d.common;dojo.declare("dojox.charting.plot2d.Grid",dojox.charting.Element,{defaultParams:{hAxis:"x",vAxis:"y",hMajorLines:true,hMinorLines:false,vMajorLines:true,vMinorLines:false,hStripes:"none",vStripes:"none",animate:null},optionalParams:{},constructor:function(_437,_438){this.opt=dojo.clone(this.defaultParams);du.updateWithObject(this.opt,_438);this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.dirty=true;this.animate=this.opt.animate;this.zoom=null,this.zoomQueue=[];this.lastWindow={vscale:1,hscale:1,xoffset:0,yoffset:0};},clear:function(){this._hAxis=null;this._vAxis=null;this.dirty=true;return this;},setAxis:function(axis){if(axis){this[axis.vertical?"_vAxis":"_hAxis"]=axis;}return this;},addSeries:function(run){return this;},getSeriesStats:function(){return dojo.delegate(dc.defaultStats);},initializeScalers:function(){return this;},isDirty:function(){return this.dirty||this._hAxis&&this._hAxis.dirty||this._vAxis&&this._vAxis.dirty;},performZoom:function(dim,_439){var vs=this._vAxis.scale||1,hs=this._hAxis.scale||1,_43a=dim.height-_439.b,_43b=this._hAxis.getScaler().bounds,_43c=(_43b.from-_43b.lower)*_43b.scale,_43d=this._vAxis.getScaler().bounds,_43e=(_43d.from-_43d.lower)*_43d.scale;rVScale=vs/this.lastWindow.vscale,rHScale=hs/this.lastWindow.hscale,rXOffset=(this.lastWindow.xoffset-_43c)/((this.lastWindow.hscale==1)?hs:this.lastWindow.hscale),rYOffset=(_43e-this.lastWindow.yoffset)/((this.lastWindow.vscale==1)?vs:this.lastWindow.vscale),shape=this.group,anim=dojox.gfx.fx.animateTransform(dojo.delegate({shape:shape,duration:1200,transform:[{name:"translate",start:[0,0],end:[_439.l*(1-rHScale),_43a*(1-rVScale)]},{name:"scale",start:[1,1],end:[rHScale,rVScale]},{name:"original"},{name:"translate",start:[0,0],end:[rXOffset,rYOffset]}]},this.zoom));dojo.mixin(this.lastWindow,{vscale:vs,hscale:hs,xoffset:_43c,yoffset:_43e});this.zoomQueue.push(anim);dojo.connect(anim,"onEnd",this,function(){this.zoom=null;this.zoomQueue.shift();if(this.zoomQueue.length>0){this.zoomQueue[0].play();}});if(this.zoomQueue.length==1){this.zoomQueue[0].play();}return this;},getRequiredColors:function(){return 0;},render:function(dim,_43f){if(this.zoom){return this.performZoom(dim,_43f);}this.dirty=this.isDirty();if(!this.dirty){return this;}this.cleanGroup();var s=this.group,ta=this.chart.theme.axis;try{var _440=this._vAxis.getScaler(),vt=_440.scaler.getTransformerFromModel(_440),_441=this._vAxis.getTicks();if(this.opt.hMinorLines){dojo.forEach(_441.minor,function(tick){var y=dim.height-_43f.b-vt(tick.value);var _442=s.createLine({x1:_43f.l,y1:y,x2:dim.width-_43f.r,y2:y}).setStroke(ta.minorTick);if(this.animate){this._animateGrid(_442,"h",_43f.l,_43f.r+_43f.l-dim.width);}},this);}if(this.opt.hMajorLines){dojo.forEach(_441.major,function(tick){var y=dim.height-_43f.b-vt(tick.value);var _443=s.createLine({x1:_43f.l,y1:y,x2:dim.width-_43f.r,y2:y}).setStroke(ta.majorTick);if(this.animate){this._animateGrid(_443,"h",_43f.l,_43f.r+_43f.l-dim.width);}},this);}}catch(e){}try{var _444=this._hAxis.getScaler(),ht=_444.scaler.getTransformerFromModel(_444),_441=this._hAxis.getTicks();if(_441&&this.opt.vMinorLines){dojo.forEach(_441.minor,function(tick){var x=_43f.l+ht(tick.value);var _445=s.createLine({x1:x,y1:_43f.t,x2:x,y2:dim.height-_43f.b}).setStroke(ta.minorTick);if(this.animate){this._animateGrid(_445,"v",dim.height-_43f.b,dim.height-_43f.b-_43f.t);}},this);}if(_441&&this.opt.vMajorLines){dojo.forEach(_441.major,function(tick){var x=_43f.l+ht(tick.value);var _446=s.createLine({x1:x,y1:_43f.t,x2:x,y2:dim.height-_43f.b}).setStroke(ta.majorTick);if(this.animate){this._animateGrid(_446,"v",dim.height-_43f.b,dim.height-_43f.b-_43f.t);}},this);}}catch(e){}this.dirty=false;return this;},_animateGrid:function(_447,type,_448,size){var _449=type=="h"?[_448,0]:[0,_448];var _44a=type=="h"?[1/size,1]:[1,1/size];dojox.gfx.fx.animateTransform(dojo.delegate({shape:_447,duration:1200,transform:[{name:"translate",start:_449,end:[0,0]},{name:"scale",start:_44a,end:[1,1]},{name:"original"}]},this.animate)).play();}});})();}if(!dojo._hasResource["dojox.charting.plot2d.Pie"]){dojo._hasResource["dojox.charting.plot2d.Pie"]=true;dojo.provide("dojox.charting.plot2d.Pie");(function(){var df=dojox.lang.functional,du=dojox.lang.utils,dc=dojox.charting.plot2d.common,da=dojox.charting.axis2d.common,g=dojox.gfx,m=g.matrix,_44b=0.2;dojo.declare("dojox.charting.plot2d.Pie",[dojox.charting.Element,dojox.charting.plot2d._PlotEvents],{defaultParams:{labels:true,ticks:false,fixed:true,precision:1,labelOffset:20,labelStyle:"default",htmlLabels:true,radGrad:"native",fanSize:5,startAngle:0},optionalParams:{radius:0,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:"",labelWiring:{}},constructor:function(_44c,_44d){this.opt=dojo.clone(this.defaultParams);du.updateWithObject(this.opt,_44d);du.updateWithPattern(this.opt,_44d,this.optionalParams);this.run=null;this.dyn=[];},clear:function(){this.dirty=true;this.dyn=[];this.run=null;return this;},setAxis:function(axis){return this;},addSeries:function(run){this.run=run;return this;},getSeriesStats:function(){return dojo.delegate(dc.defaultStats);},initializeScalers:function(){return this;},getRequiredColors:function(){return this.run?this.run.data.length:0;},render:function(dim,_44e){if(!this.dirty){return this;}this.resetEvents();this.dirty=false;this._eventSeries={};this.cleanGroup();var s=this.group,t=this.chart.theme;if(!this.run||!this.run.data.length){return this;}var rx=(dim.width-_44e.l-_44e.r)/2,ry=(dim.height-_44e.t-_44e.b)/2,r=Math.min(rx,ry),_44f="font" in this.opt?this.opt.font:t.axis.font,size=_44f?g.normalizedLength(g.splitFontString(_44f).size):0,_450="fontColor" in this.opt?this.opt.fontColor:t.axis.fontColor,_451=m._degToRad(this.opt.startAngle),_452=_451,step,_453,_454,_455,_456,_457,run=this.run.data,_458=this.events();if(typeof run[0]=="number"){_453=df.map(run,"x ? Math.max(x, 0) : 0");if(df.every(_453,"<= 0")){return this;}_454=df.map(_453,"/this",df.foldl(_453,"+",0));if(this.opt.labels){_455=dojo.map(_454,function(x){return x>0?this._getLabel(x*100)+"%":"";},this);}}else{_453=df.map(run,"x ? Math.max(x.y, 0) : 0");if(df.every(_453,"<= 0")){return this;}_454=df.map(_453,"/this",df.foldl(_453,"+",0));if(this.opt.labels){_455=dojo.map(_454,function(x,i){if(x<=0){return "";}var v=run[i];return "text" in v?v.text:this._getLabel(x*100)+"%";},this);}}var _459=df.map(run,function(v,i){if(v===null||typeof v=="number"){return t.next("slice",[this.opt,this.run],true);}return t.next("slice",[this.opt,this.run,v],true);},this);if(this.opt.labels){_456=df.foldl1(df.map(_455,function(_45a,i){var font=_459[i].series.font;return dojox.gfx._base._getTextBox(_45a,{font:font}).w;},this),"Math.max(a, b)")/2;if(this.opt.labelOffset<0){r=Math.min(rx-2*_456,ry-size)+this.opt.labelOffset;}_457=r-this.opt.labelOffset;}if("radius" in this.opt){r=this.opt.radius;_457=r-this.opt.labelOffset;}var _45b={cx:_44e.l+rx,cy:_44e.t+ry,r:r};this.dyn=[];var _45c=new Array(_454.length);dojo.some(_454,function(_45d,i){if(_45d<0){return false;}if(_45d==0){this.dyn.push({fill:null,stroke:null});return false;}var v=run[i],_45e=_459[i],_45f;if(_45d>=1){_45f=this._plotFill(_45e.series.fill,dim,_44e);_45f=this._shapeFill(_45f,{x:_45b.cx-_45b.r,y:_45b.cy-_45b.r,width:2*_45b.r,height:2*_45b.r});_45f=this._pseudoRadialFill(_45f,{x:_45b.cx,y:_45b.cy},_45b.r);var _460=s.createCircle(_45b).setFill(_45f).setStroke(_45e.series.stroke);this.dyn.push({fill:_45f,stroke:_45e.series.stroke});if(_458){var o={element:"slice",index:i,run:this.run,shape:_460,x:i,y:typeof v=="number"?v:v.y,cx:_45b.cx,cy:_45b.cy,cr:r};this._connectEvents(o);_45c[i]=o;}return true;}var end=_452+_45d*2*Math.PI;if(i+1==_454.length){end=_451+2*Math.PI;}var step=end-_452,x1=_45b.cx+r*Math.cos(_452),y1=_45b.cy+r*Math.sin(_452),x2=_45b.cx+r*Math.cos(end),y2=_45b.cy+r*Math.sin(end);var _461=m._degToRad(this.opt.fanSize);if(_45e.series.fill&&_45e.series.fill.type==="radial"&&this.opt.radGrad==="fan"&&step>_461){var _462=s.createGroup(),_463=Math.ceil(step/_461),_464=step/_463;_45f=this._shapeFill(_45e.series.fill,{x:_45b.cx-_45b.r,y:_45b.cy-_45b.r,width:2*_45b.r,height:2*_45b.r});for(var j=0;j<_463;++j){var _465=j==0?x1:_45b.cx+r*Math.cos(_452+(j-_44b)*_464),_466=j==0?y1:_45b.cy+r*Math.sin(_452+(j-_44b)*_464),_467=j==_463-1?x2:_45b.cx+r*Math.cos(_452+(j+1+_44b)*_464),_468=j==_463-1?y2:_45b.cy+r*Math.sin(_452+(j+1+_44b)*_464),fan=_462.createPath({}).moveTo(_45b.cx,_45b.cy).lineTo(_465,_466).arcTo(r,r,0,_464>Math.PI,true,_467,_468).lineTo(_45b.cx,_45b.cy).closePath().setFill(this._pseudoRadialFill(_45f,{x:_45b.cx,y:_45b.cy},r,_452+(j+0.5)*_464,_452+(j+0.5)*_464));}_462.createPath({}).moveTo(_45b.cx,_45b.cy).lineTo(x1,y1).arcTo(r,r,0,step>Math.PI,true,x2,y2).lineTo(_45b.cx,_45b.cy).closePath().setStroke(_45e.series.stroke);_460=_462;}else{_460=s.createPath({}).moveTo(_45b.cx,_45b.cy).lineTo(x1,y1).arcTo(r,r,0,step>Math.PI,true,x2,y2).lineTo(_45b.cx,_45b.cy).closePath().setStroke(_45e.series.stroke);var _45f=_45e.series.fill;if(_45f&&_45f.type==="radial"){_45f=this._shapeFill(_45f,{x:_45b.cx-_45b.r,y:_45b.cy-_45b.r,width:2*_45b.r,height:2*_45b.r});if(this.opt.radGrad==="linear"){_45f=this._pseudoRadialFill(_45f,{x:_45b.cx,y:_45b.cy},r,_452,end);}}else{if(_45f&&_45f.type==="linear"){_45f=this._plotFill(_45f,dim,_44e);_45f=this._shapeFill(_45f,_460.getBoundingBox());}}_460.setFill(_45f);}this.dyn.push({fill:_45f,stroke:_45e.series.stroke});if(_458){var o={element:"slice",index:i,run:this.run,shape:_460,x:i,y:typeof v=="number"?v:v.y,cx:_45b.cx,cy:_45b.cy,cr:r};this._connectEvents(o);_45c[i]=o;}_452=end;return false;},this);if(this.opt.labels){if(this.opt.labelStyle=="default"){_452=_451;dojo.some(_454,function(_469,i){if(_469<=0){return false;}var _46a=_459[i];if(_469>=1){var v=run[i],elem=da.createText[this.opt.htmlLabels&&dojox.gfx.renderer!="vml"?"html":"gfx"](this.chart,s,_45b.cx,_45b.cy+size/2,"middle",_455[i],_46a.series.font,_46a.series.fontColor);if(this.opt.htmlLabels){this.htmlElements.push(elem);}return true;}var end=_452+_469*2*Math.PI,v=run[i];if(i+1==_454.length){end=_451+2*Math.PI;}var _46b=(_452+end)/2,x=_45b.cx+_457*Math.cos(_46b),y=_45b.cy+_457*Math.sin(_46b)+size/2;var elem=da.createText[this.opt.htmlLabels&&dojox.gfx.renderer!="vml"?"html":"gfx"](this.chart,s,x,y,"middle",_455[i],_46a.series.font,_46a.series.fontColor);if(this.opt.htmlLabels){this.htmlElements.push(elem);}_452=end;return false;},this);}else{if(this.opt.labelStyle=="columns"){_452=_451;var _46c=[];dojo.forEach(_454,function(_46d,i){var end=_452+_46d*2*Math.PI;if(i+1==_454.length){end=_451+2*Math.PI;}var _46e=(_452+end)/2;_46c.push({angle:_46e,left:Math.cos(_46e)<0,theme:_459[i],index:i,omit:end-_452<0.001});_452=end;});var _46f=dojox.gfx._base._getTextBox("a",{font:_44f}).h;this._getProperLabelRadius(_46c,_46f,_45b.r*1.1);dojo.forEach(_46c,function(_470,i){if(!_470.omit){var _471=_45b.cx-_45b.r*2,_472=_45b.cx+_45b.r*2,_473=dojox.gfx._base._getTextBox(_455[i],{font:_44f}).w,x=_45b.cx+_470.labelR*Math.cos(_470.angle),y=_45b.cy+_470.labelR*Math.sin(_470.angle),_474=(_470.left)?(_471+_473):(_472-_473),_475=(_470.left)?_471:_474;var _476=s.createPath().moveTo(_45b.cx+_45b.r*Math.cos(_470.angle),_45b.cy+_45b.r*Math.sin(_470.angle));if(Math.abs(_470.labelR*Math.cos(_470.angle))<_45b.r*2-_473){_476.lineTo(x,y);}_476.lineTo(_474,y).setStroke(_470.theme.series.labelWiring);var elem=da.createText[this.opt.htmlLabels&&dojox.gfx.renderer!="vml"?"html":"gfx"](this.chart,s,_475,y,"left",_455[i],_470.theme.series.font,_470.theme.series.fontColor);if(this.opt.htmlLabels){this.htmlElements.push(elem);}}},this);}}}var esi=0;this._eventSeries[this.run.name]=df.map(run,function(v){return v<=0?null:_45c[esi++];});return this;},_getProperLabelRadius:function(_477,_478,_479){var _47a={},_47b={},_47c=1,_47d=1;if(_477.length==1){_477[0].labelR=_479;return;}for(var i=0;i<_477.length;i++){var _47e=Math.abs(Math.sin(_477[i].angle));if(_477[i].left){if(_47c>_47e){_47c=_47e;_47a=_477[i];}}else{if(_47d>_47e){_47d=_47e;_47b=_477[i];}}}_47a.labelR=_47b.labelR=_479;this._caculateLabelR(_47a,_477,_478);this._caculateLabelR(_47b,_477,_478);},_caculateLabelR:function(_47f,_480,_481){var i=_47f.index,_482=_480.length,_483=_47f.labelR;while(!(_480[i%_482].left^_480[(i+1)%_482].left)){if(!_480[(i+1)%_482].omit){var _484=(Math.sin(_480[i%_482].angle)*_483+((_480[i%_482].left)?(-_481):_481))/Math.sin(_480[(i+1)%_482].angle);_483=(_484<_47f.labelR)?_47f.labelR:_484;_480[(i+1)%_482].labelR=_483;}i++;}i=_47f.index,j=(i==0)?_482-1:i-1;while(!(_480[i].left^_480[j].left)){if(!_480[j].omit){var _484=(Math.sin(_480[i].angle)*_483+((_480[i].left)?_481:(-_481)))/Math.sin(_480[j].angle);_483=(_484<_47f.labelR)?_47f.labelR:_484;_480[j].labelR=_483;}i--;j--;i=(i<0)?i+_480.length:i;j=(j<0)?j+_480.length:j;}},_getLabel:function(_485){return dc.getLabel(_485,this.opt.fixed,this.opt.precision);}});})();}if(!dojo._hasResource["dojox.charting.plot2d.Bubble"]){dojo._hasResource["dojox.charting.plot2d.Bubble"]=true;dojo.provide("dojox.charting.plot2d.Bubble");(function(){var df=dojox.lang.functional,du=dojox.lang.utils,dc=dojox.charting.plot2d.common,_486=df.lambda("item.purgeGroup()");dojo.declare("dojox.charting.plot2d.Bubble",dojox.charting.plot2d.Base,{defaultParams:{hAxis:"x",vAxis:"y",animate:null},optionalParams:{stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(_487,_488){this.opt=dojo.clone(this.defaultParams);du.updateWithObject(this.opt,_488);du.updateWithPattern(this.opt,_488,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},render:function(dim,_489){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_489);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){dojo.forEach(this.series,_486);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_48a=this.events();for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();if(!run.data.length){run.dirty=false;t.skip();continue;}if(typeof run.data[0]=="number"){console.warn("dojox.charting.plot2d.Bubble: the data in the following series cannot be rendered as a bubble chart; ",run);continue;}var _48b=t.next("circle",[this.opt,run]),s=run.group,_48c=dojo.map(run.data,function(v,i){return v?{x:ht(v.x)+_489.l,y:dim.height-_489.b-vt(v.y),radius:this._vScaler.bounds.scale*(v.size/2)}:null;},this);var _48d=null,_48e=null,_48f=null;if(_48b.series.shadow){_48f=dojo.map(_48c,function(item){if(item!==null){var _490=t.addMixin(_48b,"circle",item,true),_491=_490.series.shadow;var _492=s.createCircle({cx:item.x+_491.dx,cy:item.y+_491.dy,r:item.radius}).setStroke(_491).setFill(_491.color);if(this.animate){this._animateBubble(_492,dim.height-_489.b,item.radius);}return _492;}return null;},this);if(_48f.length){run.dyn.shadow=_48f[_48f.length-1].getStroke();}}if(_48b.series.outline){_48e=dojo.map(_48c,function(item){if(item!==null){var _493=t.addMixin(_48b,"circle",item,true),_494=dc.makeStroke(_493.series.outline);_494.width=2*_494.width+_48b.series.stroke.width;var _495=s.createCircle({cx:item.x,cy:item.y,r:item.radius}).setStroke(_494);if(this.animate){this._animateBubble(_495,dim.height-_489.b,item.radius);}return _495;}return null;},this);if(_48e.length){run.dyn.outline=_48e[_48e.length-1].getStroke();}}_48d=dojo.map(_48c,function(item){if(item!==null){var _496=t.addMixin(_48b,"circle",item,true),rect={x:item.x-item.radius,y:item.y-item.radius,width:2*item.radius,height:2*item.radius};var _497=this._plotFill(_496.series.fill,dim,_489);_497=this._shapeFill(_497,rect);var _498=s.createCircle({cx:item.x,cy:item.y,r:item.radius}).setFill(_497).setStroke(_496.series.stroke);if(this.animate){this._animateBubble(_498,dim.height-_489.b,item.radius);}return _498;}return null;},this);if(_48d.length){run.dyn.fill=_48d[_48d.length-1].getFill();run.dyn.stroke=_48d[_48d.length-1].getStroke();}if(_48a){var _499=new Array(_48d.length);dojo.forEach(_48d,function(s,i){if(s!==null){var o={element:"circle",index:i,run:run,shape:s,outline:_48e&&_48e[i]||null,shadow:_48f&&_48f[i]||null,x:run.data[i].x,y:run.data[i].y,r:run.data[i].size/2,cx:_48c[i].x,cy:_48c[i].y,cr:_48c[i].radius};this._connectEvents(o);_499[i]=o;}},this);this._eventSeries[run.name]=_499;}else{delete this._eventSeries[run.name];}run.dirty=false;}this.dirty=false;return this;},_animateBubble:function(_49a,_49b,size){dojox.gfx.fx.animateTransform(dojo.delegate({shape:_49a,duration:1200,transform:[{name:"translate",start:[0,_49b],end:[0,0]},{name:"scale",start:[0,1/size],end:[1,1]},{name:"original"}]},this.animate)).play();}});})();}if(!dojo._hasResource["dojox.charting.plot2d.Candlesticks"]){dojo._hasResource["dojox.charting.plot2d.Candlesticks"]=true;dojo.provide("dojox.charting.plot2d.Candlesticks");(function(){var df=dojox.lang.functional,du=dojox.lang.utils,dc=dojox.charting.plot2d.common,_49c=df.lambda("item.purgeGroup()");dojo.declare("dojox.charting.plot2d.Candlesticks",dojox.charting.plot2d.Base,{defaultParams:{hAxis:"x",vAxis:"y",gap:2,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(_49d,_49e){this.opt=dojo.clone(this.defaultParams);du.updateWithObject(this.opt,_49e);du.updateWithPattern(this.opt,_49e,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},collectStats:function(_49f){var _4a0=dojo.delegate(dc.defaultStats);for(var i=0;i<_49f.length;i++){var run=_49f[i];if(!run.data.length){continue;}var _4a1=_4a0.vmin,_4a2=_4a0.vmax;if(!("ymin" in run)||!("ymax" in run)){dojo.forEach(run.data,function(val,idx){if(val!==null){var x=val.x||idx+1;_4a0.hmin=Math.min(_4a0.hmin,x);_4a0.hmax=Math.max(_4a0.hmax,x);_4a0.vmin=Math.min(_4a0.vmin,val.open,val.close,val.high,val.low);_4a0.vmax=Math.max(_4a0.vmax,val.open,val.close,val.high,val.low);}});}if("ymin" in run){_4a0.vmin=Math.min(_4a1,run.ymin);}if("ymax" in run){_4a0.vmax=Math.max(_4a2,run.ymax);}}return _4a0;},getSeriesStats:function(){var _4a3=this.collectStats(this.series);_4a3.hmin-=0.5;_4a3.hmax+=0.5;return _4a3;},render:function(dim,_4a4){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_4a4);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){dojo.forEach(this.series,_49c);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_4a5,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_4a6=Math.max(0,this._vScaler.bounds.lower),_4a7=vt(_4a6),_4a8=this.events();f=dc.calculateBarSize(this._hScaler.bounds.scale,this.opt);gap=f.gap;_4a5=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _4a9=t.next("candlestick",[this.opt,run]),s=run.group,_4aa=new Array(run.data.length);for(var j=0;j<run.data.length;++j){var v=run.data[j];if(v!==null){var _4ab=t.addMixin(_4a9,"candlestick",v,true);var x=ht(v.x||(j+0.5))+_4a4.l+gap,y=dim.height-_4a4.b,open=vt(v.open),_4ac=vt(v.close),high=vt(v.high),low=vt(v.low);if("mid" in v){var mid=vt(v.mid);}if(low>high){var tmp=high;high=low;low=tmp;}if(_4a5>=1){var _4ad=open>_4ac;var line={x1:_4a5/2,x2:_4a5/2,y1:y-high,y2:y-low},rect={x:0,y:y-Math.max(open,_4ac),width:_4a5,height:Math.max(_4ad?open-_4ac:_4ac-open,1)};shape=s.createGroup();shape.setTransform({dx:x,dy:0});var _4ae=shape.createGroup();_4ae.createLine(line).setStroke(_4ab.series.stroke);_4ae.createRect(rect).setStroke(_4ab.series.stroke).setFill(_4ad?_4ab.series.fill:"white");if("mid" in v){_4ae.createLine({x1:(_4ab.series.stroke.width||1),x2:_4a5-(_4ab.series.stroke.width||1),y1:y-mid,y2:y-mid}).setStroke(_4ad?"white":_4ab.series.stroke);}run.dyn.fill=_4ab.series.fill;run.dyn.stroke=_4ab.series.stroke;if(_4a8){var o={element:"candlestick",index:j,run:run,shape:_4ae,x:x,y:y-Math.max(open,_4ac),cx:_4a5/2,cy:(y-Math.max(open,_4ac))+(Math.max(_4ad?open-_4ac:_4ac-open,1)/2),width:_4a5,height:Math.max(_4ad?open-_4ac:_4ac-open,1),data:v};this._connectEvents(o);_4aa[j]=o;}}if(this.animate){this._animateCandlesticks(shape,y-low,high-low);}}}this._eventSeries[run.name]=_4aa;run.dirty=false;}this.dirty=false;return this;},_animateCandlesticks:function(_4af,_4b0,_4b1){dojox.gfx.fx.animateTransform(dojo.delegate({shape:_4af,duration:1200,transform:[{name:"translate",start:[0,_4b0-(_4b0/_4b1)],end:[0,0]},{name:"scale",start:[1,1/_4b1],end:[1,1]},{name:"original"}]},this.animate)).play();}});})();}if(!dojo._hasResource["dojox.charting.plot2d.OHLC"]){dojo._hasResource["dojox.charting.plot2d.OHLC"]=true;dojo.provide("dojox.charting.plot2d.OHLC");(function(){var df=dojox.lang.functional,du=dojox.lang.utils,dc=dojox.charting.plot2d.common,_4b2=df.lambda("item.purgeGroup()");dojo.declare("dojox.charting.plot2d.OHLC",dojox.charting.plot2d.Base,{defaultParams:{hAxis:"x",vAxis:"y",gap:2,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(_4b3,_4b4){this.opt=dojo.clone(this.defaultParams);du.updateWithObject(this.opt,_4b4);du.updateWithPattern(this.opt,_4b4,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},collectStats:function(_4b5){var _4b6=dojo.delegate(dc.defaultStats);for(var i=0;i<_4b5.length;i++){var run=_4b5[i];if(!run.data.length){continue;}var _4b7=_4b6.vmin,_4b8=_4b6.vmax;if(!("ymin" in run)||!("ymax" in run)){dojo.forEach(run.data,function(val,idx){if(val!==null){var x=val.x||idx+1;_4b6.hmin=Math.min(_4b6.hmin,x);_4b6.hmax=Math.max(_4b6.hmax,x);_4b6.vmin=Math.min(_4b6.vmin,val.open,val.close,val.high,val.low);_4b6.vmax=Math.max(_4b6.vmax,val.open,val.close,val.high,val.low);}});}if("ymin" in run){_4b6.vmin=Math.min(_4b7,run.ymin);}if("ymax" in run){_4b6.vmax=Math.max(_4b8,run.ymax);}}return _4b6;},getSeriesStats:function(){var _4b9=this.collectStats(this.series);_4b9.hmin-=0.5;_4b9.hmax+=0.5;return _4b9;},render:function(dim,_4ba){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_4ba);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){dojo.forEach(this.series,_4b2);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_4bb,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_4bc=Math.max(0,this._vScaler.bounds.lower),_4bd=vt(_4bc),_4be=this.events();f=dc.calculateBarSize(this._hScaler.bounds.scale,this.opt);gap=f.gap;_4bb=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _4bf=t.next("candlestick",[this.opt,run]),s=run.group,_4c0=new Array(run.data.length);for(var j=0;j<run.data.length;++j){var v=run.data[j];if(v!==null){var _4c1=t.addMixin(_4bf,"candlestick",v,true);var x=ht(v.x||(j+0.5))+_4ba.l+gap,y=dim.height-_4ba.b,open=vt(v.open),_4c2=vt(v.close),high=vt(v.high),low=vt(v.low);if(low>high){var tmp=high;high=low;low=tmp;}if(_4bb>=1){var hl={x1:_4bb/2,x2:_4bb/2,y1:y-high,y2:y-low},op={x1:0,x2:((_4bb/2)+((_4c1.series.stroke.width||1)/2)),y1:y-open,y2:y-open},cl={x1:((_4bb/2)-((_4c1.series.stroke.width||1)/2)),x2:_4bb,y1:y-_4c2,y2:y-_4c2};shape=s.createGroup();shape.setTransform({dx:x,dy:0});var _4c3=shape.createGroup();_4c3.createLine(hl).setStroke(_4c1.series.stroke);_4c3.createLine(op).setStroke(_4c1.series.stroke);_4c3.createLine(cl).setStroke(_4c1.series.stroke);run.dyn.stroke=_4c1.series.stroke;if(_4be){var o={element:"candlestick",index:j,run:run,shape:_4c3,x:x,y:y-Math.max(open,_4c2),cx:_4bb/2,cy:(y-Math.max(open,_4c2))+(Math.max(open>_4c2?open-_4c2:_4c2-open,1)/2),width:_4bb,height:Math.max(open>_4c2?open-_4c2:_4c2-open,1),data:v};this._connectEvents(o);_4c0[j]=o;}}if(this.animate){this._animateOHLC(shape,y-low,high-low);}}}this._eventSeries[run.name]=_4c0;run.dirty=false;}this.dirty=false;return this;},_animateOHLC:function(_4c4,_4c5,_4c6){dojox.gfx.fx.animateTransform(dojo.delegate({shape:_4c4,duration:1200,transform:[{name:"translate",start:[0,_4c5-(_4c5/_4c6)],end:[0,0]},{name:"scale",start:[1,1/_4c6],end:[1,1]},{name:"original"}]},this.animate)).play();}});})();}if(!dojo._hasResource["dojo.fx.easing"]){dojo._hasResource["dojo.fx.easing"]=true;dojo.provide("dojo.fx.easing");dojo.getObject("fx.easing",true,dojo);dojo.fx.easing={linear:function(n){return n;},quadIn:function(n){return Math.pow(n,2);},quadOut:function(n){return n*(n-2)*-1;},quadInOut:function(n){n=n*2;if(n<1){return Math.pow(n,2)/2;}return -1*((--n)*(n-2)-1)/2;},cubicIn:function(n){return Math.pow(n,3);},cubicOut:function(n){return Math.pow(n-1,3)+1;},cubicInOut:function(n){n=n*2;if(n<1){return Math.pow(n,3)/2;}n-=2;return (Math.pow(n,3)+2)/2;},quartIn:function(n){return Math.pow(n,4);},quartOut:function(n){return -1*(Math.pow(n-1,4)-1);},quartInOut:function(n){n=n*2;if(n<1){return Math.pow(n,4)/2;}n-=2;return -1/2*(Math.pow(n,4)-2);},quintIn:function(n){return Math.pow(n,5);},quintOut:function(n){return Math.pow(n-1,5)+1;},quintInOut:function(n){n=n*2;if(n<1){return Math.pow(n,5)/2;}n-=2;return (Math.pow(n,5)+2)/2;},sineIn:function(n){return -1*Math.cos(n*(Math.PI/2))+1;},sineOut:function(n){return Math.sin(n*(Math.PI/2));},sineInOut:function(n){return -1*(Math.cos(Math.PI*n)-1)/2;},expoIn:function(n){return (n==0)?0:Math.pow(2,10*(n-1));},expoOut:function(n){return (n==1)?1:(-1*Math.pow(2,-10*n)+1);},expoInOut:function(n){if(n==0){return 0;}if(n==1){return 1;}n=n*2;if(n<1){return Math.pow(2,10*(n-1))/2;}--n;return (-1*Math.pow(2,-10*n)+2)/2;},circIn:function(n){return -1*(Math.sqrt(1-Math.pow(n,2))-1);},circOut:function(n){n=n-1;return Math.sqrt(1-Math.pow(n,2));},circInOut:function(n){n=n*2;if(n<1){return -1/2*(Math.sqrt(1-Math.pow(n,2))-1);}n-=2;return 1/2*(Math.sqrt(1-Math.pow(n,2))+1);},backIn:function(n){var s=1.70158;return Math.pow(n,2)*((s+1)*n-s);},backOut:function(n){n=n-1;var s=1.70158;return Math.pow(n,2)*((s+1)*n+s)+1;},backInOut:function(n){var s=1.70158*1.525;n=n*2;if(n<1){return (Math.pow(n,2)*((s+1)*n-s))/2;}n-=2;return (Math.pow(n,2)*((s+1)*n+s)+2)/2;},elasticIn:function(n){if(n==0||n==1){return n;}var p=0.3;var s=p/4;n=n-1;return -1*Math.pow(2,10*n)*Math.sin((n-s)*(2*Math.PI)/p);},elasticOut:function(n){if(n==0||n==1){return n;}var p=0.3;var s=p/4;return Math.pow(2,-10*n)*Math.sin((n-s)*(2*Math.PI)/p)+1;},elasticInOut:function(n){if(n==0){return 0;}n=n*2;if(n==2){return 1;}var p=0.3*1.5;var s=p/4;if(n<1){n-=1;return -0.5*(Math.pow(2,10*n)*Math.sin((n-s)*(2*Math.PI)/p));}n-=1;return 0.5*(Math.pow(2,-10*n)*Math.sin((n-s)*(2*Math.PI)/p))+1;},bounceIn:function(n){return (1-dojo.fx.easing.bounceOut(1-n));},bounceOut:function(n){var s=7.5625;var p=2.75;var l;if(n<(1/p)){l=s*Math.pow(n,2);}else{if(n<(2/p)){n-=(1.5/p);l=s*Math.pow(n,2)+0.75;}else{if(n<(2.5/p)){n-=(2.25/p);l=s*Math.pow(n,2)+0.9375;}else{n-=(2.625/p);l=s*Math.pow(n,2)+0.984375;}}}return l;},bounceInOut:function(n){if(n<0.5){return dojo.fx.easing.bounceIn(n*2)/2;}return (dojo.fx.easing.bounceOut(n*2-1)/2)+0.5;}};}if(!dojo._hasResource["dojox.charting.plot2d.Spider"]){dojo._hasResource["dojox.charting.plot2d.Spider"]=true;dojo.provide("dojox.charting.plot2d.Spider");dojo.experimental("dojox.charting.plot2d.Spider");(function(){var df=dojox.lang.functional,du=dojox.lang.utils,dc=dojox.charting.plot2d.common,da=dojox.charting.axis2d.common,g=dojox.gfx,m=g.matrix,_4c7=0.2;dojo.declare("dojox.charting.plot2d.Spider",[dojox.charting.Element,dojox.charting.plot2d._PlotEvents],{defaultParams:{labels:true,ticks:false,fixed:true,precision:1,labelOffset:-10,labelStyle:"default",htmlLabels:true,startAngle:-90,divisions:3,axisColor:"",axisWidth:0,spiderColor:"",spiderWidth:0,seriesWidth:0,seriesFillAlpha:0.2,spiderOrigin:0.16,markerSize:3,spiderType:"polygon",animationType:dojo.fx.easing.backOut,axisTickFont:"",axisTickFontColor:"",axisFont:"",axisFontColor:""},optionalParams:{radius:0,font:"",fontColor:""},constructor:function(_4c8,_4c9){this.opt=dojo.clone(this.defaultParams);du.updateWithObject(this.opt,_4c9);du.updateWithPattern(this.opt,_4c9,this.optionalParams);this.series=[];this.dyn=[];this.datas={};this.labelKey=[];this.oldSeriePoints={};this.animations={};},clear:function(){this.dirty=true;this.dyn=[];this.series=[];this.datas={};this.labelKey=[];this.oldSeriePoints={};this.animations={};return this;},setAxis:function(axis){return this;},addSeries:function(run){var _4ca=false;this.series.push(run);for(var key in run.data){var val=run.data[key],data=this.datas[key];if(data){data.vlist.push(val);data.min=Math.min(data.min,val);data.max=Math.max(data.max,val);}else{this.datas[key]={min:val,max:val,vlist:[val]};}}if(this.labelKey.length<=0){for(var key in run.data){this.labelKey.push(key);}}return this;},getSeriesStats:function(){return dojox.charting.plot2d.common.collectSimpleStats(this.series);},calculateAxes:function(dim){this.initializeScalers(dim,this.getSeriesStats());return this;},getRequiredColors:function(){return this.series.length;},initializeScalers:function(dim,_4cb){if(this._hAxis){if(!this._hAxis.initialized()){this._hAxis.calculate(_4cb.hmin,_4cb.hmax,dim.width);}this._hScaler=this._hAxis.getScaler();}else{this._hScaler=dojox.charting.scaler.primitive.buildScaler(_4cb.hmin,_4cb.hmax,dim.width);}if(this._vAxis){if(!this._vAxis.initialized()){this._vAxis.calculate(_4cb.vmin,_4cb.vmax,dim.height);}this._vScaler=this._vAxis.getScaler();}else{this._vScaler=dojox.charting.scaler.primitive.buildScaler(_4cb.vmin,_4cb.vmax,dim.height);}return this;},render:function(dim,_4cc){if(!this.dirty){return this;}this.dirty=false;this.cleanGroup();var s=this.group,t=this.chart.theme;this.resetEvents();if(!this.series||!this.series.length){return this;}var o=this.opt,ta=t.axis,rx=(dim.width-_4cc.l-_4cc.r)/2,ry=(dim.height-_4cc.t-_4cc.b)/2,r=Math.min(rx,ry),_4cd=o.font||(ta.majorTick&&ta.majorTick.font)||(ta.tick&&ta.tick.font)||"normal normal normal 7pt Tahoma",_4ce=o.axisFont||(ta.tick&&ta.tick.titleFont)||"normal normal normal 11pt Tahoma",_4cf=o.axisTickFontColor||(ta.majorTick&&ta.majorTick.fontColor)||(ta.tick&&ta.tick.fontColor)||"silver",_4d0=o.axisFontColor||(ta.tick&&ta.tick.titleFontColor)||"black",_4d1=o.axisColor||(ta.tick&&ta.tick.axisColor)||"silver",_4d2=o.spiderColor||(ta.tick&&ta.tick.spiderColor)||"silver",_4d3=o.axisWidth||(ta.stroke&&ta.stroke.width)||2,_4d4=o.spiderWidth||(ta.stroke&&ta.stroke.width)||2,_4d5=o.seriesWidth||(ta.stroke&&ta.stroke.width)||2,_4d6=g.normalizedLength(g.splitFontString(_4ce).size),_4d7=m._degToRad(o.startAngle),_4d8=_4d7,step,_4d9,_4da,_4db,_4dc,_4dd,_4de,_4df,_4e0,_4e1,_4e2,ro=o.spiderOrigin,dv=o.divisions>=3?o.divisions:3,ms=o.markerSize,spt=o.spiderType,at=o.animationType,_4e3=o.labelOffset<-10?o.labelOffset:-10,_4e4=0.2;if(o.labels){_4db=dojo.map(this.series,function(s){return s.name;},this);_4dc=df.foldl1(df.map(_4db,function(_4e5,i){var font=t.series.font;return dojox.gfx._base._getTextBox(_4e5,{font:font}).w;},this),"Math.max(a, b)")/2;r=Math.min(rx-2*_4dc,ry-_4d6)+_4e3;_4dd=r-_4e3;}if("radius" in o){r=o.radius;_4dd=r-_4e3;}r/=(1+_4e4);var _4e6={cx:_4cc.l+rx,cy:_4cc.t+ry,r:r};for(var i=this.series.length-1;i>=0;i--){var _4e7=this.series[i];if(!this.dirty&&!_4e7.dirty){t.skip();continue;}_4e7.cleanGroup();var run=_4e7.data;if(run!==null){var len=this._getObjectLength(run);if(!_4de||_4de.length<=0){_4de=[],_4df=[],_4e2=[];this._buildPoints(_4de,len,_4e6,r,_4d8,true);this._buildPoints(_4df,len,_4e6,r*ro,_4d8,true);this._buildPoints(_4e2,len,_4e6,_4dd,_4d8);if(dv>2){_4e0=[],_4e1=[];for(var j=0;j<dv-2;j++){_4e0[j]=[];this._buildPoints(_4e0[j],len,_4e6,r*(ro+(1-ro)*(j+1)/(dv-1)),_4d8,true);_4e1[j]=r*(ro+(1-ro)*(j+1)/(dv-1));}}}}}var _4e8=s.createGroup(),_4e9={color:_4d1,width:_4d3},_4ea={color:_4d2,width:_4d4};for(var j=_4de.length-1;j>=0;--j){var _4eb=_4de[j],st={x:_4eb.x+(_4eb.x-_4e6.cx)*_4e4,y:_4eb.y+(_4eb.y-_4e6.cy)*_4e4},nd={x:_4eb.x+(_4eb.x-_4e6.cx)*_4e4/2,y:_4eb.y+(_4eb.y-_4e6.cy)*_4e4/2};_4e8.createLine({x1:_4e6.cx,y1:_4e6.cy,x2:st.x,y2:st.y}).setStroke(_4e9);this._drawArrow(_4e8,st,nd,_4e9);}var _4ec=s.createGroup();for(var j=_4e2.length-1;j>=0;--j){var _4eb=_4e2[j],_4ed=dojox.gfx._base._getTextBox(this.labelKey[j],{font:_4ce}).w||0,_4ee=this.opt.htmlLabels&&dojox.gfx.renderer!="vml"?"html":"gfx";elem=da.createText[_4ee](this.chart,_4ec,(!dojo._isBodyLtr()&&_4ee=="html")?(_4eb.x+_4ed-dim.width):_4eb.x,_4eb.y,"middle",this.labelKey[j],_4ce,_4d0);if(this.opt.htmlLabels){this.htmlElements.push(elem);}}var _4ef=s.createGroup();if(spt=="polygon"){_4ef.createPolyline(_4de).setStroke(_4ea);_4ef.createPolyline(_4df).setStroke(_4ea);if(_4e0.length>0){for(var j=_4e0.length-1;j>=0;--j){_4ef.createPolyline(_4e0[j]).setStroke(_4ea);}}}else{var _4f0=this._getObjectLength(this.datas);_4ef.createCircle({cx:_4e6.cx,cy:_4e6.cy,r:r}).setStroke(_4ea);_4ef.createCircle({cx:_4e6.cx,cy:_4e6.cy,r:r*ro}).setStroke(_4ea);if(_4e1.length>0){for(var j=_4e1.length-1;j>=0;--j){_4ef.createCircle({cx:_4e6.cx,cy:_4e6.cy,r:_4e1[j]}).setStroke(_4ea);}}}var _4f1=s.createGroup(),len=this._getObjectLength(this.datas),k=0;for(var key in this.datas){var data=this.datas[key],min=data.min,max=data.max,_4f2=max-min,end=_4d8+2*Math.PI*k/len;for(var i=0;i<dv;i++){var text=min+_4f2*i/(dv-1),_4eb=this._getCoordinate(_4e6,r*(ro+(1-ro)*i/(dv-1)),end);text=this._getLabel(text);var _4ed=dojox.gfx._base._getTextBox(text,{font:_4cd}).w||0,_4ee=this.opt.htmlLabels&&dojox.gfx.renderer!="vml"?"html":"gfx";if(this.opt.htmlLabels){this.htmlElements.push(da.createText[_4ee](this.chart,_4f1,(!dojo._isBodyLtr()&&_4ee=="html")?(_4eb.x+_4ed-dim.width):_4eb.x,_4eb.y,"start",text,_4cd,_4cf));}}k++;}this.chart.seriesShapes={};var _4f3=[];for(var i=this.series.length-1;i>=0;i--){var _4e7=this.series[i],run=_4e7.data;if(run!==null){var _4f4=[],k=0,_4f5=[];for(var key in run){var data=this.datas[key],min=data.min,max=data.max,_4f2=max-min,_4f6=run[key],end=_4d8+2*Math.PI*k/len,_4eb=this._getCoordinate(_4e6,r*(ro+(1-ro)*(_4f6-min)/_4f2),end);_4f4.push(_4eb);_4f5.push({sname:_4e7.name,key:key,data:_4f6});k++;}_4f4[_4f4.length]=_4f4[0];_4f5[_4f5.length]=_4f5[0];var _4f7=this._getBoundary(_4f4),_4f8=t.next("spider",[o,_4e7]),ts=_4e7.group,f=g.normalizeColor(_4f8.series.fill),sk={color:_4f8.series.fill,width:_4d5};f.a=o.seriesFillAlpha;_4e7.dyn={fill:f,stroke:sk};var osps=this.oldSeriePoints[_4e7.name];var cs=this._createSeriesEntry(ts,(osps||_4df),_4f4,f,sk,r,ro,ms,at);this.chart.seriesShapes[_4e7.name]=cs;this.oldSeriePoints[_4e7.name]=_4f4;var po={element:"spider_poly",index:i,id:"spider_poly_"+_4e7.name,run:_4e7,plot:this,shape:cs.poly,parent:ts,brect:_4f7,cx:_4e6.cx,cy:_4e6.cy,cr:r,f:f,s:s};this._connectEvents(po);var so={element:"spider_plot",index:i,id:"spider_plot_"+_4e7.name,run:_4e7,plot:this,shape:_4e7.group};this._connectEvents(so);dojo.forEach(cs.circles,function(c,i){var _4f9=c.getShape(),co={element:"spider_circle",index:i,id:"spider_circle_"+_4e7.name+i,run:_4e7,plot:this,shape:c,parent:ts,tdata:_4f5[i],cx:_4f4[i].x,cy:_4f4[i].y,f:f,s:s};this._connectEvents(co);},this);}}return this;},_createSeriesEntry:function(ts,osps,sps,f,sk,r,ro,ms,at){var _4fa=ts.createPolyline(osps).setFill(f).setStroke(sk),_4fb=[];for(var j=0;j<osps.length;j++){var _4fc=osps[j],cr=ms;var _4fd=ts.createCircle({cx:_4fc.x,cy:_4fc.y,r:cr}).setFill(f).setStroke(sk);_4fb.push(_4fd);}var _4fe=dojo.map(sps,function(np,j){var sp=osps[j],anim=new dojo._Animation({duration:1000,easing:at,curve:[sp.y,np.y]});var spl=_4fa,sc=_4fb[j];dojo.connect(anim,"onAnimate",function(y){var _4ff=spl.getShape();_4ff.points[j].y=y;spl.setShape(_4ff);var _500=sc.getShape();_500.cy=y;sc.setShape(_500);});return anim;});var _501=dojo.map(sps,function(np,j){var sp=osps[j],anim=new dojo._Animation({duration:1000,easing:at,curve:[sp.x,np.x]});var spl=_4fa,sc=_4fb[j];dojo.connect(anim,"onAnimate",function(x){var _502=spl.getShape();_502.points[j].x=x;spl.setShape(_502);var _503=sc.getShape();_503.cx=x;sc.setShape(_503);});return anim;});var _504=dojo.fx.combine(_4fe.concat(_501));_504.play();return {group:ts,poly:_4fa,circles:_4fb};},plotEvent:function(o){var _505=o.id?o.id:"default",a;if(_505 in this.animations){a=this.animations[_505];a.anim&&a.anim.stop(true);}else{a=this.animations[_505]={};}if(o.element=="spider_poly"){if(!a.color){var _506=o.shape.getFill();if(!_506||!(_506 instanceof dojo.Color)){return;}a.color={start:_506,end:_507(_506)};}var _508=a.color.start,end=a.color.end;if(o.type=="onmouseout"){var t=_508;_508=end;end=t;}a.anim=dojox.gfx.fx.animateFill({shape:o.shape,duration:800,easing:dojo.fx.easing.backOut,color:{start:_508,end:end}});a.anim.play();}else{if(o.element=="spider_circle"){var init,_509,_50a=1.5;if(o.type=="onmouseover"){init=dojox.gfx.matrix.identity;_509=_50a;var _50b={type:"rect"};_50b.x=o.cx;_50b.y=o.cy;_50b.width=_50b.height=1;var lt=dojo.coords(this.chart.node,true);_50b.x+=lt.x;_50b.y+=lt.y;_50b.x=Math.round(_50b.x);_50b.y=Math.round(_50b.y);_50b.width=Math.ceil(_50b.width);_50b.height=Math.ceil(_50b.height);this.aroundRect=_50b;var _50c=["after","before"];if(dijit&&dijit.Tooltip){dijit.showTooltip(o.tdata.sname+"<br/>"+o.tdata.key+"<br/>"+o.tdata.data,this.aroundRect,_50c);}}else{init=dojox.gfx.matrix.scaleAt(_50a,o.cx,o.cy);_509=1/_50a;if(dijit&&dijit.Tooltip){this.aroundRect&&dijit.hideTooltip(this.aroundRect);}}var cs=o.shape.getShape(),init=m.scaleAt(_50a,cs.cx,cs.cy),_50d={shape:o.shape,duration:200,easing:dojo.fx.easing.backOut,transform:[{name:"scaleAt",start:[1,cs.cx,cs.cy],end:[_509,cs.cx,cs.cy]},init]};a.anim=dojox.gfx.fx.animateTransform(_50d);a.anim.play();}else{if(o.element=="spider_plot"){if(o.type=="onmouseover"&&!dojo.isIE){o.shape.moveToFront();}}}}},_getBoundary:function(_50e){var xmax=_50e[0].x,xmin=_50e[0].x,ymax=_50e[0].y,ymin=_50e[0].y;for(var i=0;i<_50e.length;i++){var _50f=_50e[i];xmax=Math.max(_50f.x,xmax);ymax=Math.max(_50f.y,ymax);xmin=Math.min(_50f.x,xmin);ymin=Math.min(_50f.y,ymin);}return {x:xmin,y:ymin,width:xmax-xmin,height:ymax-ymin};},_drawArrow:function(s,_510,end,_511){var len=Math.sqrt(Math.pow(end.x-_510.x,2)+Math.pow(end.y-_510.y,2)),sin=(end.y-_510.y)/len,cos=(end.x-_510.x)/len,_512={x:end.x+(len/3)*(-sin),y:end.y+(len/3)*cos},_513={x:end.x+(len/3)*sin,y:end.y+(len/3)*(-cos)};s.createPolyline([_510,_512,_513]).setFill(_511.color).setStroke(_511);},_buildPoints:function(_514,_515,_516,_517,_518,_519){for(var i=0;i<_515;i++){var end=_518+2*Math.PI*i/_515;_514.push(this._getCoordinate(_516,_517,end));}if(_519){_514.push(this._getCoordinate(_516,_517,_518+2*Math.PI));}},_getCoordinate:function(_51a,_51b,_51c){return {x:_51a.cx+_51b*Math.cos(_51c),y:_51a.cy+_51b*Math.sin(_51c)};},_getObjectLength:function(obj){var _51d=0;if(dojo.isObject(obj)){for(var key in obj){_51d++;}}return _51d;},_getLabel:function(_51e){return dc.getLabel(_51e,this.opt.fixed,this.opt.precision);}});function _507(_51f){var a=new dojox.color.Color(_51f),x=a.toHsl();if(x.s==0){x.l=x.l<50?100:0;}else{x.s=100;if(x.l<50){x.l=75;}else{if(x.l>75){x.l=50;}else{x.l=x.l-50>75-x.l?50:75;}}}var _51f=dojox.color.fromHsl(x);_51f.a=0.7;return _51f;};})();}if(!dojo._hasResource["dojox.lang.functional.fold"]){dojo._hasResource["dojox.lang.functional.fold"]=true;dojo.provide("dojox.lang.functional.fold");(function(){var d=dojo,df=dojox.lang.functional,_520={};d.mixin(df,{foldl:function(a,f,z,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var i,n;if(d.isArray(a)){for(i=0,n=a.length;i<n;z=f.call(o,z,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();z=f.call(o,z,a.next(),i++,a)){}}else{for(i in a){if(!(i in _520)){z=f.call(o,z,a[i],i,a);}}}}return z;},foldl1:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var z,i,n;if(d.isArray(a)){z=a[0];for(i=1,n=a.length;i<n;z=f.call(o,z,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){if(a.hasNext()){z=a.next();for(i=1;a.hasNext();z=f.call(o,z,a.next(),i++,a)){}}}else{var _521=true;for(i in a){if(!(i in _520)){if(_521){z=a[i];_521=false;}else{z=f.call(o,z,a[i],i,a);}}}}}return z;},foldr:function(a,f,z,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);for(var i=a.length;i>0;--i,z=f.call(o,z,a[i],i,a)){}return z;},foldr1:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var n=a.length,z=a[n-1],i=n-1;for(;i>0;--i,z=f.call(o,z,a[i],i,a)){}return z;},reduce:function(a,f,z){return arguments.length<3?df.foldl1(a,f):df.foldl(a,f,z);},reduceRight:function(a,f,z){return arguments.length<3?df.foldr1(a,f):df.foldr(a,f,z);},unfold:function(pr,f,g,z,o){o=o||d.global;f=df.lambda(f);g=df.lambda(g);pr=df.lambda(pr);var t=[];for(;!pr.call(o,z);t.push(f.call(o,z)),z=g.call(o,z)){}return t;}});})();}if(!dojo._hasResource["dojox.color._base"]){dojo._hasResource["dojox.color._base"]=true;dojo.provide("dojox.color._base");dojox.color.Color=dojo.Color;dojox.color.blend=dojo.blendColors;dojox.color.fromRgb=dojo.colorFromRgb;dojox.color.fromHex=dojo.colorFromHex;dojox.color.fromArray=dojo.colorFromArray;dojox.color.fromString=dojo.colorFromString;dojox.color.greyscale=dojo.colors.makeGrey;dojo.mixin(dojox.color,{fromCmy:function(cyan,_522,_523){if(dojo.isArray(cyan)){_522=cyan[1],_523=cyan[2],cyan=cyan[0];}else{if(dojo.isObject(cyan)){_522=cyan.m,_523=cyan.y,cyan=cyan.c;}}cyan/=100,_522/=100,_523/=100;var r=1-cyan,g=1-_522,b=1-_523;return new dojox.color.Color({r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)});},fromCmyk:function(cyan,_524,_525,_526){if(dojo.isArray(cyan)){_524=cyan[1],_525=cyan[2],_526=cyan[3],cyan=cyan[0];}else{if(dojo.isObject(cyan)){_524=cyan.m,_525=cyan.y,_526=cyan.b,cyan=cyan.c;}}cyan/=100,_524/=100,_525/=100,_526/=100;var r,g,b;r=1-Math.min(1,cyan*(1-_526)+_526);g=1-Math.min(1,_524*(1-_526)+_526);b=1-Math.min(1,_525*(1-_526)+_526);return new dojox.color.Color({r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)});},fromHsl:function(hue,_527,_528){if(dojo.isArray(hue)){_527=hue[1],_528=hue[2],hue=hue[0];}else{if(dojo.isObject(hue)){_527=hue.s,_528=hue.l,hue=hue.h;}}_527/=100;_528/=100;while(hue<0){hue+=360;}while(hue>=360){hue-=360;}var r,g,b;if(hue<120){r=(120-hue)/60,g=hue/60,b=0;}else{if(hue<240){r=0,g=(240-hue)/60,b=(hue-120)/60;}else{r=(hue-240)/60,g=0,b=(360-hue)/60;}}r=2*_527*Math.min(r,1)+(1-_527);g=2*_527*Math.min(g,1)+(1-_527);b=2*_527*Math.min(b,1)+(1-_527);if(_528<0.5){r*=_528,g*=_528,b*=_528;}else{r=(1-_528)*r+2*_528-1;g=(1-_528)*g+2*_528-1;b=(1-_528)*b+2*_528-1;}return new dojox.color.Color({r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)});},fromHsv:function(hue,_529,_52a){if(dojo.isArray(hue)){_529=hue[1],_52a=hue[2],hue=hue[0];}else{if(dojo.isObject(hue)){_529=hue.s,_52a=hue.v,hue=hue.h;}}if(hue==360){hue=0;}_529/=100;_52a/=100;var r,g,b;if(_529==0){r=_52a,b=_52a,g=_52a;}else{var _52b=hue/60,i=Math.floor(_52b),f=_52b-i;var p=_52a*(1-_529);var q=_52a*(1-(_529*f));var t=_52a*(1-(_529*(1-f)));switch(i){case 0:r=_52a,g=t,b=p;break;case 1:r=q,g=_52a,b=p;break;case 2:r=p,g=_52a,b=t;break;case 3:r=p,g=q,b=_52a;break;case 4:r=t,g=p,b=_52a;break;case 5:r=_52a,g=p,b=q;break;}}return new dojox.color.Color({r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)});}});dojo.extend(dojox.color.Color,{toCmy:function(){var cyan=1-(this.r/255),_52c=1-(this.g/255),_52d=1-(this.b/255);return {c:Math.round(cyan*100),m:Math.round(_52c*100),y:Math.round(_52d*100)};},toCmyk:function(){var cyan,_52e,_52f,_530;var r=this.r/255,g=this.g/255,b=this.b/255;_530=Math.min(1-r,1-g,1-b);cyan=(1-r-_530)/(1-_530);_52e=(1-g-_530)/(1-_530);_52f=(1-b-_530)/(1-_530);return {c:Math.round(cyan*100),m:Math.round(_52e*100),y:Math.round(_52f*100),b:Math.round(_530*100)};},toHsl:function(){var r=this.r/255,g=this.g/255,b=this.b/255;var min=Math.min(r,b,g),max=Math.max(r,g,b);var _531=max-min;var h=0,s=0,l=(min+max)/2;if(l>0&&l<1){s=_531/((l<0.5)?(2*l):(2-2*l));}if(_531>0){if(max==r&&max!=g){h+=(g-b)/_531;}if(max==g&&max!=b){h+=(2+(b-r)/_531);}if(max==b&&max!=r){h+=(4+(r-g)/_531);}h*=60;}return {h:h,s:Math.round(s*100),l:Math.round(l*100)};},toHsv:function(){var r=this.r/255,g=this.g/255,b=this.b/255;var min=Math.min(r,b,g),max=Math.max(r,g,b);var _532=max-min;var h=null,s=(max==0)?0:(_532/max);if(s==0){h=0;}else{if(r==max){h=60*(g-b)/_532;}else{if(g==max){h=120+60*(b-r)/_532;}else{h=240+60*(r-g)/_532;}}if(h<0){h+=360;}}return {h:h,s:Math.round(s*100),v:Math.round(max*100)};}});}if(!dojo._hasResource["dojox.color"]){dojo._hasResource["dojox.color"]=true;dojo.provide("dojox.color");}if(!dojo._hasResource["dojox.color.Palette"]){dojo._hasResource["dojox.color.Palette"]=true;dojo.provide("dojox.color.Palette");(function(){var dxc=dojox.color;dxc.Palette=function(base){this.colors=[];if(base instanceof dojox.color.Palette){this.colors=base.colors.slice(0);}else{if(base instanceof dojox.color.Color){this.colors=[null,null,base,null,null];}else{if(dojo.isArray(base)){this.colors=dojo.map(base.slice(0),function(item){if(dojo.isString(item)){return new dojox.color.Color(item);}return item;});}else{if(dojo.isString(base)){this.colors=[null,null,new dojox.color.Color(base),null,null];}}}}};function _533(p,_534,val){var ret=new dojox.color.Palette();ret.colors=[];dojo.forEach(p.colors,function(item){var r=(_534=="dr")?item.r+val:item.r,g=(_534=="dg")?item.g+val:item.g,b=(_534=="db")?item.b+val:item.b,a=(_534=="da")?item.a+val:item.a;ret.colors.push(new dojox.color.Color({r:Math.min(255,Math.max(0,r)),g:Math.min(255,Math.max(0,g)),b:Math.min(255,Math.max(0,b)),a:Math.min(1,Math.max(0,a))}));});return ret;};function tCMY(p,_535,val){var ret=new dojox.color.Palette();ret.colors=[];dojo.forEach(p.colors,function(item){var o=item.toCmy(),c=(_535=="dc")?o.c+val:o.c,m=(_535=="dm")?o.m+val:o.m,y=(_535=="dy")?o.y+val:o.y;ret.colors.push(dojox.color.fromCmy(Math.min(100,Math.max(0,c)),Math.min(100,Math.max(0,m)),Math.min(100,Math.max(0,y))));});return ret;};function _536(p,_537,val){var ret=new dojox.color.Palette();ret.colors=[];dojo.forEach(p.colors,function(item){var o=item.toCmyk(),c=(_537=="dc")?o.c+val:o.c,m=(_537=="dm")?o.m+val:o.m,y=(_537=="dy")?o.y+val:o.y,k=(_537=="dk")?o.b+val:o.b;ret.colors.push(dojox.color.fromCmyk(Math.min(100,Math.max(0,c)),Math.min(100,Math.max(0,m)),Math.min(100,Math.max(0,y)),Math.min(100,Math.max(0,k))));});return ret;};function tHSL(p,_538,val){var ret=new dojox.color.Palette();ret.colors=[];dojo.forEach(p.colors,function(item){var o=item.toHsl(),h=(_538=="dh")?o.h+val:o.h,s=(_538=="ds")?o.s+val:o.s,l=(_538=="dl")?o.l+val:o.l;ret.colors.push(dojox.color.fromHsl(h%360,Math.min(100,Math.max(0,s)),Math.min(100,Math.max(0,l))));});return ret;};function tHSV(p,_539,val){var ret=new dojox.color.Palette();ret.colors=[];dojo.forEach(p.colors,function(item){var o=item.toHsv(),h=(_539=="dh")?o.h+val:o.h,s=(_539=="ds")?o.s+val:o.s,v=(_539=="dv")?o.v+val:o.v;ret.colors.push(dojox.color.fromHsv(h%360,Math.min(100,Math.max(0,s)),Math.min(100,Math.max(0,v))));});return ret;};function _53a(val,low,high){return high-((high-val)*((high-low)/high));};dojo.extend(dxc.Palette,{transform:function(_53b){var fn=_533;if(_53b.use){var use=_53b.use.toLowerCase();if(use.indexOf("hs")==0){if(use.charAt(2)=="l"){fn=tHSL;}else{fn=tHSV;}}else{if(use.indexOf("cmy")==0){if(use.charAt(3)=="k"){fn=_536;}else{fn=tCMY;}}}}else{if("dc" in _53b||"dm" in _53b||"dy" in _53b){if("dk" in _53b){fn=_536;}else{fn=tCMY;}}else{if("dh" in _53b||"ds" in _53b){if("dv" in _53b){fn=tHSV;}else{fn=tHSL;}}}}var _53c=this;for(var p in _53b){if(p=="use"){continue;}_53c=fn(_53c,p,_53b[p]);}return _53c;},clone:function(){return new dxc.Palette(this);}});dojo.mixin(dxc.Palette,{generators:{analogous:function(args){var high=args.high||60,low=args.low||18,base=dojo.isString(args.base)?new dojox.color.Color(args.base):args.base,hsv=base.toHsv();var h=[(hsv.h+low+360)%360,(hsv.h+Math.round(low/2)+360)%360,hsv.h,(hsv.h-Math.round(high/2)+360)%360,(hsv.h-high+360)%360];var s1=Math.max(10,(hsv.s<=95)?hsv.s+5:(100-(hsv.s-95))),s2=(hsv.s>1)?hsv.s-1:21-hsv.s,v1=(hsv.v>=92)?hsv.v-9:Math.max(hsv.v+9,20),v2=(hsv.v<=90)?Math.max(hsv.v+5,20):(95+Math.ceil((hsv.v-90)/2)),s=[s1,s2,hsv.s,s1,s1],v=[v1,v2,hsv.v,v1,v2];return new dxc.Palette(dojo.map(h,function(hue,i){return dojox.color.fromHsv(hue,s[i],v[i]);}));},monochromatic:function(args){var base=dojo.isString(args.base)?new dojox.color.Color(args.base):args.base,hsv=base.toHsv();var s1=(hsv.s-30>9)?hsv.s-30:hsv.s+30,s2=hsv.s,v1=_53a(hsv.v,20,100),v2=(hsv.v-20>20)?hsv.v-20:hsv.v+60,v3=(hsv.v-50>20)?hsv.v-50:hsv.v+30;return new dxc.Palette([dojox.color.fromHsv(hsv.h,s1,v1),dojox.color.fromHsv(hsv.h,s2,v3),base,dojox.color.fromHsv(hsv.h,s1,v3),dojox.color.fromHsv(hsv.h,s2,v2)]);},triadic:function(args){var base=dojo.isString(args.base)?new dojox.color.Color(args.base):args.base,hsv=base.toHsv();var h1=(hsv.h+57+360)%360,h2=(hsv.h-157+360)%360,s1=(hsv.s>20)?hsv.s-10:hsv.s+10,s2=(hsv.s>90)?hsv.s-10:hsv.s+10,s3=(hsv.s>95)?hsv.s-5:hsv.s+5,v1=(hsv.v-20>20)?hsv.v-20:hsv.v+20,v2=(hsv.v-30>20)?hsv.v-30:hsv.v+30,v3=(hsv.v-30>70)?hsv.v-30:hsv.v+30;return new dxc.Palette([dojox.color.fromHsv(h1,s1,hsv.v),dojox.color.fromHsv(hsv.h,s2,v2),base,dojox.color.fromHsv(h2,s2,v1),dojox.color.fromHsv(h2,s3,v3)]);},complementary:function(args){var base=dojo.isString(args.base)?new dojox.color.Color(args.base):args.base,hsv=base.toHsv();var h1=((hsv.h*2)+137<360)?(hsv.h*2)+137:Math.floor(hsv.h/2)-137,s1=Math.max(hsv.s-10,0),s2=_53a(hsv.s,10,100),s3=Math.min(100,hsv.s+20),v1=Math.min(100,hsv.v+30),v2=(hsv.v>20)?hsv.v-30:hsv.v+30;return new dxc.Palette([dojox.color.fromHsv(hsv.h,s1,v1),dojox.color.fromHsv(hsv.h,s2,v2),base,dojox.color.fromHsv(h1,s3,v2),dojox.color.fromHsv(h1,hsv.s,hsv.v)]);},splitComplementary:function(args){var base=dojo.isString(args.base)?new dojox.color.Color(args.base):args.base,_53d=args.da||30,hsv=base.toHsv();var _53e=((hsv.h*2)+137<360)?(hsv.h*2)+137:Math.floor(hsv.h/2)-137,h1=(_53e-_53d+360)%360,h2=(_53e+_53d)%360,s1=Math.max(hsv.s-10,0),s2=_53a(hsv.s,10,100),s3=Math.min(100,hsv.s+20),v1=Math.min(100,hsv.v+30),v2=(hsv.v>20)?hsv.v-30:hsv.v+30;return new dxc.Palette([dojox.color.fromHsv(h1,s1,v1),dojox.color.fromHsv(h1,s2,v2),base,dojox.color.fromHsv(h2,s3,v2),dojox.color.fromHsv(h2,hsv.s,hsv.v)]);},compound:function(args){var base=dojo.isString(args.base)?new dojox.color.Color(args.base):args.base,hsv=base.toHsv();var h1=((hsv.h*2)+18<360)?(hsv.h*2)+18:Math.floor(hsv.h/2)-18,h2=((hsv.h*2)+120<360)?(hsv.h*2)+120:Math.floor(hsv.h/2)-120,h3=((hsv.h*2)+99<360)?(hsv.h*2)+99:Math.floor(hsv.h/2)-99,s1=(hsv.s-40>10)?hsv.s-40:hsv.s+40,s2=(hsv.s-10>80)?hsv.s-10:hsv.s+10,s3=(hsv.s-25>10)?hsv.s-25:hsv.s+25,v1=(hsv.v-40>10)?hsv.v-40:hsv.v+40,v2=(hsv.v-20>80)?hsv.v-20:hsv.v+20,v3=Math.max(hsv.v,20);return new dxc.Palette([dojox.color.fromHsv(h1,s1,v1),dojox.color.fromHsv(h1,s2,v2),base,dojox.color.fromHsv(h2,s3,v3),dojox.color.fromHsv(h3,s2,v2)]);},shades:function(args){var base=dojo.isString(args.base)?new dojox.color.Color(args.base):args.base,hsv=base.toHsv();var s=(hsv.s==100&&hsv.v==0)?0:hsv.s,v1=(hsv.v-50>20)?hsv.v-50:hsv.v+30,v2=(hsv.v-25>=20)?hsv.v-25:hsv.v+55,v3=(hsv.v-75>=20)?hsv.v-75:hsv.v+5,v4=Math.max(hsv.v-10,20);return new dxc.Palette([new dojox.color.fromHsv(hsv.h,s,v1),new dojox.color.fromHsv(hsv.h,s,v2),base,new dojox.color.fromHsv(hsv.h,s,v3),new dojox.color.fromHsv(hsv.h,s,v4)]);}},generate:function(base,type){if(dojo.isFunction(type)){return type({base:base});}else{if(dxc.Palette.generators[type]){return dxc.Palette.generators[type]({base:base});}}throw new Error("dojox.color.Palette.generate: the specified generator ('"+type+"') does not exist.");}});})();}if(!dojo._hasResource["dojox.charting.Theme"]){dojo._hasResource["dojox.charting.Theme"]=true;dojo.provide("dojox.charting.Theme");dojo.declare("dojox.charting.Theme",null,{shapeSpaces:{shape:1,shapeX:1,shapeY:1},constructor:function(_53f){_53f=_53f||{};var def=dojox.charting.Theme.defaultTheme;dojo.forEach(["chart","plotarea","axis","series","marker"],function(name){this[name]=dojo.delegate(def[name],_53f[name]);},this);if(_53f.seriesThemes&&_53f.seriesThemes.length){this.colors=null;this.seriesThemes=_53f.seriesThemes.slice(0);}else{this.seriesThemes=null;this.colors=(_53f.colors||dojox.charting.Theme.defaultColors).slice(0);}this.markerThemes=null;if(_53f.markerThemes&&_53f.markerThemes.length){this.markerThemes=_53f.markerThemes.slice(0);}this.markers=_53f.markers?dojo.clone(_53f.markers):dojo.delegate(dojox.charting.Theme.defaultMarkers);this.noGradConv=_53f.noGradConv;this.noRadialConv=_53f.noRadialConv;if(_53f.reverseFills){this.reverseFills();}this._current=0;this._buildMarkerArray();},clone:function(){var _540=new dojox.charting.Theme({chart:this.chart,plotarea:this.plotarea,axis:this.axis,series:this.series,marker:this.marker,colors:this.colors,markers:this.markers,seriesThemes:this.seriesThemes,markerThemes:this.markerThemes,noGradConv:this.noGradConv,noRadialConv:this.noRadialConv});dojo.forEach(["clone","clear","next","skip","addMixin","post","getTick"],function(name){if(this.hasOwnProperty(name)){_540[name]=this[name];}},this);return _540;},clear:function(){this._current=0;},next:function(_541,_542,_543){var _544=dojox.lang.utils.merge,_545,_546;if(this.colors){_545=dojo.delegate(this.series);_546=dojo.delegate(this.marker);var _547=new dojo.Color(this.colors[this._current%this.colors.length]),old;if(_545.stroke&&_545.stroke.color){_545.stroke=dojo.delegate(_545.stroke);old=new dojo.Color(_545.stroke.color);_545.stroke.color=new dojo.Color(_547);_545.stroke.color.a=old.a;}else{_545.stroke={color:_547};}if(_546.stroke&&_546.stroke.color){_546.stroke=dojo.delegate(_546.stroke);old=new dojo.Color(_546.stroke.color);_546.stroke.color=new dojo.Color(_547);_546.stroke.color.a=old.a;}else{_546.stroke={color:_547};}if(!_545.fill||_545.fill.type){_545.fill=_547;}else{old=new dojo.Color(_545.fill);_545.fill=new dojo.Color(_547);_545.fill.a=old.a;}if(!_546.fill||_546.fill.type){_546.fill=_547;}else{old=new dojo.Color(_546.fill);_546.fill=new dojo.Color(_547);_546.fill.a=old.a;}}else{_545=this.seriesThemes?_544(this.series,this.seriesThemes[this._current%this.seriesThemes.length]):this.series;_546=this.markerThemes?_544(this.marker,this.markerThemes[this._current%this.markerThemes.length]):_545;}var _548=_546&&_546.symbol||this._markers[this._current%this._markers.length];var _549={series:_545,marker:_546,symbol:_548};++this._current;if(_542){_549=this.addMixin(_549,_541,_542);}if(_543){_549=this.post(_549,_541);}return _549;},skip:function(){++this._current;},addMixin:function(_54a,_54b,_54c,_54d){if(dojo.isArray(_54c)){dojo.forEach(_54c,function(m){_54a=this.addMixin(_54a,_54b,m);},this);}else{var t={};if("color" in _54c){if(_54b=="line"||_54b=="area"){dojo.setObject("series.stroke.color",_54c.color,t);dojo.setObject("marker.stroke.color",_54c.color,t);}else{dojo.setObject("series.fill",_54c.color,t);}}dojo.forEach(["stroke","outline","shadow","fill","font","fontColor","labelWiring"],function(name){var _54e="marker"+name.charAt(0).toUpperCase()+name.substr(1),b=_54e in _54c;if(name in _54c){dojo.setObject("series."+name,_54c[name],t);if(!b){dojo.setObject("marker."+name,_54c[name],t);}}if(b){dojo.setObject("marker."+name,_54c[_54e],t);}});if("marker" in _54c){t.symbol=_54c.marker;}_54a=dojox.lang.utils.merge(_54a,t);}if(_54d){_54a=this.post(_54a,_54b);}return _54a;},post:function(_54f,_550){var fill=_54f.series.fill,t;if(!this.noGradConv&&this.shapeSpaces[fill.space]&&fill.type=="linear"){if(_550=="bar"){t={x1:fill.y1,y1:fill.x1,x2:fill.y2,y2:fill.x2};}else{if(!this.noRadialConv&&fill.space=="shape"&&(_550=="slice"||_550=="circle")){t={type:"radial",cx:0,cy:0,r:100};}}if(t){return dojox.lang.utils.merge(_54f,{series:{fill:t}});}}return _54f;},getTick:function(name,_551){var tick=this.axis.tick,_552=name+"Tick";merge=dojox.lang.utils.merge;if(tick){if(this.axis[_552]){tick=merge(tick,this.axis[_552]);}}else{tick=this.axis[_552];}if(_551){if(tick){if(_551[_552]){tick=merge(tick,_551[_552]);}}else{tick=_551[_552];}}return tick;},inspectObjects:function(f){dojo.forEach(["chart","plotarea","axis","series","marker"],function(name){f(this[name]);},this);if(this.seriesThemes){dojo.forEach(this.seriesThemes,f);}if(this.markerThemes){dojo.forEach(this.markerThemes,f);}},reverseFills:function(){this.inspectObjects(function(o){if(o&&o.fill){o.fill=dojox.gfx.gradutils.reverse(o.fill);}});},addMarker:function(name,_553){this.markers[name]=_553;this._buildMarkerArray();},setMarkers:function(obj){this.markers=obj;this._buildMarkerArray();},_buildMarkerArray:function(){this._markers=[];for(var p in this.markers){this._markers.push(this.markers[p]);}}});dojo.mixin(dojox.charting.Theme,{defaultMarkers:{CIRCLE:"m-3,0 c0,-4 6,-4 6,0 m-6,0 c0,4 6,4 6,0",SQUARE:"m-3,-3 l0,6 6,0 0,-6 z",DIAMOND:"m0,-3 l3,3 -3,3 -3,-3 z",CROSS:"m0,-3 l0,6 m-3,-3 l6,0",X:"m-3,-3 l6,6 m0,-6 l-6,6",TRIANGLE:"m-3,3 l3,-6 3,6 z",TRIANGLE_INVERTED:"m-3,-3 l3,6 3,-6 z"},defaultColors:["#54544c","#858e94","#6e767a","#948585","#474747"],defaultTheme:{chart:{stroke:null,fill:"white",pageStyle:null,titleGap:20,titlePos:"top",titleFont:"normal normal bold 14pt Tahoma",titleFontColor:"#333"},plotarea:{stroke:null,fill:"white"},axis:{stroke:{color:"#333",width:1},tick:{color:"#666",position:"center",font:"normal normal normal 7pt Tahoma",fontColor:"#333",titleGap:15,titleFont:"normal normal normal 11pt Tahoma",titleFontColor:"#333",titleOrientation:"axis"},majorTick:{width:1,length:6},minorTick:{width:0.8,length:3},microTick:{width:0.5,length:1}},series:{stroke:{width:1.5,color:"#333"},outline:{width:0.1,color:"#ccc"},shadow:null,fill:"#ccc",font:"normal normal normal 8pt Tahoma",fontColor:"#000",labelWiring:{width:1,color:"#ccc"}},marker:{stroke:{width:1.5,color:"#333"},outline:{width:0.1,color:"#ccc"},shadow:null,fill:"#ccc",font:"normal normal normal 8pt Tahoma",fontColor:"#000"}},defineColors:function(_554){_554=_554||{};var c=[],n=_554.num||5;if(_554.colors){var l=_554.colors.length;for(var i=0;i<n;i++){c.push(_554.colors[i%l]);}return c;}if(_554.hue){var s=_554.saturation||100;var st=_554.low||30;var end=_554.high||90;var l=(end+st)/2;return dojox.color.Palette.generate(dojox.color.fromHsv(_554.hue,s,l),"monochromatic").colors;}if(_554.generator){return dojox.color.Palette.generate(_554.base,_554.generator).colors;}return c;},generateGradient:function(_555,_556,_557){var fill=dojo.delegate(_555);fill.colors=[{offset:0,color:_556},{offset:1,color:_557}];return fill;},generateHslColor:function(_558,_559){_558=new dojox.color.Color(_558);var hsl=_558.toHsl(),_55a=dojox.color.fromHsl(hsl.h,hsl.s,_559);_55a.a=_558.a;return _55a;},generateHslGradient:function(_55b,_55c,_55d,_55e){_55b=new dojox.color.Color(_55b);var hsl=_55b.toHsl(),_55f=dojox.color.fromHsl(hsl.h,hsl.s,_55d),_560=dojox.color.fromHsl(hsl.h,hsl.s,_55e);_55f.a=_560.a=_55b.a;return dojox.charting.Theme.generateGradient(_55c,_55f,_560);}});}if(!dojo._hasResource["dojox.charting.Series"]){dojo._hasResource["dojox.charting.Series"]=true;dojo.provide("dojox.charting.Series");dojo.declare("dojox.charting.Series",dojox.charting.Element,{constructor:function(_561,data,_562){dojo.mixin(this,_562);if(typeof this.plot!="string"){this.plot="default";}this.update(data);},clear:function(){this.dyn={};},update:function(data){if(dojo.isArray(data)){this.data=data;}else{this.source=data;this.data=this.source.data;if(this.source.setSeriesObject){this.source.setSeriesObject(this);}}this.dirty=true;this.clear();}});}if(!dojo._hasResource["dojox.charting.Chart"]){dojo._hasResource["dojox.charting.Chart"]=true;dojo.provide("dojox.charting.Chart");(function(){var df=dojox.lang.functional,dc=dojox.charting,g=dojox.gfx,_563=df.lambda("item.clear()"),_564=df.lambda("item.purgeGroup()"),_565=df.lambda("item.destroy()"),_566=df.lambda("item.dirty = false"),_567=df.lambda("item.dirty = true"),_568=df.lambda("item.name");dojo.declare("dojox.charting.Chart",null,{constructor:function(node,_569){if(!_569){_569={};}this.margins=_569.margins?_569.margins:{l:10,t:10,r:10,b:10};this.stroke=_569.stroke;this.fill=_569.fill;this.delayInMs=_569.delayInMs||200;this.title=_569.title;this.titleGap=_569.titleGap;this.titlePos=_569.titlePos;this.titleFont=_569.titleFont;this.titleFontColor=_569.titleFontColor;this.chartTitle=null;this.theme=null;this.axes={};this.stack=[];this.plots={};this.series=[];this.runs={};this.dirty=true;this.coords=null;this.node=dojo.byId(node);var box=dojo.marginBox(node);this.surface=g.createSurface(this.node,box.w||400,box.h||300);},destroy:function(){dojo.forEach(this.series,_565);dojo.forEach(this.stack,_565);df.forIn(this.axes,_565);if(this.chartTitle&&this.chartTitle.tagName){dojo.destroy(this.chartTitle);}this.surface.destroy();},getCoords:function(){if(!this.coords){this.coords=dojo.coords(this.node,true);}return this.coords;},setTheme:function(_56a){this.theme=_56a.clone();this.dirty=true;return this;},addAxis:function(name,_56b){var axis,_56c=_56b&&_56b.type||"Default";if(typeof _56c=="string"){if(!dc.axis2d||!dc.axis2d[_56c]){throw Error("Can't find axis: "+_56c+" - didn't you forget to dojo"+".require() it?");}axis=new dc.axis2d[_56c](this,_56b);}else{axis=new _56c(this,_56b);}axis.name=name;axis.dirty=true;if(name in this.axes){this.axes[name].destroy();}this.axes[name]=axis;this.dirty=true;return this;},getAxis:function(name){return this.axes[name];},removeAxis:function(name){if(name in this.axes){this.axes[name].destroy();delete this.axes[name];this.dirty=true;}return this;},addPlot:function(name,_56d){var plot,_56e=_56d&&_56d.type||"Default";if(typeof _56e=="string"){if(!dc.plot2d||!dc.plot2d[_56e]){throw Error("Can't find plot: "+_56e+" - didn't you forget to dojo"+".require() it?");}plot=new dc.plot2d[_56e](this,_56d);}else{plot=new _56e(this,_56d);}plot.name=name;plot.dirty=true;if(name in this.plots){this.stack[this.plots[name]].destroy();this.stack[this.plots[name]]=plot;}else{this.plots[name]=this.stack.length;this.stack.push(plot);}this.dirty=true;return this;},removePlot:function(name){if(name in this.plots){var _56f=this.plots[name];delete this.plots[name];this.stack[_56f].destroy();this.stack.splice(_56f,1);df.forIn(this.plots,function(idx,name,_570){if(idx>_56f){_570[name]=idx-1;}});var ns=dojo.filter(this.series,function(run){return run.plot!=name;});if(ns.length<this.series.length){dojo.forEach(this.series,function(run){if(run.plot==name){run.destroy();}});this.runs={};dojo.forEach(ns,function(run,_571){this.runs[run.plot]=_571;},this);this.series=ns;}this.dirty=true;}return this;},getPlotOrder:function(){return df.map(this.stack,_568);},setPlotOrder:function(_572){var _573={},_574=df.filter(_572,function(name){if(!(name in this.plots)||(name in _573)){return false;}_573[name]=1;return true;},this);if(_574.length<this.stack.length){df.forEach(this.stack,function(plot){var name=plot.name;if(!(name in _573)){_574.push(name);}});}var _575=df.map(_574,function(name){return this.stack[this.plots[name]];},this);df.forEach(_575,function(plot,i){this.plots[plot.name]=i;},this);this.stack=_575;this.dirty=true;return this;},movePlotToFront:function(name){if(name in this.plots){var _576=this.plots[name];if(_576){var _577=this.getPlotOrder();_577.splice(_576,1);_577.unshift(name);return this.setPlotOrder(_577);}}return this;},movePlotToBack:function(name){if(name in this.plots){var _578=this.plots[name];if(_578<this.stack.length-1){var _579=this.getPlotOrder();_579.splice(_578,1);_579.push(name);return this.setPlotOrder(_579);}}return this;},addSeries:function(name,data,_57a){var run=new dc.Series(this,data,_57a);run.name=name;if(name in this.runs){this.series[this.runs[name]].destroy();this.series[this.runs[name]]=run;}else{this.runs[name]=this.series.length;this.series.push(run);}this.dirty=true;if(!("ymin" in run)&&"min" in run){run.ymin=run.min;}if(!("ymax" in run)&&"max" in run){run.ymax=run.max;}return this;},removeSeries:function(name){if(name in this.runs){var _57b=this.runs[name];delete this.runs[name];this.series[_57b].destroy();this.series.splice(_57b,1);df.forIn(this.runs,function(idx,name,runs){if(idx>_57b){runs[name]=idx-1;}});this.dirty=true;}return this;},updateSeries:function(name,data){if(name in this.runs){var run=this.series[this.runs[name]];run.update(data);this._invalidateDependentPlots(run.plot,false);this._invalidateDependentPlots(run.plot,true);}return this;},getSeriesOrder:function(_57c){return df.map(df.filter(this.series,function(run){return run.plot==_57c;}),_568);},setSeriesOrder:function(_57d){var _57e,_57f={},_580=df.filter(_57d,function(name){if(!(name in this.runs)||(name in _57f)){return false;}var run=this.series[this.runs[name]];if(_57e){if(run.plot!=_57e){return false;}}else{_57e=run.plot;}_57f[name]=1;return true;},this);df.forEach(this.series,function(run){var name=run.name;if(!(name in _57f)&&run.plot==_57e){_580.push(name);}});var _581=df.map(_580,function(name){return this.series[this.runs[name]];},this);this.series=_581.concat(df.filter(this.series,function(run){return run.plot!=_57e;}));df.forEach(this.series,function(run,i){this.runs[run.name]=i;},this);this.dirty=true;return this;},moveSeriesToFront:function(name){if(name in this.runs){var _582=this.runs[name],_583=this.getSeriesOrder(this.series[_582].plot);if(name!=_583[0]){_583.splice(_582,1);_583.unshift(name);return this.setSeriesOrder(_583);}}return this;},moveSeriesToBack:function(name){if(name in this.runs){var _584=this.runs[name],_585=this.getSeriesOrder(this.series[_584].plot);if(name!=_585[_585.length-1]){_585.splice(_584,1);_585.push(name);return this.setSeriesOrder(_585);}}return this;},resize:function(_586,_587){var box;switch(arguments.length){case 1:box=dojo.mixin({},_586);dojo.marginBox(this.node,box);break;case 2:box={w:_586,h:_587};dojo.marginBox(this.node,box);break;}box=dojo.marginBox(this.node);this.surface.setDimensions(box.w,box.h);this.dirty=true;this.coords=null;return this.render();},getGeometry:function(){var ret={};df.forIn(this.axes,function(axis){if(axis.initialized()){ret[axis.name]={name:axis.name,vertical:axis.vertical,scaler:axis.scaler,ticks:axis.ticks};}});return ret;},setAxisWindow:function(name,_588,_589,zoom){var axis=this.axes[name];if(axis){axis.setWindow(_588,_589);dojo.forEach(this.stack,function(plot){if(plot.hAxis==name||plot.vAxis==name){plot.zoom=zoom;}});}return this;},setWindow:function(sx,sy,dx,dy,zoom){if(!("plotArea" in this)){this.calculateGeometry();}df.forIn(this.axes,function(axis){var _58a,_58b,_58c=axis.getScaler().bounds,s=_58c.span/(_58c.upper-_58c.lower);if(axis.vertical){_58a=sy;_58b=dy/s/_58a;}else{_58a=sx;_58b=dx/s/_58a;}axis.setWindow(_58a,_58b);});dojo.forEach(this.stack,function(plot){plot.zoom=zoom;});return this;},zoomIn:function(name,_58d){var axis=this.axes[name];if(axis){var _58e,_58f,_590=axis.getScaler().bounds;var _591=Math.min(_58d[0],_58d[1]);var _592=Math.max(_58d[0],_58d[1]);_591=_58d[0]<_590.lower?_590.lower:_591;_592=_58d[1]>_590.upper?_590.upper:_592;_58e=(_590.upper-_590.lower)/(_592-_591);_58f=_591-_590.lower;this.setAxisWindow(name,_58e,_58f);this.render();}},calculateGeometry:function(){if(this.dirty){return this.fullGeometry();}var _593=dojo.filter(this.stack,function(plot){return plot.dirty||(plot.hAxis&&this.axes[plot.hAxis].dirty)||(plot.vAxis&&this.axes[plot.vAxis].dirty);},this);_594(_593,this.plotArea);return this;},fullGeometry:function(){this._makeDirty();dojo.forEach(this.stack,_563);if(!this.theme){this.setTheme(new dojox.charting.Theme(dojox.charting._def));}dojo.forEach(this.series,function(run){if(!(run.plot in this.plots)){if(!dc.plot2d||!dc.plot2d.Default){throw Error("Can't find plot: Default - didn't you forget to dojo"+".require() it?");}var plot=new dc.plot2d.Default(this,{});plot.name=run.plot;this.plots[run.plot]=this.stack.length;this.stack.push(plot);}this.stack[this.plots[run.plot]].addSeries(run);},this);dojo.forEach(this.stack,function(plot){if(plot.hAxis){plot.setAxis(this.axes[plot.hAxis]);}if(plot.vAxis){plot.setAxis(this.axes[plot.vAxis]);}},this);var dim=this.dim=this.surface.getDimensions();dim.width=g.normalizedLength(dim.width);dim.height=g.normalizedLength(dim.height);df.forIn(this.axes,_563);_594(this.stack,dim);var _595=this.offsets={l:0,r:0,t:0,b:0};df.forIn(this.axes,function(axis){df.forIn(axis.getOffsets(),function(o,i){_595[i]+=o;});});if(this.title){this.titleGap=(this.titleGap==0)?0:this.titleGap||this.theme.chart.titleGap||20;this.titlePos=this.titlePos||this.theme.chart.titlePos||"top";this.titleFont=this.titleFont||this.theme.chart.titleFont;this.titleFontColor=this.titleFontColor||this.theme.chart.titleFontColor||"black";var _596=g.normalizedLength(g.splitFontString(this.titleFont).size);_595[this.titlePos=="top"?"t":"b"]+=(_596+this.titleGap);}df.forIn(this.margins,function(o,i){_595[i]+=o;});this.plotArea={width:dim.width-_595.l-_595.r,height:dim.height-_595.t-_595.b};df.forIn(this.axes,_563);_594(this.stack,this.plotArea);return this;},render:function(){if(this.theme){this.theme.clear();}if(this.dirty){return this.fullRender();}this.calculateGeometry();df.forEachRev(this.stack,function(plot){plot.render(this.dim,this.offsets);},this);df.forIn(this.axes,function(axis){axis.render(this.dim,this.offsets);},this);this._makeClean();if(this.surface.render){this.surface.render();}return this;},fullRender:function(){this.fullGeometry();var _597=this.offsets,dim=this.dim,rect;dojo.forEach(this.series,_564);df.forIn(this.axes,_564);dojo.forEach(this.stack,_564);if(this.chartTitle&&this.chartTitle.tagName){dojo.destroy(this.chartTitle);}this.surface.clear();this.chartTitle=null;var t=this.theme,fill=t.plotarea&&t.plotarea.fill,_598=t.plotarea&&t.plotarea.stroke,rect={x:_597.l-1,y:_597.t-1,width:dim.width-_597.l-_597.r+2,height:dim.height-_597.t-_597.b+2};if(fill){fill=dc.Element.prototype._shapeFill(dc.Element.prototype._plotFill(fill,dim,_597),rect);this.surface.createRect(rect).setFill(fill);}if(_598){this.surface.createRect({x:_597.l,y:_597.t,width:dim.width-_597.l-_597.r+1,height:dim.height-_597.t-_597.b+1}).setStroke(_598);}df.foldr(this.stack,function(z,plot){return plot.render(dim,_597),0;},0);fill=this.fill!==undefined?this.fill:(t.chart&&t.chart.fill);_598=this.stroke!==undefined?this.stroke:(t.chart&&t.chart.stroke);if(fill=="inherit"){var node=this.node,fill=new dojo.Color(dojo.style(node,"backgroundColor"));while(fill.a==0&&node!=document.documentElement){fill=new dojo.Color(dojo.style(node,"backgroundColor"));node=node.parentNode;}}if(fill){fill=dc.Element.prototype._plotFill(fill,dim,_597);if(_597.l){rect={width:_597.l,height:dim.height+1};this.surface.createRect(rect).setFill(dc.Element.prototype._shapeFill(fill,rect));}if(_597.r){rect={x:dim.width-_597.r,width:_597.r+1,height:dim.height+2};this.surface.createRect(rect).setFill(dc.Element.prototype._shapeFill(fill,rect));}if(_597.t){rect={width:dim.width+1,height:_597.t};this.surface.createRect(rect).setFill(dc.Element.prototype._shapeFill(fill,rect));}if(_597.b){rect={y:dim.height-_597.b,width:dim.width+1,height:_597.b+2};this.surface.createRect(rect).setFill(dc.Element.prototype._shapeFill(fill,rect));}}if(_598){this.surface.createRect({width:dim.width-1,height:dim.height-1}).setStroke(_598);}if(this.title){var _599=(g.renderer=="canvas"),_59a=_599||!dojo.isIE&&!dojo.isOpera?"html":"gfx",_59b=g.normalizedLength(g.splitFontString(this.titleFont).size);this.chartTitle=dc.axis2d.common.createText[_59a](this,this.surface,dim.width/2,this.titlePos=="top"?_59b+this.margins.t:dim.height-this.margins.b,"middle",this.title,this.titleFont,this.titleFontColor);}df.forIn(this.axes,function(axis){axis.render(dim,_597);});this._makeClean();if(this.surface.render){this.surface.render();}return this;},delayedRender:function(){if(!this._delayedRenderHandle){this._delayedRenderHandle=setTimeout(dojo.hitch(this,function(){clearTimeout(this._delayedRenderHandle);this._delayedRenderHandle=null;this.render();}),this.delayInMs);}return this;},connectToPlot:function(name,_59c,_59d){return name in this.plots?this.stack[this.plots[name]].connect(_59c,_59d):null;},fireEvent:function(_59e,_59f,_5a0){if(_59e in this.runs){var _5a1=this.series[this.runs[_59e]].plot;if(_5a1 in this.plots){var plot=this.stack[this.plots[_5a1]];if(plot){plot.fireEvent(_59e,_59f,_5a0);}}}return this;},_makeClean:function(){dojo.forEach(this.axes,_566);dojo.forEach(this.stack,_566);dojo.forEach(this.series,_566);this.dirty=false;},_makeDirty:function(){dojo.forEach(this.axes,_567);dojo.forEach(this.stack,_567);dojo.forEach(this.series,_567);this.dirty=true;},_invalidateDependentPlots:function(_5a2,_5a3){if(_5a2 in this.plots){var plot=this.stack[this.plots[_5a2]],axis,_5a4=_5a3?"vAxis":"hAxis";if(plot[_5a4]){axis=this.axes[plot[_5a4]];if(axis&&axis.dependOnData()){axis.dirty=true;dojo.forEach(this.stack,function(p){if(p[_5a4]&&p[_5a4]==plot[_5a4]){p.dirty=true;}});}}else{plot.dirty=true;}}}});function _5a5(_5a6){return {min:_5a6.hmin,max:_5a6.hmax};};function _5a7(_5a8){return {min:_5a8.vmin,max:_5a8.vmax};};function _5a9(_5aa,h){_5aa.hmin=h.min;_5aa.hmax=h.max;};function _5ab(_5ac,v){_5ac.vmin=v.min;_5ac.vmax=v.max;};function _5ad(_5ae,_5af){if(_5ae&&_5af){_5ae.min=Math.min(_5ae.min,_5af.min);_5ae.max=Math.max(_5ae.max,_5af.max);}return _5ae||_5af;};function _594(_5b0,_5b1){var _5b2={},axes={};dojo.forEach(_5b0,function(plot){var _5b3=_5b2[plot.name]=plot.getSeriesStats();if(plot.hAxis){axes[plot.hAxis]=_5ad(axes[plot.hAxis],_5a5(_5b3));}if(plot.vAxis){axes[plot.vAxis]=_5ad(axes[plot.vAxis],_5a7(_5b3));}});dojo.forEach(_5b0,function(plot){var _5b4=_5b2[plot.name];if(plot.hAxis){_5a9(_5b4,axes[plot.hAxis]);}if(plot.vAxis){_5ab(_5b4,axes[plot.vAxis]);}plot.initializeScalers(_5b1,_5b4);});};})();}if(!dojo._hasResource["dojox.charting.Chart2D"]){dojo._hasResource["dojox.charting.Chart2D"]=true;dojo.provide("dojox.charting.Chart2D");dojo.deprecated("dojox.charting.Chart2D","Use dojo.charting.Chart instead and require all other components explicitly","2.0");dojox.charting.Chart2D=dojox.charting.Chart;}if(!dojo._hasResource["dojox.charting.themes.PlotKit.base"]){dojo._hasResource["dojox.charting.themes.PlotKit.base"]=true;dojo.provide("dojox.charting.themes.PlotKit.base");(function(){var dc=dojox.charting,pk=dc.themes.PlotKit;pk.base=new dc.Theme({chart:{stroke:null,fill:"yellow"},plotarea:{stroke:null,fill:"yellow"},axis:{stroke:{color:"#fff",width:1},line:{color:"#fff",width:0.5},majorTick:{color:"#fff",width:0.5,length:6},minorTick:{color:"#fff",width:0.5,length:3},tick:{font:"normal normal normal 7pt Helvetica,Arial,sans-serif",fontColor:"#999"}},series:{stroke:{width:2.5,color:"#fff"},fill:"#666",font:"normal normal normal 7.5pt Helvetica,Arial,sans-serif",fontColor:"#666"},marker:{stroke:{width:2},fill:"#333",font:"normal normal normal 7pt Helvetica,Arial,sans-serif",fontColor:"#666"},colors:["red","green","blue"]});pk.base.next=function(_5b5,_5b6,_5b7){var _5b8=dc.Theme.prototype.next.apply(this,arguments);if(_5b5=="line"){_5b8.marker.outline={width:2,color:"#fff"};_5b8.series.stroke.width=3.5;_5b8.marker.stroke.width=2;}else{if(_5b5=="candlestick"){_5b8.series.stroke.width=1;}else{_5b8.series.stroke.color="#fff";}}return _5b8;};})();}if(!dojo._hasResource["dijit.Tooltip"]){dojo._hasResource["dijit.Tooltip"]=true;dojo.provide("dijit.Tooltip");dojo.declare("dijit._MasterTooltip",[dijit._Widget,dijit._Templated],{duration:dijit.defaultDuration,templateString:dojo.cache("dijit","templates/Tooltip.html","<div class=\"dijitTooltip dijitTooltipLeft\" id=\"dojoTooltip\"\r\n\t><div class=\"dijitTooltipContainer dijitTooltipContents\" dojoAttachPoint=\"containerNode\" role='alert'></div\r\n\t><div class=\"dijitTooltipConnector\" dojoAttachPoint=\"connectorNode\"></div\r\n></div>\r\n"),postCreate:function(){dojo.body().appendChild(this.domNode);this.bgIframe=new dijit.BackgroundIframe(this.domNode);this.fadeIn=dojo.fadeIn({node:this.domNode,duration:this.duration,onEnd:dojo.hitch(this,"_onShow")});this.fadeOut=dojo.fadeOut({node:this.domNode,duration:this.duration,onEnd:dojo.hitch(this,"_onHide")});},show:function(_5b9,_5ba,_5bb,rtl){if(this.aroundNode&&this.aroundNode===_5ba){return;}this.domNode.width="auto";if(this.fadeOut.status()=="playing"){this._onDeck=arguments;return;}this.containerNode.innerHTML=_5b9;var pos=dijit.placeOnScreenAroundElement(this.domNode,_5ba,dijit.getPopupAroundAlignment((_5bb&&_5bb.length)?_5bb:dijit.Tooltip.defaultPosition,!rtl),dojo.hitch(this,"orient"));dojo.style(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=true;this.aroundNode=_5ba;},orient:function(node,_5bc,_5bd,_5be,_5bf){this.connectorNode.style.top="";var _5c0=_5be.w-this.connectorNode.offsetWidth;node.className="dijitTooltip "+{"BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[_5bc+"-"+_5bd];this.domNode.style.width="auto";var size=dojo.contentBox(this.domNode);var _5c1=Math.min((Math.max(_5c0,1)),size.w);var _5c2=_5c1<size.w;this.domNode.style.width=_5c1+"px";if(_5c2){this.containerNode.style.overflow="auto";var _5c3=this.containerNode.scrollWidth;this.containerNode.style.overflow="visible";if(_5c3>_5c1){_5c3=_5c3+dojo.style(this.domNode,"paddingLeft")+dojo.style(this.domNode,"paddingRight");this.domNode.style.width=_5c3+"px";}}if(_5bd.charAt(0)=="B"&&_5bc.charAt(0)=="B"){var mb=dojo.marginBox(node);var _5c4=this.connectorNode.offsetHeight;if(mb.h>_5be.h){var _5c5=_5be.h-(_5bf.h/2)-(_5c4/2);this.connectorNode.style.top=_5c5+"px";this.connectorNode.style.bottom="";}else{this.connectorNode.style.bottom=Math.min(Math.max(_5bf.h/2-_5c4/2,0),mb.h-_5c4)+"px";this.connectorNode.style.top="";}}else{this.connectorNode.style.top="";this.connectorNode.style.bottom="";}return Math.max(0,size.w-_5c0);},_onShow:function(){if(dojo.isIE){this.domNode.style.filter="";}},hide:function(_5c6){if(this._onDeck&&this._onDeck[1]==_5c6){this._onDeck=null;}else{if(this.aroundNode===_5c6){this.fadeIn.stop();this.isShowingNow=false;this.aroundNode=null;this.fadeOut.play();}else{}}},_onHide:function(){this.domNode.style.cssText="";this.containerNode.innerHTML="";if(this._onDeck){this.show.apply(this,this._onDeck);this._onDeck=null;}}});dijit.showTooltip=function(_5c7,_5c8,_5c9,rtl){if(!dijit._masterTT){dijit._masterTT=new dijit._MasterTooltip();}return dijit._masterTT.show(_5c7,_5c8,_5c9,rtl);};dijit.hideTooltip=function(_5ca){if(!dijit._masterTT){dijit._masterTT=new dijit._MasterTooltip();}return dijit._masterTT.hide(_5ca);};dojo.declare("dijit.Tooltip",dijit._Widget,{label:"",showDelay:400,connectId:[],position:[],_setConnectIdAttr:function(_5cb){dojo.forEach(this._connections||[],function(_5cc){dojo.forEach(_5cc,dojo.hitch(this,"disconnect"));},this);var ary=dojo.isArrayLike(_5cb)?_5cb:(_5cb?[_5cb]:[]);this._connections=dojo.map(ary,function(id){var node=dojo.byId(id);return node?[this.connect(node,"onmouseenter","_onTargetMouseEnter"),this.connect(node,"onmouseleave","_onTargetMouseLeave"),this.connect(node,"onfocus","_onTargetFocus"),this.connect(node,"onblur","_onTargetBlur")]:[];},this);this._set("connectId",_5cb);this._connectIds=ary;},addTarget:function(node){var id=node.id||node;if(dojo.indexOf(this._connectIds,id)==-1){this.set("connectId",this._connectIds.concat(id));}},removeTarget:function(node){var id=node.id||node,idx=dojo.indexOf(this._connectIds,id);if(idx>=0){this._connectIds.splice(idx,1);this.set("connectId",this._connectIds);}},buildRendering:function(){this.inherited(arguments);dojo.addClass(this.domNode,"dijitTooltipData");},startup:function(){this.inherited(arguments);var ids=this.connectId;dojo.forEach(dojo.isArrayLike(ids)?ids:[ids],this.addTarget,this);},_onTargetMouseEnter:function(e){this._onHover(e);},_onTargetMouseLeave:function(e){this._onUnHover(e);},_onTargetFocus:function(e){this._focus=true;this._onHover(e);},_onTargetBlur:function(e){this._focus=false;this._onUnHover(e);},_onHover:function(e){if(!this._showTimer){var _5cd=e.target;this._showTimer=setTimeout(dojo.hitch(this,function(){this.open(_5cd);}),this.showDelay);}},_onUnHover:function(e){if(this._focus){return;}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}this.close();},open:function(_5ce){if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}dijit.showTooltip(this.label||this.domNode.innerHTML,_5ce,this.position,!this.isLeftToRight());this._connectNode=_5ce;this.onShow(_5ce,this.position);},close:function(){if(this._connectNode){dijit.hideTooltip(this._connectNode);delete this._connectNode;this.onHide();}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}},onShow:function(_5cf,_5d0){},onHide:function(){},uninitialize:function(){this.close();this.inherited(arguments);}});dijit.Tooltip.defaultPosition=["after","before"];}if(!dojo._hasResource["dojox.charting.action2d.Base"]){dojo._hasResource["dojox.charting.action2d.Base"]=true;dojo.provide("dojox.charting.action2d.Base");(function(){var _5d1=400,_5d2=dojo.fx.easing.backOut,df=dojox.lang.functional;dojo.declare("dojox.charting.action2d.Base",null,{overOutEvents:{onmouseover:1,onmouseout:1},constructor:function(_5d3,plot,_5d4){this.chart=_5d3;this.plot=plot||"default";this.anim={};if(!_5d4){_5d4={};}this.duration=_5d4.duration?_5d4.duration:_5d1;this.easing=_5d4.easing?_5d4.easing:_5d2;},connect:function(){this.handle=this.chart.connectToPlot(this.plot,this,"process");},disconnect:function(){if(this.handle){dojo.disconnect(this.handle);this.handle=null;}},reset:function(){},destroy:function(){this.disconnect();df.forIn(this.anim,function(o){df.forIn(o,function(anim){anim.action.stop(true);});});this.anim={};}});})();}if(!dojo._hasResource["dojox.lang.functional.scan"]){dojo._hasResource["dojox.lang.functional.scan"]=true;dojo.provide("dojox.lang.functional.scan");(function(){var d=dojo,df=dojox.lang.functional,_5d5={};d.mixin(df,{scanl:function(a,f,z,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var t,n,i;if(d.isArray(a)){t=new Array((n=a.length)+1);t[0]=z;for(i=0;i<n;z=f.call(o,z,a[i],i,a),t[++i]=z){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){t=[z];for(i=0;a.hasNext();t.push(z=f.call(o,z,a.next(),i++,a))){}}else{t=[z];for(i in a){if(!(i in _5d5)){t.push(z=f.call(o,z,a[i],i,a));}}}}return t;},scanl1:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var t,n,z,_5d6=true;if(d.isArray(a)){t=new Array(n=a.length);t[0]=z=a[0];for(var i=1;i<n;t[i]=z=f.call(o,z,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){if(a.hasNext()){t=[z=a.next()];for(var i=1;a.hasNext();t.push(z=f.call(o,z,a.next(),i++,a))){}}}else{for(var i in a){if(!(i in _5d5)){if(_5d6){t=[z=a[i]];_5d6=false;}else{t.push(z=f.call(o,z,a[i],i,a));}}}}}return t;},scanr:function(a,f,z,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var n=a.length,t=new Array(n+1),i=n;t[n]=z;for(;i>0;--i,z=f.call(o,z,a[i],i,a),t[i]=z){}return t;},scanr1:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var n=a.length,t=new Array(n),z=a[n-1],i=n-1;t[i]=z;for(;i>0;--i,z=f.call(o,z,a[i],i,a),t[i]=z){}return t;}});})();}if(!dojo._hasResource["dojox.charting.action2d.Tooltip"]){dojo._hasResource["dojox.charting.action2d.Tooltip"]=true;dojo.provide("dojox.charting.action2d.Tooltip");(function(){var _5d7=function(o){var t=o.run&&o.run.data&&o.run.data[o.index];if(t&&typeof t!="number"&&(t.tooltip||t.text)){return t.tooltip||t.text;}if(o.element=="candlestick"){return "<table cellpadding=\"1\" cellspacing=\"0\" border=\"0\" style=\"font-size:0.9em;\">"+"<tr><td>Open:</td><td align=\"right\"><strong>"+o.data.open+"</strong></td></tr>"+"<tr><td>High:</td><td align=\"right\"><strong>"+o.data.high+"</strong></td></tr>"+"<tr><td>Low:</td><td align=\"right\"><strong>"+o.data.low+"</strong></td></tr>"+"<tr><td>Close:</td><td align=\"right\"><strong>"+o.data.close+"</strong></td></tr>"+(o.data.mid!==undefined?"<tr><td>Mid:</td><td align=\"right\"><strong>"+o.data.mid+"</strong></td></tr>":"")+"</table>";}return o.element=="bar"?o.x:o.y;};var df=dojox.lang.functional,m=dojox.gfx.matrix,pi4=Math.PI/4,pi2=Math.PI/2;dojo.declare("dojox.charting.action2d.Tooltip",dojox.charting.action2d.Base,{defaultParams:{text:_5d7},optionalParams:{},constructor:function(_5d8,plot,_5d9){this.text=_5d9&&_5d9.text?_5d9.text:_5d7;this.connect();},process:function(o){if(o.type==="onplotreset"||o.type==="onmouseout"){dijit.hideTooltip(this.aroundRect);this.aroundRect=null;if(o.type==="onplotreset"){delete this.angles;}return;}if(!o.shape||o.type!=="onmouseover"){return;}var _5da={type:"rect"},_5db=["after","before"];switch(o.element){case "marker":_5da.x=o.cx;_5da.y=o.cy;_5da.width=_5da.height=1;break;case "circle":_5da.x=o.cx-o.cr;_5da.y=o.cy-o.cr;_5da.width=_5da.height=2*o.cr;break;case "column":_5db=["above","below"];case "bar":_5da=dojo.clone(o.shape.getShape());break;case "candlestick":_5da.x=o.x;_5da.y=o.y;_5da.width=o.width;_5da.height=o.height;break;default:if(!this.angles){if(typeof o.run.data[0]=="number"){this.angles=df.map(df.scanl(o.run.data,"+",0),"* 2 * Math.PI / this",df.foldl(o.run.data,"+",0));}else{this.angles=df.map(df.scanl(o.run.data,"a + b.y",0),"* 2 * Math.PI / this",df.foldl(o.run.data,"a + b.y",0));}}var _5dc=m._degToRad(o.plot.opt.startAngle),_5dd=(this.angles[o.index]+this.angles[o.index+1])/2+_5dc;_5da.x=o.cx+o.cr*Math.cos(_5dd);_5da.y=o.cy+o.cr*Math.sin(_5dd);_5da.width=_5da.height=1;if(_5dd<pi4){}else{if(_5dd<pi2+pi4){_5db=["below","above"];}else{if(_5dd<Math.PI+pi4){_5db=["before","after"];}else{if(_5dd<2*Math.PI-pi4){_5db=["above","below"];}}}}break;}var lt=dojo.coords(this.chart.node,true);_5da.x+=lt.x;_5da.y+=lt.y;_5da.x=Math.round(_5da.x);_5da.y=Math.round(_5da.y);_5da.width=Math.ceil(_5da.width);_5da.height=Math.ceil(_5da.height);this.aroundRect=_5da;var _5de=this.text(o);if(_5de){dijit.showTooltip(_5de,this.aroundRect,_5db);}}});})();}if(!dojo._hasResource["esri.dijit.Popup"]){dojo._hasResource["esri.dijit.Popup"]=true;dojo.provide("esri.dijit.Popup");(function(){var dc=dojox.charting,pk=dc.themes.PlotKit;pk.popup=pk.base.clone();pk.popup.chart.fill=pk.popup.plotarea.fill="#e7eef6";pk.popup.colors=["#284B70","#702828","#5F7143","#F6BC0C","#382C6C","#50224F","#1D7554","#4C4C4C","#0271AE","#706E41","#446A73","#0C3E69","#757575","#B7B7B7","#A3A3A3"];pk.popup.series.stroke.width=1;pk.popup.marker.stroke.width=1;}());dojo.declare("esri.dijit.Popup",[esri.InfoWindowBase,esri.PopupBase],{offsetX:3,offsetY:3,zoomFactor:4,marginLeft:10,marginTop:10,highlight:true,constructor:function(_5df,_5e0){this.initialize();dojo.mixin(this,_5df);this.domNode=dojo.byId(_5e0);var nls=this._nls=dojo.mixin({},esri.bundle.widgets.popup);var _5e1=this.domNode;dojo.addClass(_5e1,"esriPopup");var _5e2="<div class='sizer'>"+"<div class='titlePane'>"+"<div class='spinner hidden' title='"+nls.NLS_searching+"...'></div>"+"<div class='title'></div>"+"<div class='titleButton prev hidden' title='"+nls.NLS_prevFeature+"'></div>"+"<div class='titleButton next hidden' title='"+nls.NLS_nextFeature+"'></div>"+"<div class='titleButton maximize' title='"+nls.NLS_maximize+"'></div>"+"<div class='titleButton close' title='"+nls.NLS_close+"'></div>"+"</div>"+"</div>"+"<div class='sizer content'>"+"<div class='contentPane'>"+"</div>"+"</div>"+"<div class='sizer'>"+"<div class='actionsPane'>"+"<div class='actionList hidden'>"+"<a class='action zoomTo' href='javascript:void(0);'>Zoom to</a>"+"</div>"+"</div>"+"</div>"+"<div class='pointer top hidden'></div>"+"<div class='pointer bottom hidden'></div>"+"<div class='pointer left hidden'></div>"+"<div class='pointer right hidden'></div>"+"<div class='pointer topLeft hidden'></div>"+"<div class='pointer topRight hidden'></div>"+"<div class='pointer bottomLeft hidden'></div>"+"<div class='pointer bottomRight hidden'></div>";dojo.attr(_5e1,"innerHTML",_5e2);this._sizers=dojo.query(".sizer",_5e1);var _5e3=dojo.query(".titlePane",_5e1)[0];dojo.setSelectable(_5e3,false);this._title=dojo.query(".title",_5e3)[0];this._prevFeatureButton=dojo.query(".prev",_5e3)[0];this._nextFeatureButton=dojo.query(".next",_5e3)[0];this._maxButton=dojo.query(".maximize",_5e3)[0];this._spinner=dojo.query(".spinner",_5e3)[0];this._contentPane=dojo.query(".contentPane",_5e1)[0];this._actionList=dojo.query(".actionsPane .actionList",_5e1)[0];this._eventConnections=[dojo.connect(dojo.query(".close",_5e3)[0],"onclick",this,this.hide),dojo.connect(this._prevFeatureButton,"onclick",this,this.selectPrevious),dojo.connect(this._nextFeatureButton,"onclick",this,this.selectNext),dojo.connect(this._maxButton,"onclick",this,this._toggleSize),dojo.connect(dojo.query(".zoomTo",this._actionList)[0],"onclick",this,this._zoomToFeature)];if(esri.isTouchEnabled){var _5e4=esri.setScrollable(this._contentPane);this._eventConnections.push(_5e4[0],_5e4[1]);}esri.hide(_5e1);this.isShowing=false;},setMap:function(map){this.inherited(arguments);if(this.highlight){this.enableHighlight(map);}},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments);},setTitle:function(_5e5){this.destroyDijits(this._title);this.place(_5e5,this._title);if(this.isShowing){this.startupDijits(this._title);}},setContent:function(_5e6){this.destroyDijits(this._contentPane);this.place(_5e6,this._contentPane);if(this.isShowing){this.startupDijits(this._contentPane);}},show:function(_5e7){if(!_5e7){esri.show(this.domNode);this.isShowing=true;return;}var map=this.map,_5e8;if(_5e7.spatialReference){this._location=_5e7;_5e8=map.toScreen(_5e7);}else{this._location=map.toMap(_5e7);_5e8=_5e7;}var _5e9=map._getFrameWidth();if(_5e9!==-1){_5e8.x=_5e8.x%_5e9;if(_5e8.x<0){_5e8.x+=_5e9;}if(map.width>_5e9){var _5ea=(map.width-_5e9)/2;while(_5e8.x<_5ea){_5e8.x+=_5e9;}}}if(this._maximized){this.restore();}else{this._setPosition(_5e8);}if(!this.isShowing){esri.show(this.domNode);this.isShowing=true;this.onShow();}},hide:function(){if(this.isShowing){esri.hide(this.domNode);this.isShowing=false;this.onHide();}},resize:function(_5eb,_5ec){this._sizers.style({width:_5eb+"px"});dojo.style(this._contentPane,"maxHeight",_5ec+"px");},onShow:function(){this._followMap();this.startupDijits(this._title);this.startupDijits(this._contentPane);this.showHighlight();},onHide:function(){this._unfollowMap();this.hideHighlight();},maximize:function(){var map=this.map;if(!map||this._maximized){return;}this._maximized=true;var max=this._maxButton;dojo.removeClass(max,"maximize");dojo.addClass(max,"restore");dojo.attr(max,"title",this._nls.NLS_restore);var _5ed=this.marginLeft,_5ee=this.marginTop,_5ef=map.width-(2*_5ed),_5f0=map.height-(2*_5ee),_5f1=this.domNode;dojo.style(_5f1,{left:_5ed+"px",right:null,top:_5ee+"px",bottom:null});this._savedWidth=dojo.style(this._sizers[0],"width");this._savedHeight=dojo.style(this._contentPane,"maxHeight");this._sizers.style({width:_5ef+"px"});dojo.style(this._contentPane,{maxHeight:(_5f0-65)+"px",height:(_5f0-65)+"px"});this._showPointer("");this._unfollowMap();},restore:function(){var map=this.map;if(!map||!this._maximized){return;}this._maximized=false;var max=this._maxButton;dojo.removeClass(max,"restore");dojo.addClass(max,"maximize");dojo.attr(max,"title",this._nls.NLS_maximize);dojo.style(this._contentPane,"height",null);this.resize(this._savedWidth,this._savedHeight);this._savedWidth=this._savedHeight=null;this.show(this._location);this._followMap();},destroy:function(){if(this.map){this.unsetMap();}this.cleanup();if(this.isShowing){this.hide();}this.destroyDijits(this._title);this.destroyDijits(this._content);dojo.forEach(this._eventConnections,dojo.disconnect);dojo.destroy(this.domNode);this._sizers=this._contentPane=this._actionList=this._title=this._prevFeatureButton=this._nextFeatureButton=this._spinner=this._eventConnections=this._pagerScope=this._targetLocation=this._nls=this._maxButton=null;},selectNext:function(){this.select(this.selectedIndex+1);},selectPrevious:function(){this.select(this.selectedIndex-1);},setFeatures:function(){this.inherited(arguments);this._updateUI();},onSetFeatures:function(){},onClearFeatures:function(){this.setTitle("&nbsp;");this.setContent("&nbsp;");this._setPagerCallbacks(this);this._updateUI();this.hideHighlight();},onSelectionChange:function(){var ptr=this.selectedIndex;this._updateUI();if(ptr>=0){this.setContent(this.features[ptr].getContent());this.updateHighlight(this.map,this.features[ptr]);if(this.isShowing){this.showHighlight();}}},onDfdComplete:function(){this._updateUI();},_followMap:function(){this._unfollowMap();var map=this.map;this._handles=[dojo.connect(map,"onPanStart",this,this._onPanStart),dojo.connect(map,"onPan",this,this._onPan),dojo.connect(map,"onZoomStart",this,this._onZoomStart),dojo.connect(map,"onExtentChange",this,this._onExtentChange)];},_unfollowMap:function(){var _5f2=this._handles;if(_5f2){dojo.forEach(_5f2,dojo.disconnect,dojo);this._handles=null;}},_onPanStart:function(){var _5f3=this.domNode.style;this._panOrigin={left:_5f3.left,top:_5f3.top,right:_5f3.right,bottom:_5f3.bottom};},_onPan:function(_5f4,_5f5){var _5f6=this._panOrigin,dx=_5f5.x,dy=_5f5.y,left=_5f6.left,top=_5f6.top,_5f7=_5f6.right,_5f8=_5f6.bottom;if(left){left=(parseFloat(left)+dx)+"px";}if(top){top=(parseFloat(top)+dy)+"px";}if(_5f7){_5f7=(parseFloat(_5f7)-dx)+"px";}if(_5f8){_5f8=(parseFloat(_5f8)-dy)+"px";}dojo.style(this.domNode,{left:left,top:top,right:_5f7,bottom:_5f8});},_onZoomStart:function(){esri.hide(this.domNode);},_onExtentChange:function(_5f9,_5fa,_5fb){if(_5fb){esri.show(this.domNode);}this.show(this._targetLocation||this._location);this._targetLocation=null;},_toggleSize:function(){if(this._maximized){this.restore();}else{this.maximize();}},_setPosition:function(_5fc){var posX=_5fc.x,posY=_5fc.y,offX=this.offsetX||0,offY=this.offsetY||0,_5fd=0,_5fe=dojo.contentBox(this.map.container),_5ff=_5fe.w,_600=_5fe.h,_601="Right",_602="top",_603="Left",_604="bottom";if(posX<=_5ff/2){_601="Right";_603="Left";}else{if(posX<=_5ff){_601="Left";_603="Right";}}if(posY<=_600/2){_602="bottom";_604="top";}else{if(posY<=_600){_602="top";_604="bottom";}}var _605=_602+_601,_606=_604+_603;this._showPointer(_606);switch(_606){case "topLeft":case "topRight":case "bottomLeft":case "bottomRight":_5fd=45;break;}switch(_605){case "topLeft":dojo.style(this.domNode,{left:null,right:(_5ff-posX+offX)+"px",top:null,bottom:(_600-posY+_5fd+offY)+"px"});break;case "topRight":dojo.style(this.domNode,{left:(posX+offX)+"px",right:null,top:null,bottom:(_600-posY+_5fd+offY)+"px"});break;case "bottomLeft":dojo.style(this.domNode,{left:null,right:(_5ff-posX+offX)+"px",top:(posY+_5fd+offY)+"px",bottom:null});break;case "bottomRight":dojo.style(this.domNode,{left:(posX+offX)+"px",right:null,top:(posY+_5fd+offY)+"px",bottom:null});break;}},_showPointer:function(_607){var _608=["topLeft","topRight","bottomRight","bottomLeft"];dojo.forEach(_608,function(ptr){if(ptr===_607){dojo.query(".pointer."+ptr,this.domNode).removeClass("hidden");}else{dojo.query(".pointer."+ptr,this.domNode).addClass("hidden");}},this);},_setPagerCallbacks:function(_609,_60a,_60b){if(_609===this&&(!this._pagerScope||this._pagerScope===this)){return;}if(_609===this._pagerScope){return;}this._pagerScope=_609;if(_609===this){_60a=this.selectPrevious;_60b=this.selectNext;}var _60c=this._eventConnections;dojo.disconnect(_60c[1]);dojo.disconnect(_60c[2]);if(_60a){_60c[1]=dojo.connect(this._prevFeatureButton,"onclick",_609,_60a);}if(_60b){_60c[2]=dojo.connect(this._nextFeatureButton,"onclick",_609,_60b);}},_zoomToFeature:function(){var _60d=this.features,ptr=this.selectedIndex,map=this.map;if(_60d){var _60e=_60d[ptr].geometry,_60f,_610,_611=0,_612;if(_60e){switch(_60e.type){case "point":_60f=_60e;break;case "multipoint":_60f=_60e.getPoint(0);_610=_60e.getExtent();break;case "polyline":_60f=_60e.getPoint(0,0);_610=_60e.getExtent();if(map._getFrameWidth()!==-1){dojo.forEach(_60e.paths,function(path){var _613={"paths":[path,map.spatialReference]},_614=new esri.geometry.Polyline(_613),_615=_614.getExtent(),_616=Math.abs(_615.ymax-_615.ymin),_617=Math.abs(_615.xmax-_615.xmin),_618=(_617>_616)?_617:_616;if(_618>_611){_611=_618;_612=_615;}});_610=_612;}break;case "polygon":_60f=_60e.getPoint(0,0);_610=_60e.getExtent();if(map._getFrameWidth()!==-1){dojo.forEach(_60e.rings,function(ring){var _619={"rings":[ring,map.spatialReference]},_61a=new esri.geometry.Polygon(_619),_61b=_61a.getExtent(),_61c=Math.abs(_61b.ymax-_61b.ymin),_61d=Math.abs(_61b.xmax-_61b.xmin),_61e=(_61d>_61c)?_61d:_61c;if(_61e>_611){_611=_61e;_612=_61b;}});_610=_612;}break;}}if(!_60f){_60f=this._location;}if(!_610||!_610.intersects(this._location)){this._location=_60f;}if(_610){map.setExtent(_610,true);}else{var _61f=map.getNumLevels(),_620=map.getLevel(),last=_61f-1,_621=this.zoomFactor||1;if(_61f>0){if(_620===last){return;}var _622=_620+_621;if(_622>last){_622=last;}map._scrollZoomHandler({value:(_622-_620),mapPoint:_60f});}else{map._scrollZoomHandler({value:(1/Math.pow(2,_621))*2,mapPoint:_60f});}}}},_updateUI:function(){var _623="&nbsp;",ptr=this.selectedIndex,_624=this.features,_625=this.deferreds,prev=this._prevFeatureButton,next=this._nextFeatureButton,_626=this._spinner,_627=this._actionList,nls=this._nls;if(_624&&_624.length>1){_623="("+(ptr+1)+" of "+_624.length+")";if(ptr===0){dojo.addClass(prev,"hidden");}else{dojo.removeClass(prev,"hidden");}if(ptr===_624.length-1){dojo.addClass(next,"hidden");}else{dojo.removeClass(next,"hidden");}}else{dojo.addClass(prev,"hidden");dojo.addClass(next,"hidden");}this.setTitle(_623);if(_625&&_625.length){if(_624){dojo.removeClass(_626,"hidden");}else{this.setContent("<div style='text-align: center;'>"+nls.NLS_searching+"...</div>");}}else{dojo.addClass(_626,"hidden");if(!_624||!_624.length){this.setContent("<div style='text-align: center;'>"+nls.NLS_noInfo+".</div>");}}if(_624&&_624.length){dojo.removeClass(_627,"hidden");}else{dojo.addClass(_627,"hidden");}}});dojo.declare("esri.dijit.PopupTemplate",[esri.PopupInfoTemplate],{constructor:function(json){this.initialize(json);this._nls=dojo.mixin({},esri.bundle.widgets.popup);},getTitle:function(_628){return this.info?this.getComponents(_628).title:"";},getContent:function(_629){return this.info?new esri.dijit._PopupRenderer({template:this,graphic:_629,_nls:this._nls},dojo.create("div")).domNode:"";}});dojo.declare("esri.dijit._PopupRenderer",[dijit._Widget,dijit._Templated],{templateString:"<div class='esriViewPopup'>"+"<div class='mainSection'>"+"<div class='header' dojoAttachPoint='_title'></div>"+"<div class='hzLine'></div>"+"<div dojoAttachPoint='_description'></div>"+"<div class='break'></div>"+"</div>"+"<div class='attachmentsSection hidden'>"+"<div>Attachments:</div>"+"<ul dojoAttachPoint='_attachmentsList'>"+"</ul>"+"<div class='break'></div>"+"</div>"+"<div class='mediaSection hidden'>"+"<div class='header' dojoAttachPoint='_mediaTitle'></div>"+"<div class='hzLine'></div>"+"<div class='caption' dojoAttachPoint='_mediaCaption'></div>"+"<div class='gallery' dojoAttachPoint='_gallery'>"+"<div class='mediaHandle prev' dojoAttachPoint='_prevMedia' dojoAttachEvent='onclick: _goToPrevMedia'></div>"+"<div class='mediaHandle next' dojoAttachPoint='_nextMedia' dojoAttachEvent='onclick: _goToNextMedia'></div>"+"<ul class='summary'>"+"<li class='image mediaCount hidden' dojoAttachPoint='_imageCount'>0</li>"+"<li class='image mediaIcon hidden'></li>"+"<li class='chart mediaCount hidden' dojoAttachPoint='_chartCount'>0</li>"+"<li class='chart mediaIcon hidden'></li>"+"</ul>"+"<div class='frame' dojoAttachPoint='_mediaFrame'></div>"+"</div>"+"</div>"+"</div>",startup:function(){this.inherited(arguments);var _62a=this.template,_62b=this.graphic,_62c=_62a.getComponents(_62b),_62d=_62c.title,_62e=_62c.description,_62f=_62c.fields,_630=_62c.mediaInfos,_631=this.domNode,nls=this._nls;this._prevMedia.title=nls.NLS_prevMedia;this._nextMedia.title=nls.NLS_nextMedia;dojo.attr(this._title,"innerHTML",_62d);if(!_62d){dojo.addClass(this._title,"hidden");}if(!_62e&&_62f){_62e="";dojo.forEach(_62f,function(row){_62e+=("<tr valign='top'>");_62e+=("<td class='attrName'>"+row[0]+"</td>");_62e+=("<td class='attrValue'>"+row[1].replace(/^\s*(https?:\/\/[^\s]+)\s*$/i,"<a target='_blank' href='$1' title='$1'>More info</a>")+"</td>");_62e+=("</tr>");});if(_62e){_62e="<table class='attrTable' cellpadding='0px' cellspacing='0px'>"+_62e+"</table>";}}dojo.attr(this._description,"innerHTML",_62e);if(!_62e){dojo.addClass(this._description,"hidden");}dojo.query("a",this._description).forEach(function(node){dojo.attr(node,"target","_blank");});if(_62d&&_62e){dojo.query(".mainSection .hzLine",_631).removeClass("hidden");}else{if(_62d||_62e){dojo.query(".mainSection .hzLine",_631).addClass("hidden");}else{dojo.query(".mainSection",_631).addClass("hidden");}}var dfd=(this._dfd=_62a.getAttachments(_62b));if(dfd){dfd.addBoth(dojo.hitch(this,this._attListHandler,dfd));dojo.attr(this._attachmentsList,"innerHTML","<li>"+nls.NLS_searching+"...</li>");dojo.query(".attachmentsSection",_631).removeClass("hidden");}if(_630&&_630.length){dojo.query(".mediaSection",_631).removeClass("hidden");dojo.setSelectable(this._mediaFrame,false);this._mediaInfos=_630;this._mediaPtr=0;this._updateUI();this._displayMedia();}},destroy:function(){if(this._dfd){this._dfd.cancel();}this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._dfd=null;this.inherited(arguments);},_goToPrevMedia:function(){var ptr=this._mediaPtr-1;if(ptr<0){return;}this._mediaPtr--;this._updateUI();this._displayMedia();},_goToNextMedia:function(){var ptr=this._mediaPtr+1;if(ptr===this._mediaInfos.length){return;}this._mediaPtr++;this._updateUI();this._displayMedia();},_updateUI:function(){var _632=this._mediaInfos,_633=_632.length,_634=this.domNode,_635=this._prevMedia,_636=this._nextMedia;if(_633>1){var _637=0,_638=0;dojo.forEach(_632,function(info){if(info.type==="image"){_637++;}else{if(info.type.indexOf("chart")!==-1){_638++;}}});if(_637){dojo.attr(this._imageCount,"innerHTML",_637);dojo.query(".summary .image",_634).removeClass("hidden");}if(_638){dojo.attr(this._chartCount,"innerHTML",_638);dojo.query(".summary .chart",_634).removeClass("hidden");}}else{dojo.query(".summary",_634).addClass("hidden");dojo.addClass(_635,"hidden");dojo.addClass(_636,"hidden");}var ptr=this._mediaPtr;if(ptr===0){dojo.addClass(_635,"hidden");}else{dojo.removeClass(_635,"hidden");}if(ptr===_633-1){dojo.addClass(_636,"hidden");}else{dojo.removeClass(_636,"hidden");}this._destroyFrame();},_displayMedia:function(){var info=this._mediaInfos[this._mediaPtr],_639=info.title,_63a=info.caption,_63b=dojo.query(".mediaSection .hzLine",this.domNode)[0];dojo.attr(this._mediaTitle,"innerHTML",_639);dojo[_639?"removeClass":"addClass"](this._mediaTitle,"hidden");dojo.attr(this._mediaCaption,"innerHTML",_63a);dojo[_63a?"removeClass":"addClass"](this._mediaCaption,"hidden");dojo[(_639&&_63a)?"removeClass":"addClass"](_63b,"hidden");if(info.type==="image"){this._showImage(info.value);}else{this._showChart(info.type,info.value);}},_showImage:function(_63c){dojo.addClass(this._mediaFrame,"image");var _63d=dojo.style(this._gallery,"height"),html="<img src='"+_63c.sourceURL+"' onload='esri.dijit._PopupRenderer.prototype._imageLoaded(this,"+_63d+");' />";if(_63c.linkURL){html="<a target='_blank' href='"+_63c.linkURL+"'>"+html+"</a>";}dojo.attr(this._mediaFrame,"innerHTML",html);},_showChart:function(type,_63e){dojo.removeClass(this._mediaFrame,"image");var _63f=this._chart=new dojox.charting.Chart2D(dojo.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});_63f.setTheme(dojo.getObject("dojox.charting.themes."+(_63e.theme||"PlotKit.popup")));switch(type){case "piechart":_63f.addPlot("default",{type:"Pie",labels:false});_63f.addSeries("Series A",_63e.fields);break;case "linechart":_63f.addPlot("default",{type:"Markers"});_63f.addAxis("x",{min:0,majorTicks:false,minorTicks:false,majorLabels:false,minorLabels:false});_63f.addAxis("y",{includeZero:true,vertical:true,fixUpper:"minor"});dojo.forEach(_63e.fields,function(info,idx){info.x=idx+1;});_63f.addSeries("Series A",_63e.fields);break;case "columnchart":_63f.addPlot("default",{type:"Columns",gap:3});_63f.addAxis("y",{includeZero:true,vertical:true,fixUpper:"minor"});_63f.addSeries("Series A",_63e.fields);break;case "barchart":_63f.addPlot("default",{type:"Bars",gap:3});_63f.addAxis("x",{includeZero:true,fixUpper:"minor",minorLabels:false});_63f.addAxis("y",{vertical:true,majorTicks:false,minorTicks:false,majorLabels:false,minorLabels:false});_63f.addSeries("Series A",_63e.fields);break;}this._action=new dojox.charting.action2d.Tooltip(_63f);_63f.render();},_destroyFrame:function(){if(this._chart){this._chart.destroy();this._chart=null;}if(this._action){this._action.destroy();this._action=null;}dojo.attr(this._mediaFrame,"innerHTML","");},_imageLoaded:function(img,_640){var _641=img.height;if(_641<_640){var diff=Math.round((_640-_641)/2);dojo.style(img,"marginTop",diff+"px");}},_attListHandler:function(dfd,_642){if(dfd===this._dfd){this._dfd=null;var html="";if(!(_642 instanceof Error)&&_642&&_642.length){dojo.forEach(_642,function(info){html+=("<li>");html+=("<a href='"+info.url+"' target='_blank'>"+(info.name||"[No name]")+"</a>");html+=("</li>");});}dojo.attr(this._attachmentsList,"innerHTML",html||"<li>"+this._nls.NLS_noAttach+"</li>");}}});}if(!dojo._hasResource["esri.layers.KMLLayer"]){dojo._hasResource["esri.layers.KMLLayer"]=true;dojo.provide("esri.layers.KMLLayer");dojo.declare("esri.layers.KMLLayer",[esri.layers.Layer],{serviceUrl:"http://utility.arcgis.com/sharing/kml",constructor:function(url,_643){if(!url){console.log("KMLLayer:constructor - please provide url for the KML file");}this._outSR=null;if(_643&&_643.outSR){this._outSR=_643.outSR;this._outSR=(this._outSR)?this._outSR.wkid:null;}this._options=_643;if(esri.config.defaults.kmlService){this.serviceUrl=esri.config.defaults.kmlService;}var link=(this.linkInfo=_643&&_643.linkInfo);if(link){this.visible=!!link.visibility;}if(!link||(link&&link.visibility)){this._parseKml();}},getFeature:function(_644){if(!_644){return;}var type=_644.type,id=_644.id,_645,i,len;switch(type){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryPolygon":var _646=this["_"+type];if(_646){_645=dojo.getObject("_mode._featureMap."+id,false,_646);}break;case "GroundOverlay":var _647=this._groundLyr;if(_647){var _648=_647.getImages();len=_648.length;for(i=0;i<len;i++){if(_648[i].id===id){_645=_648[i];break;}}}break;case "ScreenOverlay":break;case "NetworkLink":dojo.some(this._links,function(link){if(link.linkInfo.id===id){_645=link;return true;}else{return false;}});break;case "Folder":var _649=this.folders;len=_649?_649.length:0;for(i=0;i<len;i++){if(_649[i].id===id){_645=_649[i];break;}}break;default:console.log("KMLLayer:getFeature - unknown feature type");break;}return _645;},getLayers:function(){var _64a=[];if(this._groundLyr){_64a.push(this._groundLyr);}if(this._fLayers){_64a=_64a.concat(this._fLayers);}return _64a;},setFolderVisibility:function(_64b,_64c){if(!_64b){return;}_64b.visible=_64c;if(_64c){var _64d=this._getParentFolders(_64b,[]);if(_64d.length>0){_64c=dojo.every(_64d,function(_64e){return _64e.visible;});}}this._setState(_64b,_64c);},_parseKml:function(){var self=this;esri.request({url:this.serviceUrl,content:{url:this.url,model:"simple",folders:"",outSR:this._outSR},callbackParamName:"callback",load:function(_64f){self._initLayer(_64f);},error:function(err){self.onError("Error reading kml document. ("+dojo.toJson(err)+")");}});},_initLayer:function(json){this.name=json.name;this.description=json.description;this.snippet=json.snippet;this.visibility=json.visibility;this.featureInfos=json.featureInfos;var i,len;var _650=(this._links=json.networkLinks);len=_650?_650.length:0;var _651=this;for(i=0;i<len;i++){var _652={linkInfo:_650[i]};_652=dojo.mixin(_652,this._options);if(_652.id){_652.id=_652.id+"_"+i;}if(_650[i].viewRefreshMode==="never"){_650[i]=new esri.layers.KMLLayer(_650[i].href,_652);dojo.connect(_650[i],"onLoad",function(a){_651._map.addLayer(a);});}}var _653=json.groundOverlays;if(_653&&_653.length>0){var _652=dojo.mixin({},this._options);if(_652.id){_652.id=_652.id+"_"+"mapImage";}var _654=(this._groundLyr=new esri.layers.MapImageLayer(_652));len=_653.length;for(i=0;i<len;i++){_654.addImage(new esri.layers.KMLGroundOverlay(_653[i]));}}var _655=dojo.getObject("featureCollection.layers",false,json);if(_655&&_655.length>0){this._fLayers=[];dojo.forEach(_655,function(_656,i){var _657=dojo.getObject("featureSet.features",false,_656),_658;if(_657&&_657.length>0){_656.layerDefinition.capabilities="Query,Data";var _659={outFields:["*"],infoTemplate:_656.popupInfo?new esri.dijit.PopupTemplate(_656.popupInfo):null,editable:false};_659=dojo.mixin(_659,this._options);if(_659.id){_659.id=_659.id+"_"+i;}_658=new esri.layers.FeatureLayer(_656,_659);if(_658.geometryType){this["_"+_658.geometryType]=_658;}this._fLayers.push(_658);}},this);if(this._fLayers.length===0){delete this._fLayers;}}var _65a=(this.folders=json.folders),_65b=[],fldr;if(_65a){len=_65a.length;for(i=0;i<len;i++){fldr=(_65a[i]=new esri.layers.KMLFolder(_65a[i]));if(fldr.parentFolderId===-1){_65b.push(fldr);}}}len=_65b.length;for(i=0;i<len;i++){fldr=_65b[i];this._setState(fldr,fldr.visible);}this.loaded=true;this.onLoad(this);},_setState:function(_65c,_65d){var _65e=_65c.featureInfos,info,_65f,i,len=_65e?_65e.length:0,_660=_65d?"show":"hide";for(i=0;i<len;i++){info=_65e[i];_65f=this.getFeature(info);if(!_65f){continue;}if(info.type==="Folder"){this._setState(_65f,_65d&&_65f.visible);}else{_65f[_660]();}}},_getParentFolders:function(_661,_662){var _663=_661.parentFolderId;if(_663!==-1){var _664=this.getFeature({type:"Folder",id:_663});_662.push(_664);return this._getParentFolders(_664,_662);}return _662;},_setMap:function(map,_665){this._map=map;var div=this._div=dojo.create("div",null,_665);dojo.style(div,"position","absolute");if(this._groundLyr){var _666=map.spatialReference._isWebMercator();if(_666){var _667=esri.geometry.geographicToWebMercator;dojo.forEach(this._groundLyr.getImages(),function(_668){_668.extent=_667(_668.extent);});}map.addLayer(this._groundLyr,map.layerIds.length);}var _669=this._fLayers;if(_669&&_669.length>0){var _666=map.spatialReference._isWebMercator();dojo.forEach(_669,function(_66a){if(_666){var _66b=_66a.graphics,i,geom,len=_66b?_66b.length:0,_667=esri.geometry.geographicToWebMercator;for(i=0;i<len;i++){geom=_66b[i].geometry;if(geom){_66b[i].setGeometry(_667(geom));}}}map.addLayer(_66a);});}this.onVisibilityChange(this.visible);return div;},_unsetMap:function(map,_66c){if(this._groundLyr){map.removeLayer(this._groundLyr);}if(this._fLayers){dojo.forEach(this._fLayers,function(_66d){map.removeLayer(_66d);});}var div=this._div;if(div){_66c.removeChild(div);dojo.destroy(div);}this._map=this._div=null;},onVisibilityChange:function(_66e){var _66f=_66e?"show":"hide";if(_66e&&this.linkInfo&&!this.loaded){this._parseKml();}else{if(this._groundLyr){this._groundLyr[_66f]();}if(this._fLayers){dojo.forEach(this._fLayers,function(_670){_670[_66f]();});}}}});dojo.declare("esri.layers.KMLGroundOverlay",[esri.layers.MapImage],{constructor:function(json){if(esri._isDefined(this.visibility)){this.visible=!!this.visibility;}}});dojo.declare("esri.layers.KMLFolder",null,{constructor:function(json){dojo.mixin(this,json);if(esri._isDefined(this.visibility)){this.visible=!!this.visibility;}}});}if(!dojo._hasResource["esri.layers.wms"]){dojo._hasResource["esri.layers.wms"]=true;dojo.provide("esri.layers.wms");dojo.declare("esri.layers.WMSLayer",[esri.layers.DynamicMapServiceLayer],{_CRS_TO_EPSG:{84:4326,83:4269,27:4267},_REVERSED_LAT_LONG_RANGES:[[4001,4999],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],_WEB_MERCATOR:[102100,3857,102113,900913],_WORLD_MERCATOR:[3395,54004],allExtents:[],constructor:function(url,_671){this._getCapabilitiesURL=url;this._initLayer=dojo.hitch(this,this._initLayer);this._parseCapabilities=dojo.hitch(this,this._parseCapabilities);this._getCapabilitiesError=dojo.hitch(this,this._getCapabilitiesError);if(_671){this.imageFormat=this._getImageFormat(_671.format);this.imageTransparency=(_671.transparent===false)?false:true;this.visibleLayers=_671.visibleLayers?_671.visibleLayers:[];if(_671.resourceInfo){this._readResourceInfo(_671.resourceInfo);}else{this._getCapabilities();}}else{this.imageFormat="image/png";this.imageTransparency=true;this.visibleLayers=[];this._getCapabilities();}this._blankImageURL=dojo.moduleUrl("esri","../../images/pixel.png").uri;},setVisibleLayers:function(_672){_672=this._checkVisibleLayersList(_672);this.visibleLayers=(_672)?_672:[];this.refresh(true);},setImageFormat:function(_673){this.imageFormat=this._getImageFormat(_673);this.refresh(true);},setImageTransparency:function(_674){this.imageTransparency=_674;this.refresh(true);},getImageUrl:function(_675,_676,_677,_678){if(!this.visibleLayers||this.visibleLayers.length===0){_678(this._blankImageURL);return;}var wkid=_675.spatialReference.wkid;if(dojo.some(this._WEB_MERCATOR,function(el){return el==wkid;})){var _679=dojo.filter(this.spatialReferences,function(el){return (dojo.some(this._WEB_MERCATOR,function(el2){return el2==el;}));},this);if(_679.length==0){_679=dojo.filter(this.spatialReferences,function(el){return (dojo.some(this._WORLD_MERCATOR,function(el2){return el2==el;}));},this);}if(_679.length>0){wkid=_679[0];}else{wkid=this._WEB_MERCATOR[0];}}var list=dojo.filter(this.spatialReferences,function(el){return el!==wkid;});this.spatialReferences=list;this.spatialReferences.unshift(wkid);var xmin=_675.xmin;var xmax=_675.xmax;var ymin=_675.ymin;var ymax=_675.ymax;var _67a={};_67a.SERVICE="WMS";_67a.REQUEST="GetMap";_67a.FORMAT=this.imageFormat;_67a.TRANSPARENT=this.imageTransparency?"TRUE":"FALSE";_67a.STYLES="";_67a.VERSION=this.version;_67a.LAYERS=this.visibleLayers?this.visibleLayers.toString():null;_67a.WIDTH=_676;_67a.HEIGHT=_677;if(this.maxWidth<_676){_67a.WIDTH=this.maxWidth;}if(this.maxHeight<_677){_67a.HEIGHT=this.maxHeight;}var _67b=wkid?wkid:NaN;if(!isNaN(_67b)){if(this.version=="1.3.0"){_67a.CRS="EPSG:"+_67b;}else{_67a.SRS="EPSG:"+_67b;}}if(this.version=="1.3.0"&&this._useLatLong(_67b)){_67a.BBOX=ymin+","+xmin+","+ymax+","+xmax;}else{_67a.BBOX=xmin+","+ymin+","+xmax+","+ymax;}var _67c=this.getMapURL;_67c+=(_67c.indexOf("?")==-1)?"?":"";for(var key in _67a){_67c+=(_67c.substring(_67c.length-1,_67c.length)=="?")?"":"&";_67c+=key+"="+_67a[key];}_678(_67c);},_initLayer:function(_67d,io){this.spatialReference=new esri.SpatialReference(this.extent.spatialReference);this.initialExtent=new esri.geometry.Extent(this.extent);this.fullExtent=new esri.geometry.Extent(this.extent);this.visibleLayers=this._checkVisibleLayersList(this.visibleLayers);this.loaded=true;this.onLoad(this);var _67e=this._loadCallback;if(_67e){delete this._loadCallback;_67e(this);}},_readResourceInfo:function(_67f){if(!_67f.extent){console.error("esri.layers.WMSLayer: unable to find the 'extent' property in resourceInfo");return;}if(!_67f.layerInfos){console.error("esri.layers.WMSLayer: unable to find the 'layerInfos' property in resourceInfo");return;}this.extent=_67f.extent;this.layerInfos=_67f.layerInfos;this.description=_67f.description?_67f.description:"";this.copyright=_67f.copyright?_67f.copyright:"";this.title=_67f.title?_67f.title:"";this.getMapURL=_67f.getMapURL?_67f.getMapURL:this._getCapabilitiesURL;this.version=_67f.version?_67f.version:"1.3.0";this.maxWidth=_67f.maxWidth?_67f.maxWidth:5000;this.maxHeight=_67f.maxHeight?_67f.maxHeight:5000;this.spatialReferences=_67f.spatialReferences?_67f.spatialReferences:[];this._initLayer();},_getCapabilities:function(){var _680=this._url.query?this._url.query:{};_680.SERVICE="WMS";_680.REQUEST="GetCapabilities";var uri=this._url.path+"?";for(var key in _680){uri+=(uri.substring(uri.length-1,uri.length)=="?")?"":"&";uri+=key+"="+_680[key];}var _681=esri.request({url:uri,handleAs:"xml",load:this._parseCapabilities,error:this._getCapabilitiesError},{usePost:false});},_parseCapabilities:function(xml){if(!xml){this.onError("GetCapabilities request for "+this._getCapabilitiesURL+" failed. (Response is null.)");return;}this.version=this._getAttributeValue("WMS_Capabilities","version",xml,null);if(!this.version){this.version=this._getAttributeValue("WMT_MS_Capabilities","version",xml,"1.3.0");}var _682=this._getTag("Service",xml);this.title=this._getTagValue("Title",_682,"");if(this.title.length==0){this.title=this._getTagValue("Name",_682,"");}this.copyright=this._getTagValue("AccessConstraints",_682,"");this.description=this._getTagValue("Abstract",_682,"");this.maxWidth=parseInt(this._getTagValue("MaxWidth",_682,5000));this.maxHeight=parseInt(this._getTagValue("MaxHeight",_682,5000));var _683=this._getTag("Layer",xml);if(!_683){this._getCapabilitiesError({"error":{"message":"Response does not contain any layers."}});return;}var _684=this._getLayerInfo(_683);if(_684){this.layerInfos=_684.subLayers;this.extent=_684.extent;this.spatialReferences=_684.spatialReferences;this.allExtents=_684.allExtents;}this.getMapURL=this._getCapabilitiesURL;var _685=dojo.query("DCPType",this._getTag("GetMap",xml));if(_685&&_685.length>0){var _686=dojo.query("HTTP",_685[0]);if(_686&&_686.length>0){var _687=dojo.query("Get",_686[0]);if(_687&&_687.length>0){var _688=this._getAttributeValue("OnlineResource","xlink:href",_687[0],null);if(_688){if(_688.indexOf("&")==(_688.length-1)){_688=_688.substring(0,_688.length-1);}this.getMapURL=_688;}}}}this.getMapFormats=[];dojo.forEach(dojo.query("Format",this._getTag("GetMap",xml)),function(_689){if(dojo.isIE){this.getMapFormats.push(_689.text);}else{this.getMapFormats.push(_689.textContent);}},this);this._initLayer();},_getCapabilitiesError:function(_68a,io){this.onError("GetCapabilities request for "+this._getCapabilitiesURL+" failed. ("+dojo.toJson(_68a)+")");},_getLayerInfo:function(_68b){var _68c;if(_68b){_68c=new esri.layers.WMSLayerInfo();_68c.name="";_68c.title="";_68c.description="";dojo.forEach(_68b.childNodes,function(_68d){if(_68d.nodeName=="Name"){_68c.name=(dojo.isIE?_68d.text:_68d.textContent)||"";}else{if(_68d.nodeName=="Title"){_68c.title=(dojo.isIE?_68d.text:_68d.textContent)||"";}else{if(_68d.nodeName=="Abstract"){_68c.description=(dojo.isIE?_68d.text:_68d.textContent)||"";}}}},this);_68c.allExtents=[];var _68e=this._getTag("LatLonBoundingBox",_68b);if(_68e){_68c.allExtents[0]=this._getExtent(_68e,4326);}var _68f=this._getTag("EX_GeographicBoundingBox",_68b);if(_68f){var _690=new esri.geometry.Extent(0,0,0,0,new esri.SpatialReference({wkid:4326}));_690.xmin=parseFloat(this._getTagValue("westBoundLongitude",_68f,0));_690.ymin=parseFloat(this._getTagValue("southBoundLatitude",_68f,0));_690.xmax=parseFloat(this._getTagValue("eastBoundLongitude",_68f,0));_690.ymax=parseFloat(this._getTagValue("northBoundLatitude",_68f,0));_68c.allExtents[0]=_690;}var _691=dojo.query("BoundingBox",_68b);if(_691.length===0){_68c.extent=_68c.allExtents[0];}else{var _692=(this.version=="1.3.0")?"CRS":"SRS";var bb,_693,wkid;for(var i=0;i<_691.length;i++){bb=_691[i];var tag=bb.parentNode.nodeName;if(tag!=="Layer"){continue;}var name="";var _694="";dojo.forEach(bb.parentNode.childNodes,function(_695){if(_695.nodeName=="Name"){name=(dojo.isIE?_695.text:_695.textContent)||"";}if(_695.nodeName=="Title"){_694=(dojo.isIE?_695.text:_695.textContent)||"";}},this);if(name!==_68c.name||_694!==_68c.title){continue;}_693=bb.getAttribute(_692);if(_693&&_693.indexOf("EPSG:")===0){wkid=parseInt(_693.substring(5));if(wkid==0){continue;}var _690;if(this.version=="1.3.0"){_690=this._getExtent(bb,wkid,this._useLatLong(wkid));}else{_690=this._getExtent(bb,wkid);}_68c.allExtents[wkid]=_690;if(!_68c.extent){_68c.extent=_690;}}else{if(_693&&_693.indexOf("CRS:")===0){wkid=parseInt(_693.substring(4));if(wkid==0){continue;}if(this._CRS_TO_EPSG[wkid]){wkid=this._CRS_TO_EPSG[wkid];}_68c.allExtents[wkid]=this._getExtent(bb,wkid);}else{wkid=parseInt(_693);_68c.allExtents[wkid]=this._getExtent(bb,wkid);}}}if(!_68c.extent){bb=_691[0];_693=bb.getAttribute(_692)[0];if(_693){if(_693.indexOf("CRS:")===0){wkid=parseInt(_693.substring(4));if(this._CRS_TO_EPSG[wkid]){wkid=this._CRS_TO_EPSG[wkid];}_68c.extent=_68c.allExtents[wkid];}else{wkid=parseInt(_693);_68c.extent=_68c.allExtents[wkid];}}}}if(!_68c.extent){_68c.extent=_68c.allExtents[0];}_68c.spatialReferences=[];var _696=(this.version=="1.3.0")?"CRS":"SRS";dojo.forEach(dojo.query(_696,_68b),function(crs){var _697;if(dojo.isIE){_697=crs.text;}else{_697=crs.textContent;}var arr=_697.split(" ");dojo.forEach(arr,function(val){if(val.indexOf(":")>-1){val=parseInt(val.split(":")[1]);}else{val=parseInt(val);}if(val!=84&&val!=0){if(!dojo.some(_68c.spatialReferences,function(el){return el==val;})){_68c.spatialReferences.push(val);}}});},this);var _698=this._getTag("Style",_68b);if(_698){var _699=this._getTag("LegendURL",_698);if(_699){var _69a=this._getTag("OnlineResource",_699);if(_69a){_68c.legendURL=_69a.getAttribute("xlink:href");}}}var _69b=dojo.query("Layer",_68b);var _69c="||";if(_69b.length>0){_68c.subLayers=[];dojo.forEach(_69b,function(_69d){var l=this._getLayerInfo(_69d);if(l.subLayers&&l.subLayers.length>0&&l.name===l.subLayers[0].name){l.name=null;}if(_69c.indexOf("||"+l.name+"||")==-1){_68c.subLayers.push(l);if(l.subLayers&&l.subLayers.length>0){dojo.forEach(l.subLayers,function(_69e){_69c+=_69e.name+"||";},this);}}},this);}}return _68c;},_getImageFormat:function(_69f){var _6a0=_69f?_69f.toLowerCase():"";switch(_6a0){case "jpg":return "image/jpeg";case "bmp":return "image/bmp";case "gif":return "image/gif";case "svg":return "image/svg+xml";default:return "image/png";}},_getExtent:function(_6a1,wkid,_6a2){var _6a3;if(_6a1){_6a3=new esri.geometry.Extent();var minx=parseFloat(_6a1.getAttribute("minx"));var miny=parseFloat(_6a1.getAttribute("miny"));var maxx=parseFloat(_6a1.getAttribute("maxx"));var maxy=parseFloat(_6a1.getAttribute("maxy"));if(_6a2){_6a3.xmin=isNaN(miny)?Number.MIN_VALUE:miny;_6a3.ymin=isNaN(minx)?Number.MIN_VALUE:minx;_6a3.xmax=isNaN(maxy)?Number.MAX_VALUE:maxy;_6a3.ymax=isNaN(maxx)?Number.MAX_VALUE:maxx;}else{_6a3.xmin=isNaN(minx)?Number.MIN_VALUE:minx;_6a3.ymin=isNaN(miny)?Number.MIN_VALUE:miny;_6a3.xmax=isNaN(maxx)?Number.MAX_VALUE:maxx;_6a3.ymax=isNaN(maxy)?Number.MAX_VALUE:maxy;}_6a3.spatialReference=new esri.SpatialReference({wkid:wkid});}return _6a3;},_useLatLong:function(wkid){var _6a4;for(var i=0;i<this._REVERSED_LAT_LONG_RANGES.length;i++){var _6a5=this._REVERSED_LAT_LONG_RANGES[i];if(wkid>=_6a5[0]&&wkid<=_6a5[1]){_6a4=true;break;}}return _6a4;},_getTag:function(_6a6,xml){var tags=dojo.query(_6a6,xml);if(tags&&tags.length>0){return tags[0];}else{return null;}},_getTagValue:function(_6a7,xml,_6a8){var _6a9=dojo.query(_6a7,xml);if(_6a9&&_6a9.length>0){if(dojo.isIE){return _6a9[0].text;}else{return _6a9[0].textContent;}}else{return _6a8;}},_getAttributeValue:function(_6aa,_6ab,xml,_6ac){var _6ad=dojo.query(_6aa,xml);if(_6ad&&_6ad.length>0){return _6ad[0].getAttribute(_6ab);}else{return _6ac;}},_checkVisibleLayersList:function(_6ae){if(_6ae&&_6ae.length>0&&this.layerInfos&&this.layerInfos.length>0){if((typeof _6ae[0])=="number"){var list=[];dojo.forEach(_6ae,function(pos){if(pos<this.layerInfos.length){list.push(this.layerInfos[pos].name);}},this);_6ae=list;}}return _6ae;}});dojo.declare("esri.layers.WMSLayerInfo",null,{name:null,title:null,description:null,extent:null,legendURL:null,subLayers:[],constructor:function(_6af){if(_6af){this.name=_6af.name;this.title=_6af.title;this.description=_6af.description;this.extent=_6af.extent;this.legendURL=_6af.legendURL;}}});}if(!dojo._hasResource["dojo.DeferredList"]){dojo._hasResource["dojo.DeferredList"]=true;dojo.provide("dojo.DeferredList");dojo.DeferredList=function(list,_6b0,_6b1,_6b2,_6b3){var _6b4=[];dojo.Deferred.call(this);var self=this;if(list.length===0&&!_6b0){this.resolve([0,[]]);}var _6b5=0;dojo.forEach(list,function(item,i){item.then(function(_6b6){if(_6b0){self.resolve([i,_6b6]);}else{_6b7(true,_6b6);}},function(_6b8){if(_6b1){self.reject(_6b8);}else{_6b7(false,_6b8);}if(_6b2){return null;}throw _6b8;});function _6b7(_6b9,_6ba){_6b4[i]=[_6b9,_6ba];_6b5++;if(_6b5===list.length){self.resolve(_6b4);}};});};dojo.DeferredList.prototype=new dojo.Deferred();dojo.DeferredList.prototype.gatherResults=function(_6bb){var d=new dojo.DeferredList(_6bb,false,true,false);d.addCallback(function(_6bc){var ret=[];dojo.forEach(_6bc,function(_6bd){ret.push(_6bd[1]);});return ret;});return d;};}if(!dojo._hasResource["esri.arcgis.utils"]){dojo._hasResource["esri.arcgis.utils"]=true;dojo.provide("esri.arcgis.utils");(function(){var EAU=esri.arcgis.utils;EAU.arcgisUrl="http://www.arcgis.com/sharing/content/items";EAU.getItem=function(_6be){if(EAU._arcgisUrl&&EAU._arcgisUrl.length>0){EAU.arcgisUrl=EAU._arcgisUrl;}var url=EAU.arcgisUrl+"/"+_6be;var _6bf={},_6c0=new dojo.Deferred();esri.request({url:url,content:{f:"json"},callbackParamName:"callback",load:function(_6c1){_6bf.item=_6c1;esri.request({url:url+"/data",content:{f:"json"},callbackParamName:"callback",load:function(_6c2){_6bf.itemData=_6c2;_6c0.callback(_6bf);},error:function(_6c3){_6c0.errback(_6c3);}});},error:function(_6c4){_6c0.errback(_6c4);}});return _6c0;};EAU.createMap=function(arg1,_6c5,_6c6){var _6c7=new dojo.Deferred();_6c6=_6c6||{};var _6c8=_6c6.infoTemplateClass;_6c6._clazz=(_6c8&&dojo.getObject(_6c8))||esri.dijit.PopupTemplate;if(dojo.isString(arg1)){EAU.getItem(arg1).addCallback(function(_6c9){EAU._getPopups(_6c9,_6c6).addCallback(function(_6ca){EAU._getLayers(_6ca.itemData,_6c6).addCallback(dojo.hitch(null,EAU._preCreateMap,_6ca,_6c5,_6c6,_6c7));});}).addErrback(dojo.hitch(_6c7,_6c7.errback));}else{EAU._getPopups(arg1,_6c6).addCallback(function(_6cb){EAU._getLayers(_6cb.itemData,_6c6).addCallback(dojo.hitch(null,EAU._preCreateMap,_6cb,_6c5,_6c6,_6c7));});}return _6c7;};EAU._arcgisUrl=null;EAU._getPopups=function(_6cc,_6cd){var _6ce=new dojo.Deferred();if(_6cd.ignorePopups){_6ce.callback(_6cc);return _6ce;}var _6cf=_6cc.itemData;var _6d0=[];var _6d1=[];dojo.forEach(_6cf.operationalLayers,function(_6d2){if(_6d2.itemId&&!_6d2.type&&!_6d2.layers&&_6d2.url.indexOf("/MapServer")>-1&&_6d2.url.indexOf("/MapServer/")===-1){_6d1.push(_6d2);_6d0.push(EAU._getItemData(_6d2));}});if(_6d0.length>0){var _6d3=new dojo.DeferredList(_6d0);_6d3.addCallback(function(_6d4){dojo.forEach(_6d1,function(_6d5,i){var _6d6=_6d0[i].ioArgs.json;if(_6d6&&_6d6.layers){_6d5.layers=_6d6.layers;}});_6ce.callback(_6cc);});}else{_6ce.callback(_6cc);}return _6ce;};EAU._getItemData=function(_6d7){var url=EAU.arcgisUrl+"/"+_6d7.itemId+"/data";var _6d8=esri.request({url:url,content:{f:"json"},callbackParamName:"callback"});return _6d8;};EAU._getLayers=function(_6d9,_6da){var _6db=[];var _6dc=[];var _6dd=[];var _6de=new dojo.Deferred();dojo.forEach(_6d9.operationalLayers,function(_6df,_6e0){if(_6df.featureCollection){dojo.forEach(_6df.featureCollection.layers,function(_6e1,idx){_6e1.opacity=_6df.opacity;_6e1.visibility=_6df.visibility;_6e1.id=(_6df.id?_6df.id:("operational"+_6e0))+"_"+idx;_6dd.push(_6e1);});}else{_6dd.push(_6df);}});dojo.forEach(_6d9.baseMap.baseMapLayers,function(_6e2,_6e3){_6e2.baseMapLayer=true;_6e2.id=_6e2.id?_6e2.id:"base"+_6e3;_6db.push(_6e2);});dojo.forEach(_6dd,function(_6e4,_6e5){_6e4.id=_6e4.id?_6e4.id:"operational"+_6e5;_6db.push(_6e4);});dojo.forEach(_6db,function(_6e6,i){if(_6e6.url&&!_6e6.type){_6e6.deferredsPos=_6dc.length;_6e6.errors=[];_6dc.push(EAU._getServiceInfo(_6e6.url,_6e6.errors));}else{_6e6.layerObject=EAU._initLayer(_6e6,_6db,_6da);}});var _6e7=new dojo.DeferredList(_6dc);_6e7.addCallback(function(_6e8){dojo.forEach(_6db,function(_6e9,_6ea){if(_6e9.url&&!_6e9.type){_6e9.resourceInfo=_6dc[_6e9.deferredsPos].ioArgs.json;if(_6ea===0||_6db[0].layerObject){_6e9.layerObject=EAU._initLayer(_6e9,_6db,_6da);}}});var _6eb=dojo.filter(_6db,function(lyr){return !lyr.isReference;});var _6ec=dojo.filter(_6db,function(lyr){return !!lyr.isReference;});_6db=_6eb.concat(_6ec);_6de.callback(_6db);});return _6de;};EAU._preCreateMap=function(_6ed,_6ee,_6ef,_6f0,_6f1){try{var _6f2=_6ef.mapOptions||{};var card=_6ed.item;var _6f3=[];dojo.forEach(_6f1,function(_6f4){if(dojo.isArray(_6f4.layerObject)){dojo.forEach(_6f4.layerObject,function(l){_6f3.push(l);});}else{_6f3.push(_6f4.layerObject);}});if(!_6f3[0]){_6f0.errback(new Error(esri.bundle.arcgis.utils.baseLayerError));return;}_6f3=dojo.filter(_6f3,esri._isDefined);if(card){if(card.extent){if(!_6f2.extent){var _6f5=new esri.geometry.Extent(card.extent[0][0],card.extent[0][1],card.extent[1][0],card.extent[1][1],new esri.SpatialReference({wkid:4326}));var _6f6=_6f3[0].spatialReference;if(_6f6.wkid===4326){_6f2.extent=_6f5;EAU._createMap(_6f3,_6f1,_6ed,_6ee,_6ef,_6f0);}else{if(_6f6.wkid===102100||_6f6.wkid===102113||_6f6.wkid===3857){_6f2.extent=esri.geometry.geographicToWebMercator(_6f5);EAU._createMap(_6f3,_6f1,_6ed,_6ee,_6ef,_6f0);}else{if(_6ef.geometryServiceURL||esri.config.defaults.geometryService){var gs;if(_6ef.geometryServiceURL){gs=new esri.tasks.GeometryService(_6ef.geometryServiceURL);}else{gs=esri.config.defaults.geometryService;}gs.project([_6f5],_6f6,function(_6f7){var _6f8=_6f7[0];_6f2.extent=_6f2.extent||_6f8;EAU._createMap(_6f3,_6f1,_6ed,_6ee,_6ef,_6f0);});}else{_6f0.errback(new Error(esri.bundle.arcgis.utils.geometryServiceError));}}}}else{EAU._createMap(_6f3,_6f1,_6ed,_6ee,_6ef,_6f0);}}else{EAU._createMap(_6f3,_6f1,_6ed,_6ee,_6ef,_6f0);}}else{EAU._createMap(_6f3,_6f1,_6ed,_6ee,_6ef,_6f0);}}catch(err){_6f0.errback(err);}};EAU._createMap=function(_6f9,_6fa,_6fb,_6fc,_6fd,_6fe){var _6ff=_6fd.mapOptions,_700,_701;if(!_6ff.infoWindow){_700=new esri.dijit.Popup(null,dojo.create("div"));_6ff.infoWindow=_700;}if(!esri._isDefined(_6ff.showInfoWindowOnClick)){_6ff.showInfoWindowOnClick=false;}var map=new esri.Map(_6fc,_6ff);dojo.connect(map,"onZoomEnd",EAU._onZoomEnd);if(_700){dojo.place(_700.domNode,map.root);}var _702=Math.floor(_6ff.extent.getWidth()/map.width);dojo.forEach(_6f9,function(_703){if(_703&&_703.declaredClass&&_703.declaredClass.indexOf("FeatureLayer")!==-1&&!_703.isEditable()){_703.setMaxAllowableOffset(_702);}});if(_6fd.ignorePopups){dojo.forEach(_6f9,function(_704){delete _704.infoTemplate;});}if(!(_6fd.ignorePopups||_6fd.disableClickBehavior)){_701=dojo.connect(map,"onClick",EAU._showPopup);}dojo.connect(map,"onLayersAddResult",EAU._onLayersAddResult);map.addLayers(_6f9);if(!_6fd.ignorePopups){EAU._addSelectionLayers(_6f9,_702,map,_6fd._clazz);}var _705=[];dojo.forEach(_6fa,function(_706){_705=_705.concat(_706.errors);},this);_6fe.callback({map:map,itemInfo:_6fb,errors:_705,clickEventHandle:_701,clickEventListener:EAU._showPopup});};EAU._addSelectionLayers=function(_707,_708,map,_709){var _70a=[];dojo.forEach(_707,function(_70b){var _70c=_70b.__popups;if(_70c&&_70c.length>1&&_70b.version>=10){_70b.__deferredsPos=_70a.length;_70a.push(EAU._getLayersInfo(_70b));}});var _70d=[];if(_70a.length>0){var _70e=new dojo.DeferredList(_70a);_70e.addCallback(function(_70f){dojo.forEach(_707,function(_710,_711){if(_710.__popups&&_710.__popups.length>0){if(_710.__deferredsPos||_710.__deferredsPos===0){var _712=_70a[_710.__deferredsPos].ioArgs.json;_70d=_70d.concat(EAU._createSelectionFeatureLayers(_710,_712.layers,_708,_709));delete _710.__deferredsPos;}else{_70d=_70d.concat(EAU._createSelectionFeatureLayers(_710,null,_708,_709));}}});map.addLayers(_70d);});}else{dojo.forEach(_707,function(_713,_714){if(_713.__popups&&_713.__popups.length>0){_70d=_70d.concat(EAU._createSelectionFeatureLayers(_713,null,_708,_709));}});map.addLayers(_70d);}};EAU._createSelectionFeatureLayers=function(_715,_716,_717,_718){var url=_715.url;var _719=_715.__popups;var ids=_715.__popupIds;var _71a=_715.__resourceInfo;var _71b=[];dojo.forEach(_719,function(_71c,_71d){var i,_71e=null;if(_716){for(i=0;i<_716.length;i++){if(_716[i].id===ids[_71d]){_71e=_716[i];break;}}}var _71f=new esri.layers.FeatureLayer(url+"/"+ids[_71d],{id:_715.id+"_"+ids[_71d],outFields:["*"],mode:esri.layers.FeatureLayer.MODE_SELECTION,infoTemplate:_71c&&new _718(_71c),drawMode:false,visible:_715.visible,resourceInfo:_71e,maxAllowableOffset:_717});dojo.connect(_71f,"onLoad",function(_720){EAU._updateLayerScaleInfo(_71a.layers,_720);});_71b.push(_71f);});delete _715.__popups;delete _715.__popupIds;delete _715.__resourceInfo;return _71b;};EAU._getServiceInfo=function(url,_721){return esri.request({url:url,content:{f:"json"},callbackParamName:"callback",error:function(_722,io){if(_722.message){_722.message+=" [url:"+url+"]";}else{_722.message="[url:"+url+"]";}_721.push(_722);esri.config.defaults.io.errorHandler(_722,io);}});};EAU._getLayersInfo=function(_723){return esri.request({url:_723.url+"/layers",content:{f:"json"},callbackParamName:"callback",error:function(_724,io){}});};EAU._initLayer=function(_725,_726,_727){var _728,_729=_727._clazz;if(_725.type==="OpenStreetMap"){_728=new esri.layers.OpenStreetMapLayer({id:_725.id});}else{if(_725.type==="WMS"){var _72a=[];var _72b=[];dojo.forEach(_725.layers,function(_72c){_72b.push(new esri.layers.WMSLayerInfo({name:_72c.name,title:_72c.title,legendURL:_72c.legendURL}));_72a.push(_72c.name);},this);if(_725.visibleLayers){_72a=_725.visibleLayers;}var _72d=new esri.geometry.Extent(_725.extent[0][0],_725.extent[0][1],_725.extent[1][0],_725.extent[1][1],new esri.SpatialReference({wkid:4326}));var _72e={extent:_72d,layerInfos:_72b,version:_725.version,maxWidth:_725.maxWidth,maxHeight:_725.maxHeight,getMapUrl:_725.mapUrl,spatialReferences:_725.spatialReferences,title:_725.title,copyright:_725.copyright};_728=new esri.layers.WMSLayer(_725.url,{id:_725.id,visibleLayers:_72a,format:"png",transparent:_725.baseMapLayer?false:true,opacity:_725.opacity,resourceInfo:_72e});}else{if(_725.type==="KML"){_728=new esri.layers.KMLLayer(_725.url,{id:_725.id});dojo.connect(_728,"onLoad",function(){if(_725.opacity!==null){var _72f=_728.getLayers();dojo.forEach(_72f,function(_730){if(_730.declaredClass=="esri.layers.FeatureLayer"||_730.declaredClass=="esri.layers.MapImageLayer"){_730.setOpacity(_725.opacity);}});}if(_725.visibleFolders){dojo.forEach(_728.folders,function(_731){if(dojo.indexOf(_725.visibleFolders,_731.id)>-1){_728.setFolderVisibility(_731,true);}else{_728.setFolderVisibility(_731,false);}},this);}});}else{if(_725.layerDefinition&&!_725.url){var _732=dojo.fromJson(dojo.toJson(_725));delete _732.id;delete _732.opacity;delete _732.visibility;_728=new esri.layers.FeatureLayer(_732,{id:_725.id,opacity:_725.opacity,visible:_725.visibility,outFields:["*"],infoTemplate:_732.popupInfo&&new _729(_732.popupInfo)});}else{if(_725.type==="BingMapsAerial"||_725.type==="BingMapsRoad"||_725.type==="BingMapsHybrid"){var _733=esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL_WITH_LABELS;if(_725.type==="BingMapsAerial"){_733=esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL;}else{if(_725.type==="BingMapsRoad"){_733=esri.virtualearth.VETiledLayer.MAP_STYLE_ROAD;}}_728=new esri.virtualearth.VETiledLayer({bingMapsKey:_727.bingMapsKey,mapStyle:_733,id:_725.id});}else{if(_725.resourceInfo&&_725.resourceInfo.mapName){if(_725.resourceInfo.singleFusedMapCache===true){if(!_725.baseMapLayer){if(EAU._sameSpatialReferenceAsBasemap(_725,_726)){if(EAU._sameTilingSchemeAsBasemap(_725,_726)){_728=EAU._loadAsCached(_725);}else{_728=EAU._loadAsDynamic(_725);}}else{_728=EAU._loadAsDynamic(_725);}}else{_728=EAU._loadAsCached(_725);}}else{_728=EAU._loadAsDynamic(_725);}}else{if(_725.resourceInfo&&_725.resourceInfo.pixelSizeX){var _734=new esri.layers.ImageServiceParameters();_734.bandIds=_725.bandIds;if(!_725.bandIds&&_725.resourceInfo.bandCount&&parseInt(_725.resourceInfo.bandCount,10)>3){_734.bandIds=[0,1,2];}_728=new esri.layers.ArcGISImageServiceLayer(_725.url,{resourceInfo:_725.resourceInfo,opacity:_725.opacity,visible:_725.visibility,id:_725.id,imageServiceParameters:_734});}else{if(_725.resourceInfo&&_725.resourceInfo.type==="Feature Layer"){_728=new esri.layers.FeatureLayer(_725.url,{resourceInfo:_725.resourceInfo,opacity:_725.opacity,visible:_725.visibility,id:_725.id,mode:esri._isDefined(_725.mode)?_725.mode:esri.layers.FeatureLayer.MODE_ONDEMAND,outFields:["*"],infoTemplate:_725.popupInfo&&new _729(_725.popupInfo)});if(_725.layerDefinition){if(_725.layerDefinition.drawingInfo&&_725.layerDefinition.drawingInfo.renderer){var _735=esri.renderer.fromJson(_725.layerDefinition.drawingInfo.renderer);_728.setRenderer(_735);}if(_725.layerDefinition.definitionExpression){_728.setDefinitionExpression(_725.layerDefinition.definitionExpression);}if(_725.layerDefinition.minScale!==null){_728.minScale=_725.layerDefinition.minScale;}if(_725.layerDefinition.maxScale!==null){_728.maxScale=_725.layerDefinition.maxScale;}}}}}}}}}}return _728;};EAU._loadAsCached=function(_736){var _737=[];if(!_736.displayLevels){_737=dojo.map(_736.resourceInfo.tileInfo.lods,function(lod){return lod.level;});}var _738=new esri.layers.ArcGISTiledMapServiceLayer(_736.url,{resourceInfo:_736.resourceInfo,opacity:_736.opacity,visible:_736.visibility,displayLevels:(_736.displayLevels)?_736.displayLevels:_737,id:_736.id});EAU._processPopups(_738,_736);return _738;};EAU._loadAsDynamic=function(_739){var _73a=new esri.layers.ImageParameters();_73a.format="png24";if(_739.resourceInfo&&_739.resourceInfo.supportedImageFormatTypes&&_739.resourceInfo.supportedImageFormatTypes.indexOf("PNG32")>-1){_73a.format="png32";}var _73b=new esri.layers.ArcGISDynamicMapServiceLayer(_739.url,{resourceInfo:_739.resourceInfo,opacity:_739.opacity,visible:_739.visibility,id:_739.id,imageParameters:_73a});if(!_739.visibleLayers){var _73c="";var _73d=_73b.layerInfos;dojo.forEach(_73d,function(_73e){if(_73e.defaultVisibility){_73c+=(_73c.length>0?",":"")+_73e.id;}});_739.visibleLayers=_73c;}var _73f=EAU._getVisibleFeatureLayers(_73b.layerInfos,_739.visibleLayers);_73b.setVisibleLayers(_73f);if(_739.layers&&_739.layers.length>0){var _740=[];dojo.forEach(_739.layers,function(_741){if(_741.layerDefinition&&_741.layerDefinition.definitionExpression){_740[_741.id]=_741.layerDefinition.definitionExpression;}},this);if(_740.length>0){_73b.setLayerDefinitions(_740);}}EAU._processPopups(_73b,_739);return _73b;};EAU._processPopups=function(_742,_743){var _744=_742.layerInfos;var _745=_743.layers;if(_745&&_744){var _746=[],ids=[];dojo.forEach(_744,function(_747){var id=_747.id,i;if(!_747.subLayerIds&&dojo.indexOf(_742.visibleLayers,id)!==-1){for(i=0;i<_745.length;i++){var _748=_745[i];if(_748.id===id){ids.push(id);_746.push(_748.popupInfo);break;}}}});if(_746.length){_742.__popups=_746;_742.__popupIds=ids;_742.__resourceInfo=_743.resourceInfo;}}};EAU._onZoomEnd=function(){var map=this;var _749=Math.floor(map.extent.getWidth()/map.width);dojo.forEach(map.graphicsLayerIds,function(id){var _74a=map.getLayer(id);if(_74a&&_74a.declaredClass==="esri.layers.FeatureLayer"&&!_74a.isEditable()){_74a.setMaxAllowableOffset(_749);}});};EAU._onLayersAddResult=function(_74b){dojo.forEach(_74b,function(_74c){var _74d=_74c.layer;if(_74d.toJson){var json=_74d.toJson();if(json.featureSet&&_74d.name.indexOf("Text")>-1){dojo.forEach(json.featureSet.features,function(_74e,idx){if(_74e.attributes.TEXT){var _74f=_74d.graphics[idx];_74f.symbol.setText(_74e.attributes.TEXT);if(_74e.symbol.horizontalAlignment){_74f.symbol.align=_74e.symbol.horizontalAlignment;}_74f.setSymbol(_74f.symbol);_74f.setAttributes(_74e.attributes);}},this);}}});};EAU._sameSpatialReferenceAsBasemap=function(_750,_751){var _752=[102113,102100,3857];var sp1=_751[0].layerObject.fullExtent.spatialReference;var sp2=new esri.SpatialReference(_750.resourceInfo.fullExtent.spatialReference);if(dojo.toJson(sp1.toJson())===dojo.toJson(sp2.toJson())){return true;}else{if(dojo.some(_752,function(wkid){return wkid===sp2.wkid;})&&dojo.some(_752,function(wkid){return wkid===sp1.wkid;})){return true;}}return false;};EAU._sameTilingSchemeAsBasemap=function(_753,_754){if(!_754[0].layerObject.tileInfo){return false;}var _755=[];dojo.forEach(_754,function(_756){if(_756.baseMapLayer){if(_756.layerObject.tileInfo){_755=_755.concat(dojo.map(_756.layerObject.tileInfo.lods,function(lod){return lod.scale;}));}}});var _757=dojo.some(_753.resourceInfo.tileInfo.lods,function(lod){return dojo.some(_755,function(_758){return _758===lod.scale;});});return _757;};EAU._showPopup=function(evt){var map=this,_759=map.infoWindow,_75a=evt.graphic;if(!map.loaded){return;}_759.hide();_759.clearFeatures();var _75b=[];dojo.forEach(map.graphicsLayerIds,function(_75c){var _75d=map.getLayer(_75c);if(_75d&&_75d.declaredClass.indexOf("FeatureLayer")!==-1&&_75d.loaded&&_75d.visible){_75d.clearSelection();if(_75d.infoTemplate&&!_75d._suspended){_75b.push(_75d);}}});_75a=(_75a&&_75a._getEffInfoTemplate())?_75a:null;if(!_75b.length&&!_75a){return;}var _75e=EAU._calculateClickTolerance(_75b);var _75f=evt.screenPoint,_760=map.toMap(new esri.geometry.Point(_75f.x-_75e,_75f.y+_75e)),_761=map.toMap(new esri.geometry.Point(_75f.x+_75e,_75f.y-_75e)),_762=new esri.geometry.Extent(_760.x,_760.y,_761.x,_761.y,map.spatialReference);var _763=new esri.tasks.Query();_763.geometry=_762;_763.timeExtent=map.timeExtent;var _764=dojo.map(_75b,function(_765){var dfd=_765.selectFeatures(_763);dfd.addCallback(function(){var _766=_765.getSelectedFeatures();return _766;});return dfd;});if(_75a){var dfd=new dojo.Deferred();dfd.callback([_75a]);_764.splice(0,0,dfd);}var _767=dojo.some(_764,function(dfd){return dfd.fired===-1;});if(!_767){var _768=_75a?1:0;dojo.forEach(_75b,function(_769){_768=_768+_769.getSelectedFeatures().length;});if(!_768){return;}}_759.setFeatures(_764);_759.show(evt.mapPoint);};EAU._calculateClickTolerance=function(_76a){var _76b=6;dojo.forEach(_76a,function(_76c){var _76d=_76c.renderer;if(_76d.declaredClass==="esri.renderer.SimpleRenderer"){var _76e=_76d.symbol;if(_76e.xoffset){_76b=Math.max(_76b,Math.abs(_76e.xoffset));}if(_76e.yoffset){_76b=Math.max(_76b,Math.abs(_76e.yoffset));}}else{if(_76d.declaredClass==="esri.renderer.UniqueValueRenderer"||_76d.declaredClass==="esri.renderer.ClassBreaksRenderer"){dojo.forEach(_76d.infos,function(info){var _76f=info.symbol;if(_76f.xoffset){_76b=Math.max(_76b,Math.abs(_76f.xoffset));}if(_76f.yoffset){_76b=Math.max(_76b,Math.abs(_76f.yoffset));}});}}});return _76b;};EAU._getVisibleFeatureLayers=function(_770,_771){if(!_770||!_771||_771.length===0){return [];}var _772=","+_771+",";var _773=[];var _774="";var k,_775=",";for(k=0;k<_770.length;k++){if(_770[k].subLayerIds!==null){if(_772.indexOf(","+_770[k].id+",")===-1||_775.indexOf(","+_770[k].id+",")>-1){_775+=_770[k].subLayerIds.toString()+",";}}else{if(_772.indexOf(","+_770[k].id+",")>-1&&_775.indexOf(","+_770[k].id+",")===-1){_773.push(_770[k].id);_774=",";}}}return _773;};EAU._updateLayerScaleInfo=function(_776,_777){if(_777.version<=10.1&&_776){var i,id=parseInt(_777.url.substring(_777.url.lastIndexOf("/")+1,_777.url.length));for(i=_776.length-1;i>=0;i--){if(_776[i].id==id){if(_777.minScale==0&&_776[i].minScale>0){_777.minScale=_776[i].minScale;}else{if(_777.minScale>0&&_776[i].minScale==0){_777.minScale=_777.minScale;}else{if(_777.minScale>0&&_776[i].minScale>0){_777.minScale=Math.min(_777.minScale,_776[i].minScale);}}}_777.maxScale=Math.max(_777.maxScale,_776[i].maxScale);if(_776[i].parentLayerId>-1){id=_776[i].parentLayerId;}else{break;}}}}};}());}
