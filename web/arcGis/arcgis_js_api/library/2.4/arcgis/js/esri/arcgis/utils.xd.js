/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

window[esri._dojoScopeName||"dojo"]._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","esri.layers.osm"],["provide","dojo.io.iframe"],["provide","esri.layers.FeatureLayer"],["provide","esri.layers.MapImageLayer"],["provide","esri.PopupBase"],["provide","dojox.charting.scaler.common"],["provide","dojox.charting.scaler.linear"],["provide","dojox.charting.axis2d.common"],["provide","dojox.charting.Element"],["provide","dojox.charting.axis2d.Base"],["provide","dojox.lang.functional.lambda"],["provide","dojox.lang.functional.array"],["provide","dojox.lang.functional.object"],["provide","dojox.lang.functional"],["provide","dojox.lang.utils"],["provide","dojox.charting.axis2d.Invisible"],["provide","dojo.colors"],["provide","dojox.charting.axis2d.Default"],["provide","dojox.charting.plot2d.common"],["provide","dojox.charting.scaler.primitive"],["provide","dojox.charting.plot2d._PlotEvents"],["provide","dojox.charting.plot2d.Base"],["provide","dojox.lang.functional.reversed"],["provide","dojox.gfx.fx"],["provide","dojox.charting.plot2d.Default"],["provide","dojox.charting.plot2d.Lines"],["provide","dojox.charting.plot2d.Areas"],["provide","dojox.charting.plot2d.Markers"],["provide","dojox.charting.plot2d.MarkersOnly"],["provide","dojox.gfx.gradutils"],["provide","dojox.charting.plot2d.Scatter"],["provide","dojox.lang.functional.sequence"],["provide","dojox.charting.plot2d.Stacked"],["provide","dojox.charting.plot2d.StackedLines"],["provide","dojox.charting.plot2d.StackedAreas"],["provide","dojox.charting.plot2d.Columns"],["provide","dojox.charting.plot2d.StackedColumns"],["provide","dojox.charting.plot2d.ClusteredColumns"],["provide","dojox.charting.plot2d.Bars"],["provide","dojox.charting.plot2d.StackedBars"],["provide","dojox.charting.plot2d.ClusteredBars"],["provide","dojox.charting.plot2d.Grid"],["provide","dojox.charting.plot2d.Pie"],["provide","dojox.charting.plot2d.Bubble"],["provide","dojox.charting.plot2d.Candlesticks"],["provide","dojox.charting.plot2d.OHLC"],["provide","dojo.fx.easing"],["provide","dojox.charting.plot2d.Spider"],["provide","dojox.lang.functional.fold"],["provide","dojox.color._base"],["provide","dojox.color"],["provide","dojox.color.Palette"],["provide","dojox.charting.Theme"],["provide","dojox.charting.Series"],["provide","dojox.charting.Chart"],["provide","dojox.charting.Chart2D"],["provide","dojox.charting.themes.PlotKit.base"],["provide","dijit.Tooltip"],["provide","dojox.charting.action2d.Base"],["provide","dojox.lang.functional.scan"],["provide","dojox.charting.action2d.Tooltip"],["provide","esri.dijit.Popup"],["provide","esri.layers.KMLLayer"],["provide","esri.layers.wms"],["provide","dojo.DeferredList"],["provide","esri.arcgis.utils"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["esri.layers.osm"]){_4._hasResource["esri.layers.osm"]=true;_4.provide("esri.layers.osm");_4.declare("esri.layers.OpenStreetMapLayer",esri.layers.TiledMapServiceLayer,{constructor:function(_7){this.spatialReference=new esri.SpatialReference({wkid:102100});this.tileInfo=new esri.layers.TileInfo({rows:256,cols:256,dpi:96,format:"PNG8",compressionQuality:0,origin:{x:-20037508.342787,y:20037508.342787},spatialReference:{wkid:102100},lods:[{level:0,scale:591657527.591555,resolution:156543.033928},{level:1,scale:295828763.795777,resolution:78271.5169639999},{level:2,scale:147914381.897889,resolution:39135.7584820001},{level:3,scale:73957190.948944,resolution:19567.8792409999},{level:4,scale:36978595.474472,resolution:9783.93962049996},{level:5,scale:18489297.737236,resolution:4891.96981024998},{level:6,scale:9244648.868618,resolution:2445.98490512499},{level:7,scale:4622324.434309,resolution:1222.99245256249},{level:8,scale:2311162.217155,resolution:611.49622628138},{level:9,scale:1155581.108577,resolution:305.748113140558},{level:10,scale:577790.554289,resolution:152.874056570411},{level:11,scale:288895.277144,resolution:76.4370282850732},{level:12,scale:144447.638572,resolution:38.2185141425366},{level:13,scale:72223.819286,resolution:19.1092570712683},{level:14,scale:36111.909643,resolution:9.55462853563415},{level:15,scale:18055.954822,resolution:4.77731426794937},{level:16,scale:9027.977411,resolution:2.38865713397468},{level:17,scale:4513.988705,resolution:1.19432856685505},{level:18,scale:2256.994353,resolution:0.597164283559817}]});this.fullExtent=new esri.geometry.Extent({xmin:-20037508.34,ymin:-20037508.34,xmax:20037508.34,ymax:20037508.34,spatialReference:{wkid:102100}});this.initialExtent=new esri.geometry.Extent({xmin:-20037508.34,ymin:-20037508.34,xmax:20037508.34,ymax:20037508.34,spatialReference:{wkid:102100}});this.tileServers=(_7&&_7.tileServers)||["http://a.tile.openstreetmap.org/","http://b.tile.openstreetmap.org/","http://c.tile.openstreetmap.org/"];this.serversLength=this.tileServers.length;this.serverIndex=0;this._displayLevels=_7?_7.displayLevels:null;this.loaded=true;this.onLoad(this);var _8=_7&&_7.loadCallback;if(_8){_8(this);}},getTileUrl:function(_9,_a,_b){return esri._getProxiedUrl(this.tileServers[this.serverIndex++%this.serversLength]+"/"+_9+"/"+_b+"/"+_a+".png");}});}if(!_4._hasResource["dojo.io.iframe"]){_4._hasResource["dojo.io.iframe"]=true;_4.provide("dojo.io.iframe");_4.getObject("io",true,_4);_4.io.iframe={create:function(_c,_d,_e){if(window[_c]){return window[_c];}if(window.frames[_c]){return window.frames[_c];}var _f=null;var _10=_e;if(!_10){if(_4.config["useXDomain"]&&!_4.config["dojoBlankHtmlUrl"]){console.warn("dojo.io.iframe.create: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");}_10=(_4.config["dojoBlankHtmlUrl"]||_4.moduleUrl("dojo","resources/blank.html"));}var _f=_4.place("<iframe id=\""+_c+"\" name=\""+_c+"\" src=\""+_10+"\" onload=\""+_d+"\" style=\"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden\">",_4.body());window[_c]=_f;return _f;},setSrc:function(_11,src,_12){try{if(!_12){if(_4.isWebKit){_11.location=src;}else{frames[_11.name].location=src;}}else{var _13;if(_4.isIE||_4.isWebKit){_13=_11.contentWindow.document;}else{_13=_11.contentWindow;}if(!_13){_11.location=src;return;}else{_13.location.replace(src);}}}catch(e){console.log("dojo.io.iframe.setSrc: ",e);}},doc:function(_14){var doc=_14.contentDocument||(((_14.name)&&(_14.document)&&(_4.doc.getElementsByTagName("iframe")[_14.name].contentWindow)&&(_4.doc.getElementsByTagName("iframe")[_14.name].contentWindow.document)))||((_14.name)&&(_4.doc.frames[_14.name])&&(_4.doc.frames[_14.name].document))||null;return doc;},send:function(_15){if(!this["_frame"]){this._frame=this.create(this._iframeName,_4._scopeName+".io.iframe._iframeOnload();");}var dfd=_4._ioSetArgs(_15,function(dfd){dfd.canceled=true;dfd.ioArgs._callNext();},function(dfd){var _16=null;try{var _17=dfd.ioArgs;var dii=_4.io.iframe;var ifd=dii.doc(dii._frame);var _18=_17.handleAs;_16=ifd;if(_18!="html"){if(_18=="xml"){if(_4.isIE<9||(_4.isIE&&_4.isQuirks)){_4.query("a",dii._frame.contentWindow.document.documentElement).orphan();var _19=(dii._frame.contentWindow.document).documentElement.innerText;_19=_19.replace(/>\s+</g,"><");_19=_4.trim(_19);var _1a={responseText:_19};_16=_4._contentHandlers["xml"](_1a);}}else{_16=ifd.getElementsByTagName("textarea")[0].value;if(_18=="json"){_16=_4.fromJson(_16);}else{if(_18=="javascript"){_16=_4.eval(_16);}}}}}catch(e){_16=e;}finally{_17._callNext();}return _16;},function(_1b,dfd){dfd.ioArgs._hasError=true;dfd.ioArgs._callNext();return _1b;});dfd.ioArgs._callNext=function(){if(!this["_calledNext"]){this._calledNext=true;_4.io.iframe._currentDfd=null;_4.io.iframe._fireNextRequest();}};this._dfdQueue.push(dfd);this._fireNextRequest();_4._ioWatch(dfd,function(dfd){return !dfd.ioArgs["_hasError"];},function(dfd){return (!!dfd.ioArgs["_finished"]);},function(dfd){if(dfd.ioArgs._finished){dfd.callback(dfd);}else{dfd.errback(new Error("Invalid dojo.io.iframe request state"));}});return dfd;},_currentDfd:null,_dfdQueue:[],_iframeName:_4._scopeName+"IoIframe",_fireNextRequest:function(){try{if((this._currentDfd)||(this._dfdQueue.length==0)){return;}do{var dfd=this._currentDfd=this._dfdQueue.shift();}while(dfd&&dfd.canceled&&this._dfdQueue.length);if(!dfd||dfd.canceled){this._currentDfd=null;return;}var _1c=dfd.ioArgs;var _1d=_1c.args;_1c._contentToClean=[];var fn=_4.byId(_1d["form"]);var _1e=_1d["content"]||{};if(fn){if(_1e){var _1f=function(_20,_21){_4.create("input",{type:"hidden",name:_20,value:_21},fn);_1c._contentToClean.push(_20);};for(var x in _1e){var val=_1e[x];if(_4.isArray(val)&&val.length>1){var i;for(i=0;i<val.length;i++){_1f(x,val[i]);}}else{if(!fn[x]){_1f(x,val);}else{fn[x].value=val;}}}}var _22=fn.getAttributeNode("action");var _23=fn.getAttributeNode("method");var _24=fn.getAttributeNode("target");if(_1d["url"]){_1c._originalAction=_22?_22.value:null;if(_22){_22.value=_1d.url;}else{fn.setAttribute("action",_1d.url);}}if(!_23||!_23.value){if(_23){_23.value=(_1d["method"])?_1d["method"]:"post";}else{fn.setAttribute("method",(_1d["method"])?_1d["method"]:"post");}}_1c._originalTarget=_24?_24.value:null;if(_24){_24.value=this._iframeName;}else{fn.setAttribute("target",this._iframeName);}fn.target=this._iframeName;_4._ioNotifyStart(dfd);fn.submit();}else{var _25=_1d.url+(_1d.url.indexOf("?")>-1?"&":"?")+_1c.query;_4._ioNotifyStart(dfd);this.setSrc(this._frame,_25,true);}}catch(e){dfd.errback(e);}},_iframeOnload:function(){var dfd=this._currentDfd;if(!dfd){this._fireNextRequest();return;}var _26=dfd.ioArgs;var _27=_26.args;var _28=_4.byId(_27.form);if(_28){var _29=_26._contentToClean;for(var i=0;i<_29.length;i++){var key=_29[i];for(var j=0;j<_28.childNodes.length;j++){var _2a=_28.childNodes[j];if(_2a.name==key){_4.destroy(_2a);break;}}}if(_26["_originalAction"]){_28.setAttribute("action",_26._originalAction);}if(_26["_originalTarget"]){_28.setAttribute("target",_26._originalTarget);_28.target=_26._originalTarget;}}_26._finished=true;}};}if(!_4._hasResource["esri.layers.FeatureLayer"]){_4._hasResource["esri.layers.FeatureLayer"]=true;_4.provide("esri.layers.FeatureLayer");_4.declare("esri.layers.FeatureLayer",esri.layers.GraphicsLayer,{constructor:function(url,_2b){this._outFields=_2b&&_2b.outFields;this._loadCallback=_2b&&_2b.loadCallback;var _2c=_2b&&_2b._usePatch;this._usePatch=(_2c===null||_2c===undefined)?true:_2c;this._trackIdField=_2b&&_2b.trackIdField;this.objectIdField=_2b&&_2b.objectIdField;this._maxOffset=_2b&&_2b.maxAllowableOffset;this._optEditable=_2b&&_2b.editable;this.useMapTime=(_2b&&_2b.hasOwnProperty("useMapTime"))?(!!_2b.useMapTime):true;this._selectedFeatures={};this._selectedFeaturesArr=[];this._newFeatures=[];this._deletedFeatures={};this._ulid=this._getUniqueId();var _2d=this.constructor,_2e=this.mode=(esri._isDefined(_2b&&_2b.mode)?_2b.mode:_2d.MODE_ONDEMAND);switch(_2e){case _2d.MODE_SNAPSHOT:this._mode=new esri.layers._SnapshotMode(this);this._isSnapshot=true;break;case _2d.MODE_ONDEMAND:this._tileWidth=(_2b&&_2b.tileWidth)||512;this._tileHeight=(_2b&&_2b.tileHeight)||512;this._mode=new esri.layers._OnDemandMode(this);break;case _2d.MODE_SELECTION:this._mode=new esri.layers._SelectionMode(this);this._isSelOnly=true;break;}this._initLayer=_4.hitch(this,this._initLayer);this._selectHandler=_4.hitch(this,this._selectHandler);if(_4.isObject(url)&&url.layerDefinition){var _2f=url;this._collection=true;this._editable=true;this.mode=_2d.MODE_SNAPSHOT;this._initLayer(_2f);return this;}this._task=new esri.tasks.QueryTask(this.url);var _30=this._url.path;this._editable=this._fserver=false;if(_30.search(/\/FeatureServer\//i)!==-1){this._fserver=true;}var _31=_2b&&_2b.resourceInfo;if(_31){this._initLayer(_31);}else{esri.request({url:_30,content:_4.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});}},_initLayer:function(_32,io){if(_32||io){this._json=_32;if(this._collection){this._mode=new esri.layers._SnapshotMode(this);this._isSnapshot=true;this._featureSet=_32.featureSet;this._nextId=_32.nextObjectId;_32=_32.layerDefinition;}else{if(_32.hasOwnProperty("capabilities")){var _33=(this.capabilities=_32.capabilities);if(_33&&_33.toLowerCase().indexOf("editing")!==-1){this._editable=true;}}else{this._editable=this._fserver;}}if(esri._isDefined(this._optEditable)){this._editable=this._optEditable;delete this._optEditable;}this._json=_4.toJson(this._json);if(this._editable){delete this._maxOffset;}this.minScale=_32.minScale||0;this.maxScale=_32.maxScale||0;this.layerId=_32.id;this.name=_32.name;this.description=_32.description;this.copyright=_32.copyrightText;this.type=_32.type;this.geometryType=_32.geometryType;this.displayField=_32.displayField;this.defaultDefinitionExpression=_32.definitionExpression;this.fullExtent=new esri.geometry.Extent(_32.extent);this._isTable=(this.type==="Table");var _34=this.fields=[];var _35=_32.fields;for(var i=0;i<_35.length;i++){_34.push(new esri.layers.Field(_35[i]));}if(!this.objectIdField){this.objectIdField=_32.objectIdField;if(!this.objectIdField){var _35=_32.fields;for(var i=0;i<_35.length;i++){var _36=_35[i];if(_36.type==="esriFieldTypeOID"){this.objectIdField=_36.name;break;}}}if(!this.objectIdField){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url},esri.bundle.layers.FeatureLayer.noOIDField));}}if(!esri._isDefined(this._nextId)){var _37=this.objectIdField,_38=-1;if(this._collection&&_37){var _39=this._featureSet,_3a=_39&&_39.features,i,il,oid,_3b;for(i=0,il=_3a?_3a.length:0;i<il;i++){_3b=_3a[i].attributes;oid=_3b&&_3b[_37];if(oid>_38){_38=oid;}}}this._nextId=(_38+1);}this.globalIdField=_32.globalIdField;this.typeIdField=_32.typeIdField;this.visibilityField=_32.visibilityField;var _3c=_32.defaultSymbol;if(_3c){this.defaultSymbol=esri.symbol.fromJson(_3c);}var _3d=this.types=[];var _3e=_32.types;if(_3e){for(var i=0;i<_3e.length;i++){_3d.push(new esri.layers.FeatureType(_3e[i]));}}var _3f=_32.templates;var _40=this.templates=[];if(_3f){for(var i=0;i<_3f.length;i++){_40.push(new esri.layers.FeatureTemplate(_3f[i]));}}var _41=_32.timeInfo;if(_41){this.timeInfo=new esri.layers.TimeInfo(_41);this._startTimeField=_41.startTimeField;this._endTimeField=_41.endTimeField;if(this._startTimeField&&this._endTimeField){this._twoTimeFields=true;}if(this._trackIdField){_41.trackIdField=this._trackIdField;}else{this._trackIdField=_41.trackIdField;}}this.relationships=_32.relationships;this.hasAttachments=(!this._collection&&_32.hasAttachments)?true:false;this.htmlPopupType=_32.htmlPopupType;var _42=_32.drawingInfo;if(!this.renderer){if(_42&&_42.renderer){var _43=_42.renderer;this.setRenderer(esri.renderer.fromJson(_43));if(_43.type==="classBreaks"){this.renderer._setMaxInclusiveness(true);}if(!this._collection){var _44=_43.type,_43=this.renderer,_45=[];switch(_44){case "simple":_45.push(_43.symbol);break;case "uniqueValue":case "classBreaks":_45.push(_43.defaultSymbol);_45=_45.concat(_4.map(_43.infos,function(_46){return _46.symbol;}));break;}_45=_4.filter(_45,esri._isDefined);var _47=this._url.path+"/images/",_48=this._getToken();_4.forEach(_45,function(sym){var url=sym.url;if(url){if((url.search(/https?\:/)===-1)&&(url.indexOf("data:")===-1)){sym.url=_47+url;}if(_48&&sym.url.search(/https?\:/)!==-1){sym.url+=("?token="+_48);}}});}}else{if(_3c){var _3e=this.types,_43;if(_3e.length>0){_43=new esri.renderer.UniqueValueRenderer(this.defaultSymbol,this.typeIdField);_4.forEach(_3e,function(_49){_43.addValue(_49.id,_49.symbol);});}else{_43=new esri.renderer.SimpleRenderer(this.defaultSymbol);}this.setRenderer(_43);}else{if(!this._isTable){var _4a;switch(this.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":_4a=new esri.symbol.SimpleMarkerSymbol();break;case "esriGeometryPolyline":_4a=new esri.symbol.SimpleLineSymbol();break;case "esriGeometryPolygon":_4a=new esri.symbol.SimpleFillSymbol();break;}this.setRenderer(_4a?new esri.renderer.SimpleRenderer(_4a):null);}}}}var _4b=(_42&&_42.transparency)||0;if(!esri._isDefined(this.opacity)&&_4b>0){this.opacity=1-(_4b/100);}this.version=_32.currentVersion;if(!this.version){var ver;if("capabilities" in _32||"drawingInfo" in _32||"hasAttachments" in _32||"htmlPopupType" in _32||"relationships" in _32||"timeInfo" in _32||"typeIdField" in _32||"types" in _32){ver=10;}else{ver=9.3;}this.version=ver;}if((_4.isIE||_4.isSafari)&&this._editable&&this.version<10.02){this._ts=true;}this.loaded=true;this._fixRendererFields();this._checkFields();if(this._collection){this._fireUpdateStart();var _39=this._featureSet;delete this._featureSet;this._mode._drawFeatures(new esri.tasks.FeatureSet(_39));this._fcAdded=true;}this.onLoad(this);var _4c=this._loadCallback;if(_4c){delete this._loadCallback;_4c(this);}}},setRenderer:function(ren){this.inherited("setRenderer",arguments);var _4d=this.renderer;if(_4d){this._ager=(_4d.declaredClass.indexOf("TemporalRenderer")!==-1&&_4d.observationAger&&_4d.observationRenderer);var _4e=_4.filter([_4d,_4d.observationRenderer,_4d.latestObservationRenderer,_4d.trackRenderer],esri._isDefined);var _4f=[];_4.forEach(_4e,function(rnd){_4f.push(rnd.attributeField);_4f.push(rnd.attributeField2);_4f.push(rnd.attributeField3);},this);this._rendererFields=_4.filter(_4f,esri._isDefined);}else{this._ager=false;this._rendererFields=[];}if(this.loaded&&this._rendererFields.length>0){this._fixRendererFields();this._checkFields(this._rendererFields);}if(this.loaded&&this._collection){this._typesDirty=true;}},_setMap:function(map,_50){this._map=map;this._toggleTime(true);var div=this.inherited("_setMap",arguments);this.clearSelection();var _51=this.renderer;if(this.timeInfo){if(this._trackIdField||(_51&&(_51.latestObservationRenderer||_51.trackRenderer))){this._trackManager=new esri.layers._TrackManager(this);this._trackManager.initialize(map);}}if(this.minScale!==0||this.maxScale!==0){this._zoomConnect=_4.connect(map,"onZoomEnd",this,this._updateStatus);}var _52=this._mode;if(_52){_52.initialize(map);}return div;},_unsetMap:function(map,_53){var _54=this._mode;if(_54){_54.destroy();this._mode=null;}if(this._trackManager){this._trackManager.destroy();this._trackManager=null;}_4.disconnect(this._zoomConnect);this._toggleTime(false);this.inherited("_unsetMap",arguments);},refresh:function(){var _55=this._mode;if(_55){_55.refresh();}},isEditable:function(){return this._editable;},setMaxAllowableOffset:function(_56){if(!this._editable){this._maxOffset=_56;}return this;},setDefinitionExpression:function(_57){this._defnExpr=_57;var _58=this._mode;if(_58){_58.propertyChangeHandler(1);}return this;},getDefinitionExpression:function(){return this._defnExpr;},setTimeDefinition:function(_59){if(this._isSnapshot){this._timeDefn=_59;var _5a=this._mode;if(_5a){_5a.propertyChangeHandler(2);}}return this;},getTimeDefinition:function(){return this._timeDefn;},setTimeOffset:function(_5b,_5c){this._timeOffset=_5b;this._timeOffsetUnits=_5c;var _5d=this._mode;if(_5d){_5d.propertyChangeHandler(0);}return this;},setUseMapTime:function(use){this.useMapTime=use;this._toggleTime(!this._suspended);var _5e=this._mode;if(_5e){_5e.propertyChangeHandler(0);}},selectFeatures:function(_5f,_60,_61,_62){_60=_60||this.constructor.SELECTION_NEW;var _63=this._getShallowClone(_5f),map=this._map,dfd=esri._fixDfd(new _4.Deferred(esri._dfdCanceller));_63.outFields=this._getOutFields();_63.returnGeometry=true;if(map){_63.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());}if(!this._applyQueryFilters(_63)){var _64={features:[]};this._selectHandler(_64,_60,_61,_62,dfd);return dfd;}var _65=this._canDoClientSideQuery(_63);if(_65){var _64={features:this._doQuery(_63,_65)};this._selectHandler(_64,_60,_61,_62,dfd);return dfd;}else{if(this._collection){var err=new Error("FeatureLayer::selectFeatures - "+esri.bundle.layers.FeatureLayer.invalidParams);this._resolve([err],null,_62,dfd,true);return dfd;}var _66=this;if(this._ts){_63._ts=(new Date()).getTime();}var _67=dfd._pendingDfd=this._task.execute(_63);_67.addCallbacks(function(_68){_66._selectHandler(_68,_60,_61,_62,dfd);},function(err){_66._resolve([err],null,_62,dfd,true);});return dfd;}},getSelectedFeatures:function(){var _69=this._selectedFeatures,_6a=[];for(var _6b in _69){if(_69.hasOwnProperty(_6b)){_6a.push(_69[_6b]);}}return _6a;},clearSelection:function(_6c){var _6d=this._selectedFeatures,_6e=this._mode;for(var _6f in _6d){if(_6d.hasOwnProperty(_6f)){this._unSelectFeatureIIf(_6f,_6e);_6e._removeFeatureIIf(_6f);}}this._selectedFeatures={};if(this._isSelOnly){_6e._applyTimeFilter(true);}if(!_6c){this.onSelectionClear();}return this;},setSelectionSymbol:function(_70){this._selectionSymbol=_70;if(_70){var _71=this._selectedFeatures;for(var _72 in _71){if(_71.hasOwnProperty(_72)){_71[_72].setSymbol(_70);}}}return this;},getSelectionSymbol:function(){return this._selectionSymbol;},__msigns:[{n:"applyEdits",c:5,a:[{i:0},{i:1}],e:4,f:1}],applyEdits:function(_73,_74,_75,_76,_77,_78){var _79=_78.assembly,dfd=_78.dfd;this._applyNormalized(_73,_79&&_79[0]);this._applyNormalized(_74,_79&&_79[1]);this.onBeforeApplyEdits(_73,_74,_75);var _7a={},_7b=this.objectIdField,_7c={f:"json"},_7d=false;if(this._collection){var _7e={};_7e.addResults=_73?_4.map(_73,function(){_7d=true;return {objectId:this._nextId++,success:true};},this):null;_7e.updateResults=_74?_4.map(_74,function(_7f){_7d=true;var oid=_7f.attributes[_7b];_7a[oid]=_7f;return {objectId:oid,success:true};},this):null;_7e.deleteResults=_75?_4.map(_75,function(_80){_7d=true;return {objectId:_80.attributes[_7b],success:true};},this):null;if(_7d){this._editHandler(_7e,_73,_7a,_76,_77,dfd);}return;}if(_73&&_73.length>0){_7c.adds=this._convertFeaturesToJson(_73);_7d=true;}if(_74&&_74.length>0){for(var i=0;i<_74.length;i++){var _81=_74[i];_7a[_81.attributes[_7b]]=_81;}_7c.updates=this._convertFeaturesToJson(_74);_7d=true;}if(_75&&_75.length>0){var ids=[];for(var i=0;i<_75.length;i++){ids.push(_75[i].attributes[_7b]);}_7c.deletes=ids.join(",");_7d=true;}if(_7d){var _82=this;return esri.request({url:this._url.path+"/applyEdits",content:_4.mixin(_7c,this._url.query),callbackParamName:"callback",load:function(_83){_82._editHandler(_83,_73,_7a,_76,_77,dfd);},error:function(err){_82._resolve([err],null,_77,dfd,true);}},{usePost:true});}},queryFeatures:function(_84,_85,_86){return this._query("execute","onQueryFeaturesComplete",_84,_85,_86);},queryRelatedFeatures:function(_87,_88,_89){return this._query("executeRelationshipQuery","onQueryRelatedFeaturesComplete",_87,_88,_89);},queryIds:function(_8a,_8b,_8c){return this._query("executeForIds","onQueryIdsComplete",_8a,_8b,_8c);},queryCount:function(_8d,_8e,_8f){return this._query("executeForCount","onQueryCountComplete",_8d,_8e,_8f);},queryAttachmentInfos:function(_90,_91,_92){var url=this._url.path+"/"+_90+"/attachments",dfd=new _4.Deferred(esri._dfdCanceller),_93=this;dfd._pendingDfd=esri.request({url:url,content:_4.mixin({f:"json"},this._url.query),callbackParamName:"callback",load:function(_94){var _95=_94.attachmentInfos;_4.forEach(_95,function(_96){_96.url=url+"/"+_96.id;_96.objectId=_90;});_93._resolve([_95],"onQueryAttachmentInfosComplete",_91,dfd);},error:function(err){_93._resolve([err],null,_92,dfd,true);}});return dfd;},addAttachment:function(_97,_98,_99,_9a){return this._sendAttachment("add",_97,_98,_99,_9a);},updateAttachment:function(_9b,_9c,_9d,_9e,_9f){_9d.appendChild(_4.create("input",{type:"hidden",name:"attachmentId",value:_9c}));return this._sendAttachment("update",_9b,_9d,_9e,_9f);},deleteAttachments:function(_a0,_a1,_a2,_a3){var url=this._url.path+"/"+_a0+"/deleteAttachments",dfd=new _4.Deferred(esri._dfdCanceller),_a4=this,_a5={f:"json",attachmentIds:_a1.join(",")};dfd._pendingDfd=esri.request({url:url,content:_4.mixin(_a5,this._url.query),callbackParamName:"callback",load:_4.hitch(this,function(_a6){var _a7=_a6.deleteAttachmentResults;_a7=_4.map(_a7,function(_a8){var res=new esri.layers.FeatureEditResult(_a8);res.attachmentId=res.objectId;res.objectId=_a0;return res;});_a4._resolve([_a7],"onDeleteAttachmentsComplete",_a2,dfd);}),error:function(err){_a4._resolve([err],null,_a3,dfd,true);}},{usePost:true});return dfd;},addType:function(_a9){if(!this._collection){return false;}var _aa=this.types;if(_aa){var _ab=_4.some(_aa,function(_ac,_ad){if(_ac.id==_a9.id){return true;}return false;});if(_ab){return false;}else{_aa.push(_a9);}}else{this.types=[_a9];}this._typesDirty=true;return true;},deleteType:function(_ae){if(!this._collection){return;}var _af=this.types;if(_af){var _b0=-1;_4.some(_af,function(_b1,_b2){if(_b1.id==_ae){_b0=_b2;return true;}return false;});if(_b0>-1){this._typesDirty=true;return _af.splice(_b0,1)[0];}}},toJson:function(){var _b3=this._json,_b4=_4.isString(_b3)?_4.fromJson(_b3):_4.clone(_b3);if(!_b4){return;}_b4=_b4.layerDefinition?_b4:{layerDefinition:_b4};var _b5=_b4.layerDefinition,_b6=this._collection;if(_b6&&this._typesDirty){_b5.types=_4.map(this.types||[],function(_b7){return _b7.toJson();});var _b8=this.renderer,_b9=_b5.drawingInfo;if(_b9&&_b8&&_b8.declaredClass.indexOf("TemporalRenderer")===-1){_b9.renderer=_b8.toJson();}}var _ba=null;if(!(_b6&&!this._fcAdded)){_ba={geometryType:_b5.geometryType,features:this._convertFeaturesToJson(this.graphics,true)};}_b4.featureSet=_4.mixin({},_b4.featureSet||{},_ba);if(_b6){_b4.nextObjectId=this._nextId;}return _b4;},onSelectionComplete:function(){},onSelectionClear:function(){},onBeforeApplyEdits:function(){},onEditsComplete:function(){},onQueryFeaturesComplete:function(){},onQueryRelatedFeaturesComplete:function(){},onQueryIdsComplete:function(){},onQueryCountComplete:function(){},onQueryAttachmentInfosComplete:function(){},onAddAttachmentComplete:function(){},onUpdateAttachmentComplete:function(){},onDeleteAttachmentsComplete:function(){},_counter:{value:0},_getUniqueId:function(){return this._counter.value++;},_getDesiredStatus:function(){return this.visible&&this._isMapAtVisibleScale();},_isMapAtVisibleScale:function(){var _bb=esri.geometry.getScale(this._map);var _bc=this.minScale,_bd=this.maxScale,_be=!_bc,_bf=!_bd;if(!_be&&_bb<=_bc){_be=true;}if(!_bf&&_bb>=_bd){_bf=true;}return (_be&&_bf)?true:false;},_suspend:function(){this.inherited("_suspend",arguments);this._toggleTime(false);var _c0=this._mode;if(_c0){_c0.suspend();}},_resume:function(){this.inherited("_resume",arguments);this._toggleTime(true);var _c1=this._mode;if(_c1){_c1.resume();}},_toggleTime:function(_c2){var map=this._map;if(_c2&&this.timeInfo&&this.useMapTime&&map){this._mapTimeExtent=map.timeExtent;if(!this._timeConnect){this._timeConnect=_4.connect(map,"onTimeExtentChange",this,this._timeChangeHandler);}}else{this._mapTimeExtent=null;_4.disconnect(this._timeConnect);this._timeConnect=null;}},_timeChangeHandler:function(_c3){this._mapTimeExtent=_c3;var _c4=this._mode;if(_c4){_c4.propertyChangeHandler(0);}},_getOffsettedTE:function(_c5){var _c6=this._timeOffset,_c7=this._timeOffsetUnits;return (_c5&&_c6&&_c7)?_c5.offset(-1*_c6,_c7):_c5;},_getTimeOverlap:function(_c8,_c9){if(_c8&&_c9){return _c8.intersection(_c9);}else{return _c8||_c9;}},_getTimeFilter:function(_ca){var _cb=this.getTimeDefinition(),_cc=null,_cd;if(_cb||_cc){_cd=this._getTimeOverlap(_cb,_cc);if(!_cd){return [false];}}if(_ca){_ca=_cd?this._getTimeOverlap(_ca,_cd):_ca;if(!_ca){return [false];}}else{_ca=_cd;}return [true,_ca];},_getAttributeFilter:function(_ce){var _cf=this.getDefinitionExpression();if(_ce){_ce=_cf?"("+_cf+") AND ("+_ce+")":_ce;}else{_ce=_cf;}return _ce;},_applyQueryFilters:function(_d0){_d0.where=this._getAttributeFilter(_d0.where);_d0.maxAllowableOffset=this._maxOffset;if(this.timeInfo){var _d1=this._getTimeFilter(_d0.timeExtent);if(!_d1[0]){return false;}else{_d0.timeExtent=_d1[1];}}return true;},_isNew:function(_d2){var _d3=_4.indexOf(this._newFeatures,_d2);return _d3===-1?false:true;},_isDeleted:function(_d4){var _d5=_d4.attributes,_d6=this.objectIdField,oid=_d5[_d6];return this._deletedFeatures[oid]?true:false;},_add:function(_d7){var _d8=this._selectionSymbol,_d9=_d7.attributes,_da=this.visibilityField;if(_d8&&this._isSelOnly){_d7.setSymbol(_d8);}if(_da&&_d9&&_d9.hasOwnProperty(_da)){_d7[_d9[_da]?"show":"hide"]();}return this.add.apply(this,arguments);},_remove:function(){return this.remove.apply(this,arguments);},_canDoClientSideQuery:function(_db){var _dc=[],map=this._map;if(this._isTable||!map){return;}if(_db.text||(_db.where&&_db.where!==this.getDefinitionExpression())){return;}var _dd=this._isSnapshot,_de=this._isSelOnly;var _df=_db.geometry;if(_df){if(!_de&&_db.spatialRelationship===esri.tasks.Query.SPATIAL_REL_INTERSECTS&&(_df.type==="extent"&&(_dd||map.extent.contains(_df)))){_dc.push(1);}else{return;}}var ids=_db.objectIds;if(ids){if(_dd){_dc.push(2);}else{var len=ids.length,_e0=this._mode,_e1=0;for(var i=0;i<len;i++){if(_e0._getFeature(ids[i])){_e1++;}}if(_e1===len){_dc.push(2);}else{return;}}}if(this.timeInfo){var _e2=_db.timeExtent,_e3=this._mapTimeExtent;if(_dd){if(_e2){_dc.push(3);}}else{if(_de){if(_e2){return;}}else{if(_e3){if(_4.indexOf(_dc,2)!==-1){if(_e2){_dc.push(3);}}else{return;}}else{if(_dc.length>0){if(_e2){_dc.push(3);}}else{if(_e2){return;}}}}}}return _dc.length>0?_dc:null;},_doQuery:function(_e4,_e5,_e6){var _e7=[],_e8=this._mode,_e9=this.objectIdField;if(_4.indexOf(_e5,2)!==-1){_e7=[];var ids=_e4.objectIds,len=ids.length;for(var i=0;i<len;i++){var obj=_e8._getFeature(ids[i]);if(obj){_e7.push(obj);}}if(_e7.length===0){return [];}}if(_4.indexOf(_e5,1)!==-1){var _ea=_e7.length>0?_e7:this.graphics,len=_ea.length,_eb=_e4.geometry._normalize(null,true);_e7=[];for(var i=0;i<len;i++){var _ec=_ea[i],_ed=_ec.geometry;if(this.normalization&&_eb.length){if(_eb[0].intersects(_ed)||_eb[1].intersects(_ed)){_e7.push(_ec);}}else{if(_eb.intersects(_ed)){_e7.push(_ec);}}}if(_e7.length===0){return [];}}if(_4.indexOf(_e5,3)!==-1){if(this.timeInfo){var _ea=_e7.length>0?_e7:this.graphics,_ee=_e4.timeExtent;var _ef=this._filterByTime(_ea,_ee.startTime,_ee.endTime);_e7=_ef.match;}}if(_e6){return _4.map(_e7,function(obj){return obj.attributes[_e9];},this);}else{return _e7;}},_filterByTime:function(_f0,_f1,_f2){var _f3=this._startTimeField,_f4=this._endTimeField,_f5;if(!this._twoTimeFields){_f5=_f3||_f4;}var _f6=esri._isDefined,yea=[],nay=[];_f1=_f1?_f1.getTime():-Infinity;_f2=_f2?_f2.getTime():Infinity;if(_f5){for(var i=0,len=_f0.length;i<len;i++){var _f7=_f0[i],_f8=_f7.attributes;var _f9=_f8[_f5];if(_f9>=_f1&&_f9<=_f2){yea.push(_f7);}else{nay.push(_f7);}}}else{for(var i=0,len=_f0.length;i<len;i++){var _f7=_f0[i],_f8=_f7.attributes;var _fa=_f8[_f3],end=_f8[_f4];_fa=_f6(_fa)?_fa:-Infinity;end=_f6(end)?end:Infinity;if((_fa>=_f1&&_fa<=_f2)||(end>=_f1&&end<=_f2)){yea.push(_f7);}else{nay.push(_f7);}}}return {match:yea,noMatch:nay};},_resolve:function(_fb,_fc,_fd,dfd,_fe){if(_fc){this[_fc].apply(this,_fb);}if(_fd){_fd.apply(null,_fb);}if(dfd){esri._resDfd(dfd,_fb,_fe);}},_getShallowClone:function(_ff){var _100=new esri.tasks.Query();for(var prop in _ff){if(_ff.hasOwnProperty(prop)){_100[prop]=_ff[prop];}}return _100;},_query:function(type,_101,_102,_103,_104){var that=this,dfd=new _4.Deferred(esri._dfdCanceller);var _105=function(_106,_107){if(!_107&&type==="execute"&&!that._isTable){var _108=_106.features,mode=that._mode,_109=that.objectIdField;for(var il=_108.length,i=il-1;i>=0;i--){var oid=_108[i].attributes[_109];var _10a=mode._getFeature(oid);if(_10a){_108.splice(i,1,_10a);}}}that._resolve([_106],_101,_103,dfd);};if(type!=="executeRelationshipQuery"){_102=this._getShallowClone(_102);_102.outFields=this._getOutFields();_102.returnGeometry=true;var map=this._map;if(map){_102.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());}if(!this._applyQueryFilters(_102)){var _10b;switch(type){case "execute":_10b=new esri.tasks.FeatureSet({features:[]});break;case "executeForIds":_10b=[];break;case "executeForCount":_10b=0;break;}_105(_10b,true);return dfd;}var _10c=this._canDoClientSideQuery(_102);if(_10c){var _10d=this._doQuery(_102,_10c,(type==="executeForIds"||type==="executeForCount"));var _10b;switch(type){case "execute":_10b=new esri.tasks.FeatureSet();_10b.features=_10d;break;case "executeForIds":_10b=_10d;break;case "executeForCount":_10b=_10d.length;break;}_105(_10b,true);return dfd;}}if(this._collection){var err=new Error("FeatureLayer::_query - "+esri.bundle.layers.FeatureLayer.invalidParams);this._resolve([err],null,_104,dfd,true);return dfd;}if(this._ts){_102._ts=(new Date()).getTime();}var temp=dfd._pendingDfd=this._task[type](_102);temp.addCallbacks(_105,function(err){that._resolve([err],null,_104,dfd,true);});return dfd;},_convertFeaturesToJson:function(_10e,_10f){var json=[],_110=this._selectionSymbol,_111=this.visibilityField;for(var i=0;i<_10e.length;i++){var _112=_10e[i],_113={},_114=_112.geometry,attr=_112.attributes,_115=_112.symbol;if(_114){_113.geometry=_114.toJson();}if(_111){_113.attributes=attr=_4.mixin({},attr);attr[_111]=_112.visible?1:0;}else{if(attr){_113.attributes=_4.mixin({},attr);}}if(_115&&(_115!==_110)){_113.symbol=_115.toJson();}json.push(_113);}return _10f?json:_4.toJson(json);},_selectHandler:function(_116,_117,_118,_119,dfd){var _11a,ctor=this.constructor;switch(_117){case ctor.SELECTION_NEW:this.clearSelection(true);_11a=true;break;case ctor.SELECTION_ADD:_11a=true;break;case ctor.SELECTION_SUBTRACT:_11a=false;break;}var _11b=_116.features,mode=this._mode,_11c=[],_11d=this.objectIdField;if(_11a){for(var i=0;i<_11b.length;i++){var _11e=_11b[i];var oid=_11e.attributes[_11d];var _11f=mode._addFeatureIIf(oid,_11e);_11c.push(_11f);this._selectFeatureIIf(oid,_11f,mode);}}else{for(var i=0;i<_11b.length;i++){var _11e=_11b[i];var oid=_11e.attributes[_11d];this._unSelectFeatureIIf(oid,mode);var _120=mode._removeFeatureIIf(oid);_11c.push(_120||_11e);}}if(this._isSelOnly){mode._applyTimeFilter(true);}this._resolve([_11c,_117],"onSelectionComplete",_118,dfd);},_selectFeatureIIf:function(oid,_121,mode){var _122=this._selectedFeatures,_123=_122[oid];if(!_123){mode._incRefCount(oid);_122[oid]=_121;if(!this._isTable){this._setSelectSymbol(_121);}}return _123||_121;},_unSelectFeatureIIf:function(oid,mode){var _124=this._selectedFeatures[oid];if(_124){mode._decRefCount(oid);delete this._selectedFeatures[oid];if(!this._isTable){this._setUnSelectSymbol(_124);}}return _124;},_isSelected:function(_125){},_setSelectSymbol:function(_126){var _127=this._selectionSymbol;if(_127&&!this._isSelOnly){_126.setSymbol(_127);}},_setUnSelectSymbol:function(_128){var _129=this._selectionSymbol;if(_129&&!this._isSelOnly){if(_129===_128.symbol){_128.setSymbol(null,true);}}},_getOutFields:function(){var _12a=_4.filter([this.objectIdField,this.typeIdField,this._startTimeField,this._endTimeField,this._trackIdField].concat(this._rendererFields),function(_12b,_12c,arr){return !!_12b&&(_4.indexOf(arr,_12b)===_12c);});var _12d=_4.clone(this._outFields);if(_12d){if(_4.indexOf(_12d,"*")!==-1){return _12d;}_4.forEach(_12a,function(_12e){if(_4.indexOf(_12d,_12e)===-1){_12d.push(_12e);}});return _12d;}else{return _12a;}},_checkFields:function(_12f){var _130=_12f||this._getOutFields();_4.forEach(_130,function(_131){if(_131==="*"){return;}if(!this._getField(_131)){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url,field:_131},esri.bundle.layers.FeatureLayer.fieldNotFound));}},this);if(!_12f&&!this._isTable&&!this._fserver&&!this._collection){var _132=_4.some(this.fields,function(_133){return (_133&&_133.type==="esriFieldTypeGeometry")?true:false;});if(!_132){console.debug("esri.layers.FeatureLayer: "+esri.substitute({url:this.url},esri.bundle.layers.FeatureLayer.noGeometryField));}}},_fixRendererFields:function(){var _134=this.renderer;if(_134&&this.fields.length>0){var _135=_4.filter([_134,_134.observationRenderer,_134.latestObservationRenderer,_134.trackRenderer],esri._isDefined);var _136=[];_4.forEach(_135,function(rnd){var _137,_138;_138=rnd.attributeField;if(_138){_137=!this._getField(_138)&&this._getField(_138,true);if(_137){rnd.attributeField=_137.name;}}_138=rnd.attributeField2;if(_138){_137=!this._getField(_138)&&this._getField(_138,true);if(_137){rnd.attributeField2=_137.name;}}_138=rnd.attributeField3;if(_138){_137=!this._getField(_138)&&this._getField(_138,true);if(_137){rnd.attributeField3=_137.name;}}_136.push(rnd.attributeField);_136.push(rnd.attributeField2);_136.push(rnd.attributeField3);},this);this._rendererFields=_4.filter(_136,esri._isDefined);}},_getField:function(_139,_13a){var _13b=this.fields;if(_13b.length===0){return null;}var _13c;if(_13a){_139=_139.toLowerCase();}_4.some(_13b,function(_13d){var _13e=false;if(_13a){_13e=(_13d&&_13d.name.toLowerCase()===_139)?true:false;}else{_13e=(_13d&&_13d.name===_139)?true:false;}if(_13e){_13c=_13d;}return _13e;});return _13c;},_getDateOpts:function(){if(!this._dtOpts){var _13f=_4.map(_4.filter(this.fields,function(_140){return !!(_140&&_140.type==="esriFieldTypeDate");}),function(_141){return _141.name;});this._dtOpts={properties:_13f};}return this._dtOpts;},_applyNormalized:function(_142,_143){if(_142&&_143){_4.forEach(_142,function(_144,_145){if(_144&&_143[_145]){_144.setGeometry(_143[_145]);}});}},_editHandler:function(_146,adds,_147,_148,_149,dfd){var _14a=_146.addResults,_14b=_146.updateResults,_14c=_146.deleteResults;var mode=this._mode;var _14d=this._isTable;if(_14a){for(var i=0;i<_14a.length;i++){_14a[i]=new esri.layers.FeatureEditResult(_14a[i]);if(_14d){continue;}var _14e=_14a[i];if(_14e.success){var oid=_14e.objectId,_14f=adds[i],gl=_14f._graphicsLayer;if(gl&&gl!==this){gl.remove(_14f);}var attr=_14f.attributes||{},_150=this.objectIdField;attr[_150]=oid;_14f.setAttributes(attr);mode.drawFeature(_14f);}}}if(_14b){for(var i=0;i<_14b.length;i++){_14b[i]=new esri.layers.FeatureEditResult(_14b[i]);if(_14d){continue;}var _14e=_14b[i];if(_14e.success){var oid=_14e.objectId;var _14f=_147[oid];var _151=mode._getFeature(oid);if(_151){if(_151.geometry!==_14f.geometry){_151.setGeometry(esri.geometry.fromJson(_14f.geometry.toJson()));}this._repaint(_151,oid);}}}}if(_14c){var _152=[];for(var i=0;i<_14c.length;i++){_14c[i]=new esri.layers.FeatureEditResult(_14c[i]);if(_14d){continue;}var _14e=_14c[i];if(_14e.success){var oid=_14e.objectId;var _14f=mode._getFeature(oid);if(_14f){if(this._unSelectFeatureIIf(oid,mode)){_152.push(_14f);}_14f._count=0;mode._removeFeatureIIf(oid);}}}if(_152.length>0){this.onSelectionComplete(_152,this.constructor.SELECTION_SUBTRACT);}}this._resolve([_14a,_14b,_14c],"onEditsComplete",_148,dfd);},_sendAttachment:function(type,_153,_154,_155,_156){var _157=(type==="add")?"addAttachment":"updateAttachment";var url=this._url.path+"/"+_153+"/"+_157;_154.enctype="multipart/form-data";if(_4.isIE<9){_154.encoding="multipart/form-data";}_154.method="post";var _158=_154.elements;if(!_4.some(_158,function(el){return el.name==="f";})){_154.appendChild(_4.create("input",{type:"hidden",name:"f",value:"json"}));}if(!_4.some(_158,function(el){return el.name==="callback.html";})){_154.appendChild(_4.create("input",{type:"hidden",name:"callback.html",value:"textarea"}));}var _159=this._getToken();if(_159&&!_4.some(_158,function(el){return el.name==="token";})){_154.appendChild(_4.create("input",{type:"hidden",name:"token",value:_159}));}var dfd=new _4.Deferred(esri._dfdCanceller),self=this,_15a=function(_15b){if(!(_15b instanceof Error)){_15b=_4.mixin(new Error(),_15b);}self._resolve([_15b],null,_156,dfd,true);},_15c=(esri.config.defaults.io.alwaysUseProxy||!esri._hasSameOrigin(url,window.location.href))?esri._getProxyUrl():null;dfd._pendingDfd=_4.io.iframe.send({url:(_15c?(_15c.path+"?"):"")+url+"?callback.html=textarea",form:_154,handleAs:"json",load:_4.hitch(this,function(_15d,io){var _15e=_15d.error;if(_15e){_15a(_15e);return;}var _15f=(type==="add")?"addAttachmentResult":"updateAttachmentResult";var _160=(type==="add")?"onAddAttachmentComplete":"onUpdateAttachmentComplete";var _161=new esri.layers.FeatureEditResult(_15d[_15f]);_161.attachmentId=_161.objectId;_161.objectId=_153;self._resolve([_161],_160,_155,dfd);}),error:_15a});return dfd;},_repaint:function(_162,oid,_163){oid=esri._isDefined(oid)?oid:_162.attributes[this.objectIdField];if(!(oid in this._selectedFeatures)||!this._selectionSymbol){_162.setSymbol(_162.symbol,_163);}},_getKind:function(_164){var _165=this._trackManager;if(_165){return _165.isLatestObservation(_164)?1:0;}return 0;}});_4.mixin(esri.layers.FeatureLayer,{MODE_SNAPSHOT:0,MODE_ONDEMAND:1,MODE_SELECTION:2,SELECTION_NEW:3,SELECTION_ADD:4,SELECTION_SUBTRACT:5,POPUP_NONE:"esriServerHTMLPopupTypeNone",POPUP_HTML_TEXT:"esriServerHTMLPopupTypeAsHTMLText",POPUP_URL:"esriServerHTMLPopupTypeAsURL"});esri._createWrappers("esri.layers.FeatureLayer");_4.declare("esri.layers.FeatureType",null,{constructor:function(json){if(json&&_4.isObject(json)){this.id=json.id;this.name=json.name;var _166=json.symbol;if(_166){this.symbol=esri.symbol.fromJson(_166);}var _167=json.domains;var _168=this.domains={};for(var _169 in _167){if(_167.hasOwnProperty(_169)){var _16a=_167[_169];switch(_16a.type){case "range":_168[_169]=new esri.layers.RangeDomain(_16a);break;case "codedValue":_168[_169]=new esri.layers.CodedValueDomain(_16a);break;case "inherited":_168[_169]=new esri.layers.InheritedDomain(_16a);break;}}}var _16b=json.templates;if(_16b){var _16c=this.templates=[];for(var i=0;i<_16b.length;i++){_16c.push(new esri.layers.FeatureTemplate(_16b[i]));}}}},toJson:function(){var json={id:this.id,name:this.name,symbol:this.symbol&&this.symbol.toJson()};var _16d=this.domains,_16e=this.templates,_16f=esri._sanitize;if(_16d){var _170=json.domains={};for(var _171 in _16d){if(_16d.hasOwnProperty(_171)){_170[_171]=_16d[_171]&&_16d[_171].toJson();}}_16f(_170);}if(_16e){json.templates=_4.map(_16e,function(_172){return _172.toJson();});}return _16f(json);}});_4.declare("esri.layers.FeatureTemplate",null,{constructor:function(json){if(json&&_4.isObject(json)){this.name=json.name;this.description=json.description;this.drawingTool=json.drawingTool;var _173=json.prototype;this.prototype=new esri.Graphic(_173.geometry,null,_173.attributes);}},toJson:function(){return esri._sanitize({name:this.name,description:this.description,drawingTool:this.drawingTool,prototype:this.prototype&&this.prototype.toJson()});}});_4.mixin(esri.layers.FeatureTemplate,{TOOL_AUTO_COMPLETE_POLYGON:"esriFeatureEditToolAutoCompletePolygon",TOOL_CIRCLE:"esriFeatureEditToolCircle",TOOL_ELLIPSE:"esriFeatureEditToolEllipse",TOOL_FREEHAND:"esriFeatureEditToolFreehand",TOOL_LINE:"esriFeatureEditToolLine",TOOL_NONE:"esriFeatureEditToolNone",TOOL_POINT:"esriFeatureEditToolPoint",TOOL_POLYGON:"esriFeatureEditToolPolygon",TOOL_RECTANGLE:"esriFeatureEditToolRectangle",TOOL_ARROW:"esriFeatureEditToolArrow",TOOL_TRIANGLE:"esriFeatureEditToolTriangle",TOOL_LEFT_ARROW:"esriFeatureEditToolLeftArrow",TOOL_RIGHT_ARROW:"esriFeatureEditToolRightArrow",TOOL_UP_ARROW:"esriFeatureEditToolUpArrow",TOOL_DOWN_ARROW:"esriFeatureEditToolDownArrow"});_4.declare("esri.layers.FeatureEditResult",null,{constructor:function(json){if(json&&_4.isObject(json)){this.objectId=json.objectId;this.success=json.success;if(!json.success){var err=json.error;this.error=new Error();this.error.code=err.code;this.error.message=err.description;}}}});_4.declare("esri.layers._RenderMode",null,{constructor:function(){this._prefix="jsonp_"+(_4._scopeName||"dojo")+"IoScript";},initialize:function(map){},propertyChangeHandler:function(type){},destroy:function(){},drawFeature:function(_174){},suspend:function(){},resume:function(){},refresh:function(){},_incRefCount:function(oid){var _175=this._featureMap[oid];if(_175){_175._count++;}},_decRefCount:function(oid){var _176=this._featureMap[oid];if(_176){_176._count--;}},_getFeature:function(oid){return this._featureMap[oid];},_addFeatureIIf:function(oid,_177){var fmap=this._featureMap,_178=fmap[oid],_179=this.featureLayer;if(!_178){fmap[oid]=_177;_179._add(_177);_177._count=0;}return _178||_177;},_removeFeatureIIf:function(oid){var _17a=this._featureMap[oid],_17b=this.featureLayer;if(_17a){if(_17a._count){return;}delete this._featureMap[oid];_17b._remove(_17a);}return _17a;},_clearIIf:function(){var _17c=this.featureLayer,_17d=_17c.graphics,_17e=_17c._selectedFeatures,_17f=_17c.objectIdField;for(var i=_17d.length-1;i>=0;i--){var _180=_17d[i];var oid=_180.attributes[_17f];if(oid in _17e){_180._count=1;continue;}_180._count=0;this._removeFeatureIIf(oid);}},_isPending:function(id){var dfd=_4.io.script[this._prefix+id];return dfd?true:false;},_cancelPendingRequest:function(dfd,id){dfd=dfd||_4.io.script[this._prefix+id];if(dfd){try{dfd.cancel();_4.io.script._validCheck(dfd);}catch(e){}}},_purgeRequests:function(){_4.io.script._validCheck(null);},_toggleVisibility:function(show){var _181=this.featureLayer,_182=_181.graphics,_183=show?"show":"hide";show=show&&_181._ager;for(var i=0,len=_182.length;i<len;i++){var _184=_182[i];_184[_183]();if(show){_181._repaint(_184);}}},_applyTimeFilter:function(_185){var _186=this.featureLayer;if(!_186.timeInfo||_186._suspended){return;}if(!_185){_186._fireUpdateStart();}var _187=_186._trackManager;if(_187){_187.clearTracks();}var defn=_186.getTimeDefinition(),_188=_186._getOffsettedTE(_186._mapTimeExtent);if(_188){_188=_186._getTimeOverlap(defn,_188);if(_188){var _189=_186._filterByTime(_186.graphics,_188.startTime,_188.endTime);if(_187){_187.addFeatures(_189.match);}_4.forEach(_189.match,function(_18a){var _18b=_18a._shape;if(!_18a.visible){_18a.show();_18b=_18a._shape;_18b&&_18b._moveToFront();}if(_186._ager&&_18b){_186._repaint(_18a);}});_4.forEach(_189.noMatch,function(_18c){if(_18c.visible){_18c.hide();}});}else{this._toggleVisibility(false);}}else{if(_187){_187.addFeatures(_186.graphics);}this._toggleVisibility(true);}if(_187){_187.moveLatestToFront();_187.drawTracks();}if(!_185){_186._fireUpdateEnd();}}});_4.declare("esri.layers._SelectionMode",[esri.layers._RenderMode],{constructor:function(_18d){this.featureLayer=_18d;this._featureMap={};},initialize:function(map){this.map=map;this._init=true;},propertyChangeHandler:function(type){if(this._init&&type===0){this._applyTimeFilter();}},destroy:function(){this._init=false;},resume:function(){this.propertyChangeHandler(0);}});_4.declare("esri.layers._SnapshotMode",[esri.layers._RenderMode],{constructor:function(_18e){this.featureLayer=_18e;this._featureMap={};this._drawFeatures=_4.hitch(this,this._drawFeatures);this._queryErrorHandler=_4.hitch(this,this._queryErrorHandler);},initialize:function(map){this.map=map;var _18f=this.featureLayer;if(_18f._collection){this._applyTimeFilter();}else{this._fetchAll();}this._init=true;},propertyChangeHandler:function(type){if(this._init){if(type){this._fetchAll();}else{this._applyTimeFilter();}}},destroy:function(){this._init=false;},drawFeature:function(_190){var _191=this.featureLayer,_192=_191.objectIdField,oid=_190.attributes[_192];if(!_191._isDeleted(_190)){this._addFeatureIIf(oid,_190);this._incRefCount(oid);}},resume:function(){this.propertyChangeHandler(0);},refresh:function(){var _193=this.featureLayer;if(_193._collection){_193._fireUpdateStart();_193._refresh(true);_193._fireUpdateEnd();}else{this._fetchAll();}},_getRequestId:function(_194){var id="_"+_194.name+_194.layerId+_194._ulid;return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_fetchAll:function(){var _195=this.featureLayer;if(_195._collection){return;}_195._fireUpdateStart();this._clearIIf();this._sendRequest();},_sendRequest:function(){var map=this.map,_196=this.featureLayer,_197=_196.getDefinitionExpression();var _198=new esri.tasks.Query();_198.outFields=_196._getOutFields();_198.where=_197||"1=1";_198.returnGeometry=true;_198.outSpatialReference=new esri.SpatialReference(map.spatialReference.toJson());_198.timeExtent=_196.getTimeDefinition();_198.maxAllowableOffset=_196._maxOffset;if(_196._ts){_198._ts=(new Date()).getTime();}var _199;if(_196._usePatch){_199=this._getRequestId(_196);this._cancelPendingRequest(null,_199);}_196._task.execute(_198,this._drawFeatures,this._queryErrorHandler,_199);},_drawFeatures:function(_19a){this._purgeRequests();var _19b=_19a.features,_19c=this.featureLayer,_19d=_19c.objectIdField;for(var i=0,len=_19b.length;i<len;i++){var _19e=_19b[i];var oid=_19e.attributes[_19d];if(!_19c._isDeleted(_19e)){this._addFeatureIIf(oid,_19e);this._incRefCount(oid);}}this._applyTimeFilter(true);_19c._fireUpdateEnd();},_queryErrorHandler:function(err){this._purgeRequests();var _19f=this.featureLayer;_19f._errorHandler(err);_19f._fireUpdateEnd(err);}});_4.declare("esri.layers._OnDemandMode",[esri.layers._RenderMode],{constructor:function(_1a0){this.featureLayer=_1a0;this._featureMap={};this._queryErrorHandler=_4.hitch(this,this._queryErrorHandler);},initialize:function(map){this.map=map;this._initialize();this._init=true;},propertyChangeHandler:function(type){if(this._init){if(type<2){this._zoomHandler();}}},destroy:function(){this._disableConnectors();this._init=false;},drawFeature:function(_1a1){var _1a2=this._gridLayer,geom=_1a1.geometry,type=geom.type,_1a3=[];switch(type){case "point":_1a3=_1a2.getCellsInExtent({xmin:geom.x,ymin:geom.y,xmax:geom.x,ymax:geom.y}).cells;break;default:_1a3=_1a2.getCellsInExtent(geom.getExtent()).cells;break;}var _1a4=this._cellMap,_1a5=this.featureLayer,_1a6=_1a5.objectIdField;for(var i=0;i<_1a3.length;i++){var cell=_1a3[i];var oid=_1a1.attributes[_1a6];if(!_1a5._isDeleted(_1a1)){_1a4[cell.row][cell.col].features.push(_1a1);this._addFeatureIIf(oid,_1a1);this._incRefCount(oid);}}},suspend:function(){if(!this._init){return;}this._disableConnectors();},resume:function(){if(!this._init){return;}this._enableConnectors();this._zoomHandler();},refresh:function(){this._zoomHandler();},_initialize:function(){var map=this.map,_1a7=this.featureLayer;var _1a8=_1a7._wrap&&_1a7._srInfo;this._gridLayer=new esri.layers._GridLayout(new esri.geometry.Point(_1a8?_1a8.valid[0]:map.extent.xmin,map.extent.ymax,map.spatialReference),{width:_1a7._tileWidth,height:_1a7._tileHeight},{width:map.width,height:map.height},_1a8);this._ioQueue=[];if(!_1a7._suspended){this._zoomHandler();this._enableConnectors();}},_enableConnectors:function(){var map=this.map;this._zoomConnect=_4.connect(map,"onZoomEnd",this,this._zoomHandler);this._panConnect=_4.connect(map,"onPanEnd",this,this._panHandler);},_disableConnectors:function(){_4.disconnect(this._zoomConnect);_4.disconnect(this._panConnect);},_zoomHandler:function(){this._processIOQueue(true);var _1a9=this.featureLayer;if(_1a9._suspended){return;}_1a9._fireUpdateStart();this._clearIIf();var _1aa=_1a9._trackManager;if(_1aa){_1aa.clearTracks();}this._cellMap={};this._gridLayer.setResolution(this.map.extent);this._sendRequest();},_panHandler:function(){this.featureLayer._fireUpdateStart();this._sendRequest();},_getRequestId:function(_1ab,cell){var id="_"+_1ab.name+_1ab.layerId+_1ab._ulid+"_"+cell.resolution+"_"+cell.row+"_"+cell.col;return id.replace(/[^a-zA-Z0-9\_]+/g,"_");},_sendRequest:function(){var _1ac=this.featureLayer,map=this.map,_1ad=map.extent;var _1ae=this._gridLayer.getCellsInExtent(_1ad),_1af=_1ae.cells;if(!_1ac._editable){var _1b0=this._cellMap;_1af=_4.filter(_1af,function(cell){if(_1b0[cell.row]&&_1b0[cell.row][cell.col]){return false;}return true;});}var _1b1=_1ac._getOutFields();var _1b2=_1ac.getDefinitionExpression();var time=_1ac._getOffsettedTE(_1ac._mapTimeExtent);var _1b3=_1ac._usePatch,_1b4=this._ioQueue;this._pending=this._pending||0;for(var i=0;i<_1af.length;i++){var cell=_1af[i];var _1b5=new esri.tasks.Query();_1b5.geometry=cell.extent;_1b5.outFields=_1b1;_1b5.where=_1b2;_1b5.returnGeometry=true;_1b5.timeExtent=time;_1b5.maxAllowableOffset=_1ac._maxOffset;if(_1ac._ts){_1b5._ts=(new Date()).getTime();}var _1b6;if(_1b3){_1b6=this._getRequestId(_1ac,cell);if(this._isPending(_1b6)){continue;}}var self=this,func=this._drawFeatures;this._pending++;_1b4.push(_1ac._task.execute(_1b5,function(){var _1b7=cell;return function(_1b8){func.apply(self,[_1b8,_1b7]);};}.call(this),this._queryErrorHandler,_1b6));}this._removeOldCells(_1ad);this._endCheck();},_drawFeatures:function(_1b9,cell){this._finalizeIO();var _1ba=this.featureLayer,map=this.map,_1bb=map.extent,_1bc=cell.extent,row=cell.row,col=cell.col,_1bd=_1ba.objectIdField;var _1be=_1b9.features,_1bf=this._gridLayer;var _1c0=this._cellMap;var _1c1=_1c0[row]&&_1c0[row][col];if((cell.resolution!=this._gridLayer._resolution)||(!_1bf.intersects(_1bc,_1bb))){if(_1c1){this._removeCell(row,col);}}else{if(_1c1){this._updateCell(_1c1,_1be);}else{cell.features=_1be;_1c0[row]=_1c0[row]||{};_1c0[row][col]=cell;for(var i=0,len=_1be.length;i<len;i++){var _1c2=_1be[i];var oid=_1c2.attributes[_1bd];if(!_1ba._isDeleted(_1c2)){this._addFeatureIIf(oid,_1c2);this._incRefCount(oid);}}}}this._endCheck();},_queryErrorHandler:function(err){this._finalizeIO();this.featureLayer._errorHandler(err);this._endCheck(true);},_finalizeIO:function(){this._purgeRequests();this._pending--;},_endCheck:function(_1c3){if(this._pending===0){this._processIOQueue();var _1c4=this.featureLayer,_1c5=_1c4._trackManager;if(_1c5){_1c5.clearTracks();_1c5.addFeatures(_1c4.graphics);if(_1c4._ager){_4.forEach(_1c4.graphics,function(_1c6){if(_1c6._shape){_1c4._repaint(_1c6);}});}_1c5.moveLatestToFront();_1c5.drawTracks();}this.featureLayer._fireUpdateEnd(_1c3&&new Error("FeatureLayer: "+esri.bundle.layers.FeatureLayer.updateError));}},_processIOQueue:function(_1c7){this._ioQueue=_4.filter(this._ioQueue,function(dfd){var keep=dfd.fired>-1?false:true;return keep;});if(_1c7){_4.forEach(this._ioQueue,this._cancelPendingRequest);}},_removeOldCells:function(_1c8){var _1c9=this._cellMap,_1ca=this._gridLayer;for(var _1cb in _1c9){if(_1c9[_1cb]){var row=_1c9[_1cb];var _1cc=0,_1cd=0;for(var _1ce in row){if(row[_1ce]){_1cc++;var _1cf=row[_1ce].extent;if(!_1ca.intersects(_1cf,_1c8)){this._removeCell(_1cb,_1ce);_1cd++;}}}if(_1cd===_1cc){delete _1c9[_1cb];}}}},_updateCell:function(cell,_1d0){var _1d1=this.featureLayer,_1d2=_1d1.objectIdField,_1d3=_1d1._selectedFeatures;cell.features=cell.features||[];for(var i=0,len=_1d0.length;i<len;i++){var _1d4=_1d0[i];var oid=_1d4.attributes[_1d2];var _1d5=this._addFeatureIIf(oid,_1d4);if(_1d5===_1d4){this._incRefCount(oid);cell.features.push(_1d5);}else{if(!(oid in _1d3)){_1d5.setGeometry(_1d4.geometry);_1d5.setAttributes(_1d4.attributes);}}}},_removeCell:function(row,col){var _1d6=this._cellMap,_1d7=this.featureLayer,_1d8=_1d7.objectIdField;var cell=_1d6[row]&&_1d6[row][col];if(cell){delete _1d6[row][col];var _1d9=cell.features;for(var i=0;i<_1d9.length;i++){var _1da=_1d9[i];var oid=_1da.attributes[_1d8];this._decRefCount(oid);if(oid in _1d7._selectedFeatures){continue;}this._removeFeatureIIf(oid);}}}});_4.declare("esri.layers._GridLayout",null,{constructor:function(_1db,_1dc,_1dd,_1de){this.origin=_1db;this.cellWidth=_1dc.width;this.cellHeight=_1dc.height;this.mapWidth=_1dd.width;this.mapHeight=_1dd.height;this.srInfo=_1de;},setResolution:function(_1df){this._resolution=(_1df.xmax-_1df.xmin)/this.mapWidth;if(this.srInfo){var _1e0=Math.round((2*this.srInfo.valid[1])/this._resolution),_1e1=Math.round(_1e0/this.cellWidth);this._frameStats=[_1e1,0,_1e1-1];}},getCellCoordinates:function(_1e2){var res=this._resolution,_1e3=this.origin;return {row:Math.floor((_1e3.y-_1e2.y)/(this.cellHeight*res)),col:Math.floor((_1e2.x-_1e3.x)/(this.cellWidth*res))};},normalize:function(col){var _1e4=this._frameStats;if(_1e4){var _1e5=_1e4[0],m180=_1e4[1],p180=_1e4[2];if(col<m180){col=col%_1e5;col=col<m180?col+_1e5:col;}else{if(col>p180){col=col%_1e5;}}}return col;},intersects:function(_1e6,_1e7){var _1e8=this.srInfo;if(_1e8){return _4.some(_1e7._getParts(_1e8),function(_1e9){return _1e6.intersects(_1e9.extent);});}else{return _1e6.intersects(_1e7);}},getCellExtent:function(row,col){var res=this._resolution,_1ea=this.origin,_1eb=this.cellWidth,_1ec=this.cellHeight;return new esri.geometry.Extent((col*_1eb*res)+_1ea.x,_1ea.y-((row+1)*_1ec*res),((col+1)*_1eb*res)+_1ea.x,_1ea.y-(row*_1ec*res),new esri.SpatialReference(_1ea.spatialReference.toJson()));},getCellsInExtent:function(_1ed){var _1ee=this.getCellCoordinates({x:_1ed.xmin,y:_1ed.ymax}),_1ef=this.getCellCoordinates({x:_1ed.xmax,y:_1ed.ymin}),_1f0=_1ee.row,_1f1=_1ef.row,_1f2=_1ee.col,_1f3=_1ef.col,_1f4=[],i,j,nj;for(i=_1f0;i<=_1f1;i++){for(j=_1f2;j<=_1f3;j++){nj=this.normalize(j);_1f4.push({row:i,col:nj,extent:this.getCellExtent(i,nj),resolution:this._resolution});}}return {minRow:_1f0,maxRow:_1f1,minCol:_1f2,maxCol:_1f3,cells:_1f4};}});_4.declare("esri.layers._TrackManager",null,{constructor:function(_1f5){this.layer=_1f5;this.trackMap={};},initialize:function(map){this.map=map;var _1f6=this.layer,_1f7=_1f6.renderer.trackRenderer;if(_1f7&&(_1f6.geometryType==="esriGeometryPoint")){var _1f8=(this.container=new esri.layers._GraphicsLayer({id:_1f6.id+"_tracks"}));_1f8._onPanHandler=function(){};_1f8._setMap(map,_1f6._div);_1f8.setRenderer(_1f7);}},addFeatures:function(_1f9){var _1fa=this.trackMap,_1fb=this.layer,_1fc=_1fb._trackIdField;_4.forEach(_1f9,function(_1fd){var _1fe=_1fd.attributes,tkid=_1fe[_1fc];var ary=(_1fa[tkid]=(_1fa[tkid]||[]));ary.push(_1fd);});var _1ff=_1fb._startTimeField,_200=_1fb.objectIdField;var _201=function(a,b){var _202=a.attributes[_1ff],_203=b.attributes[_1ff];if(_202===_203){return (a.attributes[_200]<b.attributes[_200])?-1:1;}else{return (_202<_203)?-1:1;}};for(var tkid in _1fa){_1fa[tkid].sort(_201);}},drawTracks:function(){var _204=this.container;if(!_204){return;}var _205=this.trackMap,sr=this.map.spatialReference;var _206=function(_207){var _208=_207.geometry;return [_208.x,_208.y];};for(var tkid in _205){var path=_4.map(_205[tkid],_206);_204.add(new esri.Graphic(new esri.geometry.Polyline({paths:[path],spatialReference:sr})));}},moveLatestToFront:function(){_4.forEach(this.getLatestObservations(),function(_209){var _20a=_209._shape;_20a&&_20a._moveToFront();this._repaint(_209,null,true);},this.layer);},getLatestObservations:function(){var _20b=[];if(!this.layer.renderer.latestObservationRenderer){return _20b;}var _20c=this.trackMap;for(var tkid in _20c){var ary=_20c[tkid];_20b.push(ary[ary.length-1]);}return _20b;},clearTracks:function(){var _20d=this.getLatestObservations();this.trackMap={};var _20e=this.container;if(_20e){_20e.clear();}_4.forEach(_20d,function(_20f){this._repaint(_20f,null,true);},this.layer);},isLatestObservation:function(_210){var _211=this.layer._trackIdField;var _212=this.trackMap[_210.attributes[_211]];if(_212){return (_212[_212.length-1]===_210);}return false;},destroy:function(){var _213=this.container;if(_213){_213.clear();_213._unsetMap(this.map,this.layer._div);this.container=null;}this.map=null;this.layer=null;this.trackMap=null;}});}if(!_4._hasResource["esri.layers.MapImageLayer"]){_4._hasResource["esri.layers.MapImageLayer"]=true;_4.provide("esri.layers.MapImageLayer");_4.declare("esri.layers.MapImageLayer",[esri.layers.Layer],{"-chains-":{constructor:"manual"},constructor:function(_214){this.inherited(arguments,[null,_214]);this._mapImages=[];var _215=_4.hitch;this._panStart=_215(this,this._panStart);this._pan=_215(this,this._pan);this._extentChange=_215(this,this._extentChange);this._zoom=_215(this,this._zoom);this.loaded=true;this.onLoad(this);},opacity:1,setOpacity:function(_216){if(this.opacity!=_216){this.onOpacityChange(this.opacity=_216);}},onOpacityChange:function(_217){if(this._div){_4.style(this._div,"opacity",_217);}},_transform:esri._getDOMAccessor("transform"),addImage:function(_218){var _219=this._mapImages.push(_218);_219=_219-1;_218._idx=_219;_218._layer=this;if(this._div){this._createImage(_218,_219);}},removeImage:function(_21a){if(_21a){var idx=_21a._idx,_21b=this._mapImages;if(_21b[idx]===_21a){delete _21b[idx];var node=_21a._node;if(node){this._clearEvents(node);node.e_idx=node.e_bl=node.e_tr=node.e_l=node.e_t=node.e_w=node.e_h=null;var div=this._div;if(div){div.removeChild(node);_4.destroy(node);}}_21a._node=_21a._idx=_21a._layer=null;}}},removeAllImages:function(){var _21c=this._mapImages,i,len=_21c.length;for(i=0;i<len;i++){var _21d=_21c[i];if(_21d){this.removeImage(_21d);}}this._mapImages=[];},getImages:function(){var _21e=this._mapImages,_21f=[],i,len=_21e.length;for(i=0;i<len;i++){if(_21e[i]){_21f.push(_21e[i]);}}return _21f;},_createImage:function(_220,idx){var node=_4.create("img");_4.style(node,{position:"absolute",left:"0px",top:"0px"});if(_220.rotation){var _221="rotate("+(360-_220.rotation)+"deg)";if(_4.isIE<9){}else{_4.style(node,this._transform,_221);_4.style(node,"transform",_221);}}_220._node=node;node.e_idx=idx;node.e_layer=this;node.e_load=_4.connect(node,"onload",esri.layers.MapImageLayer.prototype._imageLoaded);node.e_error=_4.connect(node,"onerror",esri.layers.MapImageLayer.prototype._imageError);node.e_abort=_4.connect(node,"onabort",esri.layers.MapImageLayer.prototype._imageError);node.src=_220.href;},_imageLoaded:function(evt){var node=evt.target||evt.currentTarget,self=node.e_layer,_222=self._mapImages[node.e_idx];self._clearEvents(node);if(!_222||_222._node!==node){return;}if(self._map){self._attach(_222);}},_imageError:function(evt){var node=evt.target||evt.currentTarget,self=node.e_layer,_223=self._mapImages[node.e_idx];self._clearEvents(node);if(_223){_223._node=null;}},_clearEvents:function(node){var _224=_4.disconnect;_224(node.e_load);_224(node.e_error);_224(node.e_abort);node.e_load=node.e_error=node.e_abort=node.e_layer=null;},_attach:function(_225){var _226=_225.extent,_227=_226.spatialReference,_228=this._sr,_229=_227.wkid||4326,div=this._div,node=_225._node,_22a=new esri.geometry.Point({x:_226.xmin,y:_226.ymin}),_22b=new esri.geometry.Point({x:_226.xmax,y:_226.ymax});if(_227&&(_229!==_228.wkid)){if(_229===4326&&_228._isWebMercator()){node.e_bl=esri.geometry.geographicToWebMercator(_22a);node.e_tr=esri.geometry.geographicToWebMercator(_22b);}else{if(_227._isWebMercator()&&_228.wkid===4326){node.e_bl=esri.geometry.webMercatorToGeographic(_22a);node.e_tr=esri.geometry.webMercatorToGeographic(_22b);}}}else{node.e_bl=_22a;node.e_tr=_22b;}if(_225.visible){this._setPos(node,_4.style(div,"left"),_4.style(div,"top"));div.appendChild(node);}},_setPos:function(node,_22c,_22d){var _22e=node.e_bl,_22f=node.e_tr,map=this._map;_22e=map.toScreen(_22e);_22f=map.toScreen(_22f);var left=_22e.x-_22c,top=_22f.y-_22d,_230=Math.abs(_22f.x-_22e.x),_231=Math.abs(_22e.y-_22f.y);_4.style(node,{left:left+"px",top:top+"px",width:_230+"px",height:_231+"px"});node.e_l=left;node.e_t=top;node.e_w=_230;node.e_h=_231;},_setMap:function(map,_232){this._map=map;this._sr=map.spatialReference;var div=this._div=_4.create("div",null,_232);_4.style(div,"position","absolute");_4.style(div,"opacity",this.opacity);var _233=this._mapImages,i,len=_233.length;for(i=0;i<len;i++){var _234=_233[i],node=_234._node;if(!node){this._createImage(_234,_234._idx);}}this.onVisibilityChange(this.visible);return div;},_unsetMap:function(map,_235){this._disconnect();var div=this._div;if(div){var _236=this._mapImages,i,len=_236.length;for(i=0;i<len;i++){var _237=_236[i];if(_237){var node=_237._node;if(node){this._clearEvents(node);node.e_idx=node.e_bl=node.e_tr=node.e_l=node.e_t=node.e_w=node.e_h=null;}_237._node=null;}}_235.removeChild(div);_4.destroy(div);}this._map=this._div=this._sr=null;},onVisibilityChange:function(_238){var div=this._div;if(div){if(_238){this._redraw();this._connect(this._map);esri.show(div);}else{this._disconnect();esri.hide(div);}}},_connect:function(map){if(!this._connections){var _239=_4.connect;this._connections=[_239(map,"onPanStart",this._panStart),_239(map,"onPan",this._pan),_239(map,"onExtentChange",this._extentChange),_239(map,"onZoom",this._zoom)];}},_disconnect:function(){if(this._connections){_4.forEach(this._connections,_4.disconnect);this._connections=null;}},_panStart:function(){this._panL=_4.style(this._div,"left");this._panT=_4.style(this._div,"top");},_pan:function(_23a,_23b){_4.style(this._div,{left:this._panL+_23b.x+"px",top:this._panT+_23b.y+"px"});},_extentChange:function(_23c,_23d,_23e){if(_23e){this._redraw();}else{if(_23d){_4.style(this._div,{left:this._panL+_23d.x+"px",top:this._panT+_23d.y+"px"});}}},_redraw:function(){var div=this._div,_23f=_4.style(div,"left"),_240=_4.style(div,"top"),i,len=div.childNodes.length,node;for(i=0;i<len;i++){node=div.childNodes[i];this._setPos(node,_23f,_240);}},_zoom:function(_241,_242,_243){var div=this._div,_244=_4.style(div,"left"),_245=_4.style(div,"top"),i,len=div.childNodes.length,node;for(i=0;i<len;i++){node=div.childNodes[i];var _246=node.e_w*_242,_247=node.e_h*_242,_248=(_243.x-_244-node.e_l)*(_246-node.e_w)/node.e_w,_249=(_243.y-_245-node.e_t)*(_247-node.e_h)/node.e_h;_248=isNaN(_248)?0:_248;_249=isNaN(_249)?0:_249;_4.style(node,{left:(node.e_l-_248)+"px",top:(node.e_t-_249)+"px",width:_246+"px",height:_247+"px"});}}});_4.extend(esri.layers.MapImage,{visible:true,getLayer:function(){return this._layer;},getNode:function(){return this._node;},show:function(){if(!this.visible){this.visible=true;var node=this._node,_24a=this._layer;if(node){if(_24a&&_24a._div){_24a._setPos(node,_4.style(_24a._div,"left"),_4.style(_24a._div,"top"));_24a._div.appendChild(node);}esri.show(node);}}},hide:function(){if(this.visible){this.visible=false;var node=this._node,_24b=this._layer;if(node){esri.hide(node);_24b&&_24b._div&&_24b._div.removeChild(node);}}}});}if(!_4._hasResource["esri.PopupBase"]){_4._hasResource["esri.PopupBase"]=true;_4.provide("esri.PopupBase");_4.declare("esri.PopupBase",null,{onSetFeatures:function(){},onClearFeatures:function(){},onSelectionChange:function(){},onDfdComplete:function(){},initialize:function(){this.count=0;this.selectedIndex=-1;},cleanup:function(){this.features=this.deferreds=null;},setFeatures:function(arg){if(!arg||!arg.length){return;}this.clearFeatures();var _24c,_24d;if(arg[0] instanceof _4.Deferred){_24d=arg;}else{_24c=arg;}if(_24c){this._updateFeatures(null,_24c);}else{this.deferreds=_24d;_24d=_24d.slice(0);_4.forEach(_24d,function(dfd){dfd.addBoth(_4.hitch(this,this._updateFeatures,dfd));},this);}},clearFeatures:function(){this.features=this.deferreds=null;this.count=0;var _24e=this.selectedIndex;this.selectedIndex=-1;if(_24e>-1){this.onSelectionChange();}this.onClearFeatures();},getSelectedFeature:function(){var _24f=this.features;if(_24f){return _24f[this.selectedIndex];}},select:function(_250){if(_250<0||_250>=this.count){return;}this.selectedIndex=_250;this.onSelectionChange();},enableHighlight:function(map){this._highlighted=map.graphics.add(new esri.Graphic(new esri.geometry.Point(0,0,map.spatialReference)));this._highlighted.hide();var ESYM=esri.symbol;if(!this.markerSymbol){var _251=(this.markerSymbol=new ESYM.SimpleMarkerSymbol());_251.setStyle(ESYM.SimpleMarkerSymbol.STYLE_TARGET);_251._setDim(16,16,7);_251.setOutline(new ESYM.CartographicLineSymbol(ESYM.SimpleLineSymbol.STYLE_SOLID,new _4.Color([0,255,255]),2,ESYM.CartographicLineSymbol.CAP_ROUND,ESYM.CartographicLineSymbol.JOIN_ROUND));_251.setColor(new _4.Color([0,0,0,0]));}if(!this.lineSymbol){this.lineSymbol=new ESYM.SimpleLineSymbol(ESYM.SimpleLineSymbol.STYLE_SOLID,new _4.Color([0,255,255]),2);}if(!this.fillSymbol){this.fillSymbol=new ESYM.SimpleFillSymbol(ESYM.SimpleFillSymbol.STYLE_NULL,new ESYM.SimpleLineSymbol(ESYM.SimpleLineSymbol.STYLE_SOLID,new _4.Color([0,255,255]),2),new _4.Color([0,0,0,0]));}},disableHighlight:function(map){var _252=this._highlighted;if(_252){_252.hide();map.graphics.remove(_252);delete this._highlighted;}this.markerSymbol=this.lineSymbol=this.fillSymbol=null;},showHighlight:function(){if(this._highlighted&&this.features&&this.features[this.selectedIndex]){this._highlighted.show();}},hideHighlight:function(){if(this._highlighted){this._highlighted.hide();}},updateHighlight:function(map,_253){var _254=_253.geometry,_255=this._highlighted;if(!_254||!_255){return;}_255.hide();if(!_255.getLayer()&&map){map.graphics.add(_255);}_255.setGeometry(esri.geometry.fromJson(_254.toJson()));var _256;switch(_254.type){case "point":case "multipoint":_256=this.markerSymbol;_256.setOffset(0,0);_256.setAngle(0);var lyr=_253.getLayer();if(lyr){var _257=lyr._getSymbol(_253),_258,_259,xoff=0,yoff=0,_25a=0;if(_257){switch(_257.type){case "simplemarkersymbol":_258=_259=(_257.size||0);break;case "picturemarkersymbol":_258=(_257.width||0);_259=(_257.height||0);break;}xoff=_257.xoffset||0;yoff=_257.yoffset||0;_25a=_257.angle||0;}if(_258&&_259){_256._setDim(_258+1,_259+1,7);}_256.setOffset(xoff,yoff);_256.setAngle(_25a);}break;case "polyline":_256=this.lineSymbol;break;case "polygon":_256=this.fillSymbol;break;}_255.setSymbol(_256);},_unbind:function(dfd){var _25b=_4.indexOf(this.deferreds,dfd);if(_25b===-1){return;}this.deferreds.splice(_25b,1);if(!this.deferreds.length){this.deferreds=null;return 2;}return 1;},_updateFeatures:function(dfd,_25c){if(dfd){if(this.deferreds){var res=this._unbind(dfd);if(!res){return;}if(_25c&&_25c instanceof Error){this.onDfdComplete(_25c);if(res===2){this.onSetFeatures();}return;}if(_25c&&_25c.length){if(!this.features){this.features=_25c;this.count=_25c.length;this.selectedIndex=0;this.onDfdComplete();if(res===2){this.onSetFeatures();}this.select(0);}else{var _25d=_4.filter(_25c,function(_25e){return _4.indexOf(this.features,_25e)===-1;},this);this.features=this.features.concat(_25d);this.count=this.features.length;this.onDfdComplete();if(res===2){this.onSetFeatures();}}}else{this.onDfdComplete();if(res===2){this.onSetFeatures();}}}}else{this.features=_25c;this.count=_25c.length;this.selectedIndex=0;this.onSetFeatures();this.select(0);}}});_4.declare("esri.PopupInfoTemplate",[esri.InfoTemplate],{"-chains-":{constructor:"manual"},initialize:function(json){if(!json){return;}this.info=json;this.title=this.getTitle;this.content=this.getContent;var _25f=(this._fieldLabels={}),_260=(this._fieldsMap={});if(json.fieldInfos){_4.forEach(json.fieldInfos,function(_261){_25f[_261.fieldName]=_261.label;_260[_261.fieldName]=_261;});}},toJson:function(){return _4.fromJson(_4.toJson(this.info));},getTitle:function(){},getContent:function(){},getComponents:function(_262){var _263=this.info,_264=_262.getLayer(),_265=_4.clone(_262.attributes)||{},_266=_4.clone(_265),_267=_263.fieldInfos,_268="",_269="",_26a,_26b,_26c,_26d=_264&&_264._getDateOpts&&_264._getDateOpts().properties,_26e={dateFormat:{properties:_26d,formatter:"DateFormat"+this._dateFormats["shortDateShortTime"]}};if(_267){_4.forEach(_267,function(_26f){var _270=_26f.fieldName,val=_266[_270];_266[_270]=this._formatValue(val,_270,_26e);if(_26d&&_26f.format&&_26f.format.dateFormat){var pos=_4.indexOf(_26d,_270);if(pos>-1){_26d.splice(pos,1);}}},this);}if(_264){var _271=_264.types,_272=_264.typeIdField,_273=_272&&_265[_272];for(_26b in _265){_26c=_265[_26b];if(esri._isDefined(_26c)){var _274=this._getDomainName(_264,_271,_273,_26b,_26c);if(esri._isDefined(_274)){_266[_26b]=_274;}else{if(_26b===_272){var _275=this._getTypeName(_264,_26c);if(esri._isDefined(_275)){_266[_26b]=_275;}}}}}}if(_263.title){_268=_4.trim(esri.substitute(_266,this._fixTokens(_263.title),_26e)||"");}if(_263.description){_269=_4.trim(esri.substitute(_266,this._fixTokens(_263.description),_26e)||"");}if(_267){_26a=[];_4.forEach(_267,function(_276){_26b=_276.fieldName;if(_26b&&_276.visible){_26a.push([_276.label||_26b,esri.substitute(_266,"${"+_26b+"}",_26e)||""]);}});}var _277,_278;if(_263.mediaInfos){_277=[];_4.forEach(_263.mediaInfos,function(_279){_278=0;_26c=_279.value;switch(_279.type){case "image":var url=_26c.sourceURL;url=url&&_4.trim(esri.substitute(_265,this._fixTokens(url)));_278=!!url;break;case "piechart":case "linechart":case "columnchart":case "barchart":_278=_4.some(_26c.fields,function(_27a){return esri._isDefined(_265[_27a]);});break;default:return;}if(_278){_279=_4.clone(_279);_26c=_279.value;_279.title=_279.title?_4.trim(esri.substitute(_266,this._fixTokens(_279.title),_26e)||""):"";_279.caption=_279.caption?_4.trim(esri.substitute(_266,this._fixTokens(_279.caption),_26e)||""):"";if(_279.type==="image"){_26c.sourceURL=esri.substitute(_265,this._fixTokens(_26c.sourceURL));if(_26c.linkURL){_26c.linkURL=_4.trim(esri.substitute(_265,this._fixTokens(_26c.linkURL))||"");}}else{var _27b=_265[_26c.normalizeField]||0;_26c.fields=_4.map(_26c.fields,function(_27c){var data=_265[_27c];data=(data===undefined)?null:data;if(data&&_27b){data=data/_27b;}return {y:data,tooltip:(this._fieldLabels[_27c]||_27c)+":<br/>"+this._formatValue(data,_27c,_26e)};},this);}_277.push(_279);}},this);}return {title:_268,description:_269,fields:(_26a&&_26a.length)?_26a:null,mediaInfos:(_277&&_277.length)?_277:null,formatted:_266};},getAttachments:function(_27d){var _27e=_27d.getLayer(),_27f=_27d.attributes;if(this.info.showAttachments&&_27e&&_27e.hasAttachments&&_27e.objectIdField){var oid=_27f&&_27f[_27e.objectIdField];if(oid){return _27e.queryAttachmentInfos(oid);}}},_dateFormats:{"shortDate":"(datePattern: 'M/d/y', selector: 'date')","longMonthDayYear":"(datePattern: 'MMMM d, y', selector: 'date')","dayShortMonthYear":"(datePattern: 'd MMM y', selector: 'date')","longDate":"(datePattern: 'EEEE, MMMM d, y', selector: 'date')","shortDateShortTime":"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')","shortDateShortTime24":"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')","longMonthYear":"(datePattern: 'MMMM y', selector: 'date')","shortMonthYear":"(datePattern: 'MMM y', selector: 'date')","year":"(datePattern: 'y', selector: 'date')"},_fixTokens:function(_280){return _280.replace(/(\{[^\{\r\n]+\})/g,"$$$1");},_formatValue:function(val,_281,_282){var _283=this._fieldsMap[_281],fmt=_283&&_283.format;if(!esri._isDefined(val)||!_283||!esri._isDefined(fmt)){return val;}var _284="",_285=[],_286=fmt.hasOwnProperty("places")||fmt.hasOwnProperty("digitSeparator"),_287=fmt.hasOwnProperty("digitSeparator")?fmt.digitSeparator:true;if(_286){_284="NumberFormat";_285.push("places: "+(esri._isDefined(fmt.places)?Number(fmt.places):"Infinity"));if(_285.length){_284+=("("+_285.join(",")+")");}}else{if(fmt.dateFormat){_284="DateFormat"+(this._dateFormats[fmt.dateFormat]||this._dateFormats["shortDateShortTime"]);}else{return val;}}var _288=esri.substitute({"myKey":val},"${myKey:"+_284+"}",_282)||"";if(_286&&!_287){var _289=_4.i18n.getLocalization("dojo.cldr","number");if(_289.group){_288=_288.replace(new RegExp("\\"+_289.group,"g"),"");}}return _288;},_getDomainName:function(_28a,_28b,_28c,_28d,_28e){var _28f,stop;if(_28b&&esri._isDefined(_28c)){_4.some(_28b,function(_290){if(_290.id==_28c){_28f=_290.domains&&_290.domains[_28d];if(_28f&&_28f.type==="inherited"){_28f=this._getLayerDomain(_28a,_28d);stop=true;}return true;}return false;},this);}if(!stop&&!_28f){_28f=this._getLayerDomain(_28a,_28d);}if(_28f&&_28f.codedValues){var _291;_4.some(_28f.codedValues,function(_292){if(_292.code==_28e){_291=_292.name;return true;}return false;});return _291;}},_getLayerDomain:function(_293,_294){var _295=_293.fields;if(_295){var _296;_4.some(_295,function(_297){if(_297.name===_294){_296=_297.domain;return true;}return false;});return _296;}},_getTypeName:function(_298,id){var _299=_298.types;if(_299){var _29a;_4.some(_299,function(_29b){if(_29b.id==id){_29a=_29b.name;return true;}return false;});return _29a;}}});}if(!_4._hasResource["dojox.charting.scaler.common"]){_4._hasResource["dojox.charting.scaler.common"]=true;_4.provide("dojox.charting.scaler.common");(function(){var eq=function(a,b){return Math.abs(a-b)<=0.000001*(Math.abs(a)+Math.abs(b));};_4.mixin(_6.charting.scaler.common,{findString:function(val,text){val=val.toLowerCase();for(var i=0;i<text.length;++i){if(val==text[i]){return true;}}return false;},getNumericLabel:function(_29c,_29d,_29e){var def="";if(_4.number){def=(_29e.fixed?_4.number.format(_29c,{places:_29d<0?-_29d:0}):_4.number.format(_29c))||"";}else{def=_29e.fixed?_29c.toFixed(_29d<0?-_29d:0):_29c.toString();}if(_29e.labelFunc){var r=_29e.labelFunc(def,_29c,_29d);if(r){return r;}}if(_29e.labels){var l=_29e.labels,lo=0,hi=l.length;while(lo<hi){var mid=Math.floor((lo+hi)/2),val=l[mid].value;if(val<_29c){lo=mid+1;}else{hi=mid;}}if(lo<l.length&&eq(l[lo].value,_29c)){return l[lo].text;}--lo;if(lo>=0&&lo<l.length&&eq(l[lo].value,_29c)){return l[lo].text;}lo+=2;if(lo<l.length&&eq(l[lo].value,_29c)){return l[lo].text;}}return def;}});})();}if(!_4._hasResource["dojox.charting.scaler.linear"]){_4._hasResource["dojox.charting.scaler.linear"]=true;_4.provide("dojox.charting.scaler.linear");(function(){var _29f=3,dc=_6.charting,dcs=dc.scaler,dcsc=dcs.common,_2a0=dcsc.findString,_2a1=dcsc.getNumericLabel;var _2a2=function(min,max,_2a3,_2a4,_2a5,_2a6,span){_2a3=_4.delegate(_2a3);if(!_2a4){if(_2a3.fixUpper=="major"){_2a3.fixUpper="minor";}if(_2a3.fixLower=="major"){_2a3.fixLower="minor";}}if(!_2a5){if(_2a3.fixUpper=="minor"){_2a3.fixUpper="micro";}if(_2a3.fixLower=="minor"){_2a3.fixLower="micro";}}if(!_2a6){if(_2a3.fixUpper=="micro"){_2a3.fixUpper="none";}if(_2a3.fixLower=="micro"){_2a3.fixLower="none";}}var _2a7=_2a0(_2a3.fixLower,["major"])?Math.floor(_2a3.min/_2a4)*_2a4:_2a0(_2a3.fixLower,["minor"])?Math.floor(_2a3.min/_2a5)*_2a5:_2a0(_2a3.fixLower,["micro"])?Math.floor(_2a3.min/_2a6)*_2a6:_2a3.min,_2a8=_2a0(_2a3.fixUpper,["major"])?Math.ceil(_2a3.max/_2a4)*_2a4:_2a0(_2a3.fixUpper,["minor"])?Math.ceil(_2a3.max/_2a5)*_2a5:_2a0(_2a3.fixUpper,["micro"])?Math.ceil(_2a3.max/_2a6)*_2a6:_2a3.max;if(_2a3.useMin){min=_2a7;}if(_2a3.useMax){max=_2a8;}var _2a9=(!_2a4||_2a3.useMin&&_2a0(_2a3.fixLower,["major"]))?min:Math.ceil(min/_2a4)*_2a4,_2aa=(!_2a5||_2a3.useMin&&_2a0(_2a3.fixLower,["major","minor"]))?min:Math.ceil(min/_2a5)*_2a5,_2ab=(!_2a6||_2a3.useMin&&_2a0(_2a3.fixLower,["major","minor","micro"]))?min:Math.ceil(min/_2a6)*_2a6,_2ac=!_2a4?0:(_2a3.useMax&&_2a0(_2a3.fixUpper,["major"])?Math.round((max-_2a9)/_2a4):Math.floor((max-_2a9)/_2a4))+1,_2ad=!_2a5?0:(_2a3.useMax&&_2a0(_2a3.fixUpper,["major","minor"])?Math.round((max-_2aa)/_2a5):Math.floor((max-_2aa)/_2a5))+1,_2ae=!_2a6?0:(_2a3.useMax&&_2a0(_2a3.fixUpper,["major","minor","micro"])?Math.round((max-_2ab)/_2a6):Math.floor((max-_2ab)/_2a6))+1,_2af=_2a5?Math.round(_2a4/_2a5):0,_2b0=_2a6?Math.round(_2a5/_2a6):0,_2b1=_2a4?Math.floor(Math.log(_2a4)/Math.LN10):0,_2b2=_2a5?Math.floor(Math.log(_2a5)/Math.LN10):0,_2b3=span/(max-min);if(!isFinite(_2b3)){_2b3=1;}return {bounds:{lower:_2a7,upper:_2a8,from:min,to:max,scale:_2b3,span:span},major:{tick:_2a4,start:_2a9,count:_2ac,prec:_2b1},minor:{tick:_2a5,start:_2aa,count:_2ad,prec:_2b2},micro:{tick:_2a6,start:_2ab,count:_2ae,prec:0},minorPerMajor:_2af,microPerMinor:_2b0,scaler:dcs.linear};};_4.mixin(_6.charting.scaler.linear,{buildScaler:function(min,max,span,_2b4){var h={fixUpper:"none",fixLower:"none",natural:false};if(_2b4){if("fixUpper" in _2b4){h.fixUpper=String(_2b4.fixUpper);}if("fixLower" in _2b4){h.fixLower=String(_2b4.fixLower);}if("natural" in _2b4){h.natural=Boolean(_2b4.natural);}}if("min" in _2b4){min=_2b4.min;}if("max" in _2b4){max=_2b4.max;}if(_2b4.includeZero){if(min>0){min=0;}if(max<0){max=0;}}h.min=min;h.useMin=true;h.max=max;h.useMax=true;if("from" in _2b4){min=_2b4.from;h.useMin=false;}if("to" in _2b4){max=_2b4.to;h.useMax=false;}if(max<=min){return _2a2(min,max,h,0,0,0,span);}var mag=Math.floor(Math.log(max-min)/Math.LN10),_2b5=_2b4&&("majorTickStep" in _2b4)?_2b4.majorTickStep:Math.pow(10,mag),_2b6=0,_2b7=0,_2b8;if(_2b4&&("minorTickStep" in _2b4)){_2b6=_2b4.minorTickStep;}else{do{_2b6=_2b5/10;if(!h.natural||_2b6>0.9){_2b8=_2a2(min,max,h,_2b5,_2b6,0,span);if(_2b8.bounds.scale*_2b8.minor.tick>_29f){break;}}_2b6=_2b5/5;if(!h.natural||_2b6>0.9){_2b8=_2a2(min,max,h,_2b5,_2b6,0,span);if(_2b8.bounds.scale*_2b8.minor.tick>_29f){break;}}_2b6=_2b5/2;if(!h.natural||_2b6>0.9){_2b8=_2a2(min,max,h,_2b5,_2b6,0,span);if(_2b8.bounds.scale*_2b8.minor.tick>_29f){break;}}return _2a2(min,max,h,_2b5,0,0,span);}while(false);}if(_2b4&&("microTickStep" in _2b4)){_2b7=_2b4.microTickStep;_2b8=_2a2(min,max,h,_2b5,_2b6,_2b7,span);}else{do{_2b7=_2b6/10;if(!h.natural||_2b7>0.9){_2b8=_2a2(min,max,h,_2b5,_2b6,_2b7,span);if(_2b8.bounds.scale*_2b8.micro.tick>_29f){break;}}_2b7=_2b6/5;if(!h.natural||_2b7>0.9){_2b8=_2a2(min,max,h,_2b5,_2b6,_2b7,span);if(_2b8.bounds.scale*_2b8.micro.tick>_29f){break;}}_2b7=_2b6/2;if(!h.natural||_2b7>0.9){_2b8=_2a2(min,max,h,_2b5,_2b6,_2b7,span);if(_2b8.bounds.scale*_2b8.micro.tick>_29f){break;}}_2b7=0;}while(false);}return _2b7?_2b8:_2a2(min,max,h,_2b5,_2b6,0,span);},buildTicks:function(_2b9,_2ba){var step,next,tick,_2bb=_2b9.major.start,_2bc=_2b9.minor.start,_2bd=_2b9.micro.start;if(_2ba.microTicks&&_2b9.micro.tick){step=_2b9.micro.tick,next=_2bd;}else{if(_2ba.minorTicks&&_2b9.minor.tick){step=_2b9.minor.tick,next=_2bc;}else{if(_2b9.major.tick){step=_2b9.major.tick,next=_2bb;}else{return null;}}}var _2be=1/_2b9.bounds.scale;if(_2b9.bounds.to<=_2b9.bounds.from||isNaN(_2be)||!isFinite(_2be)||step<=0||isNaN(step)||!isFinite(step)){return null;}var _2bf=[],_2c0=[],_2c1=[];while(next<=_2b9.bounds.to+_2be){if(Math.abs(_2bb-next)<step/2){tick={value:_2bb};if(_2ba.majorLabels){tick.label=_2a1(_2bb,_2b9.major.prec,_2ba);}_2bf.push(tick);_2bb+=_2b9.major.tick;_2bc+=_2b9.minor.tick;_2bd+=_2b9.micro.tick;}else{if(Math.abs(_2bc-next)<step/2){if(_2ba.minorTicks){tick={value:_2bc};if(_2ba.minorLabels&&(_2b9.minMinorStep<=_2b9.minor.tick*_2b9.bounds.scale)){tick.label=_2a1(_2bc,_2b9.minor.prec,_2ba);}_2c0.push(tick);}_2bc+=_2b9.minor.tick;_2bd+=_2b9.micro.tick;}else{if(_2ba.microTicks){_2c1.push({value:_2bd});}_2bd+=_2b9.micro.tick;}}next+=step;}return {major:_2bf,minor:_2c0,micro:_2c1};},getTransformerFromModel:function(_2c2){var _2c3=_2c2.bounds.from,_2c4=_2c2.bounds.scale;return function(x){return (x-_2c3)*_2c4;};},getTransformerFromPlot:function(_2c5){var _2c6=_2c5.bounds.from,_2c7=_2c5.bounds.scale;return function(x){return x/_2c7+_2c6;};}});})();}if(!_4._hasResource["dojox.charting.axis2d.common"]){_4._hasResource["dojox.charting.axis2d.common"]=true;_4.provide("dojox.charting.axis2d.common");(function(){var g=_6.gfx;var _2c8=function(s){s.marginLeft="0px";s.marginTop="0px";s.marginRight="0px";s.marginBottom="0px";s.paddingLeft="0px";s.paddingTop="0px";s.paddingRight="0px";s.paddingBottom="0px";s.borderLeftWidth="0px";s.borderTopWidth="0px";s.borderRightWidth="0px";s.borderBottomWidth="0px";};var _2c9=function(n){if(n["getBoundingClientRect"]){var bcr=n.getBoundingClientRect();return bcr.width||(bcr.right-bcr.left);}else{return _4.marginBox(n).w;}};_4.mixin(_6.charting.axis2d.common,{createText:{gfx:function(_2ca,_2cb,x,y,_2cc,text,font,_2cd){return _2cb.createText({x:x,y:y,text:text,align:_2cc}).setFont(font).setFill(_2cd);},html:function(_2ce,_2cf,x,y,_2d0,text,font,_2d1,_2d2){var p=_4.doc.createElement("div"),s=p.style,_2d3;_2c8(s);s.font=font;p.innerHTML=String(text).replace(/\s/g,"&nbsp;");s.color=_2d1;s.position="absolute";s.left="-10000px";_4.body().appendChild(p);var size=g.normalizedLength(g.splitFontString(font).size);if(!_2d2){_2d3=_2c9(p);}_4.body().removeChild(p);s.position="relative";if(_2d2){s.width=_2d2+"px";switch(_2d0){case "middle":s.textAlign="center";s.left=(x-_2d2/2)+"px";break;case "end":s.textAlign="right";s.left=(x-_2d2)+"px";break;default:s.left=x+"px";s.textAlign="left";break;}}else{switch(_2d0){case "middle":s.left=Math.floor(x-_2d3/2)+"px";break;case "end":s.left=Math.floor(x-_2d3)+"px";break;default:s.left=Math.floor(x)+"px";break;}}s.top=Math.floor(y-size)+"px";s.whiteSpace="nowrap";var wrap=_4.doc.createElement("div"),w=wrap.style;_2c8(w);w.width="0px";w.height="0px";wrap.appendChild(p);_2ce.node.insertBefore(wrap,_2ce.node.firstChild);return wrap;}}});})();}if(!_4._hasResource["dojox.charting.Element"]){_4._hasResource["dojox.charting.Element"]=true;_4.provide("dojox.charting.Element");_4.declare("dojox.charting.Element",null,{chart:null,group:null,htmlElements:null,dirty:true,constructor:function(_2d4){this.chart=_2d4;this.group=null;this.htmlElements=[];this.dirty=true;this.trailingSymbol="...";this._events=[];},createGroup:function(_2d5){if(!_2d5){_2d5=this.chart.surface;}if(!this.group){this.group=_2d5.createGroup();}return this;},purgeGroup:function(){this.destroyHtmlElements();if(this.group){this.group.clear();this.group.removeShape();this.group=null;}this.dirty=true;if(this._events.length){_4.forEach(this._events,function(item){item.shape.disconnect(item.handle);});this._events=[];}return this;},cleanGroup:function(_2d6){this.destroyHtmlElements();if(!_2d6){_2d6=this.chart.surface;}if(this.group){this.group.clear();}else{this.group=_2d6.createGroup();}this.dirty=true;return this;},destroyHtmlElements:function(){if(this.htmlElements.length){_4.forEach(this.htmlElements,_4.destroy);this.htmlElements=[];}},destroy:function(){this.purgeGroup();},getTextWidth:function(s,font){return _6.gfx._base._getTextBox(s,{font:font}).w||0;},getTextWithLimitLength:function(s,font,_2d7,_2d8){if(!s||s.length<=0){return {text:"",truncated:_2d8||false};}if(!_2d7||_2d7<=0){return {text:s,truncated:_2d8||false};}var _2d9=2,_2da=0.618,_2db=s.substring(0,1)+this.trailingSymbol,_2dc=this.getTextWidth(_2db,font);if(_2d7<=_2dc){return {text:_2db,truncated:true};}var _2dd=this.getTextWidth(s,font);if(_2dd<=_2d7){return {text:s,truncated:_2d8||false};}else{var _2de=0,end=s.length;while(_2de<end){if(end-_2de<=_2d9){while(this.getTextWidth(s.substring(0,_2de)+this.trailingSymbol,font)>_2d7){_2de-=1;}return {text:(s.substring(0,_2de)+this.trailingSymbol),truncated:true};}var _2df=_2de+Math.round((end-_2de)*_2da),_2e0=this.getTextWidth(s.substring(0,_2df),font);if(_2e0<_2d7){_2de=_2df;end=end;}else{_2de=_2de;end=_2df;}}}},getTextWithLimitCharCount:function(s,font,_2e1,_2e2){if(!s||s.length<=0){return {text:"",truncated:_2e2||false};}if(!_2e1||_2e1<=0||s.length<=_2e1){return {text:s,truncated:_2e2||false};}return {text:s.substring(0,_2e1)+this.trailingSymbol,truncated:true};},_plotFill:function(fill,dim,_2e3){if(!fill||!fill.type||!fill.space){return fill;}var _2e4=fill.space;switch(fill.type){case "linear":if(_2e4==="plot"||_2e4==="shapeX"||_2e4==="shapeY"){fill=_6.gfx.makeParameters(_6.gfx.defaultLinearGradient,fill);fill.space=_2e4;if(_2e4==="plot"||_2e4==="shapeX"){var span=dim.height-_2e3.t-_2e3.b;fill.y1=_2e3.t+span*fill.y1/100;fill.y2=_2e3.t+span*fill.y2/100;}if(_2e4==="plot"||_2e4==="shapeY"){var span=dim.width-_2e3.l-_2e3.r;fill.x1=_2e3.l+span*fill.x1/100;fill.x2=_2e3.l+span*fill.x2/100;}}break;case "radial":if(_2e4==="plot"){fill=_6.gfx.makeParameters(_6.gfx.defaultRadialGradient,fill);fill.space=_2e4;var _2e5=dim.width-_2e3.l-_2e3.r,_2e6=dim.height-_2e3.t-_2e3.b;fill.cx=_2e3.l+_2e5*fill.cx/100;fill.cy=_2e3.t+_2e6*fill.cy/100;fill.r=fill.r*Math.sqrt(_2e5*_2e5+_2e6*_2e6)/200;}break;case "pattern":if(_2e4==="plot"||_2e4==="shapeX"||_2e4==="shapeY"){fill=_6.gfx.makeParameters(_6.gfx.defaultPattern,fill);fill.space=_2e4;if(_2e4==="plot"||_2e4==="shapeX"){var span=dim.height-_2e3.t-_2e3.b;fill.y=_2e3.t+span*fill.y/100;fill.height=span*fill.height/100;}if(_2e4==="plot"||_2e4==="shapeY"){var span=dim.width-_2e3.l-_2e3.r;fill.x=_2e3.l+span*fill.x/100;fill.width=span*fill.width/100;}}break;}return fill;},_shapeFill:function(fill,bbox){if(!fill||!fill.space){return fill;}var _2e7=fill.space;switch(fill.type){case "linear":if(_2e7==="shape"||_2e7==="shapeX"||_2e7==="shapeY"){fill=_6.gfx.makeParameters(_6.gfx.defaultLinearGradient,fill);fill.space=_2e7;if(_2e7==="shape"||_2e7==="shapeX"){var span=bbox.width;fill.x1=bbox.x+span*fill.x1/100;fill.x2=bbox.x+span*fill.x2/100;}if(_2e7==="shape"||_2e7==="shapeY"){var span=bbox.height;fill.y1=bbox.y+span*fill.y1/100;fill.y2=bbox.y+span*fill.y2/100;}}break;case "radial":if(_2e7==="shape"){fill=_6.gfx.makeParameters(_6.gfx.defaultRadialGradient,fill);fill.space=_2e7;fill.cx=bbox.x+bbox.width/2;fill.cy=bbox.y+bbox.height/2;fill.r=fill.r*bbox.width/200;}break;case "pattern":if(_2e7==="shape"||_2e7==="shapeX"||_2e7==="shapeY"){fill=_6.gfx.makeParameters(_6.gfx.defaultPattern,fill);fill.space=_2e7;if(_2e7==="shape"||_2e7==="shapeX"){var span=bbox.width;fill.x=bbox.x+span*fill.x/100;fill.width=span*fill.width/100;}if(_2e7==="shape"||_2e7==="shapeY"){var span=bbox.height;fill.y=bbox.y+span*fill.y/100;fill.height=span*fill.height/100;}}break;}return fill;},_pseudoRadialFill:function(fill,_2e8,_2e9,_2ea,end){if(!fill||fill.type!=="radial"||fill.space!=="shape"){return fill;}var _2eb=fill.space;fill=_6.gfx.makeParameters(_6.gfx.defaultRadialGradient,fill);fill.space=_2eb;if(arguments.length<4){fill.cx=_2e8.x;fill.cy=_2e8.y;fill.r=fill.r*_2e9/100;return fill;}var _2ec=arguments.length<5?_2ea:(end+_2ea)/2;return {type:"linear",x1:_2e8.x,y1:_2e8.y,x2:_2e8.x+fill.r*_2e9*Math.cos(_2ec)/100,y2:_2e8.y+fill.r*_2e9*Math.sin(_2ec)/100,colors:fill.colors};return fill;}});}if(!_4._hasResource["dojox.charting.axis2d.Base"]){_4._hasResource["dojox.charting.axis2d.Base"]=true;_4.provide("dojox.charting.axis2d.Base");_4.declare("dojox.charting.axis2d.Base",_6.charting.Element,{constructor:function(_2ed,_2ee){this.vertical=_2ee&&_2ee.vertical;},clear:function(){return this;},initialized:function(){return false;},calculate:function(min,max,span){return this;},getScaler:function(){return null;},getTicks:function(){return null;},getOffsets:function(){return {l:0,r:0,t:0,b:0};},render:function(dim,_2ef){this.dirty=false;return this;}});}if(!_4._hasResource["dojox.lang.functional.lambda"]){_4._hasResource["dojox.lang.functional.lambda"]=true;_4.provide("dojox.lang.functional.lambda");(function(){var df=_6.lang.functional,_2f0={};var _2f1="ab".split(/a*/).length>1?String.prototype.split:function(sep){var r=this.split.call(this,sep),m=sep.exec(this);if(m&&m.index==0){r.unshift("");}return r;};var _2f2=function(s){var args=[],_2f3=_2f1.call(s,/\s*->\s*/m);if(_2f3.length>1){while(_2f3.length){s=_2f3.pop();args=_2f3.pop().split(/\s*,\s*|\s+/m);if(_2f3.length){_2f3.push("(function("+args+"){return ("+s+")})");}}}else{if(s.match(/\b_\b/)){args=["_"];}else{var l=s.match(/^\s*(?:[+*\/%&|\^\.=<>]|!=)/m),r=s.match(/[+\-*\/%&|\^\.=<>!]\s*$/m);if(l||r){if(l){args.push("$1");s="$1"+s;}if(r){args.push("$2");s=s+"$2";}}else{var vars=s.replace(/(?:\b[A-Z]|\.[a-zA-Z_$])[a-zA-Z_$\d]*|[a-zA-Z_$][a-zA-Z_$\d]*:|this|true|false|null|undefined|typeof|instanceof|in|delete|new|void|arguments|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|escape|eval|isFinite|isNaN|parseFloat|parseInt|unescape|dojo|dijit|dojox|window|document|'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"/g,"").match(/([a-z_$][a-z_$\d]*)/gi)||[],t={};_4.forEach(vars,function(v){if(!(v in t)){args.push(v);t[v]=1;}});}}}return {args:args,body:s};};var _2f4=function(a){return a.length?function(){var i=a.length-1,x=df.lambda(a[i]).apply(this,arguments);for(--i;i>=0;--i){x=df.lambda(a[i]).call(this,x);}return x;}:function(x){return x;};};_4.mixin(df,{rawLambda:function(s){return _2f2(s);},buildLambda:function(s){s=_2f2(s);return "function("+s.args.join(",")+"){return ("+s.body+");}";},lambda:function(s){if(typeof s=="function"){return s;}if(s instanceof Array){return _2f4(s);}if(s in _2f0){return _2f0[s];}s=_2f2(s);return _2f0[s]=new Function(s.args,"return ("+s.body+");");},clearLambdaCache:function(){_2f0={};}});})();}if(!_4._hasResource["dojox.lang.functional.array"]){_4._hasResource["dojox.lang.functional.array"]=true;_4.provide("dojox.lang.functional.array");(function(){var d=_4,df=_6.lang.functional,_2f5={};d.mixin(df,{filter:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var t=[],v,i,n;if(d.isArray(a)){for(i=0,n=a.length;i<n;++i){v=a[i];if(f.call(o,v,i,a)){t.push(v);}}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();){v=a.next();if(f.call(o,v,i++,a)){t.push(v);}}}else{for(i in a){if(!(i in _2f5)){v=a[i];if(f.call(o,v,i,a)){t.push(v);}}}}}return t;},forEach:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var i,n;if(d.isArray(a)){for(i=0,n=a.length;i<n;f.call(o,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();f.call(o,a.next(),i++,a)){}}else{for(i in a){if(!(i in _2f5)){f.call(o,a[i],i,a);}}}}return o;},map:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var t,n,i;if(d.isArray(a)){t=new Array(n=a.length);for(i=0;i<n;t[i]=f.call(o,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){t=[];for(i=0;a.hasNext();t.push(f.call(o,a.next(),i++,a))){}}else{t=[];for(i in a){if(!(i in _2f5)){t.push(f.call(o,a[i],i,a));}}}}return t;},every:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var i,n;if(d.isArray(a)){for(i=0,n=a.length;i<n;++i){if(!f.call(o,a[i],i,a)){return false;}}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();){if(!f.call(o,a.next(),i++,a)){return false;}}}else{for(i in a){if(!(i in _2f5)){if(!f.call(o,a[i],i,a)){return false;}}}}}return true;},some:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var i,n;if(d.isArray(a)){for(i=0,n=a.length;i<n;++i){if(f.call(o,a[i],i,a)){return true;}}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();){if(f.call(o,a.next(),i++,a)){return true;}}}else{for(i in a){if(!(i in _2f5)){if(f.call(o,a[i],i,a)){return true;}}}}}return false;}});})();}if(!_4._hasResource["dojox.lang.functional.object"]){_4._hasResource["dojox.lang.functional.object"]=true;_4.provide("dojox.lang.functional.object");(function(){var d=_4,df=_6.lang.functional,_2f6={};d.mixin(df,{keys:function(obj){var t=[];for(var i in obj){if(!(i in _2f6)){t.push(i);}}return t;},values:function(obj){var t=[];for(var i in obj){if(!(i in _2f6)){t.push(obj[i]);}}return t;},filterIn:function(obj,f,o){o=o||d.global;f=df.lambda(f);var t={},v,i;for(i in obj){if(!(i in _2f6)){v=obj[i];if(f.call(o,v,i,obj)){t[i]=v;}}}return t;},forIn:function(obj,f,o){o=o||d.global;f=df.lambda(f);for(var i in obj){if(!(i in _2f6)){f.call(o,obj[i],i,obj);}}return o;},mapIn:function(obj,f,o){o=o||d.global;f=df.lambda(f);var t={},i;for(i in obj){if(!(i in _2f6)){t[i]=f.call(o,obj[i],i,obj);}}return t;}});})();}if(!_4._hasResource["dojox.lang.functional"]){_4._hasResource["dojox.lang.functional"]=true;_4.provide("dojox.lang.functional");}if(!_4._hasResource["dojox.lang.utils"]){_4._hasResource["dojox.lang.utils"]=true;_4.provide("dojox.lang.utils");(function(){var _2f7={},du=_6.lang.utils,opts=Object.prototype.toString;var _2f8=function(o){if(o){switch(opts.call(o)){case "[object Array]":return o.slice(0);case "[object Object]":return _4.delegate(o);}}return o;};_4.mixin(du,{coerceType:function(_2f9,_2fa){switch(typeof _2f9){case "number":return Number(eval("("+_2fa+")"));case "string":return String(_2fa);case "boolean":return Boolean(eval("("+_2fa+")"));}return eval("("+_2fa+")");},updateWithObject:function(_2fb,_2fc,conv){if(!_2fc){return _2fb;}for(var x in _2fb){if(x in _2fc&&!(x in _2f7)){var t=_2fb[x];if(t&&typeof t=="object"){du.updateWithObject(t,_2fc[x],conv);}else{_2fb[x]=conv?du.coerceType(t,_2fc[x]):_2f8(_2fc[x]);}}}return _2fb;},updateWithPattern:function(_2fd,_2fe,_2ff,conv){if(!_2fe||!_2ff){return _2fd;}for(var x in _2ff){if(x in _2fe&&!(x in _2f7)){_2fd[x]=conv?du.coerceType(_2ff[x],_2fe[x]):_2f8(_2fe[x]);}}return _2fd;},merge:function(_300,_301){if(_301){var _302=opts.call(_300),_303=opts.call(_301),t,i,l,m;switch(_303){case "[object Array]":if(_303==_302){t=new Array(Math.max(_300.length,_301.length));for(i=0,l=t.length;i<l;++i){t[i]=du.merge(_300[i],_301[i]);}return t;}return _301.slice(0);case "[object Object]":if(_303==_302&&_300){t=_4.delegate(_300);for(i in _301){if(i in _300){l=_300[i];m=_301[i];if(m!==l){t[i]=du.merge(l,m);}}else{t[i]=_4.clone(_301[i]);}}return t;}return _4.clone(_301);}}return _301;}});})();}if(!_4._hasResource["dojox.charting.axis2d.Invisible"]){_4._hasResource["dojox.charting.axis2d.Invisible"]=true;_4.provide("dojox.charting.axis2d.Invisible");(function(){var dc=_6.charting,df=_6.lang.functional,du=_6.lang.utils,g=_6.gfx,lin=dc.scaler.linear,_304=du.merge,_305=4,_306=45;_4.declare("dojox.charting.axis2d.Invisible",_6.charting.axis2d.Base,{defaultParams:{vertical:false,fixUpper:"none",fixLower:"none",natural:false,leftBottom:true,includeZero:false,fixed:true,majorLabels:true,minorTicks:true,minorLabels:true,microTicks:false,rotation:0},optionalParams:{min:0,max:1,from:0,to:1,majorTickStep:4,minorTickStep:2,microTickStep:1,labels:[],labelFunc:null,maxLabelSize:0,maxLabelCharCount:0,trailingSymbol:null},constructor:function(_307,_308){this.opt=_4.clone(this.defaultParams);du.updateWithObject(this.opt,_308);du.updateWithPattern(this.opt,_308,this.optionalParams);},dependOnData:function(){return !("min" in this.opt)||!("max" in this.opt);},clear:function(){delete this.scaler;delete this.ticks;this.dirty=true;return this;},initialized:function(){return "scaler" in this&&!(this.dirty&&this.dependOnData());},setWindow:function(_309,_30a){this.scale=_309;this.offset=_30a;return this.clear();},getWindowScale:function(){return "scale" in this?this.scale:1;},getWindowOffset:function(){return "offset" in this?this.offset:0;},_groupLabelWidth:function(_30b,font,_30c){if(!_30b.length){return 0;}if(_4.isObject(_30b[0])){_30b=df.map(_30b,function(_30d){return _30d.text;});}if(_30c){_30b=df.map(_30b,function(_30e){return _4.trim(_30e).length==0?"":_30e.substring(0,_30c)+this.trailingSymbol;},this);}var s=_30b.join("<br>");return _6.gfx._base._getTextBox(s,{font:font}).w||0;},calculate:function(min,max,span,_30f){if(this.initialized()){return this;}var o=this.opt;this.labels="labels" in o?o.labels:_30f;this.scaler=lin.buildScaler(min,max,span,o);var tsb=this.scaler.bounds;if("scale" in this){o.from=tsb.lower+this.offset;o.to=(tsb.upper-tsb.lower)/this.scale+o.from;if(!isFinite(o.from)||isNaN(o.from)||!isFinite(o.to)||isNaN(o.to)||o.to-o.from>=tsb.upper-tsb.lower){delete o.from;delete o.to;delete this.scale;delete this.offset;}else{if(o.from<tsb.lower){o.to+=tsb.lower-o.from;o.from=tsb.lower;}else{if(o.to>tsb.upper){o.from+=tsb.upper-o.to;o.to=tsb.upper;}}this.offset=o.from-tsb.lower;}this.scaler=lin.buildScaler(min,max,span,o);tsb=this.scaler.bounds;if(this.scale==1&&this.offset==0){delete this.scale;delete this.offset;}}var ta=this.chart.theme.axis,_310=0,_311=o.rotation%360,_312=o.font||(ta.majorTick&&ta.majorTick.font)||(ta.tick&&ta.tick.font),size=_312?g.normalizedLength(g.splitFontString(_312).size):0,cosr=Math.abs(Math.cos(_311*Math.PI/180)),sinr=Math.abs(Math.sin(_311*Math.PI/180));if(_311<0){_311+=360;}if(size){if(this.vertical?_311!=0&&_311!=180:_311!=90&&_311!=270){if(this.labels){_310=this._groupLabelWidth(this.labels,_312,o.maxLabelCharCount);}else{var _313=Math.ceil(Math.log(Math.max(Math.abs(tsb.from),Math.abs(tsb.to)))/Math.LN10),t=[];if(tsb.from<0||tsb.to<0){t.push("-");}t.push(_4.string.rep("9",_313));var _314=Math.floor(Math.log(tsb.to-tsb.from)/Math.LN10);if(_314>0){t.push(".");t.push(_4.string.rep("9",_314));}_310=_6.gfx._base._getTextBox(t.join(""),{font:_312}).w;}_310=o.maxLabelSize?Math.min(o.maxLabelSize,_310):_310;}else{_310=size;}switch(_311){case 0:case 90:case 180:case 270:break;default:var gap1=Math.sqrt(_310*_310+size*size),gap2=this.vertical?size*cosr+_310*sinr:_310*cosr+size*sinr;_310=Math.min(gap1,gap2);break;}}this.scaler.minMinorStep=_310+_305;this.ticks=lin.buildTicks(this.scaler,o);return this;},getScaler:function(){return this.scaler;},getTicks:function(){return this.ticks;}});})();}if(!_4._hasResource["dojo.colors"]){_4._hasResource["dojo.colors"]=true;_4.provide("dojo.colors");_4.getObject("colors",true,_4);(function(){var _315=function(m1,m2,h){if(h<0){++h;}if(h>1){--h;}var h6=6*h;if(h6<1){return m1+(m2-m1)*h6;}if(2*h<1){return m2;}if(3*h<2){return m1+(m2-m1)*(2/3-h)*6;}return m1;};_4.colorFromRgb=function(_316,obj){var m=_316.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(m){var c=m[2].split(/\s*,\s*/),l=c.length,t=m[1],a;if((t=="rgb"&&l==3)||(t=="rgba"&&l==4)){var r=c[0];if(r.charAt(r.length-1)=="%"){a=_4.map(c,function(x){return parseFloat(x)*2.56;});if(l==4){a[3]=c[3];}return _4.colorFromArray(a,obj);}return _4.colorFromArray(c,obj);}if((t=="hsl"&&l==3)||(t=="hsla"&&l==4)){var H=((parseFloat(c[0])%360)+360)%360/360,S=parseFloat(c[1])/100,L=parseFloat(c[2])/100,m2=L<=0.5?L*(S+1):L+S-L*S,m1=2*L-m2;a=[_315(m1,m2,H+1/3)*256,_315(m1,m2,H)*256,_315(m1,m2,H-1/3)*256,1];if(l==4){a[3]=c[3];}return _4.colorFromArray(a,obj);}}return null;};var _317=function(c,low,high){c=Number(c);return isNaN(c)?high:c<low?low:c>high?high:c;};_4.Color.prototype.sanitize=function(){var t=this;t.r=Math.round(_317(t.r,0,255));t.g=Math.round(_317(t.g,0,255));t.b=Math.round(_317(t.b,0,255));t.a=_317(t.a,0,1);return this;};})();_4.colors.makeGrey=function(g,a){return _4.colorFromArray([g,g,g,a]);};_4.mixin(_4.Color.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],transparent:[0,0,0,0],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});}if(!_4._hasResource["dojox.charting.axis2d.Default"]){_4._hasResource["dojox.charting.axis2d.Default"]=true;_4.provide("dojox.charting.axis2d.Default");(function(){var dc=_6.charting,du=_6.lang.utils,g=_6.gfx,lin=dc.scaler.linear,_318=4,_319=45;_4.declare("dojox.charting.axis2d.Default",_6.charting.axis2d.Invisible,{defaultParams:{vertical:false,fixUpper:"none",fixLower:"none",natural:false,leftBottom:true,includeZero:false,fixed:true,majorLabels:true,minorTicks:true,minorLabels:true,microTicks:false,rotation:0,htmlLabels:true},optionalParams:{min:0,max:1,from:0,to:1,majorTickStep:4,minorTickStep:2,microTickStep:1,labels:[],labelFunc:null,maxLabelSize:0,maxLabelCharCount:0,trailingSymbol:null,stroke:{},majorTick:{},minorTick:{},microTick:{},tick:{},font:"",fontColor:"",title:"",titleGap:0,titleFont:"",titleFontColor:"",titleOrientation:""},constructor:function(_31a,_31b){this.opt=_4.clone(this.defaultParams);du.updateWithObject(this.opt,_31b);du.updateWithPattern(this.opt,_31b,this.optionalParams);},getOffsets:function(){var s=this.scaler,_31c={l:0,r:0,t:0,b:0};if(!s){return _31c;}var o=this.opt,_31d=0,a,b,c,d,gl=dc.scaler.common.getNumericLabel,_31e=0,ma=s.major,mi=s.minor,ta=this.chart.theme.axis,_31f=o.font||(ta.majorTick&&ta.majorTick.font)||(ta.tick&&ta.tick.font),_320=o.titleFont||(ta.tick&&ta.tick.titleFont),_321=(o.titleGap==0)?0:o.titleGap||(ta.tick&&ta.tick.titleGap)||15,_322=this.chart.theme.getTick("major",o),_323=this.chart.theme.getTick("minor",o),size=_31f?g.normalizedLength(g.splitFontString(_31f).size):0,_324=_320?g.normalizedLength(g.splitFontString(_320).size):0,_325=o.rotation%360,_326=o.leftBottom,cosr=Math.abs(Math.cos(_325*Math.PI/180)),sinr=Math.abs(Math.sin(_325*Math.PI/180));this.trailingSymbol=(o.trailingSymbol===undefined||o.trailingSymbol===null)?this.trailingSymbol:o.trailingSymbol;if(_325<0){_325+=360;}if(size){if(this.labels){_31d=this._groupLabelWidth(this.labels,_31f,o.maxLabelCharCount);}else{_31d=this._groupLabelWidth([gl(ma.start,ma.prec,o),gl(ma.start+ma.count*ma.tick,ma.prec,o),gl(mi.start,mi.prec,o),gl(mi.start+mi.count*mi.tick,mi.prec,o)],_31f,o.maxLabelCharCount);}_31d=o.maxLabelSize?Math.min(o.maxLabelSize,_31d):_31d;if(this.vertical){var side=_326?"l":"r";switch(_325){case 0:case 180:_31c[side]=_31d;_31c.t=_31c.b=size/2;break;case 90:case 270:_31c[side]=size;_31c.t=_31c.b=_31d/2;break;default:if(_325<=_319||(180<_325&&_325<=(180+_319))){_31c[side]=size*sinr/2+_31d*cosr;_31c[_326?"t":"b"]=size*cosr/2+_31d*sinr;_31c[_326?"b":"t"]=size*cosr/2;}else{if(_325>(360-_319)||(180>_325&&_325>(180-_319))){_31c[side]=size*sinr/2+_31d*cosr;_31c[_326?"b":"t"]=size*cosr/2+_31d*sinr;_31c[_326?"t":"b"]=size*cosr/2;}else{if(_325<90||(180<_325&&_325<270)){_31c[side]=size*sinr+_31d*cosr;_31c[_326?"t":"b"]=size*cosr+_31d*sinr;}else{_31c[side]=size*sinr+_31d*cosr;_31c[_326?"b":"t"]=size*cosr+_31d*sinr;}}}break;}_31c[side]+=_318+Math.max(_322.length,_323.length)+(o.title?(_324+_321):0);}else{var side=_326?"b":"t";switch(_325){case 0:case 180:_31c[side]=size;_31c.l=_31c.r=_31d/2;break;case 90:case 270:_31c[side]=_31d;_31c.l=_31c.r=size/2;break;default:if((90-_319)<=_325&&_325<=90||(270-_319)<=_325&&_325<=270){_31c[side]=size*sinr/2+_31d*cosr;_31c[_326?"r":"l"]=size*cosr/2+_31d*sinr;_31c[_326?"l":"r"]=size*cosr/2;}else{if(90<=_325&&_325<=(90+_319)||270<=_325&&_325<=(270+_319)){_31c[side]=size*sinr/2+_31d*cosr;_31c[_326?"l":"r"]=size*cosr/2+_31d*sinr;_31c[_326?"r":"l"]=size*cosr/2;}else{if(_325<_319||(180<_325&&_325<(180-_319))){_31c[side]=size*sinr+_31d*cosr;_31c[_326?"r":"l"]=size*cosr+_31d*sinr;}else{_31c[side]=size*sinr+_31d*cosr;_31c[_326?"l":"r"]=size*cosr+_31d*sinr;}}}break;}_31c[side]+=_318+Math.max(_322.length,_323.length)+(o.title?(_324+_321):0);}}if(_31d){this._cachedLabelWidth=_31d;}return _31c;},render:function(dim,_327){if(!this.dirty){return this;}var o=this.opt,ta=this.chart.theme.axis,_328=o.leftBottom,_329=o.rotation%360,_32a,stop,_32b,_32c=0,_32d,_32e,_32f,_330,_331,_332,_333=o.font||(ta.majorTick&&ta.majorTick.font)||(ta.tick&&ta.tick.font),_334=o.titleFont||(ta.tick&&ta.tick.titleFont),_335=o.fontColor||(ta.majorTick&&ta.majorTick.fontColor)||(ta.tick&&ta.tick.fontColor)||"black",_336=o.titleFontColor||(ta.tick&&ta.tick.titleFontColor)||"black",_337=(o.titleGap==0)?0:o.titleGap||(ta.tick&&ta.tick.titleGap)||15,_338=o.titleOrientation||(ta.tick&&ta.tick.titleOrientation)||"axis",_339=this.chart.theme.getTick("major",o),_33a=this.chart.theme.getTick("minor",o),_33b=this.chart.theme.getTick("micro",o),_33c=Math.max(_339.length,_33a.length,_33b.length),_33d="stroke" in o?o.stroke:ta.stroke,size=_333?g.normalizedLength(g.splitFontString(_333).size):0,cosr=Math.abs(Math.cos(_329*Math.PI/180)),sinr=Math.abs(Math.sin(_329*Math.PI/180)),_33e=_334?g.normalizedLength(g.splitFontString(_334).size):0;if(_329<0){_329+=360;}if(this.vertical){_32a={y:dim.height-_327.b};stop={y:_327.t};_32b={y:(dim.height-_327.b+_327.t)/2};_32d=size*sinr+(this._cachedLabelWidth||0)*cosr+_318+Math.max(_339.length,_33a.length)+_33e+_337;_32e={x:0,y:-1};_331={x:0,y:0};_32f={x:1,y:0};_330={x:_318,y:0};switch(_329){case 0:_332="end";_331.y=size*0.4;break;case 90:_332="middle";_331.x=-size;break;case 180:_332="start";_331.y=-size*0.4;break;case 270:_332="middle";break;default:if(_329<_319){_332="end";_331.y=size*0.4;}else{if(_329<90){_332="end";_331.y=size*0.4;}else{if(_329<(180-_319)){_332="start";}else{if(_329<(180+_319)){_332="start";_331.y=-size*0.4;}else{if(_329<270){_332="start";_331.x=_328?0:size*0.4;}else{if(_329<(360-_319)){_332="end";_331.x=_328?0:size*0.4;}else{_332="end";_331.y=size*0.4;}}}}}}}if(_328){_32a.x=stop.x=_327.l;_32c=(_338&&_338=="away")?90:270;_32b.x=_327.l-_32d+(_32c==270?_33e:0);_32f.x=-1;_330.x=-_330.x;}else{_32a.x=stop.x=dim.width-_327.r;_32c=(_338&&_338=="axis")?90:270;_32b.x=dim.width-_327.r+_32d-(_32c==270?0:_33e);switch(_332){case "start":_332="end";break;case "end":_332="start";break;case "middle":_331.x+=size;break;}}}else{_32a={x:_327.l};stop={x:dim.width-_327.r};_32b={x:(dim.width-_327.r+_327.l)/2};_32d=size*cosr+(this._cachedLabelWidth||0)*sinr+_318+Math.max(_339.length,_33a.length)+_33e+_337;_32e={x:1,y:0};_331={x:0,y:0};_32f={x:0,y:1};_330={x:0,y:_318};switch(_329){case 0:_332="middle";_331.y=size;break;case 90:_332="start";_331.x=-size*0.4;break;case 180:_332="middle";break;case 270:_332="end";_331.x=size*0.4;break;default:if(_329<(90-_319)){_332="start";_331.y=_328?size:0;}else{if(_329<(90+_319)){_332="start";_331.x=-size*0.4;}else{if(_329<180){_332="start";_331.y=_328?0:-size;}else{if(_329<(270-_319)){_332="end";_331.y=_328?0:-size;}else{if(_329<(270+_319)){_332="end";_331.y=_328?size*0.4:0;}else{_332="end";_331.y=_328?size:0;}}}}}}if(_328){_32a.y=stop.y=dim.height-_327.b;_32c=(_338&&_338=="axis")?180:0;_32b.y=dim.height-_327.b+_32d-(_32c?_33e:0);}else{_32a.y=stop.y=_327.t;_32c=(_338&&_338=="away")?180:0;_32b.y=_327.t-_32d+(_32c?0:_33e);_32f.y=-1;_330.y=-_330.y;switch(_332){case "start":_332="end";break;case "end":_332="start";break;case "middle":_331.y-=size;break;}}}this.cleanGroup();try{var s=this.group,c=this.scaler,t=this.ticks,_33f,f=lin.getTransformerFromModel(this.scaler),_340=!_32c&&!_329&&this.opt.htmlLabels&&!_4.isIE&&!_4.isOpera?"html":"gfx",dx=_32f.x*_339.length,dy=_32f.y*_339.length;s.createLine({x1:_32a.x,y1:_32a.y,x2:stop.x,y2:stop.y}).setStroke(_33d);if(o.title){var _341=dc.axis2d.common.createText[_340](this.chart,s,_32b.x,_32b.y,"middle",o.title,_334,_336);if(_340=="html"){this.htmlElements.push(_341);}else{_341.setTransform(g.matrix.rotategAt(_32c,_32b.x,_32b.y));}}_4.forEach(t.major,function(tick){var _342=f(tick.value),elem,x=_32a.x+_32e.x*_342,y=_32a.y+_32e.y*_342;s.createLine({x1:x,y1:y,x2:x+dx,y2:y+dy}).setStroke(_339);if(tick.label){var _343=o.maxLabelCharCount?this.getTextWithLimitCharCount(tick.label,_333,o.maxLabelCharCount):{text:tick.label,truncated:false};_343=o.maxLabelSize?this.getTextWithLimitLength(_343.text,_333,o.maxLabelSize,_343.truncated):_343;elem=dc.axis2d.common.createText[_340](this.chart,s,x+dx+_330.x+(_329?0:_331.x),y+dy+_330.y+(_329?0:_331.y),_332,_343.text,_333,_335);_343.truncated&&this.labelTooltip(elem,this.chart,tick.label,_343.text,_333,_340);if(_340=="html"){this.htmlElements.push(elem);}else{if(_329){elem.setTransform([{dx:_331.x,dy:_331.y},g.matrix.rotategAt(_329,x+dx+_330.x,y+dy+_330.y)]);}}}},this);dx=_32f.x*_33a.length;dy=_32f.y*_33a.length;_33f=c.minMinorStep<=c.minor.tick*c.bounds.scale;_4.forEach(t.minor,function(tick){var _344=f(tick.value),elem,x=_32a.x+_32e.x*_344,y=_32a.y+_32e.y*_344;s.createLine({x1:x,y1:y,x2:x+dx,y2:y+dy}).setStroke(_33a);if(_33f&&tick.label){var _345=o.maxLabelCharCount?this.getTextWithLimitCharCount(tick.label,_333,o.maxLabelCharCount):{text:tick.label,truncated:false};_345=o.maxLabelSize?this.getTextWithLimitLength(_345.text,_333,o.maxLabelSize,_345.truncated):_345;elem=dc.axis2d.common.createText[_340](this.chart,s,x+dx+_330.x+(_329?0:_331.x),y+dy+_330.y+(_329?0:_331.y),_332,_345.text,_333,_335);_345.truncated&&this.labelTooltip(elem,this.chart,tick.label,_345.text,_333,_340);if(_340=="html"){this.htmlElements.push(elem);}else{if(_329){elem.setTransform([{dx:_331.x,dy:_331.y},g.matrix.rotategAt(_329,x+dx+_330.x,y+dy+_330.y)]);}}}},this);dx=_32f.x*_33b.length;dy=_32f.y*_33b.length;_4.forEach(t.micro,function(tick){var _346=f(tick.value),elem,x=_32a.x+_32e.x*_346,y=_32a.y+_32e.y*_346;s.createLine({x1:x,y1:y,x2:x+dx,y2:y+dy}).setStroke(_33b);},this);}catch(e){}this.dirty=false;return this;},labelTooltip:function(elem,_347,_348,_349,font,_34a){if(!_5||!_5.Tooltip){return;}var _34b={type:"rect"},_34c=["above","below"],_34d=_6.gfx._base._getTextBox(_349,{font:font}).w||0;fontHeight=font?g.normalizedLength(g.splitFontString(font).size):0;if(_34a=="html"){_4.mixin(_34b,_4.coords(elem.firstChild,true));_34b.width=Math.ceil(_34d);_34b.height=Math.ceil(fontHeight);this._events.push({shape:_4,handle:_4.connect(elem.firstChild,"onmouseover",this,function(e){_5.showTooltip(_348,_34b,_34c);})});this._events.push({shape:_4,handle:_4.connect(elem.firstChild,"onmouseout",this,function(e){_5.hideTooltip(_34b);})});}else{var shp=elem.getShape(),lt=_4.coords(_347.node,true);_34b=_4.mixin(_34b,{x:shp.x-_34d/2,y:shp.y});_34b.x+=lt.x;_34b.y+=lt.y;_34b.x=Math.round(_34b.x);_34b.y=Math.round(_34b.y);_34b.width=Math.ceil(_34d);_34b.height=Math.ceil(fontHeight);this._events.push({shape:elem,handle:elem.connect("onmouseenter",this,function(e){_5.showTooltip(_348,_34b,_34c);})});this._events.push({shape:elem,handle:elem.connect("onmouseleave",this,function(e){_5.hideTooltip(_34b);})});}}});})();}if(!_4._hasResource["dojox.charting.plot2d.common"]){_4._hasResource["dojox.charting.plot2d.common"]=true;_4.provide("dojox.charting.plot2d.common");(function(){var df=_6.lang.functional,dc=_6.charting.plot2d.common;_4.mixin(_6.charting.plot2d.common,{makeStroke:function(_34e){if(!_34e){return _34e;}if(typeof _34e=="string"||_34e instanceof _4.Color){_34e={color:_34e};}return _6.gfx.makeParameters(_6.gfx.defaultStroke,_34e);},augmentColor:function(_34f,_350){var t=new _4.Color(_34f),c=new _4.Color(_350);c.a=t.a;return c;},augmentStroke:function(_351,_352){var s=dc.makeStroke(_351);if(s){s.color=dc.augmentColor(s.color,_352);}return s;},augmentFill:function(fill,_353){var fc,c=new _4.Color(_353);if(typeof fill=="string"||fill instanceof _4.Color){return dc.augmentColor(fill,_353);}return fill;},defaultStats:{vmin:Number.POSITIVE_INFINITY,vmax:Number.NEGATIVE_INFINITY,hmin:Number.POSITIVE_INFINITY,hmax:Number.NEGATIVE_INFINITY},collectSimpleStats:function(_354){var _355=_4.delegate(dc.defaultStats);for(var i=0;i<_354.length;++i){var run=_354[i];for(var j=0;j<run.data.length;j++){if(run.data[j]!==null){if(typeof run.data[j]=="number"){var _356=_355.vmin,_357=_355.vmax;if(!("ymin" in run)||!("ymax" in run)){_4.forEach(run.data,function(val,i){if(val!==null){var x=i+1,y=val;if(isNaN(y)){y=0;}_355.hmin=Math.min(_355.hmin,x);_355.hmax=Math.max(_355.hmax,x);_355.vmin=Math.min(_355.vmin,y);_355.vmax=Math.max(_355.vmax,y);}});}if("ymin" in run){_355.vmin=Math.min(_356,run.ymin);}if("ymax" in run){_355.vmax=Math.max(_357,run.ymax);}}else{var _358=_355.hmin,_359=_355.hmax,_356=_355.vmin,_357=_355.vmax;if(!("xmin" in run)||!("xmax" in run)||!("ymin" in run)||!("ymax" in run)){_4.forEach(run.data,function(val,i){if(val!==null){var x="x" in val?val.x:i+1,y=val.y;if(isNaN(x)){x=0;}if(isNaN(y)){y=0;}_355.hmin=Math.min(_355.hmin,x);_355.hmax=Math.max(_355.hmax,x);_355.vmin=Math.min(_355.vmin,y);_355.vmax=Math.max(_355.vmax,y);}});}if("xmin" in run){_355.hmin=Math.min(_358,run.xmin);}if("xmax" in run){_355.hmax=Math.max(_359,run.xmax);}if("ymin" in run){_355.vmin=Math.min(_356,run.ymin);}if("ymax" in run){_355.vmax=Math.max(_357,run.ymax);}}break;}}}return _355;},calculateBarSize:function(_35a,opt,_35b){if(!_35b){_35b=1;}var gap=opt.gap,size=(_35a-2*gap)/_35b;if("minBarSize" in opt){size=Math.max(size,opt.minBarSize);}if("maxBarSize" in opt){size=Math.min(size,opt.maxBarSize);}size=Math.max(size,1);gap=(_35a-size*_35b)/2;return {size:size,gap:gap};},collectStackedStats:function(_35c){var _35d=_4.clone(dc.defaultStats);if(_35c.length){_35d.hmin=Math.min(_35d.hmin,1);_35d.hmax=df.foldl(_35c,"seed, run -> Math.max(seed, run.data.length)",_35d.hmax);for(var i=0;i<_35d.hmax;++i){var v=_35c[0].data[i];v=v&&(typeof v=="number"?v:v.y);if(isNaN(v)){v=0;}_35d.vmin=Math.min(_35d.vmin,v);for(var j=1;j<_35c.length;++j){var t=_35c[j].data[i];t=t&&(typeof t=="number"?t:t.y);if(isNaN(t)){t=0;}v+=t;}_35d.vmax=Math.max(_35d.vmax,v);}}return _35d;},curve:function(a,_35e){var arr=a.slice(0);if(_35e=="x"){arr[arr.length]=arr[0];}var p=_4.map(arr,function(item,i){if(i==0){return "M"+item.x+","+item.y;}if(!isNaN(_35e)){var dx=item.x-arr[i-1].x,dy=arr[i-1].y;return "C"+(item.x-(_35e-1)*(dx/_35e))+","+dy+" "+(item.x-(dx/_35e))+","+item.y+" "+item.x+","+item.y;}else{if(_35e=="X"||_35e=="x"||_35e=="S"){var p0,p1=arr[i-1],p2=arr[i],p3;var bz1x,bz1y,bz2x,bz2y;var f=1/6;if(i==1){if(_35e=="x"){p0=arr[arr.length-2];}else{p0=p1;}f=1/3;}else{p0=arr[i-2];}if(i==(arr.length-1)){if(_35e=="x"){p3=arr[1];}else{p3=p2;}f=1/3;}else{p3=arr[i+1];}var p1p2=Math.sqrt((p2.x-p1.x)*(p2.x-p1.x)+(p2.y-p1.y)*(p2.y-p1.y));var p0p2=Math.sqrt((p2.x-p0.x)*(p2.x-p0.x)+(p2.y-p0.y)*(p2.y-p0.y));var p1p3=Math.sqrt((p3.x-p1.x)*(p3.x-p1.x)+(p3.y-p1.y)*(p3.y-p1.y));var _35f=p0p2*f;var _360=p1p3*f;if(_35f>p1p2/2&&_360>p1p2/2){_35f=p1p2/2;_360=p1p2/2;}else{if(_35f>p1p2/2){_35f=p1p2/2;_360=p1p2/2*p1p3/p0p2;}else{if(_360>p1p2/2){_360=p1p2/2;_35f=p1p2/2*p0p2/p1p3;}}}if(_35e=="S"){if(p0==p1){_35f=0;}if(p2==p3){_360=0;}}bz1x=p1.x+_35f*(p2.x-p0.x)/p0p2;bz1y=p1.y+_35f*(p2.y-p0.y)/p0p2;bz2x=p2.x-_360*(p3.x-p1.x)/p1p3;bz2y=p2.y-_360*(p3.y-p1.y)/p1p3;}}return "C"+(bz1x+","+bz1y+" "+bz2x+","+bz2y+" "+p2.x+","+p2.y);});return p.join(" ");},getLabel:function(_361,_362,_363){if(_4.number){return (_362?_4.number.format(_361,{places:_363}):_4.number.format(_361))||"";}return _362?_361.toFixed(_363):_361.toString();}});})();}if(!_4._hasResource["dojox.charting.scaler.primitive"]){_4._hasResource["dojox.charting.scaler.primitive"]=true;_4.provide("dojox.charting.scaler.primitive");_6.charting.scaler.primitive={buildScaler:function(min,max,span,_364){if(min==max){min-=0.5;max+=0.5;}return {bounds:{lower:min,upper:max,from:min,to:max,scale:span/(max-min),span:span},scaler:_6.charting.scaler.primitive};},buildTicks:function(_365,_366){return {major:[],minor:[],micro:[]};},getTransformerFromModel:function(_367){var _368=_367.bounds.from,_369=_367.bounds.scale;return function(x){return (x-_368)*_369;};},getTransformerFromPlot:function(_36a){var _36b=_36a.bounds.from,_36c=_36a.bounds.scale;return function(x){return x/_36c+_36b;};}};}if(!_4._hasResource["dojox.charting.plot2d._PlotEvents"]){_4._hasResource["dojox.charting.plot2d._PlotEvents"]=true;_4.provide("dojox.charting.plot2d._PlotEvents");_4.declare("dojox.charting.plot2d._PlotEvents",null,{constructor:function(){this._shapeEvents=[];this._eventSeries={};},destroy:function(){this.resetEvents();this.inherited(arguments);},plotEvent:function(o){},raiseEvent:function(o){this.plotEvent(o);var t=_4.delegate(o);t.originalEvent=o.type;t.originalPlot=o.plot;t.type="onindirect";_4.forEach(this.chart.stack,function(plot){if(plot!==this&&plot.plotEvent){t.plot=plot;plot.plotEvent(t);}},this);},connect:function(_36d,_36e){this.dirty=true;return _4.connect(this,"plotEvent",_36d,_36e);},events:function(){var ls=this.plotEvent._listeners;if(!ls||!ls.length){return false;}for(var i in ls){if(!(i in Array.prototype)){return true;}}return false;},resetEvents:function(){if(this._shapeEvents.length){_4.forEach(this._shapeEvents,function(item){item.shape.disconnect(item.handle);});this._shapeEvents=[];}this.raiseEvent({type:"onplotreset",plot:this});},_connectSingleEvent:function(o,_36f){this._shapeEvents.push({shape:o.eventMask,handle:o.eventMask.connect(_36f,this,function(e){o.type=_36f;o.event=e;this.raiseEvent(o);o.event=null;})});},_connectEvents:function(o){if(o){o.chart=this.chart;o.plot=this;o.hAxis=this.hAxis||null;o.vAxis=this.vAxis||null;o.eventMask=o.eventMask||o.shape;this._connectSingleEvent(o,"onmouseover");this._connectSingleEvent(o,"onmouseout");this._connectSingleEvent(o,"onclick");}},_reconnectEvents:function(_370){var a=this._eventSeries[_370];if(a){_4.forEach(a,this._connectEvents,this);}},fireEvent:function(_371,_372,_373,_374){var s=this._eventSeries[_371];if(s&&s.length&&_373<s.length){var o=s[_373];o.type=_372;o.event=_374||null;this.raiseEvent(o);o.event=null;}}});}if(!_4._hasResource["dojox.charting.plot2d.Base"]){_4._hasResource["dojox.charting.plot2d.Base"]=true;_4.provide("dojox.charting.plot2d.Base");_4.declare("dojox.charting.plot2d.Base",[_6.charting.Element,_6.charting.plot2d._PlotEvents],{constructor:function(_375,_376){this.zoom=null,this.zoomQueue=[];this.lastWindow={vscale:1,hscale:1,xoffset:0,yoffset:0};},clear:function(){this.series=[];this._hAxis=null;this._vAxis=null;this.dirty=true;return this;},setAxis:function(axis){if(axis){this[axis.vertical?"_vAxis":"_hAxis"]=axis;}return this;},addSeries:function(run){this.series.push(run);return this;},getSeriesStats:function(){return _6.charting.plot2d.common.collectSimpleStats(this.series);},calculateAxes:function(dim){this.initializeScalers(dim,this.getSeriesStats());return this;},isDirty:function(){return this.dirty||this._hAxis&&this._hAxis.dirty||this._vAxis&&this._vAxis.dirty;},isDataDirty:function(){return _4.some(this.series,function(item){return item.dirty;});},performZoom:function(dim,_377){var vs=this._vAxis.scale||1,hs=this._hAxis.scale||1,_378=dim.height-_377.b,_379=this._hScaler.bounds,_37a=(_379.from-_379.lower)*_379.scale,_37b=this._vScaler.bounds,_37c=(_37b.from-_37b.lower)*_37b.scale;rVScale=vs/this.lastWindow.vscale,rHScale=hs/this.lastWindow.hscale,rXOffset=(this.lastWindow.xoffset-_37a)/((this.lastWindow.hscale==1)?hs:this.lastWindow.hscale),rYOffset=(_37c-this.lastWindow.yoffset)/((this.lastWindow.vscale==1)?vs:this.lastWindow.vscale),shape=this.group,anim=_6.gfx.fx.animateTransform(_4.delegate({shape:shape,duration:1200,transform:[{name:"translate",start:[0,0],end:[_377.l*(1-rHScale),_378*(1-rVScale)]},{name:"scale",start:[1,1],end:[rHScale,rVScale]},{name:"original"},{name:"translate",start:[0,0],end:[rXOffset,rYOffset]}]},this.zoom));_4.mixin(this.lastWindow,{vscale:vs,hscale:hs,xoffset:_37a,yoffset:_37c});this.zoomQueue.push(anim);_4.connect(anim,"onEnd",this,function(){this.zoom=null;this.zoomQueue.shift();if(this.zoomQueue.length>0){this.zoomQueue[0].play();}});if(this.zoomQueue.length==1){this.zoomQueue[0].play();}return this;},render:function(dim,_37d){return this;},getRequiredColors:function(){return this.series.length;},initializeScalers:function(dim,_37e){if(this._hAxis){if(!this._hAxis.initialized()){this._hAxis.calculate(_37e.hmin,_37e.hmax,dim.width);}this._hScaler=this._hAxis.getScaler();}else{this._hScaler=_6.charting.scaler.primitive.buildScaler(_37e.hmin,_37e.hmax,dim.width);}if(this._vAxis){if(!this._vAxis.initialized()){this._vAxis.calculate(_37e.vmin,_37e.vmax,dim.height);}this._vScaler=this._vAxis.getScaler();}else{this._vScaler=_6.charting.scaler.primitive.buildScaler(_37e.vmin,_37e.vmax,dim.height);}return this;}});}if(!_4._hasResource["dojox.lang.functional.reversed"]){_4._hasResource["dojox.lang.functional.reversed"]=true;_4.provide("dojox.lang.functional.reversed");(function(){var d=_4,df=_6.lang.functional;d.mixin(df,{filterRev:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var t=[],v,i=a.length-1;for(;i>=0;--i){v=a[i];if(f.call(o,v,i,a)){t.push(v);}}return t;},forEachRev:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);for(var i=a.length-1;i>=0;f.call(o,a[i],i,a),--i){}},mapRev:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var n=a.length,t=new Array(n),i=n-1,j=0;for(;i>=0;t[j++]=f.call(o,a[i],i,a),--i){}return t;},everyRev:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);for(var i=a.length-1;i>=0;--i){if(!f.call(o,a[i],i,a)){return false;}}return true;},someRev:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);for(var i=a.length-1;i>=0;--i){if(f.call(o,a[i],i,a)){return true;}}return false;}});})();}if(!_4._hasResource["dojox.gfx.fx"]){_4._hasResource["dojox.gfx.fx"]=true;_4.provide("dojox.gfx.fx");(function(){var d=_4,g=_6.gfx,m=g.matrix;function _37f(_380,end){this.start=_380,this.end=end;};_37f.prototype.getValue=function(r){return (this.end-this.start)*r+this.start;};function _381(_382,end,_383){this.start=_382,this.end=end;this.units=_383;};_381.prototype.getValue=function(r){return (this.end-this.start)*r+this.start+this.units;};function _384(_385,end){this.start=_385,this.end=end;this.temp=new _4.Color();};_384.prototype.getValue=function(r){return d.blendColors(this.start,this.end,r,this.temp);};function _386(_387){this.values=_387;this.length=_387.length;};_386.prototype.getValue=function(r){return this.values[Math.min(Math.floor(r*this.length),this.length-1)];};function _388(_389,def){this.values=_389;this.def=def?def:{};};_388.prototype.getValue=function(r){var ret=_4.clone(this.def);for(var i in this.values){ret[i]=this.values[i].getValue(r);}return ret;};function _38a(_38b,_38c){this.stack=_38b;this.original=_38c;};_38a.prototype.getValue=function(r){var ret=[];_4.forEach(this.stack,function(t){if(t instanceof m.Matrix2D){ret.push(t);return;}if(t.name=="original"&&this.original){ret.push(this.original);return;}if(!(t.name in m)){return;}var f=m[t.name];if(typeof f!="function"){ret.push(f);return;}var val=_4.map(t.start,function(v,i){return (t.end[i]-v)*r+v;}),_38d=f.apply(m,val);if(_38d instanceof m.Matrix2D){ret.push(_38d);}},this);return ret;};var _38e=new d.Color(0,0,0,0);function _38f(prop,obj,name,def){if(prop.values){return new _386(prop.values);}var _390,_391,end;if(prop.start){_391=g.normalizeColor(prop.start);}else{_391=_390=obj?(name?obj[name]:obj):def;}if(prop.end){end=g.normalizeColor(prop.end);}else{if(!_390){_390=obj?(name?obj[name]:obj):def;}end=_390;}return new _384(_391,end);};function _392(prop,obj,name,def){if(prop.values){return new _386(prop.values);}var _393,_394,end;if(prop.start){_394=prop.start;}else{_394=_393=obj?obj[name]:def;}if(prop.end){end=prop.end;}else{if(typeof _393!="number"){_393=obj?obj[name]:def;}end=_393;}return new _37f(_394,end);};g.fx.animateStroke=function(args){if(!args.easing){args.easing=d._defaultEasing;}var anim=new d.Animation(args),_395=args.shape,_396;d.connect(anim,"beforeBegin",anim,function(){_396=_395.getStroke();var prop=args.color,_397={},_398,_399,end;if(prop){_397.color=_38f(prop,_396,"color",_38e);}prop=args.style;if(prop&&prop.values){_397.style=new _386(prop.values);}prop=args.width;if(prop){_397.width=_392(prop,_396,"width",1);}prop=args.cap;if(prop&&prop.values){_397.cap=new _386(prop.values);}prop=args.join;if(prop){if(prop.values){_397.join=new _386(prop.values);}else{_399=prop.start?prop.start:(_396&&_396.join||0);end=prop.end?prop.end:(_396&&_396.join||0);if(typeof _399=="number"&&typeof end=="number"){_397.join=new _37f(_399,end);}}}this.curve=new _388(_397,_396);});d.connect(anim,"onAnimate",_395,"setStroke");return anim;};g.fx.animateFill=function(args){if(!args.easing){args.easing=d._defaultEasing;}var anim=new d.Animation(args),_39a=args.shape,fill;d.connect(anim,"beforeBegin",anim,function(){fill=_39a.getFill();var prop=args.color,_39b={};if(prop){this.curve=_38f(prop,fill,"",_38e);}});d.connect(anim,"onAnimate",_39a,"setFill");return anim;};g.fx.animateFont=function(args){if(!args.easing){args.easing=d._defaultEasing;}var anim=new d.Animation(args),_39c=args.shape,font;d.connect(anim,"beforeBegin",anim,function(){font=_39c.getFont();var prop=args.style,_39d={},_39e,_39f,end;if(prop&&prop.values){_39d.style=new _386(prop.values);}prop=args.variant;if(prop&&prop.values){_39d.variant=new _386(prop.values);}prop=args.weight;if(prop&&prop.values){_39d.weight=new _386(prop.values);}prop=args.family;if(prop&&prop.values){_39d.family=new _386(prop.values);}prop=args.size;if(prop&&prop.units){_39f=parseFloat(prop.start?prop.start:(_39c.font&&_39c.font.size||"0"));end=parseFloat(prop.end?prop.end:(_39c.font&&_39c.font.size||"0"));_39d.size=new _381(_39f,end,prop.units);}this.curve=new _388(_39d,font);});d.connect(anim,"onAnimate",_39c,"setFont");return anim;};g.fx.animateTransform=function(args){if(!args.easing){args.easing=d._defaultEasing;}var anim=new d.Animation(args),_3a0=args.shape,_3a1;d.connect(anim,"beforeBegin",anim,function(){_3a1=_3a0.getTransform();this.curve=new _38a(args.transform,_3a1);});d.connect(anim,"onAnimate",_3a0,"setTransform");return anim;};})();}if(!_4._hasResource["dojox.charting.plot2d.Default"]){_4._hasResource["dojox.charting.plot2d.Default"]=true;_4.provide("dojox.charting.plot2d.Default");(function(){var df=_6.lang.functional,du=_6.lang.utils,dc=_6.charting.plot2d.common,_3a2=df.lambda("item.purgeGroup()");var _3a3=1200;_4.declare("dojox.charting.plot2d.Default",_6.charting.plot2d.Base,{defaultParams:{hAxis:"x",vAxis:"y",lines:true,areas:false,markers:false,tension:"",animate:false},optionalParams:{stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:"",markerStroke:{},markerOutline:{},markerShadow:{},markerFill:{},markerFont:"",markerFontColor:""},constructor:function(_3a4,_3a5){this.opt=_4.clone(this.defaultParams);du.updateWithObject(this.opt,_3a5);du.updateWithPattern(this.opt,_3a5,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},render:function(dim,_3a6){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_3a6);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){_4.forEach(this.series,_3a2);this._eventSeries={};this.cleanGroup();this.group.setTransform(null);var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,_3a7,_3a8,_3a9,_3aa=this.events();for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();if(!run.data.length){run.dirty=false;t.skip();continue;}var _3ab=t.next(this.opt.areas?"area":"line",[this.opt,run],true),s=run.group,_3ac=[],_3ad=[],rseg=null,_3ae,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_3af=this._eventSeries[run.name]=new Array(run.data.length);for(var j=0;j<run.data.length;j++){if(run.data[j]!=null){if(!rseg){rseg=[];_3ad.push(j);_3ac.push(rseg);}rseg.push(run.data[j]);}else{rseg=null;}}for(var seg=0;seg<_3ac.length;seg++){if(typeof _3ac[seg][0]=="number"){_3ae=_4.map(_3ac[seg],function(v,i){return {x:ht(i+_3ad[seg]+1)+_3a6.l,y:dim.height-_3a6.b-vt(v)};},this);}else{_3ae=_4.map(_3ac[seg],function(v,i){return {x:ht(v.x)+_3a6.l,y:dim.height-_3a6.b-vt(v.y)};},this);}var _3b0=this.opt.tension?dc.curve(_3ae,this.opt.tension):"";if(this.opt.areas&&_3ae.length>1){var fill=_3ab.series.fill;var _3b1=_4.clone(_3ae);if(this.opt.tension){var _3b2="L"+_3b1[_3b1.length-1].x+","+(dim.height-_3a6.b)+" L"+_3b1[0].x+","+(dim.height-_3a6.b)+" L"+_3b1[0].x+","+_3b1[0].y;run.dyn.fill=s.createPath(_3b0+" "+_3b2).setFill(fill).getFill();}else{_3b1.push({x:_3ae[_3ae.length-1].x,y:dim.height-_3a6.b});_3b1.push({x:_3ae[0].x,y:dim.height-_3a6.b});_3b1.push(_3ae[0]);run.dyn.fill=s.createPolyline(_3b1).setFill(fill).getFill();}}if(this.opt.lines||this.opt.markers){_3a7=_3ab.series.stroke;if(_3ab.series.outline){_3a8=run.dyn.outline=dc.makeStroke(_3ab.series.outline);_3a8.width=2*_3a8.width+_3a7.width;}}if(this.opt.markers){run.dyn.marker=_3ab.symbol;}var _3b3=null,_3b4=null,_3b5=null;if(_3a7&&_3ab.series.shadow&&_3ae.length>1){var _3b6=_3ab.series.shadow,_3b7=_4.map(_3ae,function(c){return {x:c.x+_3b6.dx,y:c.y+_3b6.dy};});if(this.opt.lines){if(this.opt.tension){run.dyn.shadow=s.createPath(dc.curve(_3b7,this.opt.tension)).setStroke(_3b6).getStroke();}else{run.dyn.shadow=s.createPolyline(_3b7).setStroke(_3b6).getStroke();}}if(this.opt.markers&&_3ab.marker.shadow){_3b6=_3ab.marker.shadow;_3b5=_4.map(_3b7,function(c){return s.createPath("M"+c.x+" "+c.y+" "+_3ab.symbol).setStroke(_3b6).setFill(_3b6.color);},this);}}if(this.opt.lines&&_3ae.length>1){if(_3a8){if(this.opt.tension){run.dyn.outline=s.createPath(_3b0).setStroke(_3a8).getStroke();}else{run.dyn.outline=s.createPolyline(_3ae).setStroke(_3a8).getStroke();}}if(this.opt.tension){run.dyn.stroke=s.createPath(_3b0).setStroke(_3a7).getStroke();}else{run.dyn.stroke=s.createPolyline(_3ae).setStroke(_3a7).getStroke();}}if(this.opt.markers){_3b3=new Array(_3ae.length);_3b4=new Array(_3ae.length);_3a8=null;if(_3ab.marker.outline){_3a8=dc.makeStroke(_3ab.marker.outline);_3a8.width=2*_3a8.width+(_3ab.marker.stroke?_3ab.marker.stroke.width:0);}_4.forEach(_3ae,function(c,i){var path="M"+c.x+" "+c.y+" "+_3ab.symbol;if(_3a8){_3b4[i]=s.createPath(path).setStroke(_3a8);}_3b3[i]=s.createPath(path).setStroke(_3ab.marker.stroke).setFill(_3ab.marker.fill);},this);run.dyn.markerFill=_3ab.marker.fill;run.dyn.markerStroke=_3ab.marker.stroke;if(_3aa){_4.forEach(_3b3,function(s,i){var o={element:"marker",index:i+_3ad[seg],run:run,shape:s,outline:_3b4[i]||null,shadow:_3b5&&_3b5[i]||null,cx:_3ae[i].x,cy:_3ae[i].y};if(typeof _3ac[seg][0]=="number"){o.x=i+_3ad[seg]+1;o.y=_3ac[seg][i];}else{o.x=_3ac[seg][i].x;o.y=_3ac[seg][i].y;}this._connectEvents(o);_3af[i+_3ad[seg]]=o;},this);}else{delete this._eventSeries[run.name];}}}run.dirty=false;}if(this.animate){var _3b8=this.group;_6.gfx.fx.animateTransform(_4.delegate({shape:_3b8,duration:_3a3,transform:[{name:"translate",start:[0,dim.height-_3a6.b],end:[0,0]},{name:"scale",start:[1,0],end:[1,1]},{name:"original"}]},this.animate)).play();}this.dirty=false;return this;}});})();}if(!_4._hasResource["dojox.charting.plot2d.Lines"]){_4._hasResource["dojox.charting.plot2d.Lines"]=true;_4.provide("dojox.charting.plot2d.Lines");_4.declare("dojox.charting.plot2d.Lines",_6.charting.plot2d.Default,{constructor:function(){this.opt.lines=true;}});}if(!_4._hasResource["dojox.charting.plot2d.Areas"]){_4._hasResource["dojox.charting.plot2d.Areas"]=true;_4.provide("dojox.charting.plot2d.Areas");_4.declare("dojox.charting.plot2d.Areas",_6.charting.plot2d.Default,{constructor:function(){this.opt.lines=true;this.opt.areas=true;}});}if(!_4._hasResource["dojox.charting.plot2d.Markers"]){_4._hasResource["dojox.charting.plot2d.Markers"]=true;_4.provide("dojox.charting.plot2d.Markers");_4.declare("dojox.charting.plot2d.Markers",_6.charting.plot2d.Default,{constructor:function(){this.opt.markers=true;}});}if(!_4._hasResource["dojox.charting.plot2d.MarkersOnly"]){_4._hasResource["dojox.charting.plot2d.MarkersOnly"]=true;_4.provide("dojox.charting.plot2d.MarkersOnly");_4.declare("dojox.charting.plot2d.MarkersOnly",_6.charting.plot2d.Default,{constructor:function(){this.opt.lines=false;this.opt.markers=true;}});}if(!_4._hasResource["dojox.gfx.gradutils"]){_4._hasResource["dojox.gfx.gradutils"]=true;_4.provide("dojox.gfx.gradutils");(function(){var d=_4,m=_6.gfx.matrix,C=d.Color;function _3b9(o,c){if(o<=0){return c[0].color;}var len=c.length;if(o>=1){return c[len-1].color;}for(var i=0;i<len;++i){var stop=c[i];if(stop.offset>=o){if(i){var prev=c[i-1];return d.blendColors(new C(prev.color),new C(stop.color),(o-prev.offset)/(stop.offset-prev.offset));}return stop.color;}}return c[len-1].color;};_6.gfx.gradutils.getColor=function(fill,pt){var o;if(fill){switch(fill.type){case "linear":var _3ba=Math.atan2(fill.y2-fill.y1,fill.x2-fill.x1),_3bb=m.rotate(-_3ba),_3bc=m.project(fill.x2-fill.x1,fill.y2-fill.y1),p=m.multiplyPoint(_3bc,pt),pf1=m.multiplyPoint(_3bc,fill.x1,fill.y1),pf2=m.multiplyPoint(_3bc,fill.x2,fill.y2),_3bd=m.multiplyPoint(_3bb,pf2.x-pf1.x,pf2.y-pf1.y).x,o=m.multiplyPoint(_3bb,p.x-pf1.x,p.y-pf1.y).x/_3bd;break;case "radial":var dx=pt.x-fill.cx,dy=pt.y-fill.cy,o=Math.sqrt(dx*dx+dy*dy)/fill.r;break;}return _3b9(o,fill.colors);}return new C(fill||[0,0,0,0]);};_6.gfx.gradutils.reverse=function(fill){if(fill){switch(fill.type){case "linear":case "radial":fill=_4.delegate(fill);if(fill.colors){var c=fill.colors,l=c.length,i=0,stop,n=fill.colors=new Array(c.length);for(;i<l;++i){stop=c[i];n[i]={offset:1-stop.offset,color:stop.color};}n.sort(function(a,b){return a.offset-b.offset;});}break;}}return fill;};})();}if(!_4._hasResource["dojox.charting.plot2d.Scatter"]){_4._hasResource["dojox.charting.plot2d.Scatter"]=true;_4.provide("dojox.charting.plot2d.Scatter");(function(){var df=_6.lang.functional,du=_6.lang.utils,dc=_6.charting.plot2d.common,_3be=df.lambda("item.purgeGroup()");_4.declare("dojox.charting.plot2d.Scatter",_6.charting.plot2d.Base,{defaultParams:{hAxis:"x",vAxis:"y",shadows:null,animate:null},optionalParams:{markerStroke:{},markerOutline:{},markerShadow:{},markerFill:{},markerFont:"",markerFontColor:""},constructor:function(_3bf,_3c0){this.opt=_4.clone(this.defaultParams);du.updateWithObject(this.opt,_3c0);du.updateWithPattern(this.opt,_3c0,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},render:function(dim,_3c1){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_3c1);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){_4.forEach(this.series,_3be);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,_3c2=this.events();for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();if(!run.data.length){run.dirty=false;t.skip();continue;}var _3c3=t.next("marker",[this.opt,run]),s=run.group,_3c4,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler);if(typeof run.data[0]=="number"){_3c4=_4.map(run.data,function(v,i){return {x:ht(i+1)+_3c1.l,y:dim.height-_3c1.b-vt(v)};},this);}else{_3c4=_4.map(run.data,function(v,i){return {x:ht(v.x)+_3c1.l,y:dim.height-_3c1.b-vt(v.y)};},this);}var _3c5=new Array(_3c4.length),_3c6=new Array(_3c4.length),_3c7=new Array(_3c4.length);_4.forEach(_3c4,function(c,i){var _3c8=typeof run.data[i]=="number"?t.post(_3c3,"marker"):t.addMixin(_3c3,"marker",run.data[i],true),path="M"+c.x+" "+c.y+" "+_3c8.symbol;if(_3c8.marker.shadow){_3c5[i]=s.createPath("M"+(c.x+_3c8.marker.shadow.dx)+" "+(c.y+_3c8.marker.shadow.dy)+" "+_3c8.symbol).setStroke(_3c8.marker.shadow).setFill(_3c8.marker.shadow.color);if(this.animate){this._animateScatter(_3c5[i],dim.height-_3c1.b);}}if(_3c8.marker.outline){var _3c9=dc.makeStroke(_3c8.marker.outline);_3c9.width=2*_3c9.width+_3c8.marker.stroke.width;_3c7[i]=s.createPath(path).setStroke(_3c9);if(this.animate){this._animateScatter(_3c7[i],dim.height-_3c1.b);}}var _3ca=dc.makeStroke(_3c8.marker.stroke),fill=this._plotFill(_3c8.marker.fill,dim,_3c1);if(fill&&(fill.type==="linear"||fill.type=="radial")){var _3cb=_6.gfx.gradutils.getColor(fill,{x:c.x,y:c.y});if(_3ca){_3ca.color=_3cb;}_3c6[i]=s.createPath(path).setStroke(_3ca).setFill(_3cb);}else{_3c6[i]=s.createPath(path).setStroke(_3ca).setFill(fill);}if(this.animate){this._animateScatter(_3c6[i],dim.height-_3c1.b);}},this);if(_3c6.length){run.dyn.stroke=_3c6[_3c6.length-1].getStroke();run.dyn.fill=_3c6[_3c6.length-1].getFill();}if(_3c2){var _3cc=new Array(_3c6.length);_4.forEach(_3c6,function(s,i){var o={element:"marker",index:i,run:run,shape:s,outline:_3c7&&_3c7[i]||null,shadow:_3c5&&_3c5[i]||null,cx:_3c4[i].x,cy:_3c4[i].y};if(typeof run.data[0]=="number"){o.x=i+1;o.y=run.data[i];}else{o.x=run.data[i].x;o.y=run.data[i].y;}this._connectEvents(o);_3cc[i]=o;},this);this._eventSeries[run.name]=_3cc;}else{delete this._eventSeries[run.name];}run.dirty=false;}this.dirty=false;return this;},_animateScatter:function(_3cd,_3ce){_6.gfx.fx.animateTransform(_4.delegate({shape:_3cd,duration:1200,transform:[{name:"translate",start:[0,_3ce],end:[0,0]},{name:"scale",start:[0,0],end:[1,1]},{name:"original"}]},this.animate)).play();}});})();}if(!_4._hasResource["dojox.lang.functional.sequence"]){_4._hasResource["dojox.lang.functional.sequence"]=true;_4.provide("dojox.lang.functional.sequence");(function(){var d=_4,df=_6.lang.functional;d.mixin(df,{repeat:function(n,f,z,o){o=o||d.global;f=df.lambda(f);var t=new Array(n),i=1;t[0]=z;for(;i<n;t[i]=z=f.call(o,z),++i){}return t;},until:function(pr,f,z,o){o=o||d.global;f=df.lambda(f);pr=df.lambda(pr);var t=[];for(;!pr.call(o,z);t.push(z),z=f.call(o,z)){}return t;}});})();}if(!_4._hasResource["dojox.charting.plot2d.Stacked"]){_4._hasResource["dojox.charting.plot2d.Stacked"]=true;_4.provide("dojox.charting.plot2d.Stacked");(function(){var df=_6.lang.functional,dc=_6.charting.plot2d.common,_3cf=df.lambda("item.purgeGroup()");_4.declare("dojox.charting.plot2d.Stacked",_6.charting.plot2d.Default,{getSeriesStats:function(){var _3d0=dc.collectStackedStats(this.series);this._maxRunLength=_3d0.hmax;return _3d0;},render:function(dim,_3d1){if(this._maxRunLength<=0){return this;}var acc=df.repeat(this._maxRunLength,"-> 0",0);for(var i=0;i<this.series.length;++i){var run=this.series[i];for(var j=0;j<run.data.length;++j){var v=run.data[j];if(v!==null){if(isNaN(v)){v=0;}acc[j]+=v;}}}if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_3d1);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){_4.forEach(this.series,_3cf);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,_3d2=this.events(),ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler);for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _3d3=t.next(this.opt.areas?"area":"line",[this.opt,run],true),s=run.group,_3d4,_3d5=_4.map(acc,function(v,i){return {x:ht(i+1)+_3d1.l,y:dim.height-_3d1.b-vt(v)};},this);var _3d6=this.opt.tension?dc.curve(_3d5,this.opt.tension):"";if(this.opt.areas){var _3d7=_4.clone(_3d5);if(this.opt.tension){var p=dc.curve(_3d7,this.opt.tension);p+=" L"+_3d5[_3d5.length-1].x+","+(dim.height-_3d1.b)+" L"+_3d5[0].x+","+(dim.height-_3d1.b)+" L"+_3d5[0].x+","+_3d5[0].y;run.dyn.fill=s.createPath(p).setFill(_3d3.series.fill).getFill();}else{_3d7.push({x:_3d5[_3d5.length-1].x,y:dim.height-_3d1.b});_3d7.push({x:_3d5[0].x,y:dim.height-_3d1.b});_3d7.push(_3d5[0]);run.dyn.fill=s.createPolyline(_3d7).setFill(_3d3.series.fill).getFill();}}if(this.opt.lines||this.opt.markers){if(_3d3.series.outline){_3d4=dc.makeStroke(_3d3.series.outline);_3d4.width=2*_3d4.width+_3d3.series.stroke.width;}}if(this.opt.markers){run.dyn.marker=_3d3.symbol;}var _3d8,_3d9,_3da;if(_3d3.series.shadow&&_3d3.series.stroke){var _3db=_3d3.series.shadow,_3dc=_4.map(_3d5,function(c){return {x:c.x+_3db.dx,y:c.y+_3db.dy};});if(this.opt.lines){if(this.opt.tension){run.dyn.shadow=s.createPath(dc.curve(_3dc,this.opt.tension)).setStroke(_3db).getStroke();}else{run.dyn.shadow=s.createPolyline(_3dc).setStroke(_3db).getStroke();}}if(this.opt.markers){_3db=_3d3.marker.shadow;_3da=_4.map(_3dc,function(c){return s.createPath("M"+c.x+" "+c.y+" "+_3d3.symbol).setStroke(_3db).setFill(_3db.color);},this);}}if(this.opt.lines){if(_3d4){if(this.opt.tension){run.dyn.outline=s.createPath(_3d6).setStroke(_3d4).getStroke();}else{run.dyn.outline=s.createPolyline(_3d5).setStroke(_3d4).getStroke();}}if(this.opt.tension){run.dyn.stroke=s.createPath(_3d6).setStroke(_3d3.series.stroke).getStroke();}else{run.dyn.stroke=s.createPolyline(_3d5).setStroke(_3d3.series.stroke).getStroke();}}if(this.opt.markers){_3d8=new Array(_3d5.length);_3d9=new Array(_3d5.length);_3d4=null;if(_3d3.marker.outline){_3d4=dc.makeStroke(_3d3.marker.outline);_3d4.width=2*_3d4.width+(_3d3.marker.stroke?_3d3.marker.stroke.width:0);}_4.forEach(_3d5,function(c,i){var path="M"+c.x+" "+c.y+" "+_3d3.symbol;if(_3d4){_3d9[i]=s.createPath(path).setStroke(_3d4);}_3d8[i]=s.createPath(path).setStroke(_3d3.marker.stroke).setFill(_3d3.marker.fill);},this);if(_3d2){var _3dd=new Array(_3d8.length);_4.forEach(_3d8,function(s,i){var o={element:"marker",index:i,run:run,shape:s,outline:_3d9[i]||null,shadow:_3da&&_3da[i]||null,cx:_3d5[i].x,cy:_3d5[i].y,x:i+1,y:run.data[i]};this._connectEvents(o);_3dd[i]=o;},this);this._eventSeries[run.name]=_3dd;}else{delete this._eventSeries[run.name];}}run.dirty=false;for(var j=0;j<run.data.length;++j){var v=run.data[j];if(v!==null){if(isNaN(v)){v=0;}acc[j]-=v;}}}this.dirty=false;return this;}});})();}if(!_4._hasResource["dojox.charting.plot2d.StackedLines"]){_4._hasResource["dojox.charting.plot2d.StackedLines"]=true;_4.provide("dojox.charting.plot2d.StackedLines");_4.declare("dojox.charting.plot2d.StackedLines",_6.charting.plot2d.Stacked,{constructor:function(){this.opt.lines=true;}});}if(!_4._hasResource["dojox.charting.plot2d.StackedAreas"]){_4._hasResource["dojox.charting.plot2d.StackedAreas"]=true;_4.provide("dojox.charting.plot2d.StackedAreas");_4.declare("dojox.charting.plot2d.StackedAreas",_6.charting.plot2d.Stacked,{constructor:function(){this.opt.lines=true;this.opt.areas=true;}});}if(!_4._hasResource["dojox.charting.plot2d.Columns"]){_4._hasResource["dojox.charting.plot2d.Columns"]=true;_4.provide("dojox.charting.plot2d.Columns");(function(){var df=_6.lang.functional,du=_6.lang.utils,dc=_6.charting.plot2d.common,_3de=df.lambda("item.purgeGroup()");_4.declare("dojox.charting.plot2d.Columns",_6.charting.plot2d.Base,{defaultParams:{hAxis:"x",vAxis:"y",gap:0,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(_3df,_3e0){this.opt=_4.clone(this.defaultParams);du.updateWithObject(this.opt,_3e0);du.updateWithPattern(this.opt,_3e0,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},getSeriesStats:function(){var _3e1=dc.collectSimpleStats(this.series);_3e1.hmin-=0.5;_3e1.hmax+=0.5;return _3e1;},render:function(dim,_3e2){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_3e2);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){_4.forEach(this.series,_3de);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_3e3,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_3e4=Math.max(0,this._vScaler.bounds.lower),_3e5=vt(_3e4),_3e6=this.events();f=dc.calculateBarSize(this._hScaler.bounds.scale,this.opt);gap=f.gap;_3e3=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _3e7=t.next("column",[this.opt,run]),s=run.group,_3e8=new Array(run.data.length);for(var j=0;j<run.data.length;++j){var _3e9=run.data[j];if(_3e9!==null){var v=typeof _3e9=="number"?_3e9:_3e9.y,vv=vt(v),_3ea=vv-_3e5,h=Math.abs(_3ea),_3eb=typeof _3e9!="number"?t.addMixin(_3e7,"column",_3e9,true):t.post(_3e7,"column");if(_3e3>=1&&h>=1){var rect={x:_3e2.l+ht(j+0.5)+gap,y:dim.height-_3e2.b-(v>_3e4?vv:_3e5),width:_3e3,height:h};var _3ec=this._plotFill(_3eb.series.fill,dim,_3e2);_3ec=this._shapeFill(_3ec,rect);var _3ed=s.createRect(rect).setFill(_3ec).setStroke(_3eb.series.stroke);run.dyn.fill=_3ed.getFill();run.dyn.stroke=_3ed.getStroke();if(_3e6){var o={element:"column",index:j,run:run,shape:_3ed,x:j+0.5,y:v};this._connectEvents(o);_3e8[j]=o;}if(this.animate){this._animateColumn(_3ed,dim.height-_3e2.b-_3e5,h);}}}}this._eventSeries[run.name]=_3e8;run.dirty=false;}this.dirty=false;return this;},_animateColumn:function(_3ee,_3ef,_3f0){_6.gfx.fx.animateTransform(_4.delegate({shape:_3ee,duration:1200,transform:[{name:"translate",start:[0,_3ef-(_3ef/_3f0)],end:[0,0]},{name:"scale",start:[1,1/_3f0],end:[1,1]},{name:"original"}]},this.animate)).play();}});})();}if(!_4._hasResource["dojox.charting.plot2d.StackedColumns"]){_4._hasResource["dojox.charting.plot2d.StackedColumns"]=true;_4.provide("dojox.charting.plot2d.StackedColumns");(function(){var df=_6.lang.functional,dc=_6.charting.plot2d.common,_3f1=df.lambda("item.purgeGroup()");_4.declare("dojox.charting.plot2d.StackedColumns",_6.charting.plot2d.Columns,{getSeriesStats:function(){var _3f2=dc.collectStackedStats(this.series);this._maxRunLength=_3f2.hmax;_3f2.hmin-=0.5;_3f2.hmax+=0.5;return _3f2;},render:function(dim,_3f3){if(this._maxRunLength<=0){return this;}var acc=df.repeat(this._maxRunLength,"-> 0",0);for(var i=0;i<this.series.length;++i){var run=this.series[i];for(var j=0;j<run.data.length;++j){var _3f4=run.data[j];if(_3f4!==null){var v=typeof _3f4=="number"?_3f4:_3f4.y;if(isNaN(v)){v=0;}acc[j]+=v;}}}if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_3f3);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){_4.forEach(this.series,_3f1);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_3f5,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_3f6=this.events();f=dc.calculateBarSize(this._hScaler.bounds.scale,this.opt);gap=f.gap;_3f5=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _3f7=t.next("column",[this.opt,run]),s=run.group,_3f8=new Array(acc.length);for(var j=0;j<acc.length;++j){var _3f4=run.data[j];if(_3f4!==null){var v=acc[j],_3f9=vt(v),_3fa=typeof _3f4!="number"?t.addMixin(_3f7,"column",_3f4,true):t.post(_3f7,"column");if(_3f5>=1&&_3f9>=1){var rect={x:_3f3.l+ht(j+0.5)+gap,y:dim.height-_3f3.b-vt(v),width:_3f5,height:_3f9};var _3fb=this._plotFill(_3fa.series.fill,dim,_3f3);_3fb=this._shapeFill(_3fb,rect);var _3fc=s.createRect(rect).setFill(_3fb).setStroke(_3fa.series.stroke);run.dyn.fill=_3fc.getFill();run.dyn.stroke=_3fc.getStroke();if(_3f6){var o={element:"column",index:j,run:run,shape:_3fc,x:j+0.5,y:v};this._connectEvents(o);_3f8[j]=o;}if(this.animate){this._animateColumn(_3fc,dim.height-_3f3.b,_3f9);}}}}this._eventSeries[run.name]=_3f8;run.dirty=false;for(var j=0;j<run.data.length;++j){var _3f4=run.data[j];if(_3f4!==null){var v=typeof _3f4=="number"?_3f4:_3f4.y;if(isNaN(v)){v=0;}acc[j]-=v;}}}this.dirty=false;return this;}});})();}if(!_4._hasResource["dojox.charting.plot2d.ClusteredColumns"]){_4._hasResource["dojox.charting.plot2d.ClusteredColumns"]=true;_4.provide("dojox.charting.plot2d.ClusteredColumns");(function(){var df=_6.lang.functional,dc=_6.charting.plot2d.common,_3fd=df.lambda("item.purgeGroup()");_4.declare("dojox.charting.plot2d.ClusteredColumns",_6.charting.plot2d.Columns,{render:function(dim,_3fe){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_3fe);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){_4.forEach(this.series,_3fd);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_3ff,_400,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_401=Math.max(0,this._vScaler.bounds.lower),_402=vt(_401),_403=this.events();f=dc.calculateBarSize(this._hScaler.bounds.scale,this.opt,this.series.length);gap=f.gap;_3ff=_400=f.size;for(var i=0;i<this.series.length;++i){var run=this.series[i],_404=_400*i;if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _405=t.next("column",[this.opt,run]),s=run.group,_406=new Array(run.data.length);for(var j=0;j<run.data.length;++j){var _407=run.data[j];if(_407!==null){var v=typeof _407=="number"?_407:_407.y,vv=vt(v),_408=vv-_402,h=Math.abs(_408),_409=typeof _407!="number"?t.addMixin(_405,"column",_407,true):t.post(_405,"column");if(_3ff>=1&&h>=1){var rect={x:_3fe.l+ht(j+0.5)+gap+_404,y:dim.height-_3fe.b-(v>_401?vv:_402),width:_3ff,height:h};var _40a=this._plotFill(_409.series.fill,dim,_3fe);_40a=this._shapeFill(_40a,rect);var _40b=s.createRect(rect).setFill(_40a).setStroke(_409.series.stroke);run.dyn.fill=_40b.getFill();run.dyn.stroke=_40b.getStroke();if(_403){var o={element:"column",index:j,run:run,shape:_40b,x:j+0.5,y:v};this._connectEvents(o);_406[j]=o;}if(this.animate){this._animateColumn(_40b,dim.height-_3fe.b-_402,h);}}}}this._eventSeries[run.name]=_406;run.dirty=false;}this.dirty=false;return this;}});})();}if(!_4._hasResource["dojox.charting.plot2d.Bars"]){_4._hasResource["dojox.charting.plot2d.Bars"]=true;_4.provide("dojox.charting.plot2d.Bars");(function(){var df=_6.lang.functional,du=_6.lang.utils,dc=_6.charting.plot2d.common,_40c=df.lambda("item.purgeGroup()");_4.declare("dojox.charting.plot2d.Bars",_6.charting.plot2d.Base,{defaultParams:{hAxis:"x",vAxis:"y",gap:0,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(_40d,_40e){this.opt=_4.clone(this.defaultParams);du.updateWithObject(this.opt,_40e);du.updateWithPattern(this.opt,_40e,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},getSeriesStats:function(){var _40f=dc.collectSimpleStats(this.series),t;_40f.hmin-=0.5;_40f.hmax+=0.5;t=_40f.hmin,_40f.hmin=_40f.vmin,_40f.vmin=t;t=_40f.hmax,_40f.hmax=_40f.vmax,_40f.vmax=t;return _40f;},render:function(dim,_410){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_410);}this.dirty=this.isDirty();this.resetEvents();if(this.dirty){_4.forEach(this.series,_40c);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_411,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_412=Math.max(0,this._hScaler.bounds.lower),_413=ht(_412),_414=this.events();f=dc.calculateBarSize(this._vScaler.bounds.scale,this.opt);gap=f.gap;_411=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _415=t.next("bar",[this.opt,run]),s=run.group,_416=new Array(run.data.length);for(var j=0;j<run.data.length;++j){var _417=run.data[j];if(_417!==null){var v=typeof _417=="number"?_417:_417.y,hv=ht(v),_418=hv-_413,w=Math.abs(_418),_419=typeof _417!="number"?t.addMixin(_415,"bar",_417,true):t.post(_415,"bar");if(w>=1&&_411>=1){var rect={x:_410.l+(v<_412?hv:_413),y:dim.height-_410.b-vt(j+1.5)+gap,width:w,height:_411};var _41a=this._plotFill(_419.series.fill,dim,_410);_41a=this._shapeFill(_41a,rect);var _41b=s.createRect(rect).setFill(_41a).setStroke(_419.series.stroke);run.dyn.fill=_41b.getFill();run.dyn.stroke=_41b.getStroke();if(_414){var o={element:"bar",index:j,run:run,shape:_41b,x:v,y:j+1.5};this._connectEvents(o);_416[j]=o;}if(this.animate){this._animateBar(_41b,_410.l+_413,-w);}}}}this._eventSeries[run.name]=_416;run.dirty=false;}this.dirty=false;return this;},_animateBar:function(_41c,_41d,_41e){_6.gfx.fx.animateTransform(_4.delegate({shape:_41c,duration:1200,transform:[{name:"translate",start:[_41d-(_41d/_41e),0],end:[0,0]},{name:"scale",start:[1/_41e,1],end:[1,1]},{name:"original"}]},this.animate)).play();}});})();}if(!_4._hasResource["dojox.charting.plot2d.StackedBars"]){_4._hasResource["dojox.charting.plot2d.StackedBars"]=true;_4.provide("dojox.charting.plot2d.StackedBars");(function(){var df=_6.lang.functional,dc=_6.charting.plot2d.common,_41f=df.lambda("item.purgeGroup()");_4.declare("dojox.charting.plot2d.StackedBars",_6.charting.plot2d.Bars,{getSeriesStats:function(){var _420=dc.collectStackedStats(this.series),t;this._maxRunLength=_420.hmax;_420.hmin-=0.5;_420.hmax+=0.5;t=_420.hmin,_420.hmin=_420.vmin,_420.vmin=t;t=_420.hmax,_420.hmax=_420.vmax,_420.vmax=t;return _420;},render:function(dim,_421){if(this._maxRunLength<=0){return this;}var acc=df.repeat(this._maxRunLength,"-> 0",0);for(var i=0;i<this.series.length;++i){var run=this.series[i];for(var j=0;j<run.data.length;++j){var _422=run.data[j];if(_422!==null){var v=typeof _422=="number"?_422:_422.y;if(isNaN(v)){v=0;}acc[j]+=v;}}}if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_421);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){_4.forEach(this.series,_41f);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_423,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_424=this.events();f=dc.calculateBarSize(this._vScaler.bounds.scale,this.opt);gap=f.gap;_423=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _425=t.next("bar",[this.opt,run]),s=run.group,_426=new Array(acc.length);for(var j=0;j<acc.length;++j){var _422=run.data[j];if(_422!==null){var v=acc[j],_427=ht(v),_428=typeof _422!="number"?t.addMixin(_425,"bar",_422,true):t.post(_425,"bar");if(_427>=1&&_423>=1){var rect={x:_421.l,y:dim.height-_421.b-vt(j+1.5)+gap,width:_427,height:_423};var _429=this._plotFill(_428.series.fill,dim,_421);_429=this._shapeFill(_429,rect);var _42a=s.createRect(rect).setFill(_429).setStroke(_428.series.stroke);run.dyn.fill=_42a.getFill();run.dyn.stroke=_42a.getStroke();if(_424){var o={element:"bar",index:j,run:run,shape:_42a,x:v,y:j+1.5};this._connectEvents(o);_426[j]=o;}if(this.animate){this._animateBar(_42a,_421.l,-_427);}}}}this._eventSeries[run.name]=_426;run.dirty=false;for(var j=0;j<run.data.length;++j){var _422=run.data[j];if(_422!==null){var v=typeof _422=="number"?_422:_422.y;if(isNaN(v)){v=0;}acc[j]-=v;}}}this.dirty=false;return this;}});})();}if(!_4._hasResource["dojox.charting.plot2d.ClusteredBars"]){_4._hasResource["dojox.charting.plot2d.ClusteredBars"]=true;_4.provide("dojox.charting.plot2d.ClusteredBars");(function(){var df=_6.lang.functional,dc=_6.charting.plot2d.common,_42b=df.lambda("item.purgeGroup()");_4.declare("dojox.charting.plot2d.ClusteredBars",_6.charting.plot2d.Bars,{render:function(dim,_42c){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_42c);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){_4.forEach(this.series,_42b);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_42d,_42e,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_42f=Math.max(0,this._hScaler.bounds.lower),_430=ht(_42f),_431=this.events();f=dc.calculateBarSize(this._vScaler.bounds.scale,this.opt,this.series.length);gap=f.gap;_42d=_42e=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i],_432=_42e*(this.series.length-i-1);if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _433=t.next("bar",[this.opt,run]),s=run.group,_434=new Array(run.data.length);for(var j=0;j<run.data.length;++j){var _435=run.data[j];if(_435!==null){var v=typeof _435=="number"?_435:_435.y,hv=ht(v),_436=hv-_430,w=Math.abs(_436),_437=typeof _435!="number"?t.addMixin(_433,"bar",_435,true):t.post(_433,"bar");if(w>=1&&_42d>=1){var rect={x:_42c.l+(v<_42f?hv:_430),y:dim.height-_42c.b-vt(j+1.5)+gap+_432,width:w,height:_42d};var _438=this._plotFill(_437.series.fill,dim,_42c);_438=this._shapeFill(_438,rect);var _439=s.createRect(rect).setFill(_438).setStroke(_437.series.stroke);run.dyn.fill=_439.getFill();run.dyn.stroke=_439.getStroke();if(_431){var o={element:"bar",index:j,run:run,shape:_439,x:v,y:j+1.5};this._connectEvents(o);_434[j]=o;}if(this.animate){this._animateBar(_439,_42c.l+_430,-_436);}}}}this._eventSeries[run.name]=_434;run.dirty=false;}this.dirty=false;return this;}});})();}if(!_4._hasResource["dojox.charting.plot2d.Grid"]){_4._hasResource["dojox.charting.plot2d.Grid"]=true;_4.provide("dojox.charting.plot2d.Grid");(function(){var du=_6.lang.utils,dc=_6.charting.plot2d.common;_4.declare("dojox.charting.plot2d.Grid",_6.charting.Element,{defaultParams:{hAxis:"x",vAxis:"y",hMajorLines:true,hMinorLines:false,vMajorLines:true,vMinorLines:false,hStripes:"none",vStripes:"none",animate:null},optionalParams:{},constructor:function(_43a,_43b){this.opt=_4.clone(this.defaultParams);du.updateWithObject(this.opt,_43b);this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.dirty=true;this.animate=this.opt.animate;this.zoom=null,this.zoomQueue=[];this.lastWindow={vscale:1,hscale:1,xoffset:0,yoffset:0};},clear:function(){this._hAxis=null;this._vAxis=null;this.dirty=true;return this;},setAxis:function(axis){if(axis){this[axis.vertical?"_vAxis":"_hAxis"]=axis;}return this;},addSeries:function(run){return this;},getSeriesStats:function(){return _4.delegate(dc.defaultStats);},initializeScalers:function(){return this;},isDirty:function(){return this.dirty||this._hAxis&&this._hAxis.dirty||this._vAxis&&this._vAxis.dirty;},performZoom:function(dim,_43c){var vs=this._vAxis.scale||1,hs=this._hAxis.scale||1,_43d=dim.height-_43c.b,_43e=this._hAxis.getScaler().bounds,_43f=(_43e.from-_43e.lower)*_43e.scale,_440=this._vAxis.getScaler().bounds,_441=(_440.from-_440.lower)*_440.scale;rVScale=vs/this.lastWindow.vscale,rHScale=hs/this.lastWindow.hscale,rXOffset=(this.lastWindow.xoffset-_43f)/((this.lastWindow.hscale==1)?hs:this.lastWindow.hscale),rYOffset=(_441-this.lastWindow.yoffset)/((this.lastWindow.vscale==1)?vs:this.lastWindow.vscale),shape=this.group,anim=_6.gfx.fx.animateTransform(_4.delegate({shape:shape,duration:1200,transform:[{name:"translate",start:[0,0],end:[_43c.l*(1-rHScale),_43d*(1-rVScale)]},{name:"scale",start:[1,1],end:[rHScale,rVScale]},{name:"original"},{name:"translate",start:[0,0],end:[rXOffset,rYOffset]}]},this.zoom));_4.mixin(this.lastWindow,{vscale:vs,hscale:hs,xoffset:_43f,yoffset:_441});this.zoomQueue.push(anim);_4.connect(anim,"onEnd",this,function(){this.zoom=null;this.zoomQueue.shift();if(this.zoomQueue.length>0){this.zoomQueue[0].play();}});if(this.zoomQueue.length==1){this.zoomQueue[0].play();}return this;},getRequiredColors:function(){return 0;},render:function(dim,_442){if(this.zoom){return this.performZoom(dim,_442);}this.dirty=this.isDirty();if(!this.dirty){return this;}this.cleanGroup();var s=this.group,ta=this.chart.theme.axis;try{var _443=this._vAxis.getScaler(),vt=_443.scaler.getTransformerFromModel(_443),_444=this._vAxis.getTicks();if(this.opt.hMinorLines){_4.forEach(_444.minor,function(tick){var y=dim.height-_442.b-vt(tick.value);var _445=s.createLine({x1:_442.l,y1:y,x2:dim.width-_442.r,y2:y}).setStroke(ta.minorTick);if(this.animate){this._animateGrid(_445,"h",_442.l,_442.r+_442.l-dim.width);}},this);}if(this.opt.hMajorLines){_4.forEach(_444.major,function(tick){var y=dim.height-_442.b-vt(tick.value);var _446=s.createLine({x1:_442.l,y1:y,x2:dim.width-_442.r,y2:y}).setStroke(ta.majorTick);if(this.animate){this._animateGrid(_446,"h",_442.l,_442.r+_442.l-dim.width);}},this);}}catch(e){}try{var _447=this._hAxis.getScaler(),ht=_447.scaler.getTransformerFromModel(_447),_444=this._hAxis.getTicks();if(_444&&this.opt.vMinorLines){_4.forEach(_444.minor,function(tick){var x=_442.l+ht(tick.value);var _448=s.createLine({x1:x,y1:_442.t,x2:x,y2:dim.height-_442.b}).setStroke(ta.minorTick);if(this.animate){this._animateGrid(_448,"v",dim.height-_442.b,dim.height-_442.b-_442.t);}},this);}if(_444&&this.opt.vMajorLines){_4.forEach(_444.major,function(tick){var x=_442.l+ht(tick.value);var _449=s.createLine({x1:x,y1:_442.t,x2:x,y2:dim.height-_442.b}).setStroke(ta.majorTick);if(this.animate){this._animateGrid(_449,"v",dim.height-_442.b,dim.height-_442.b-_442.t);}},this);}}catch(e){}this.dirty=false;return this;},_animateGrid:function(_44a,type,_44b,size){var _44c=type=="h"?[_44b,0]:[0,_44b];var _44d=type=="h"?[1/size,1]:[1,1/size];_6.gfx.fx.animateTransform(_4.delegate({shape:_44a,duration:1200,transform:[{name:"translate",start:_44c,end:[0,0]},{name:"scale",start:_44d,end:[1,1]},{name:"original"}]},this.animate)).play();}});})();}if(!_4._hasResource["dojox.charting.plot2d.Pie"]){_4._hasResource["dojox.charting.plot2d.Pie"]=true;_4.provide("dojox.charting.plot2d.Pie");(function(){var df=_6.lang.functional,du=_6.lang.utils,dc=_6.charting.plot2d.common,da=_6.charting.axis2d.common,g=_6.gfx,m=g.matrix,_44e=0.2;_4.declare("dojox.charting.plot2d.Pie",[_6.charting.Element,_6.charting.plot2d._PlotEvents],{defaultParams:{labels:true,ticks:false,fixed:true,precision:1,labelOffset:20,labelStyle:"default",htmlLabels:true,radGrad:"native",fanSize:5,startAngle:0},optionalParams:{radius:0,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:"",labelWiring:{}},constructor:function(_44f,_450){this.opt=_4.clone(this.defaultParams);du.updateWithObject(this.opt,_450);du.updateWithPattern(this.opt,_450,this.optionalParams);this.run=null;this.dyn=[];},clear:function(){this.dirty=true;this.dyn=[];this.run=null;return this;},setAxis:function(axis){return this;},addSeries:function(run){this.run=run;return this;},getSeriesStats:function(){return _4.delegate(dc.defaultStats);},initializeScalers:function(){return this;},getRequiredColors:function(){return this.run?this.run.data.length:0;},render:function(dim,_451){if(!this.dirty){return this;}this.resetEvents();this.dirty=false;this._eventSeries={};this.cleanGroup();var s=this.group,t=this.chart.theme;if(!this.run||!this.run.data.length){return this;}var rx=(dim.width-_451.l-_451.r)/2,ry=(dim.height-_451.t-_451.b)/2,r=Math.min(rx,ry),_452="font" in this.opt?this.opt.font:t.axis.font,size=_452?g.normalizedLength(g.splitFontString(_452).size):0,_453="fontColor" in this.opt?this.opt.fontColor:t.axis.fontColor,_454=m._degToRad(this.opt.startAngle),_455=_454,step,_456,_457,_458,_459,_45a,run=this.run.data,_45b=this.events();if(typeof run[0]=="number"){_456=df.map(run,"x ? Math.max(x, 0) : 0");if(df.every(_456,"<= 0")){return this;}_457=df.map(_456,"/this",df.foldl(_456,"+",0));if(this.opt.labels){_458=_4.map(_457,function(x){return x>0?this._getLabel(x*100)+"%":"";},this);}}else{_456=df.map(run,"x ? Math.max(x.y, 0) : 0");if(df.every(_456,"<= 0")){return this;}_457=df.map(_456,"/this",df.foldl(_456,"+",0));if(this.opt.labels){_458=_4.map(_457,function(x,i){if(x<=0){return "";}var v=run[i];return "text" in v?v.text:this._getLabel(x*100)+"%";},this);}}var _45c=df.map(run,function(v,i){if(v===null||typeof v=="number"){return t.next("slice",[this.opt,this.run],true);}return t.next("slice",[this.opt,this.run,v],true);},this);if(this.opt.labels){_459=df.foldl1(df.map(_458,function(_45d,i){var font=_45c[i].series.font;return _6.gfx._base._getTextBox(_45d,{font:font}).w;},this),"Math.max(a, b)")/2;if(this.opt.labelOffset<0){r=Math.min(rx-2*_459,ry-size)+this.opt.labelOffset;}_45a=r-this.opt.labelOffset;}if("radius" in this.opt){r=this.opt.radius;_45a=r-this.opt.labelOffset;}var _45e={cx:_451.l+rx,cy:_451.t+ry,r:r};this.dyn=[];var _45f=new Array(_457.length);_4.some(_457,function(_460,i){if(_460<0){return false;}if(_460==0){this.dyn.push({fill:null,stroke:null});return false;}var v=run[i],_461=_45c[i],_462;if(_460>=1){_462=this._plotFill(_461.series.fill,dim,_451);_462=this._shapeFill(_462,{x:_45e.cx-_45e.r,y:_45e.cy-_45e.r,width:2*_45e.r,height:2*_45e.r});_462=this._pseudoRadialFill(_462,{x:_45e.cx,y:_45e.cy},_45e.r);var _463=s.createCircle(_45e).setFill(_462).setStroke(_461.series.stroke);this.dyn.push({fill:_462,stroke:_461.series.stroke});if(_45b){var o={element:"slice",index:i,run:this.run,shape:_463,x:i,y:typeof v=="number"?v:v.y,cx:_45e.cx,cy:_45e.cy,cr:r};this._connectEvents(o);_45f[i]=o;}return true;}var end=_455+_460*2*Math.PI;if(i+1==_457.length){end=_454+2*Math.PI;}var step=end-_455,x1=_45e.cx+r*Math.cos(_455),y1=_45e.cy+r*Math.sin(_455),x2=_45e.cx+r*Math.cos(end),y2=_45e.cy+r*Math.sin(end);var _464=m._degToRad(this.opt.fanSize);if(_461.series.fill&&_461.series.fill.type==="radial"&&this.opt.radGrad==="fan"&&step>_464){var _465=s.createGroup(),_466=Math.ceil(step/_464),_467=step/_466;_462=this._shapeFill(_461.series.fill,{x:_45e.cx-_45e.r,y:_45e.cy-_45e.r,width:2*_45e.r,height:2*_45e.r});for(var j=0;j<_466;++j){var _468=j==0?x1:_45e.cx+r*Math.cos(_455+(j-_44e)*_467),_469=j==0?y1:_45e.cy+r*Math.sin(_455+(j-_44e)*_467),_46a=j==_466-1?x2:_45e.cx+r*Math.cos(_455+(j+1+_44e)*_467),_46b=j==_466-1?y2:_45e.cy+r*Math.sin(_455+(j+1+_44e)*_467),fan=_465.createPath({}).moveTo(_45e.cx,_45e.cy).lineTo(_468,_469).arcTo(r,r,0,_467>Math.PI,true,_46a,_46b).lineTo(_45e.cx,_45e.cy).closePath().setFill(this._pseudoRadialFill(_462,{x:_45e.cx,y:_45e.cy},r,_455+(j+0.5)*_467,_455+(j+0.5)*_467));}_465.createPath({}).moveTo(_45e.cx,_45e.cy).lineTo(x1,y1).arcTo(r,r,0,step>Math.PI,true,x2,y2).lineTo(_45e.cx,_45e.cy).closePath().setStroke(_461.series.stroke);_463=_465;}else{_463=s.createPath({}).moveTo(_45e.cx,_45e.cy).lineTo(x1,y1).arcTo(r,r,0,step>Math.PI,true,x2,y2).lineTo(_45e.cx,_45e.cy).closePath().setStroke(_461.series.stroke);var _462=_461.series.fill;if(_462&&_462.type==="radial"){_462=this._shapeFill(_462,{x:_45e.cx-_45e.r,y:_45e.cy-_45e.r,width:2*_45e.r,height:2*_45e.r});if(this.opt.radGrad==="linear"){_462=this._pseudoRadialFill(_462,{x:_45e.cx,y:_45e.cy},r,_455,end);}}else{if(_462&&_462.type==="linear"){_462=this._plotFill(_462,dim,_451);_462=this._shapeFill(_462,_463.getBoundingBox());}}_463.setFill(_462);}this.dyn.push({fill:_462,stroke:_461.series.stroke});if(_45b){var o={element:"slice",index:i,run:this.run,shape:_463,x:i,y:typeof v=="number"?v:v.y,cx:_45e.cx,cy:_45e.cy,cr:r};this._connectEvents(o);_45f[i]=o;}_455=end;return false;},this);if(this.opt.labels){if(this.opt.labelStyle=="default"){_455=_454;_4.some(_457,function(_46c,i){if(_46c<=0){return false;}var _46d=_45c[i];if(_46c>=1){var v=run[i],elem=da.createText[this.opt.htmlLabels&&_6.gfx.renderer!="vml"?"html":"gfx"](this.chart,s,_45e.cx,_45e.cy+size/2,"middle",_458[i],_46d.series.font,_46d.series.fontColor);if(this.opt.htmlLabels){this.htmlElements.push(elem);}return true;}var end=_455+_46c*2*Math.PI,v=run[i];if(i+1==_457.length){end=_454+2*Math.PI;}var _46e=(_455+end)/2,x=_45e.cx+_45a*Math.cos(_46e),y=_45e.cy+_45a*Math.sin(_46e)+size/2;var elem=da.createText[this.opt.htmlLabels&&_6.gfx.renderer!="vml"?"html":"gfx"](this.chart,s,x,y,"middle",_458[i],_46d.series.font,_46d.series.fontColor);if(this.opt.htmlLabels){this.htmlElements.push(elem);}_455=end;return false;},this);}else{if(this.opt.labelStyle=="columns"){_455=_454;var _46f=[];_4.forEach(_457,function(_470,i){var end=_455+_470*2*Math.PI;if(i+1==_457.length){end=_454+2*Math.PI;}var _471=(_455+end)/2;_46f.push({angle:_471,left:Math.cos(_471)<0,theme:_45c[i],index:i,omit:end-_455<0.001});_455=end;});var _472=_6.gfx._base._getTextBox("a",{font:_452}).h;this._getProperLabelRadius(_46f,_472,_45e.r*1.1);_4.forEach(_46f,function(_473,i){if(!_473.omit){var _474=_45e.cx-_45e.r*2,_475=_45e.cx+_45e.r*2,_476=_6.gfx._base._getTextBox(_458[i],{font:_452}).w,x=_45e.cx+_473.labelR*Math.cos(_473.angle),y=_45e.cy+_473.labelR*Math.sin(_473.angle),_477=(_473.left)?(_474+_476):(_475-_476),_478=(_473.left)?_474:_477;var _479=s.createPath().moveTo(_45e.cx+_45e.r*Math.cos(_473.angle),_45e.cy+_45e.r*Math.sin(_473.angle));if(Math.abs(_473.labelR*Math.cos(_473.angle))<_45e.r*2-_476){_479.lineTo(x,y);}_479.lineTo(_477,y).setStroke(_473.theme.series.labelWiring);var elem=da.createText[this.opt.htmlLabels&&_6.gfx.renderer!="vml"?"html":"gfx"](this.chart,s,_478,y,"left",_458[i],_473.theme.series.font,_473.theme.series.fontColor);if(this.opt.htmlLabels){this.htmlElements.push(elem);}}},this);}}}var esi=0;this._eventSeries[this.run.name]=df.map(run,function(v){return v<=0?null:_45f[esi++];});return this;},_getProperLabelRadius:function(_47a,_47b,_47c){var _47d={},_47e={},_47f=1,_480=1;if(_47a.length==1){_47a[0].labelR=_47c;return;}for(var i=0;i<_47a.length;i++){var _481=Math.abs(Math.sin(_47a[i].angle));if(_47a[i].left){if(_47f>_481){_47f=_481;_47d=_47a[i];}}else{if(_480>_481){_480=_481;_47e=_47a[i];}}}_47d.labelR=_47e.labelR=_47c;this._caculateLabelR(_47d,_47a,_47b);this._caculateLabelR(_47e,_47a,_47b);},_caculateLabelR:function(_482,_483,_484){var i=_482.index,_485=_483.length,_486=_482.labelR;while(!(_483[i%_485].left^_483[(i+1)%_485].left)){if(!_483[(i+1)%_485].omit){var _487=(Math.sin(_483[i%_485].angle)*_486+((_483[i%_485].left)?(-_484):_484))/Math.sin(_483[(i+1)%_485].angle);_486=(_487<_482.labelR)?_482.labelR:_487;_483[(i+1)%_485].labelR=_486;}i++;}i=_482.index,j=(i==0)?_485-1:i-1;while(!(_483[i].left^_483[j].left)){if(!_483[j].omit){var _487=(Math.sin(_483[i].angle)*_486+((_483[i].left)?_484:(-_484)))/Math.sin(_483[j].angle);_486=(_487<_482.labelR)?_482.labelR:_487;_483[j].labelR=_486;}i--;j--;i=(i<0)?i+_483.length:i;j=(j<0)?j+_483.length:j;}},_getLabel:function(_488){return dc.getLabel(_488,this.opt.fixed,this.opt.precision);}});})();}if(!_4._hasResource["dojox.charting.plot2d.Bubble"]){_4._hasResource["dojox.charting.plot2d.Bubble"]=true;_4.provide("dojox.charting.plot2d.Bubble");(function(){var df=_6.lang.functional,du=_6.lang.utils,dc=_6.charting.plot2d.common,_489=df.lambda("item.purgeGroup()");_4.declare("dojox.charting.plot2d.Bubble",_6.charting.plot2d.Base,{defaultParams:{hAxis:"x",vAxis:"y",animate:null},optionalParams:{stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(_48a,_48b){this.opt=_4.clone(this.defaultParams);du.updateWithObject(this.opt,_48b);du.updateWithPattern(this.opt,_48b,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},render:function(dim,_48c){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_48c);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){_4.forEach(this.series,_489);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_48d=this.events();for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();if(!run.data.length){run.dirty=false;t.skip();continue;}if(typeof run.data[0]=="number"){console.warn("dojox.charting.plot2d.Bubble: the data in the following series cannot be rendered as a bubble chart; ",run);continue;}var _48e=t.next("circle",[this.opt,run]),s=run.group,_48f=_4.map(run.data,function(v,i){return v?{x:ht(v.x)+_48c.l,y:dim.height-_48c.b-vt(v.y),radius:this._vScaler.bounds.scale*(v.size/2)}:null;},this);var _490=null,_491=null,_492=null;if(_48e.series.shadow){_492=_4.map(_48f,function(item){if(item!==null){var _493=t.addMixin(_48e,"circle",item,true),_494=_493.series.shadow;var _495=s.createCircle({cx:item.x+_494.dx,cy:item.y+_494.dy,r:item.radius}).setStroke(_494).setFill(_494.color);if(this.animate){this._animateBubble(_495,dim.height-_48c.b,item.radius);}return _495;}return null;},this);if(_492.length){run.dyn.shadow=_492[_492.length-1].getStroke();}}if(_48e.series.outline){_491=_4.map(_48f,function(item){if(item!==null){var _496=t.addMixin(_48e,"circle",item,true),_497=dc.makeStroke(_496.series.outline);_497.width=2*_497.width+_48e.series.stroke.width;var _498=s.createCircle({cx:item.x,cy:item.y,r:item.radius}).setStroke(_497);if(this.animate){this._animateBubble(_498,dim.height-_48c.b,item.radius);}return _498;}return null;},this);if(_491.length){run.dyn.outline=_491[_491.length-1].getStroke();}}_490=_4.map(_48f,function(item){if(item!==null){var _499=t.addMixin(_48e,"circle",item,true),rect={x:item.x-item.radius,y:item.y-item.radius,width:2*item.radius,height:2*item.radius};var _49a=this._plotFill(_499.series.fill,dim,_48c);_49a=this._shapeFill(_49a,rect);var _49b=s.createCircle({cx:item.x,cy:item.y,r:item.radius}).setFill(_49a).setStroke(_499.series.stroke);if(this.animate){this._animateBubble(_49b,dim.height-_48c.b,item.radius);}return _49b;}return null;},this);if(_490.length){run.dyn.fill=_490[_490.length-1].getFill();run.dyn.stroke=_490[_490.length-1].getStroke();}if(_48d){var _49c=new Array(_490.length);_4.forEach(_490,function(s,i){if(s!==null){var o={element:"circle",index:i,run:run,shape:s,outline:_491&&_491[i]||null,shadow:_492&&_492[i]||null,x:run.data[i].x,y:run.data[i].y,r:run.data[i].size/2,cx:_48f[i].x,cy:_48f[i].y,cr:_48f[i].radius};this._connectEvents(o);_49c[i]=o;}},this);this._eventSeries[run.name]=_49c;}else{delete this._eventSeries[run.name];}run.dirty=false;}this.dirty=false;return this;},_animateBubble:function(_49d,_49e,size){_6.gfx.fx.animateTransform(_4.delegate({shape:_49d,duration:1200,transform:[{name:"translate",start:[0,_49e],end:[0,0]},{name:"scale",start:[0,1/size],end:[1,1]},{name:"original"}]},this.animate)).play();}});})();}if(!_4._hasResource["dojox.charting.plot2d.Candlesticks"]){_4._hasResource["dojox.charting.plot2d.Candlesticks"]=true;_4.provide("dojox.charting.plot2d.Candlesticks");(function(){var df=_6.lang.functional,du=_6.lang.utils,dc=_6.charting.plot2d.common,_49f=df.lambda("item.purgeGroup()");_4.declare("dojox.charting.plot2d.Candlesticks",_6.charting.plot2d.Base,{defaultParams:{hAxis:"x",vAxis:"y",gap:2,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(_4a0,_4a1){this.opt=_4.clone(this.defaultParams);du.updateWithObject(this.opt,_4a1);du.updateWithPattern(this.opt,_4a1,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},collectStats:function(_4a2){var _4a3=_4.delegate(dc.defaultStats);for(var i=0;i<_4a2.length;i++){var run=_4a2[i];if(!run.data.length){continue;}var _4a4=_4a3.vmin,_4a5=_4a3.vmax;if(!("ymin" in run)||!("ymax" in run)){_4.forEach(run.data,function(val,idx){if(val!==null){var x=val.x||idx+1;_4a3.hmin=Math.min(_4a3.hmin,x);_4a3.hmax=Math.max(_4a3.hmax,x);_4a3.vmin=Math.min(_4a3.vmin,val.open,val.close,val.high,val.low);_4a3.vmax=Math.max(_4a3.vmax,val.open,val.close,val.high,val.low);}});}if("ymin" in run){_4a3.vmin=Math.min(_4a4,run.ymin);}if("ymax" in run){_4a3.vmax=Math.max(_4a5,run.ymax);}}return _4a3;},getSeriesStats:function(){var _4a6=this.collectStats(this.series);_4a6.hmin-=0.5;_4a6.hmax+=0.5;return _4a6;},render:function(dim,_4a7){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_4a7);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){_4.forEach(this.series,_49f);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_4a8,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_4a9=Math.max(0,this._vScaler.bounds.lower),_4aa=vt(_4a9),_4ab=this.events();f=dc.calculateBarSize(this._hScaler.bounds.scale,this.opt);gap=f.gap;_4a8=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _4ac=t.next("candlestick",[this.opt,run]),s=run.group,_4ad=new Array(run.data.length);for(var j=0;j<run.data.length;++j){var v=run.data[j];if(v!==null){var _4ae=t.addMixin(_4ac,"candlestick",v,true);var x=ht(v.x||(j+0.5))+_4a7.l+gap,y=dim.height-_4a7.b,open=vt(v.open),_4af=vt(v.close),high=vt(v.high),low=vt(v.low);if("mid" in v){var mid=vt(v.mid);}if(low>high){var tmp=high;high=low;low=tmp;}if(_4a8>=1){var _4b0=open>_4af;var line={x1:_4a8/2,x2:_4a8/2,y1:y-high,y2:y-low},rect={x:0,y:y-Math.max(open,_4af),width:_4a8,height:Math.max(_4b0?open-_4af:_4af-open,1)};shape=s.createGroup();shape.setTransform({dx:x,dy:0});var _4b1=shape.createGroup();_4b1.createLine(line).setStroke(_4ae.series.stroke);_4b1.createRect(rect).setStroke(_4ae.series.stroke).setFill(_4b0?_4ae.series.fill:"white");if("mid" in v){_4b1.createLine({x1:(_4ae.series.stroke.width||1),x2:_4a8-(_4ae.series.stroke.width||1),y1:y-mid,y2:y-mid}).setStroke(_4b0?"white":_4ae.series.stroke);}run.dyn.fill=_4ae.series.fill;run.dyn.stroke=_4ae.series.stroke;if(_4ab){var o={element:"candlestick",index:j,run:run,shape:_4b1,x:x,y:y-Math.max(open,_4af),cx:_4a8/2,cy:(y-Math.max(open,_4af))+(Math.max(_4b0?open-_4af:_4af-open,1)/2),width:_4a8,height:Math.max(_4b0?open-_4af:_4af-open,1),data:v};this._connectEvents(o);_4ad[j]=o;}}if(this.animate){this._animateCandlesticks(shape,y-low,high-low);}}}this._eventSeries[run.name]=_4ad;run.dirty=false;}this.dirty=false;return this;},_animateCandlesticks:function(_4b2,_4b3,_4b4){_6.gfx.fx.animateTransform(_4.delegate({shape:_4b2,duration:1200,transform:[{name:"translate",start:[0,_4b3-(_4b3/_4b4)],end:[0,0]},{name:"scale",start:[1,1/_4b4],end:[1,1]},{name:"original"}]},this.animate)).play();}});})();}if(!_4._hasResource["dojox.charting.plot2d.OHLC"]){_4._hasResource["dojox.charting.plot2d.OHLC"]=true;_4.provide("dojox.charting.plot2d.OHLC");(function(){var df=_6.lang.functional,du=_6.lang.utils,dc=_6.charting.plot2d.common,_4b5=df.lambda("item.purgeGroup()");_4.declare("dojox.charting.plot2d.OHLC",_6.charting.plot2d.Base,{defaultParams:{hAxis:"x",vAxis:"y",gap:2,animate:null},optionalParams:{minBarSize:1,maxBarSize:1,stroke:{},outline:{},shadow:{},fill:{},font:"",fontColor:""},constructor:function(_4b6,_4b7){this.opt=_4.clone(this.defaultParams);du.updateWithObject(this.opt,_4b7);du.updateWithPattern(this.opt,_4b7,this.optionalParams);this.series=[];this.hAxis=this.opt.hAxis;this.vAxis=this.opt.vAxis;this.animate=this.opt.animate;},collectStats:function(_4b8){var _4b9=_4.delegate(dc.defaultStats);for(var i=0;i<_4b8.length;i++){var run=_4b8[i];if(!run.data.length){continue;}var _4ba=_4b9.vmin,_4bb=_4b9.vmax;if(!("ymin" in run)||!("ymax" in run)){_4.forEach(run.data,function(val,idx){if(val!==null){var x=val.x||idx+1;_4b9.hmin=Math.min(_4b9.hmin,x);_4b9.hmax=Math.max(_4b9.hmax,x);_4b9.vmin=Math.min(_4b9.vmin,val.open,val.close,val.high,val.low);_4b9.vmax=Math.max(_4b9.vmax,val.open,val.close,val.high,val.low);}});}if("ymin" in run){_4b9.vmin=Math.min(_4ba,run.ymin);}if("ymax" in run){_4b9.vmax=Math.max(_4bb,run.ymax);}}return _4b9;},getSeriesStats:function(){var _4bc=this.collectStats(this.series);_4bc.hmin-=0.5;_4bc.hmax+=0.5;return _4bc;},render:function(dim,_4bd){if(this.zoom&&!this.isDataDirty()){return this.performZoom(dim,_4bd);}this.resetEvents();this.dirty=this.isDirty();if(this.dirty){_4.forEach(this.series,_4b5);this._eventSeries={};this.cleanGroup();var s=this.group;df.forEachRev(this.series,function(item){item.cleanGroup(s);});}var t=this.chart.theme,f,gap,_4be,ht=this._hScaler.scaler.getTransformerFromModel(this._hScaler),vt=this._vScaler.scaler.getTransformerFromModel(this._vScaler),_4bf=Math.max(0,this._vScaler.bounds.lower),_4c0=vt(_4bf),_4c1=this.events();f=dc.calculateBarSize(this._hScaler.bounds.scale,this.opt);gap=f.gap;_4be=f.size;for(var i=this.series.length-1;i>=0;--i){var run=this.series[i];if(!this.dirty&&!run.dirty){t.skip();this._reconnectEvents(run.name);continue;}run.cleanGroup();var _4c2=t.next("candlestick",[this.opt,run]),s=run.group,_4c3=new Array(run.data.length);for(var j=0;j<run.data.length;++j){var v=run.data[j];if(v!==null){var _4c4=t.addMixin(_4c2,"candlestick",v,true);var x=ht(v.x||(j+0.5))+_4bd.l+gap,y=dim.height-_4bd.b,open=vt(v.open),_4c5=vt(v.close),high=vt(v.high),low=vt(v.low);if(low>high){var tmp=high;high=low;low=tmp;}if(_4be>=1){var hl={x1:_4be/2,x2:_4be/2,y1:y-high,y2:y-low},op={x1:0,x2:((_4be/2)+((_4c4.series.stroke.width||1)/2)),y1:y-open,y2:y-open},cl={x1:((_4be/2)-((_4c4.series.stroke.width||1)/2)),x2:_4be,y1:y-_4c5,y2:y-_4c5};shape=s.createGroup();shape.setTransform({dx:x,dy:0});var _4c6=shape.createGroup();_4c6.createLine(hl).setStroke(_4c4.series.stroke);_4c6.createLine(op).setStroke(_4c4.series.stroke);_4c6.createLine(cl).setStroke(_4c4.series.stroke);run.dyn.stroke=_4c4.series.stroke;if(_4c1){var o={element:"candlestick",index:j,run:run,shape:_4c6,x:x,y:y-Math.max(open,_4c5),cx:_4be/2,cy:(y-Math.max(open,_4c5))+(Math.max(open>_4c5?open-_4c5:_4c5-open,1)/2),width:_4be,height:Math.max(open>_4c5?open-_4c5:_4c5-open,1),data:v};this._connectEvents(o);_4c3[j]=o;}}if(this.animate){this._animateOHLC(shape,y-low,high-low);}}}this._eventSeries[run.name]=_4c3;run.dirty=false;}this.dirty=false;return this;},_animateOHLC:function(_4c7,_4c8,_4c9){_6.gfx.fx.animateTransform(_4.delegate({shape:_4c7,duration:1200,transform:[{name:"translate",start:[0,_4c8-(_4c8/_4c9)],end:[0,0]},{name:"scale",start:[1,1/_4c9],end:[1,1]},{name:"original"}]},this.animate)).play();}});})();}if(!_4._hasResource["dojo.fx.easing"]){_4._hasResource["dojo.fx.easing"]=true;_4.provide("dojo.fx.easing");_4.getObject("fx.easing",true,_4);_4.fx.easing={linear:function(n){return n;},quadIn:function(n){return Math.pow(n,2);},quadOut:function(n){return n*(n-2)*-1;},quadInOut:function(n){n=n*2;if(n<1){return Math.pow(n,2)/2;}return -1*((--n)*(n-2)-1)/2;},cubicIn:function(n){return Math.pow(n,3);},cubicOut:function(n){return Math.pow(n-1,3)+1;},cubicInOut:function(n){n=n*2;if(n<1){return Math.pow(n,3)/2;}n-=2;return (Math.pow(n,3)+2)/2;},quartIn:function(n){return Math.pow(n,4);},quartOut:function(n){return -1*(Math.pow(n-1,4)-1);},quartInOut:function(n){n=n*2;if(n<1){return Math.pow(n,4)/2;}n-=2;return -1/2*(Math.pow(n,4)-2);},quintIn:function(n){return Math.pow(n,5);},quintOut:function(n){return Math.pow(n-1,5)+1;},quintInOut:function(n){n=n*2;if(n<1){return Math.pow(n,5)/2;}n-=2;return (Math.pow(n,5)+2)/2;},sineIn:function(n){return -1*Math.cos(n*(Math.PI/2))+1;},sineOut:function(n){return Math.sin(n*(Math.PI/2));},sineInOut:function(n){return -1*(Math.cos(Math.PI*n)-1)/2;},expoIn:function(n){return (n==0)?0:Math.pow(2,10*(n-1));},expoOut:function(n){return (n==1)?1:(-1*Math.pow(2,-10*n)+1);},expoInOut:function(n){if(n==0){return 0;}if(n==1){return 1;}n=n*2;if(n<1){return Math.pow(2,10*(n-1))/2;}--n;return (-1*Math.pow(2,-10*n)+2)/2;},circIn:function(n){return -1*(Math.sqrt(1-Math.pow(n,2))-1);},circOut:function(n){n=n-1;return Math.sqrt(1-Math.pow(n,2));},circInOut:function(n){n=n*2;if(n<1){return -1/2*(Math.sqrt(1-Math.pow(n,2))-1);}n-=2;return 1/2*(Math.sqrt(1-Math.pow(n,2))+1);},backIn:function(n){var s=1.70158;return Math.pow(n,2)*((s+1)*n-s);},backOut:function(n){n=n-1;var s=1.70158;return Math.pow(n,2)*((s+1)*n+s)+1;},backInOut:function(n){var s=1.70158*1.525;n=n*2;if(n<1){return (Math.pow(n,2)*((s+1)*n-s))/2;}n-=2;return (Math.pow(n,2)*((s+1)*n+s)+2)/2;},elasticIn:function(n){if(n==0||n==1){return n;}var p=0.3;var s=p/4;n=n-1;return -1*Math.pow(2,10*n)*Math.sin((n-s)*(2*Math.PI)/p);},elasticOut:function(n){if(n==0||n==1){return n;}var p=0.3;var s=p/4;return Math.pow(2,-10*n)*Math.sin((n-s)*(2*Math.PI)/p)+1;},elasticInOut:function(n){if(n==0){return 0;}n=n*2;if(n==2){return 1;}var p=0.3*1.5;var s=p/4;if(n<1){n-=1;return -0.5*(Math.pow(2,10*n)*Math.sin((n-s)*(2*Math.PI)/p));}n-=1;return 0.5*(Math.pow(2,-10*n)*Math.sin((n-s)*(2*Math.PI)/p))+1;},bounceIn:function(n){return (1-_4.fx.easing.bounceOut(1-n));},bounceOut:function(n){var s=7.5625;var p=2.75;var l;if(n<(1/p)){l=s*Math.pow(n,2);}else{if(n<(2/p)){n-=(1.5/p);l=s*Math.pow(n,2)+0.75;}else{if(n<(2.5/p)){n-=(2.25/p);l=s*Math.pow(n,2)+0.9375;}else{n-=(2.625/p);l=s*Math.pow(n,2)+0.984375;}}}return l;},bounceInOut:function(n){if(n<0.5){return _4.fx.easing.bounceIn(n*2)/2;}return (_4.fx.easing.bounceOut(n*2-1)/2)+0.5;}};}if(!_4._hasResource["dojox.charting.plot2d.Spider"]){_4._hasResource["dojox.charting.plot2d.Spider"]=true;_4.provide("dojox.charting.plot2d.Spider");_4.experimental("dojox.charting.plot2d.Spider");(function(){var df=_6.lang.functional,du=_6.lang.utils,dc=_6.charting.plot2d.common,da=_6.charting.axis2d.common,g=_6.gfx,m=g.matrix,_4ca=0.2;_4.declare("dojox.charting.plot2d.Spider",[_6.charting.Element,_6.charting.plot2d._PlotEvents],{defaultParams:{labels:true,ticks:false,fixed:true,precision:1,labelOffset:-10,labelStyle:"default",htmlLabels:true,startAngle:-90,divisions:3,axisColor:"",axisWidth:0,spiderColor:"",spiderWidth:0,seriesWidth:0,seriesFillAlpha:0.2,spiderOrigin:0.16,markerSize:3,spiderType:"polygon",animationType:_4.fx.easing.backOut,axisTickFont:"",axisTickFontColor:"",axisFont:"",axisFontColor:""},optionalParams:{radius:0,font:"",fontColor:""},constructor:function(_4cb,_4cc){this.opt=_4.clone(this.defaultParams);du.updateWithObject(this.opt,_4cc);du.updateWithPattern(this.opt,_4cc,this.optionalParams);this.series=[];this.dyn=[];this.datas={};this.labelKey=[];this.oldSeriePoints={};this.animations={};},clear:function(){this.dirty=true;this.dyn=[];this.series=[];this.datas={};this.labelKey=[];this.oldSeriePoints={};this.animations={};return this;},setAxis:function(axis){return this;},addSeries:function(run){var _4cd=false;this.series.push(run);for(var key in run.data){var val=run.data[key],data=this.datas[key];if(data){data.vlist.push(val);data.min=Math.min(data.min,val);data.max=Math.max(data.max,val);}else{this.datas[key]={min:val,max:val,vlist:[val]};}}if(this.labelKey.length<=0){for(var key in run.data){this.labelKey.push(key);}}return this;},getSeriesStats:function(){return _6.charting.plot2d.common.collectSimpleStats(this.series);},calculateAxes:function(dim){this.initializeScalers(dim,this.getSeriesStats());return this;},getRequiredColors:function(){return this.series.length;},initializeScalers:function(dim,_4ce){if(this._hAxis){if(!this._hAxis.initialized()){this._hAxis.calculate(_4ce.hmin,_4ce.hmax,dim.width);}this._hScaler=this._hAxis.getScaler();}else{this._hScaler=_6.charting.scaler.primitive.buildScaler(_4ce.hmin,_4ce.hmax,dim.width);}if(this._vAxis){if(!this._vAxis.initialized()){this._vAxis.calculate(_4ce.vmin,_4ce.vmax,dim.height);}this._vScaler=this._vAxis.getScaler();}else{this._vScaler=_6.charting.scaler.primitive.buildScaler(_4ce.vmin,_4ce.vmax,dim.height);}return this;},render:function(dim,_4cf){if(!this.dirty){return this;}this.dirty=false;this.cleanGroup();var s=this.group,t=this.chart.theme;this.resetEvents();if(!this.series||!this.series.length){return this;}var o=this.opt,ta=t.axis,rx=(dim.width-_4cf.l-_4cf.r)/2,ry=(dim.height-_4cf.t-_4cf.b)/2,r=Math.min(rx,ry),_4d0=o.font||(ta.majorTick&&ta.majorTick.font)||(ta.tick&&ta.tick.font)||"normal normal normal 7pt Tahoma",_4d1=o.axisFont||(ta.tick&&ta.tick.titleFont)||"normal normal normal 11pt Tahoma",_4d2=o.axisTickFontColor||(ta.majorTick&&ta.majorTick.fontColor)||(ta.tick&&ta.tick.fontColor)||"silver",_4d3=o.axisFontColor||(ta.tick&&ta.tick.titleFontColor)||"black",_4d4=o.axisColor||(ta.tick&&ta.tick.axisColor)||"silver",_4d5=o.spiderColor||(ta.tick&&ta.tick.spiderColor)||"silver",_4d6=o.axisWidth||(ta.stroke&&ta.stroke.width)||2,_4d7=o.spiderWidth||(ta.stroke&&ta.stroke.width)||2,_4d8=o.seriesWidth||(ta.stroke&&ta.stroke.width)||2,_4d9=g.normalizedLength(g.splitFontString(_4d1).size),_4da=m._degToRad(o.startAngle),_4db=_4da,step,_4dc,_4dd,_4de,_4df,_4e0,_4e1,_4e2,_4e3,_4e4,_4e5,ro=o.spiderOrigin,dv=o.divisions>=3?o.divisions:3,ms=o.markerSize,spt=o.spiderType,at=o.animationType,_4e6=o.labelOffset<-10?o.labelOffset:-10,_4e7=0.2;if(o.labels){_4de=_4.map(this.series,function(s){return s.name;},this);_4df=df.foldl1(df.map(_4de,function(_4e8,i){var font=t.series.font;return _6.gfx._base._getTextBox(_4e8,{font:font}).w;},this),"Math.max(a, b)")/2;r=Math.min(rx-2*_4df,ry-_4d9)+_4e6;_4e0=r-_4e6;}if("radius" in o){r=o.radius;_4e0=r-_4e6;}r/=(1+_4e7);var _4e9={cx:_4cf.l+rx,cy:_4cf.t+ry,r:r};for(var i=this.series.length-1;i>=0;i--){var _4ea=this.series[i];if(!this.dirty&&!_4ea.dirty){t.skip();continue;}_4ea.cleanGroup();var run=_4ea.data;if(run!==null){var len=this._getObjectLength(run);if(!_4e1||_4e1.length<=0){_4e1=[],_4e2=[],_4e5=[];this._buildPoints(_4e1,len,_4e9,r,_4db,true);this._buildPoints(_4e2,len,_4e9,r*ro,_4db,true);this._buildPoints(_4e5,len,_4e9,_4e0,_4db);if(dv>2){_4e3=[],_4e4=[];for(var j=0;j<dv-2;j++){_4e3[j]=[];this._buildPoints(_4e3[j],len,_4e9,r*(ro+(1-ro)*(j+1)/(dv-1)),_4db,true);_4e4[j]=r*(ro+(1-ro)*(j+1)/(dv-1));}}}}}var _4eb=s.createGroup(),_4ec={color:_4d4,width:_4d6},_4ed={color:_4d5,width:_4d7};for(var j=_4e1.length-1;j>=0;--j){var _4ee=_4e1[j],st={x:_4ee.x+(_4ee.x-_4e9.cx)*_4e7,y:_4ee.y+(_4ee.y-_4e9.cy)*_4e7},nd={x:_4ee.x+(_4ee.x-_4e9.cx)*_4e7/2,y:_4ee.y+(_4ee.y-_4e9.cy)*_4e7/2};_4eb.createLine({x1:_4e9.cx,y1:_4e9.cy,x2:st.x,y2:st.y}).setStroke(_4ec);this._drawArrow(_4eb,st,nd,_4ec);}var _4ef=s.createGroup();for(var j=_4e5.length-1;j>=0;--j){var _4ee=_4e5[j],_4f0=_6.gfx._base._getTextBox(this.labelKey[j],{font:_4d1}).w||0,_4f1=this.opt.htmlLabels&&_6.gfx.renderer!="vml"?"html":"gfx";elem=da.createText[_4f1](this.chart,_4ef,(!_4._isBodyLtr()&&_4f1=="html")?(_4ee.x+_4f0-dim.width):_4ee.x,_4ee.y,"middle",this.labelKey[j],_4d1,_4d3);if(this.opt.htmlLabels){this.htmlElements.push(elem);}}var _4f2=s.createGroup();if(spt=="polygon"){_4f2.createPolyline(_4e1).setStroke(_4ed);_4f2.createPolyline(_4e2).setStroke(_4ed);if(_4e3.length>0){for(var j=_4e3.length-1;j>=0;--j){_4f2.createPolyline(_4e3[j]).setStroke(_4ed);}}}else{var _4f3=this._getObjectLength(this.datas);_4f2.createCircle({cx:_4e9.cx,cy:_4e9.cy,r:r}).setStroke(_4ed);_4f2.createCircle({cx:_4e9.cx,cy:_4e9.cy,r:r*ro}).setStroke(_4ed);if(_4e4.length>0){for(var j=_4e4.length-1;j>=0;--j){_4f2.createCircle({cx:_4e9.cx,cy:_4e9.cy,r:_4e4[j]}).setStroke(_4ed);}}}var _4f4=s.createGroup(),len=this._getObjectLength(this.datas),k=0;for(var key in this.datas){var data=this.datas[key],min=data.min,max=data.max,_4f5=max-min,end=_4db+2*Math.PI*k/len;for(var i=0;i<dv;i++){var text=min+_4f5*i/(dv-1),_4ee=this._getCoordinate(_4e9,r*(ro+(1-ro)*i/(dv-1)),end);text=this._getLabel(text);var _4f0=_6.gfx._base._getTextBox(text,{font:_4d0}).w||0,_4f1=this.opt.htmlLabels&&_6.gfx.renderer!="vml"?"html":"gfx";if(this.opt.htmlLabels){this.htmlElements.push(da.createText[_4f1](this.chart,_4f4,(!_4._isBodyLtr()&&_4f1=="html")?(_4ee.x+_4f0-dim.width):_4ee.x,_4ee.y,"start",text,_4d0,_4d2));}}k++;}this.chart.seriesShapes={};var _4f6=[];for(var i=this.series.length-1;i>=0;i--){var _4ea=this.series[i],run=_4ea.data;if(run!==null){var _4f7=[],k=0,_4f8=[];for(var key in run){var data=this.datas[key],min=data.min,max=data.max,_4f5=max-min,_4f9=run[key],end=_4db+2*Math.PI*k/len,_4ee=this._getCoordinate(_4e9,r*(ro+(1-ro)*(_4f9-min)/_4f5),end);_4f7.push(_4ee);_4f8.push({sname:_4ea.name,key:key,data:_4f9});k++;}_4f7[_4f7.length]=_4f7[0];_4f8[_4f8.length]=_4f8[0];var _4fa=this._getBoundary(_4f7),_4fb=t.next("spider",[o,_4ea]),ts=_4ea.group,f=g.normalizeColor(_4fb.series.fill),sk={color:_4fb.series.fill,width:_4d8};f.a=o.seriesFillAlpha;_4ea.dyn={fill:f,stroke:sk};var osps=this.oldSeriePoints[_4ea.name];var cs=this._createSeriesEntry(ts,(osps||_4e2),_4f7,f,sk,r,ro,ms,at);this.chart.seriesShapes[_4ea.name]=cs;this.oldSeriePoints[_4ea.name]=_4f7;var po={element:"spider_poly",index:i,id:"spider_poly_"+_4ea.name,run:_4ea,plot:this,shape:cs.poly,parent:ts,brect:_4fa,cx:_4e9.cx,cy:_4e9.cy,cr:r,f:f,s:s};this._connectEvents(po);var so={element:"spider_plot",index:i,id:"spider_plot_"+_4ea.name,run:_4ea,plot:this,shape:_4ea.group};this._connectEvents(so);_4.forEach(cs.circles,function(c,i){var _4fc=c.getShape(),co={element:"spider_circle",index:i,id:"spider_circle_"+_4ea.name+i,run:_4ea,plot:this,shape:c,parent:ts,tdata:_4f8[i],cx:_4f7[i].x,cy:_4f7[i].y,f:f,s:s};this._connectEvents(co);},this);}}return this;},_createSeriesEntry:function(ts,osps,sps,f,sk,r,ro,ms,at){var _4fd=ts.createPolyline(osps).setFill(f).setStroke(sk),_4fe=[];for(var j=0;j<osps.length;j++){var _4ff=osps[j],cr=ms;var _500=ts.createCircle({cx:_4ff.x,cy:_4ff.y,r:cr}).setFill(f).setStroke(sk);_4fe.push(_500);}var _501=_4.map(sps,function(np,j){var sp=osps[j],anim=new _4._Animation({duration:1000,easing:at,curve:[sp.y,np.y]});var spl=_4fd,sc=_4fe[j];_4.connect(anim,"onAnimate",function(y){var _502=spl.getShape();_502.points[j].y=y;spl.setShape(_502);var _503=sc.getShape();_503.cy=y;sc.setShape(_503);});return anim;});var _504=_4.map(sps,function(np,j){var sp=osps[j],anim=new _4._Animation({duration:1000,easing:at,curve:[sp.x,np.x]});var spl=_4fd,sc=_4fe[j];_4.connect(anim,"onAnimate",function(x){var _505=spl.getShape();_505.points[j].x=x;spl.setShape(_505);var _506=sc.getShape();_506.cx=x;sc.setShape(_506);});return anim;});var _507=_4.fx.combine(_501.concat(_504));_507.play();return {group:ts,poly:_4fd,circles:_4fe};},plotEvent:function(o){var _508=o.id?o.id:"default",a;if(_508 in this.animations){a=this.animations[_508];a.anim&&a.anim.stop(true);}else{a=this.animations[_508]={};}if(o.element=="spider_poly"){if(!a.color){var _509=o.shape.getFill();if(!_509||!(_509 instanceof _4.Color)){return;}a.color={start:_509,end:_50a(_509)};}var _50b=a.color.start,end=a.color.end;if(o.type=="onmouseout"){var t=_50b;_50b=end;end=t;}a.anim=_6.gfx.fx.animateFill({shape:o.shape,duration:800,easing:_4.fx.easing.backOut,color:{start:_50b,end:end}});a.anim.play();}else{if(o.element=="spider_circle"){var init,_50c,_50d=1.5;if(o.type=="onmouseover"){init=_6.gfx.matrix.identity;_50c=_50d;var _50e={type:"rect"};_50e.x=o.cx;_50e.y=o.cy;_50e.width=_50e.height=1;var lt=_4.coords(this.chart.node,true);_50e.x+=lt.x;_50e.y+=lt.y;_50e.x=Math.round(_50e.x);_50e.y=Math.round(_50e.y);_50e.width=Math.ceil(_50e.width);_50e.height=Math.ceil(_50e.height);this.aroundRect=_50e;var _50f=["after","before"];if(_5&&_5.Tooltip){_5.showTooltip(o.tdata.sname+"<br/>"+o.tdata.key+"<br/>"+o.tdata.data,this.aroundRect,_50f);}}else{init=_6.gfx.matrix.scaleAt(_50d,o.cx,o.cy);_50c=1/_50d;if(_5&&_5.Tooltip){this.aroundRect&&_5.hideTooltip(this.aroundRect);}}var cs=o.shape.getShape(),init=m.scaleAt(_50d,cs.cx,cs.cy),_510={shape:o.shape,duration:200,easing:_4.fx.easing.backOut,transform:[{name:"scaleAt",start:[1,cs.cx,cs.cy],end:[_50c,cs.cx,cs.cy]},init]};a.anim=_6.gfx.fx.animateTransform(_510);a.anim.play();}else{if(o.element=="spider_plot"){if(o.type=="onmouseover"&&!_4.isIE){o.shape.moveToFront();}}}}},_getBoundary:function(_511){var xmax=_511[0].x,xmin=_511[0].x,ymax=_511[0].y,ymin=_511[0].y;for(var i=0;i<_511.length;i++){var _512=_511[i];xmax=Math.max(_512.x,xmax);ymax=Math.max(_512.y,ymax);xmin=Math.min(_512.x,xmin);ymin=Math.min(_512.y,ymin);}return {x:xmin,y:ymin,width:xmax-xmin,height:ymax-ymin};},_drawArrow:function(s,_513,end,_514){var len=Math.sqrt(Math.pow(end.x-_513.x,2)+Math.pow(end.y-_513.y,2)),sin=(end.y-_513.y)/len,cos=(end.x-_513.x)/len,_515={x:end.x+(len/3)*(-sin),y:end.y+(len/3)*cos},_516={x:end.x+(len/3)*sin,y:end.y+(len/3)*(-cos)};s.createPolyline([_513,_515,_516]).setFill(_514.color).setStroke(_514);},_buildPoints:function(_517,_518,_519,_51a,_51b,_51c){for(var i=0;i<_518;i++){var end=_51b+2*Math.PI*i/_518;_517.push(this._getCoordinate(_519,_51a,end));}if(_51c){_517.push(this._getCoordinate(_519,_51a,_51b+2*Math.PI));}},_getCoordinate:function(_51d,_51e,_51f){return {x:_51d.cx+_51e*Math.cos(_51f),y:_51d.cy+_51e*Math.sin(_51f)};},_getObjectLength:function(obj){var _520=0;if(_4.isObject(obj)){for(var key in obj){_520++;}}return _520;},_getLabel:function(_521){return dc.getLabel(_521,this.opt.fixed,this.opt.precision);}});function _50a(_522){var a=new _6.color.Color(_522),x=a.toHsl();if(x.s==0){x.l=x.l<50?100:0;}else{x.s=100;if(x.l<50){x.l=75;}else{if(x.l>75){x.l=50;}else{x.l=x.l-50>75-x.l?50:75;}}}var _522=_6.color.fromHsl(x);_522.a=0.7;return _522;};})();}if(!_4._hasResource["dojox.lang.functional.fold"]){_4._hasResource["dojox.lang.functional.fold"]=true;_4.provide("dojox.lang.functional.fold");(function(){var d=_4,df=_6.lang.functional,_523={};d.mixin(df,{foldl:function(a,f,z,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var i,n;if(d.isArray(a)){for(i=0,n=a.length;i<n;z=f.call(o,z,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){for(i=0;a.hasNext();z=f.call(o,z,a.next(),i++,a)){}}else{for(i in a){if(!(i in _523)){z=f.call(o,z,a[i],i,a);}}}}return z;},foldl1:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var z,i,n;if(d.isArray(a)){z=a[0];for(i=1,n=a.length;i<n;z=f.call(o,z,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){if(a.hasNext()){z=a.next();for(i=1;a.hasNext();z=f.call(o,z,a.next(),i++,a)){}}}else{var _524=true;for(i in a){if(!(i in _523)){if(_524){z=a[i];_524=false;}else{z=f.call(o,z,a[i],i,a);}}}}}return z;},foldr:function(a,f,z,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);for(var i=a.length;i>0;--i,z=f.call(o,z,a[i],i,a)){}return z;},foldr1:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var n=a.length,z=a[n-1],i=n-1;for(;i>0;--i,z=f.call(o,z,a[i],i,a)){}return z;},reduce:function(a,f,z){return arguments.length<3?df.foldl1(a,f):df.foldl(a,f,z);},reduceRight:function(a,f,z){return arguments.length<3?df.foldr1(a,f):df.foldr(a,f,z);},unfold:function(pr,f,g,z,o){o=o||d.global;f=df.lambda(f);g=df.lambda(g);pr=df.lambda(pr);var t=[];for(;!pr.call(o,z);t.push(f.call(o,z)),z=g.call(o,z)){}return t;}});})();}if(!_4._hasResource["dojox.color._base"]){_4._hasResource["dojox.color._base"]=true;_4.provide("dojox.color._base");_6.color.Color=_4.Color;_6.color.blend=_4.blendColors;_6.color.fromRgb=_4.colorFromRgb;_6.color.fromHex=_4.colorFromHex;_6.color.fromArray=_4.colorFromArray;_6.color.fromString=_4.colorFromString;_6.color.greyscale=_4.colors.makeGrey;_4.mixin(_6.color,{fromCmy:function(cyan,_525,_526){if(_4.isArray(cyan)){_525=cyan[1],_526=cyan[2],cyan=cyan[0];}else{if(_4.isObject(cyan)){_525=cyan.m,_526=cyan.y,cyan=cyan.c;}}cyan/=100,_525/=100,_526/=100;var r=1-cyan,g=1-_525,b=1-_526;return new _6.color.Color({r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)});},fromCmyk:function(cyan,_527,_528,_529){if(_4.isArray(cyan)){_527=cyan[1],_528=cyan[2],_529=cyan[3],cyan=cyan[0];}else{if(_4.isObject(cyan)){_527=cyan.m,_528=cyan.y,_529=cyan.b,cyan=cyan.c;}}cyan/=100,_527/=100,_528/=100,_529/=100;var r,g,b;r=1-Math.min(1,cyan*(1-_529)+_529);g=1-Math.min(1,_527*(1-_529)+_529);b=1-Math.min(1,_528*(1-_529)+_529);return new _6.color.Color({r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)});},fromHsl:function(hue,_52a,_52b){if(_4.isArray(hue)){_52a=hue[1],_52b=hue[2],hue=hue[0];}else{if(_4.isObject(hue)){_52a=hue.s,_52b=hue.l,hue=hue.h;}}_52a/=100;_52b/=100;while(hue<0){hue+=360;}while(hue>=360){hue-=360;}var r,g,b;if(hue<120){r=(120-hue)/60,g=hue/60,b=0;}else{if(hue<240){r=0,g=(240-hue)/60,b=(hue-120)/60;}else{r=(hue-240)/60,g=0,b=(360-hue)/60;}}r=2*_52a*Math.min(r,1)+(1-_52a);g=2*_52a*Math.min(g,1)+(1-_52a);b=2*_52a*Math.min(b,1)+(1-_52a);if(_52b<0.5){r*=_52b,g*=_52b,b*=_52b;}else{r=(1-_52b)*r+2*_52b-1;g=(1-_52b)*g+2*_52b-1;b=(1-_52b)*b+2*_52b-1;}return new _6.color.Color({r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)});},fromHsv:function(hue,_52c,_52d){if(_4.isArray(hue)){_52c=hue[1],_52d=hue[2],hue=hue[0];}else{if(_4.isObject(hue)){_52c=hue.s,_52d=hue.v,hue=hue.h;}}if(hue==360){hue=0;}_52c/=100;_52d/=100;var r,g,b;if(_52c==0){r=_52d,b=_52d,g=_52d;}else{var _52e=hue/60,i=Math.floor(_52e),f=_52e-i;var p=_52d*(1-_52c);var q=_52d*(1-(_52c*f));var t=_52d*(1-(_52c*(1-f)));switch(i){case 0:r=_52d,g=t,b=p;break;case 1:r=q,g=_52d,b=p;break;case 2:r=p,g=_52d,b=t;break;case 3:r=p,g=q,b=_52d;break;case 4:r=t,g=p,b=_52d;break;case 5:r=_52d,g=p,b=q;break;}}return new _6.color.Color({r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)});}});_4.extend(_6.color.Color,{toCmy:function(){var cyan=1-(this.r/255),_52f=1-(this.g/255),_530=1-(this.b/255);return {c:Math.round(cyan*100),m:Math.round(_52f*100),y:Math.round(_530*100)};},toCmyk:function(){var cyan,_531,_532,_533;var r=this.r/255,g=this.g/255,b=this.b/255;_533=Math.min(1-r,1-g,1-b);cyan=(1-r-_533)/(1-_533);_531=(1-g-_533)/(1-_533);_532=(1-b-_533)/(1-_533);return {c:Math.round(cyan*100),m:Math.round(_531*100),y:Math.round(_532*100),b:Math.round(_533*100)};},toHsl:function(){var r=this.r/255,g=this.g/255,b=this.b/255;var min=Math.min(r,b,g),max=Math.max(r,g,b);var _534=max-min;var h=0,s=0,l=(min+max)/2;if(l>0&&l<1){s=_534/((l<0.5)?(2*l):(2-2*l));}if(_534>0){if(max==r&&max!=g){h+=(g-b)/_534;}if(max==g&&max!=b){h+=(2+(b-r)/_534);}if(max==b&&max!=r){h+=(4+(r-g)/_534);}h*=60;}return {h:h,s:Math.round(s*100),l:Math.round(l*100)};},toHsv:function(){var r=this.r/255,g=this.g/255,b=this.b/255;var min=Math.min(r,b,g),max=Math.max(r,g,b);var _535=max-min;var h=null,s=(max==0)?0:(_535/max);if(s==0){h=0;}else{if(r==max){h=60*(g-b)/_535;}else{if(g==max){h=120+60*(b-r)/_535;}else{h=240+60*(r-g)/_535;}}if(h<0){h+=360;}}return {h:h,s:Math.round(s*100),v:Math.round(max*100)};}});}if(!_4._hasResource["dojox.color"]){_4._hasResource["dojox.color"]=true;_4.provide("dojox.color");}if(!_4._hasResource["dojox.color.Palette"]){_4._hasResource["dojox.color.Palette"]=true;_4.provide("dojox.color.Palette");(function(){var dxc=_6.color;dxc.Palette=function(base){this.colors=[];if(base instanceof _6.color.Palette){this.colors=base.colors.slice(0);}else{if(base instanceof _6.color.Color){this.colors=[null,null,base,null,null];}else{if(_4.isArray(base)){this.colors=_4.map(base.slice(0),function(item){if(_4.isString(item)){return new _6.color.Color(item);}return item;});}else{if(_4.isString(base)){this.colors=[null,null,new _6.color.Color(base),null,null];}}}}};function _536(p,_537,val){var ret=new _6.color.Palette();ret.colors=[];_4.forEach(p.colors,function(item){var r=(_537=="dr")?item.r+val:item.r,g=(_537=="dg")?item.g+val:item.g,b=(_537=="db")?item.b+val:item.b,a=(_537=="da")?item.a+val:item.a;ret.colors.push(new _6.color.Color({r:Math.min(255,Math.max(0,r)),g:Math.min(255,Math.max(0,g)),b:Math.min(255,Math.max(0,b)),a:Math.min(1,Math.max(0,a))}));});return ret;};function tCMY(p,_538,val){var ret=new _6.color.Palette();ret.colors=[];_4.forEach(p.colors,function(item){var o=item.toCmy(),c=(_538=="dc")?o.c+val:o.c,m=(_538=="dm")?o.m+val:o.m,y=(_538=="dy")?o.y+val:o.y;ret.colors.push(_6.color.fromCmy(Math.min(100,Math.max(0,c)),Math.min(100,Math.max(0,m)),Math.min(100,Math.max(0,y))));});return ret;};function _539(p,_53a,val){var ret=new _6.color.Palette();ret.colors=[];_4.forEach(p.colors,function(item){var o=item.toCmyk(),c=(_53a=="dc")?o.c+val:o.c,m=(_53a=="dm")?o.m+val:o.m,y=(_53a=="dy")?o.y+val:o.y,k=(_53a=="dk")?o.b+val:o.b;ret.colors.push(_6.color.fromCmyk(Math.min(100,Math.max(0,c)),Math.min(100,Math.max(0,m)),Math.min(100,Math.max(0,y)),Math.min(100,Math.max(0,k))));});return ret;};function tHSL(p,_53b,val){var ret=new _6.color.Palette();ret.colors=[];_4.forEach(p.colors,function(item){var o=item.toHsl(),h=(_53b=="dh")?o.h+val:o.h,s=(_53b=="ds")?o.s+val:o.s,l=(_53b=="dl")?o.l+val:o.l;ret.colors.push(_6.color.fromHsl(h%360,Math.min(100,Math.max(0,s)),Math.min(100,Math.max(0,l))));});return ret;};function tHSV(p,_53c,val){var ret=new _6.color.Palette();ret.colors=[];_4.forEach(p.colors,function(item){var o=item.toHsv(),h=(_53c=="dh")?o.h+val:o.h,s=(_53c=="ds")?o.s+val:o.s,v=(_53c=="dv")?o.v+val:o.v;ret.colors.push(_6.color.fromHsv(h%360,Math.min(100,Math.max(0,s)),Math.min(100,Math.max(0,v))));});return ret;};function _53d(val,low,high){return high-((high-val)*((high-low)/high));};_4.extend(dxc.Palette,{transform:function(_53e){var fn=_536;if(_53e.use){var use=_53e.use.toLowerCase();if(use.indexOf("hs")==0){if(use.charAt(2)=="l"){fn=tHSL;}else{fn=tHSV;}}else{if(use.indexOf("cmy")==0){if(use.charAt(3)=="k"){fn=_539;}else{fn=tCMY;}}}}else{if("dc" in _53e||"dm" in _53e||"dy" in _53e){if("dk" in _53e){fn=_539;}else{fn=tCMY;}}else{if("dh" in _53e||"ds" in _53e){if("dv" in _53e){fn=tHSV;}else{fn=tHSL;}}}}var _53f=this;for(var p in _53e){if(p=="use"){continue;}_53f=fn(_53f,p,_53e[p]);}return _53f;},clone:function(){return new dxc.Palette(this);}});_4.mixin(dxc.Palette,{generators:{analogous:function(args){var high=args.high||60,low=args.low||18,base=_4.isString(args.base)?new _6.color.Color(args.base):args.base,hsv=base.toHsv();var h=[(hsv.h+low+360)%360,(hsv.h+Math.round(low/2)+360)%360,hsv.h,(hsv.h-Math.round(high/2)+360)%360,(hsv.h-high+360)%360];var s1=Math.max(10,(hsv.s<=95)?hsv.s+5:(100-(hsv.s-95))),s2=(hsv.s>1)?hsv.s-1:21-hsv.s,v1=(hsv.v>=92)?hsv.v-9:Math.max(hsv.v+9,20),v2=(hsv.v<=90)?Math.max(hsv.v+5,20):(95+Math.ceil((hsv.v-90)/2)),s=[s1,s2,hsv.s,s1,s1],v=[v1,v2,hsv.v,v1,v2];return new dxc.Palette(_4.map(h,function(hue,i){return _6.color.fromHsv(hue,s[i],v[i]);}));},monochromatic:function(args){var base=_4.isString(args.base)?new _6.color.Color(args.base):args.base,hsv=base.toHsv();var s1=(hsv.s-30>9)?hsv.s-30:hsv.s+30,s2=hsv.s,v1=_53d(hsv.v,20,100),v2=(hsv.v-20>20)?hsv.v-20:hsv.v+60,v3=(hsv.v-50>20)?hsv.v-50:hsv.v+30;return new dxc.Palette([_6.color.fromHsv(hsv.h,s1,v1),_6.color.fromHsv(hsv.h,s2,v3),base,_6.color.fromHsv(hsv.h,s1,v3),_6.color.fromHsv(hsv.h,s2,v2)]);},triadic:function(args){var base=_4.isString(args.base)?new _6.color.Color(args.base):args.base,hsv=base.toHsv();var h1=(hsv.h+57+360)%360,h2=(hsv.h-157+360)%360,s1=(hsv.s>20)?hsv.s-10:hsv.s+10,s2=(hsv.s>90)?hsv.s-10:hsv.s+10,s3=(hsv.s>95)?hsv.s-5:hsv.s+5,v1=(hsv.v-20>20)?hsv.v-20:hsv.v+20,v2=(hsv.v-30>20)?hsv.v-30:hsv.v+30,v3=(hsv.v-30>70)?hsv.v-30:hsv.v+30;return new dxc.Palette([_6.color.fromHsv(h1,s1,hsv.v),_6.color.fromHsv(hsv.h,s2,v2),base,_6.color.fromHsv(h2,s2,v1),_6.color.fromHsv(h2,s3,v3)]);},complementary:function(args){var base=_4.isString(args.base)?new _6.color.Color(args.base):args.base,hsv=base.toHsv();var h1=((hsv.h*2)+137<360)?(hsv.h*2)+137:Math.floor(hsv.h/2)-137,s1=Math.max(hsv.s-10,0),s2=_53d(hsv.s,10,100),s3=Math.min(100,hsv.s+20),v1=Math.min(100,hsv.v+30),v2=(hsv.v>20)?hsv.v-30:hsv.v+30;return new dxc.Palette([_6.color.fromHsv(hsv.h,s1,v1),_6.color.fromHsv(hsv.h,s2,v2),base,_6.color.fromHsv(h1,s3,v2),_6.color.fromHsv(h1,hsv.s,hsv.v)]);},splitComplementary:function(args){var base=_4.isString(args.base)?new _6.color.Color(args.base):args.base,_540=args.da||30,hsv=base.toHsv();var _541=((hsv.h*2)+137<360)?(hsv.h*2)+137:Math.floor(hsv.h/2)-137,h1=(_541-_540+360)%360,h2=(_541+_540)%360,s1=Math.max(hsv.s-10,0),s2=_53d(hsv.s,10,100),s3=Math.min(100,hsv.s+20),v1=Math.min(100,hsv.v+30),v2=(hsv.v>20)?hsv.v-30:hsv.v+30;return new dxc.Palette([_6.color.fromHsv(h1,s1,v1),_6.color.fromHsv(h1,s2,v2),base,_6.color.fromHsv(h2,s3,v2),_6.color.fromHsv(h2,hsv.s,hsv.v)]);},compound:function(args){var base=_4.isString(args.base)?new _6.color.Color(args.base):args.base,hsv=base.toHsv();var h1=((hsv.h*2)+18<360)?(hsv.h*2)+18:Math.floor(hsv.h/2)-18,h2=((hsv.h*2)+120<360)?(hsv.h*2)+120:Math.floor(hsv.h/2)-120,h3=((hsv.h*2)+99<360)?(hsv.h*2)+99:Math.floor(hsv.h/2)-99,s1=(hsv.s-40>10)?hsv.s-40:hsv.s+40,s2=(hsv.s-10>80)?hsv.s-10:hsv.s+10,s3=(hsv.s-25>10)?hsv.s-25:hsv.s+25,v1=(hsv.v-40>10)?hsv.v-40:hsv.v+40,v2=(hsv.v-20>80)?hsv.v-20:hsv.v+20,v3=Math.max(hsv.v,20);return new dxc.Palette([_6.color.fromHsv(h1,s1,v1),_6.color.fromHsv(h1,s2,v2),base,_6.color.fromHsv(h2,s3,v3),_6.color.fromHsv(h3,s2,v2)]);},shades:function(args){var base=_4.isString(args.base)?new _6.color.Color(args.base):args.base,hsv=base.toHsv();var s=(hsv.s==100&&hsv.v==0)?0:hsv.s,v1=(hsv.v-50>20)?hsv.v-50:hsv.v+30,v2=(hsv.v-25>=20)?hsv.v-25:hsv.v+55,v3=(hsv.v-75>=20)?hsv.v-75:hsv.v+5,v4=Math.max(hsv.v-10,20);return new dxc.Palette([new _6.color.fromHsv(hsv.h,s,v1),new _6.color.fromHsv(hsv.h,s,v2),base,new _6.color.fromHsv(hsv.h,s,v3),new _6.color.fromHsv(hsv.h,s,v4)]);}},generate:function(base,type){if(_4.isFunction(type)){return type({base:base});}else{if(dxc.Palette.generators[type]){return dxc.Palette.generators[type]({base:base});}}throw new Error("dojox.color.Palette.generate: the specified generator ('"+type+"') does not exist.");}});})();}if(!_4._hasResource["dojox.charting.Theme"]){_4._hasResource["dojox.charting.Theme"]=true;_4.provide("dojox.charting.Theme");_4.declare("dojox.charting.Theme",null,{shapeSpaces:{shape:1,shapeX:1,shapeY:1},constructor:function(_542){_542=_542||{};var def=_6.charting.Theme.defaultTheme;_4.forEach(["chart","plotarea","axis","series","marker"],function(name){this[name]=_4.delegate(def[name],_542[name]);},this);if(_542.seriesThemes&&_542.seriesThemes.length){this.colors=null;this.seriesThemes=_542.seriesThemes.slice(0);}else{this.seriesThemes=null;this.colors=(_542.colors||_6.charting.Theme.defaultColors).slice(0);}this.markerThemes=null;if(_542.markerThemes&&_542.markerThemes.length){this.markerThemes=_542.markerThemes.slice(0);}this.markers=_542.markers?_4.clone(_542.markers):_4.delegate(_6.charting.Theme.defaultMarkers);this.noGradConv=_542.noGradConv;this.noRadialConv=_542.noRadialConv;if(_542.reverseFills){this.reverseFills();}this._current=0;this._buildMarkerArray();},clone:function(){var _543=new _6.charting.Theme({chart:this.chart,plotarea:this.plotarea,axis:this.axis,series:this.series,marker:this.marker,colors:this.colors,markers:this.markers,seriesThemes:this.seriesThemes,markerThemes:this.markerThemes,noGradConv:this.noGradConv,noRadialConv:this.noRadialConv});_4.forEach(["clone","clear","next","skip","addMixin","post","getTick"],function(name){if(this.hasOwnProperty(name)){_543[name]=this[name];}},this);return _543;},clear:function(){this._current=0;},next:function(_544,_545,_546){var _547=_6.lang.utils.merge,_548,_549;if(this.colors){_548=_4.delegate(this.series);_549=_4.delegate(this.marker);var _54a=new _4.Color(this.colors[this._current%this.colors.length]),old;if(_548.stroke&&_548.stroke.color){_548.stroke=_4.delegate(_548.stroke);old=new _4.Color(_548.stroke.color);_548.stroke.color=new _4.Color(_54a);_548.stroke.color.a=old.a;}else{_548.stroke={color:_54a};}if(_549.stroke&&_549.stroke.color){_549.stroke=_4.delegate(_549.stroke);old=new _4.Color(_549.stroke.color);_549.stroke.color=new _4.Color(_54a);_549.stroke.color.a=old.a;}else{_549.stroke={color:_54a};}if(!_548.fill||_548.fill.type){_548.fill=_54a;}else{old=new _4.Color(_548.fill);_548.fill=new _4.Color(_54a);_548.fill.a=old.a;}if(!_549.fill||_549.fill.type){_549.fill=_54a;}else{old=new _4.Color(_549.fill);_549.fill=new _4.Color(_54a);_549.fill.a=old.a;}}else{_548=this.seriesThemes?_547(this.series,this.seriesThemes[this._current%this.seriesThemes.length]):this.series;_549=this.markerThemes?_547(this.marker,this.markerThemes[this._current%this.markerThemes.length]):_548;}var _54b=_549&&_549.symbol||this._markers[this._current%this._markers.length];var _54c={series:_548,marker:_549,symbol:_54b};++this._current;if(_545){_54c=this.addMixin(_54c,_544,_545);}if(_546){_54c=this.post(_54c,_544);}return _54c;},skip:function(){++this._current;},addMixin:function(_54d,_54e,_54f,_550){if(_4.isArray(_54f)){_4.forEach(_54f,function(m){_54d=this.addMixin(_54d,_54e,m);},this);}else{var t={};if("color" in _54f){if(_54e=="line"||_54e=="area"){_4.setObject("series.stroke.color",_54f.color,t);_4.setObject("marker.stroke.color",_54f.color,t);}else{_4.setObject("series.fill",_54f.color,t);}}_4.forEach(["stroke","outline","shadow","fill","font","fontColor","labelWiring"],function(name){var _551="marker"+name.charAt(0).toUpperCase()+name.substr(1),b=_551 in _54f;if(name in _54f){_4.setObject("series."+name,_54f[name],t);if(!b){_4.setObject("marker."+name,_54f[name],t);}}if(b){_4.setObject("marker."+name,_54f[_551],t);}});if("marker" in _54f){t.symbol=_54f.marker;}_54d=_6.lang.utils.merge(_54d,t);}if(_550){_54d=this.post(_54d,_54e);}return _54d;},post:function(_552,_553){var fill=_552.series.fill,t;if(!this.noGradConv&&this.shapeSpaces[fill.space]&&fill.type=="linear"){if(_553=="bar"){t={x1:fill.y1,y1:fill.x1,x2:fill.y2,y2:fill.x2};}else{if(!this.noRadialConv&&fill.space=="shape"&&(_553=="slice"||_553=="circle")){t={type:"radial",cx:0,cy:0,r:100};}}if(t){return _6.lang.utils.merge(_552,{series:{fill:t}});}}return _552;},getTick:function(name,_554){var tick=this.axis.tick,_555=name+"Tick";merge=_6.lang.utils.merge;if(tick){if(this.axis[_555]){tick=merge(tick,this.axis[_555]);}}else{tick=this.axis[_555];}if(_554){if(tick){if(_554[_555]){tick=merge(tick,_554[_555]);}}else{tick=_554[_555];}}return tick;},inspectObjects:function(f){_4.forEach(["chart","plotarea","axis","series","marker"],function(name){f(this[name]);},this);if(this.seriesThemes){_4.forEach(this.seriesThemes,f);}if(this.markerThemes){_4.forEach(this.markerThemes,f);}},reverseFills:function(){this.inspectObjects(function(o){if(o&&o.fill){o.fill=_6.gfx.gradutils.reverse(o.fill);}});},addMarker:function(name,_556){this.markers[name]=_556;this._buildMarkerArray();},setMarkers:function(obj){this.markers=obj;this._buildMarkerArray();},_buildMarkerArray:function(){this._markers=[];for(var p in this.markers){this._markers.push(this.markers[p]);}}});_4.mixin(_6.charting.Theme,{defaultMarkers:{CIRCLE:"m-3,0 c0,-4 6,-4 6,0 m-6,0 c0,4 6,4 6,0",SQUARE:"m-3,-3 l0,6 6,0 0,-6 z",DIAMOND:"m0,-3 l3,3 -3,3 -3,-3 z",CROSS:"m0,-3 l0,6 m-3,-3 l6,0",X:"m-3,-3 l6,6 m0,-6 l-6,6",TRIANGLE:"m-3,3 l3,-6 3,6 z",TRIANGLE_INVERTED:"m-3,-3 l3,6 3,-6 z"},defaultColors:["#54544c","#858e94","#6e767a","#948585","#474747"],defaultTheme:{chart:{stroke:null,fill:"white",pageStyle:null,titleGap:20,titlePos:"top",titleFont:"normal normal bold 14pt Tahoma",titleFontColor:"#333"},plotarea:{stroke:null,fill:"white"},axis:{stroke:{color:"#333",width:1},tick:{color:"#666",position:"center",font:"normal normal normal 7pt Tahoma",fontColor:"#333",titleGap:15,titleFont:"normal normal normal 11pt Tahoma",titleFontColor:"#333",titleOrientation:"axis"},majorTick:{width:1,length:6},minorTick:{width:0.8,length:3},microTick:{width:0.5,length:1}},series:{stroke:{width:1.5,color:"#333"},outline:{width:0.1,color:"#ccc"},shadow:null,fill:"#ccc",font:"normal normal normal 8pt Tahoma",fontColor:"#000",labelWiring:{width:1,color:"#ccc"}},marker:{stroke:{width:1.5,color:"#333"},outline:{width:0.1,color:"#ccc"},shadow:null,fill:"#ccc",font:"normal normal normal 8pt Tahoma",fontColor:"#000"}},defineColors:function(_557){_557=_557||{};var c=[],n=_557.num||5;if(_557.colors){var l=_557.colors.length;for(var i=0;i<n;i++){c.push(_557.colors[i%l]);}return c;}if(_557.hue){var s=_557.saturation||100;var st=_557.low||30;var end=_557.high||90;var l=(end+st)/2;return _6.color.Palette.generate(_6.color.fromHsv(_557.hue,s,l),"monochromatic").colors;}if(_557.generator){return _6.color.Palette.generate(_557.base,_557.generator).colors;}return c;},generateGradient:function(_558,_559,_55a){var fill=_4.delegate(_558);fill.colors=[{offset:0,color:_559},{offset:1,color:_55a}];return fill;},generateHslColor:function(_55b,_55c){_55b=new _6.color.Color(_55b);var hsl=_55b.toHsl(),_55d=_6.color.fromHsl(hsl.h,hsl.s,_55c);_55d.a=_55b.a;return _55d;},generateHslGradient:function(_55e,_55f,_560,_561){_55e=new _6.color.Color(_55e);var hsl=_55e.toHsl(),_562=_6.color.fromHsl(hsl.h,hsl.s,_560),_563=_6.color.fromHsl(hsl.h,hsl.s,_561);_562.a=_563.a=_55e.a;return _6.charting.Theme.generateGradient(_55f,_562,_563);}});}if(!_4._hasResource["dojox.charting.Series"]){_4._hasResource["dojox.charting.Series"]=true;_4.provide("dojox.charting.Series");_4.declare("dojox.charting.Series",_6.charting.Element,{constructor:function(_564,data,_565){_4.mixin(this,_565);if(typeof this.plot!="string"){this.plot="default";}this.update(data);},clear:function(){this.dyn={};},update:function(data){if(_4.isArray(data)){this.data=data;}else{this.source=data;this.data=this.source.data;if(this.source.setSeriesObject){this.source.setSeriesObject(this);}}this.dirty=true;this.clear();}});}if(!_4._hasResource["dojox.charting.Chart"]){_4._hasResource["dojox.charting.Chart"]=true;_4.provide("dojox.charting.Chart");(function(){var df=_6.lang.functional,dc=_6.charting,g=_6.gfx,_566=df.lambda("item.clear()"),_567=df.lambda("item.purgeGroup()"),_568=df.lambda("item.destroy()"),_569=df.lambda("item.dirty = false"),_56a=df.lambda("item.dirty = true"),_56b=df.lambda("item.name");_4.declare("dojox.charting.Chart",null,{constructor:function(node,_56c){if(!_56c){_56c={};}this.margins=_56c.margins?_56c.margins:{l:10,t:10,r:10,b:10};this.stroke=_56c.stroke;this.fill=_56c.fill;this.delayInMs=_56c.delayInMs||200;this.title=_56c.title;this.titleGap=_56c.titleGap;this.titlePos=_56c.titlePos;this.titleFont=_56c.titleFont;this.titleFontColor=_56c.titleFontColor;this.chartTitle=null;this.theme=null;this.axes={};this.stack=[];this.plots={};this.series=[];this.runs={};this.dirty=true;this.coords=null;this.node=_4.byId(node);var box=_4.marginBox(node);this.surface=g.createSurface(this.node,box.w||400,box.h||300);},destroy:function(){_4.forEach(this.series,_568);_4.forEach(this.stack,_568);df.forIn(this.axes,_568);if(this.chartTitle&&this.chartTitle.tagName){_4.destroy(this.chartTitle);}this.surface.destroy();},getCoords:function(){if(!this.coords){this.coords=_4.coords(this.node,true);}return this.coords;},setTheme:function(_56d){this.theme=_56d.clone();this.dirty=true;return this;},addAxis:function(name,_56e){var axis,_56f=_56e&&_56e.type||"Default";if(typeof _56f=="string"){if(!dc.axis2d||!dc.axis2d[_56f]){throw Error("Can't find axis: "+_56f+" - didn't you forget to dojo"+".require() it?");}axis=new dc.axis2d[_56f](this,_56e);}else{axis=new _56f(this,_56e);}axis.name=name;axis.dirty=true;if(name in this.axes){this.axes[name].destroy();}this.axes[name]=axis;this.dirty=true;return this;},getAxis:function(name){return this.axes[name];},removeAxis:function(name){if(name in this.axes){this.axes[name].destroy();delete this.axes[name];this.dirty=true;}return this;},addPlot:function(name,_570){var plot,_571=_570&&_570.type||"Default";if(typeof _571=="string"){if(!dc.plot2d||!dc.plot2d[_571]){throw Error("Can't find plot: "+_571+" - didn't you forget to dojo"+".require() it?");}plot=new dc.plot2d[_571](this,_570);}else{plot=new _571(this,_570);}plot.name=name;plot.dirty=true;if(name in this.plots){this.stack[this.plots[name]].destroy();this.stack[this.plots[name]]=plot;}else{this.plots[name]=this.stack.length;this.stack.push(plot);}this.dirty=true;return this;},removePlot:function(name){if(name in this.plots){var _572=this.plots[name];delete this.plots[name];this.stack[_572].destroy();this.stack.splice(_572,1);df.forIn(this.plots,function(idx,name,_573){if(idx>_572){_573[name]=idx-1;}});var ns=_4.filter(this.series,function(run){return run.plot!=name;});if(ns.length<this.series.length){_4.forEach(this.series,function(run){if(run.plot==name){run.destroy();}});this.runs={};_4.forEach(ns,function(run,_574){this.runs[run.plot]=_574;},this);this.series=ns;}this.dirty=true;}return this;},getPlotOrder:function(){return df.map(this.stack,_56b);},setPlotOrder:function(_575){var _576={},_577=df.filter(_575,function(name){if(!(name in this.plots)||(name in _576)){return false;}_576[name]=1;return true;},this);if(_577.length<this.stack.length){df.forEach(this.stack,function(plot){var name=plot.name;if(!(name in _576)){_577.push(name);}});}var _578=df.map(_577,function(name){return this.stack[this.plots[name]];},this);df.forEach(_578,function(plot,i){this.plots[plot.name]=i;},this);this.stack=_578;this.dirty=true;return this;},movePlotToFront:function(name){if(name in this.plots){var _579=this.plots[name];if(_579){var _57a=this.getPlotOrder();_57a.splice(_579,1);_57a.unshift(name);return this.setPlotOrder(_57a);}}return this;},movePlotToBack:function(name){if(name in this.plots){var _57b=this.plots[name];if(_57b<this.stack.length-1){var _57c=this.getPlotOrder();_57c.splice(_57b,1);_57c.push(name);return this.setPlotOrder(_57c);}}return this;},addSeries:function(name,data,_57d){var run=new dc.Series(this,data,_57d);run.name=name;if(name in this.runs){this.series[this.runs[name]].destroy();this.series[this.runs[name]]=run;}else{this.runs[name]=this.series.length;this.series.push(run);}this.dirty=true;if(!("ymin" in run)&&"min" in run){run.ymin=run.min;}if(!("ymax" in run)&&"max" in run){run.ymax=run.max;}return this;},removeSeries:function(name){if(name in this.runs){var _57e=this.runs[name];delete this.runs[name];this.series[_57e].destroy();this.series.splice(_57e,1);df.forIn(this.runs,function(idx,name,runs){if(idx>_57e){runs[name]=idx-1;}});this.dirty=true;}return this;},updateSeries:function(name,data){if(name in this.runs){var run=this.series[this.runs[name]];run.update(data);this._invalidateDependentPlots(run.plot,false);this._invalidateDependentPlots(run.plot,true);}return this;},getSeriesOrder:function(_57f){return df.map(df.filter(this.series,function(run){return run.plot==_57f;}),_56b);},setSeriesOrder:function(_580){var _581,_582={},_583=df.filter(_580,function(name){if(!(name in this.runs)||(name in _582)){return false;}var run=this.series[this.runs[name]];if(_581){if(run.plot!=_581){return false;}}else{_581=run.plot;}_582[name]=1;return true;},this);df.forEach(this.series,function(run){var name=run.name;if(!(name in _582)&&run.plot==_581){_583.push(name);}});var _584=df.map(_583,function(name){return this.series[this.runs[name]];},this);this.series=_584.concat(df.filter(this.series,function(run){return run.plot!=_581;}));df.forEach(this.series,function(run,i){this.runs[run.name]=i;},this);this.dirty=true;return this;},moveSeriesToFront:function(name){if(name in this.runs){var _585=this.runs[name],_586=this.getSeriesOrder(this.series[_585].plot);if(name!=_586[0]){_586.splice(_585,1);_586.unshift(name);return this.setSeriesOrder(_586);}}return this;},moveSeriesToBack:function(name){if(name in this.runs){var _587=this.runs[name],_588=this.getSeriesOrder(this.series[_587].plot);if(name!=_588[_588.length-1]){_588.splice(_587,1);_588.push(name);return this.setSeriesOrder(_588);}}return this;},resize:function(_589,_58a){var box;switch(arguments.length){case 1:box=_4.mixin({},_589);_4.marginBox(this.node,box);break;case 2:box={w:_589,h:_58a};_4.marginBox(this.node,box);break;}box=_4.marginBox(this.node);this.surface.setDimensions(box.w,box.h);this.dirty=true;this.coords=null;return this.render();},getGeometry:function(){var ret={};df.forIn(this.axes,function(axis){if(axis.initialized()){ret[axis.name]={name:axis.name,vertical:axis.vertical,scaler:axis.scaler,ticks:axis.ticks};}});return ret;},setAxisWindow:function(name,_58b,_58c,zoom){var axis=this.axes[name];if(axis){axis.setWindow(_58b,_58c);_4.forEach(this.stack,function(plot){if(plot.hAxis==name||plot.vAxis==name){plot.zoom=zoom;}});}return this;},setWindow:function(sx,sy,dx,dy,zoom){if(!("plotArea" in this)){this.calculateGeometry();}df.forIn(this.axes,function(axis){var _58d,_58e,_58f=axis.getScaler().bounds,s=_58f.span/(_58f.upper-_58f.lower);if(axis.vertical){_58d=sy;_58e=dy/s/_58d;}else{_58d=sx;_58e=dx/s/_58d;}axis.setWindow(_58d,_58e);});_4.forEach(this.stack,function(plot){plot.zoom=zoom;});return this;},zoomIn:function(name,_590){var axis=this.axes[name];if(axis){var _591,_592,_593=axis.getScaler().bounds;var _594=Math.min(_590[0],_590[1]);var _595=Math.max(_590[0],_590[1]);_594=_590[0]<_593.lower?_593.lower:_594;_595=_590[1]>_593.upper?_593.upper:_595;_591=(_593.upper-_593.lower)/(_595-_594);_592=_594-_593.lower;this.setAxisWindow(name,_591,_592);this.render();}},calculateGeometry:function(){if(this.dirty){return this.fullGeometry();}var _596=_4.filter(this.stack,function(plot){return plot.dirty||(plot.hAxis&&this.axes[plot.hAxis].dirty)||(plot.vAxis&&this.axes[plot.vAxis].dirty);},this);_597(_596,this.plotArea);return this;},fullGeometry:function(){this._makeDirty();_4.forEach(this.stack,_566);if(!this.theme){this.setTheme(new _6.charting.Theme(_6.charting._def));}_4.forEach(this.series,function(run){if(!(run.plot in this.plots)){if(!dc.plot2d||!dc.plot2d.Default){throw Error("Can't find plot: Default - didn't you forget to dojo"+".require() it?");}var plot=new dc.plot2d.Default(this,{});plot.name=run.plot;this.plots[run.plot]=this.stack.length;this.stack.push(plot);}this.stack[this.plots[run.plot]].addSeries(run);},this);_4.forEach(this.stack,function(plot){if(plot.hAxis){plot.setAxis(this.axes[plot.hAxis]);}if(plot.vAxis){plot.setAxis(this.axes[plot.vAxis]);}},this);var dim=this.dim=this.surface.getDimensions();dim.width=g.normalizedLength(dim.width);dim.height=g.normalizedLength(dim.height);df.forIn(this.axes,_566);_597(this.stack,dim);var _598=this.offsets={l:0,r:0,t:0,b:0};df.forIn(this.axes,function(axis){df.forIn(axis.getOffsets(),function(o,i){_598[i]+=o;});});if(this.title){this.titleGap=(this.titleGap==0)?0:this.titleGap||this.theme.chart.titleGap||20;this.titlePos=this.titlePos||this.theme.chart.titlePos||"top";this.titleFont=this.titleFont||this.theme.chart.titleFont;this.titleFontColor=this.titleFontColor||this.theme.chart.titleFontColor||"black";var _599=g.normalizedLength(g.splitFontString(this.titleFont).size);_598[this.titlePos=="top"?"t":"b"]+=(_599+this.titleGap);}df.forIn(this.margins,function(o,i){_598[i]+=o;});this.plotArea={width:dim.width-_598.l-_598.r,height:dim.height-_598.t-_598.b};df.forIn(this.axes,_566);_597(this.stack,this.plotArea);return this;},render:function(){if(this.theme){this.theme.clear();}if(this.dirty){return this.fullRender();}this.calculateGeometry();df.forEachRev(this.stack,function(plot){plot.render(this.dim,this.offsets);},this);df.forIn(this.axes,function(axis){axis.render(this.dim,this.offsets);},this);this._makeClean();if(this.surface.render){this.surface.render();}return this;},fullRender:function(){this.fullGeometry();var _59a=this.offsets,dim=this.dim,rect;_4.forEach(this.series,_567);df.forIn(this.axes,_567);_4.forEach(this.stack,_567);if(this.chartTitle&&this.chartTitle.tagName){_4.destroy(this.chartTitle);}this.surface.clear();this.chartTitle=null;var t=this.theme,fill=t.plotarea&&t.plotarea.fill,_59b=t.plotarea&&t.plotarea.stroke,rect={x:_59a.l-1,y:_59a.t-1,width:dim.width-_59a.l-_59a.r+2,height:dim.height-_59a.t-_59a.b+2};if(fill){fill=dc.Element.prototype._shapeFill(dc.Element.prototype._plotFill(fill,dim,_59a),rect);this.surface.createRect(rect).setFill(fill);}if(_59b){this.surface.createRect({x:_59a.l,y:_59a.t,width:dim.width-_59a.l-_59a.r+1,height:dim.height-_59a.t-_59a.b+1}).setStroke(_59b);}df.foldr(this.stack,function(z,plot){return plot.render(dim,_59a),0;},0);fill=this.fill!==undefined?this.fill:(t.chart&&t.chart.fill);_59b=this.stroke!==undefined?this.stroke:(t.chart&&t.chart.stroke);if(fill=="inherit"){var node=this.node,fill=new _4.Color(_4.style(node,"backgroundColor"));while(fill.a==0&&node!=document.documentElement){fill=new _4.Color(_4.style(node,"backgroundColor"));node=node.parentNode;}}if(fill){fill=dc.Element.prototype._plotFill(fill,dim,_59a);if(_59a.l){rect={width:_59a.l,height:dim.height+1};this.surface.createRect(rect).setFill(dc.Element.prototype._shapeFill(fill,rect));}if(_59a.r){rect={x:dim.width-_59a.r,width:_59a.r+1,height:dim.height+2};this.surface.createRect(rect).setFill(dc.Element.prototype._shapeFill(fill,rect));}if(_59a.t){rect={width:dim.width+1,height:_59a.t};this.surface.createRect(rect).setFill(dc.Element.prototype._shapeFill(fill,rect));}if(_59a.b){rect={y:dim.height-_59a.b,width:dim.width+1,height:_59a.b+2};this.surface.createRect(rect).setFill(dc.Element.prototype._shapeFill(fill,rect));}}if(_59b){this.surface.createRect({width:dim.width-1,height:dim.height-1}).setStroke(_59b);}if(this.title){var _59c=(g.renderer=="canvas"),_59d=_59c||!_4.isIE&&!_4.isOpera?"html":"gfx",_59e=g.normalizedLength(g.splitFontString(this.titleFont).size);this.chartTitle=dc.axis2d.common.createText[_59d](this,this.surface,dim.width/2,this.titlePos=="top"?_59e+this.margins.t:dim.height-this.margins.b,"middle",this.title,this.titleFont,this.titleFontColor);}df.forIn(this.axes,function(axis){axis.render(dim,_59a);});this._makeClean();if(this.surface.render){this.surface.render();}return this;},delayedRender:function(){if(!this._delayedRenderHandle){this._delayedRenderHandle=setTimeout(_4.hitch(this,function(){clearTimeout(this._delayedRenderHandle);this._delayedRenderHandle=null;this.render();}),this.delayInMs);}return this;},connectToPlot:function(name,_59f,_5a0){return name in this.plots?this.stack[this.plots[name]].connect(_59f,_5a0):null;},fireEvent:function(_5a1,_5a2,_5a3){if(_5a1 in this.runs){var _5a4=this.series[this.runs[_5a1]].plot;if(_5a4 in this.plots){var plot=this.stack[this.plots[_5a4]];if(plot){plot.fireEvent(_5a1,_5a2,_5a3);}}}return this;},_makeClean:function(){_4.forEach(this.axes,_569);_4.forEach(this.stack,_569);_4.forEach(this.series,_569);this.dirty=false;},_makeDirty:function(){_4.forEach(this.axes,_56a);_4.forEach(this.stack,_56a);_4.forEach(this.series,_56a);this.dirty=true;},_invalidateDependentPlots:function(_5a5,_5a6){if(_5a5 in this.plots){var plot=this.stack[this.plots[_5a5]],axis,_5a7=_5a6?"vAxis":"hAxis";if(plot[_5a7]){axis=this.axes[plot[_5a7]];if(axis&&axis.dependOnData()){axis.dirty=true;_4.forEach(this.stack,function(p){if(p[_5a7]&&p[_5a7]==plot[_5a7]){p.dirty=true;}});}}else{plot.dirty=true;}}}});function _5a8(_5a9){return {min:_5a9.hmin,max:_5a9.hmax};};function _5aa(_5ab){return {min:_5ab.vmin,max:_5ab.vmax};};function _5ac(_5ad,h){_5ad.hmin=h.min;_5ad.hmax=h.max;};function _5ae(_5af,v){_5af.vmin=v.min;_5af.vmax=v.max;};function _5b0(_5b1,_5b2){if(_5b1&&_5b2){_5b1.min=Math.min(_5b1.min,_5b2.min);_5b1.max=Math.max(_5b1.max,_5b2.max);}return _5b1||_5b2;};function _597(_5b3,_5b4){var _5b5={},axes={};_4.forEach(_5b3,function(plot){var _5b6=_5b5[plot.name]=plot.getSeriesStats();if(plot.hAxis){axes[plot.hAxis]=_5b0(axes[plot.hAxis],_5a8(_5b6));}if(plot.vAxis){axes[plot.vAxis]=_5b0(axes[plot.vAxis],_5aa(_5b6));}});_4.forEach(_5b3,function(plot){var _5b7=_5b5[plot.name];if(plot.hAxis){_5ac(_5b7,axes[plot.hAxis]);}if(plot.vAxis){_5ae(_5b7,axes[plot.vAxis]);}plot.initializeScalers(_5b4,_5b7);});};})();}if(!_4._hasResource["dojox.charting.Chart2D"]){_4._hasResource["dojox.charting.Chart2D"]=true;_4.provide("dojox.charting.Chart2D");_4.deprecated("dojox.charting.Chart2D","Use dojo.charting.Chart instead and require all other components explicitly","2.0");_6.charting.Chart2D=_6.charting.Chart;}if(!_4._hasResource["dojox.charting.themes.PlotKit.base"]){_4._hasResource["dojox.charting.themes.PlotKit.base"]=true;_4.provide("dojox.charting.themes.PlotKit.base");(function(){var dc=_6.charting,pk=dc.themes.PlotKit;pk.base=new dc.Theme({chart:{stroke:null,fill:"yellow"},plotarea:{stroke:null,fill:"yellow"},axis:{stroke:{color:"#fff",width:1},line:{color:"#fff",width:0.5},majorTick:{color:"#fff",width:0.5,length:6},minorTick:{color:"#fff",width:0.5,length:3},tick:{font:"normal normal normal 7pt Helvetica,Arial,sans-serif",fontColor:"#999"}},series:{stroke:{width:2.5,color:"#fff"},fill:"#666",font:"normal normal normal 7.5pt Helvetica,Arial,sans-serif",fontColor:"#666"},marker:{stroke:{width:2},fill:"#333",font:"normal normal normal 7pt Helvetica,Arial,sans-serif",fontColor:"#666"},colors:["red","green","blue"]});pk.base.next=function(_5b8,_5b9,_5ba){var _5bb=dc.Theme.prototype.next.apply(this,arguments);if(_5b8=="line"){_5bb.marker.outline={width:2,color:"#fff"};_5bb.series.stroke.width=3.5;_5bb.marker.stroke.width=2;}else{if(_5b8=="candlestick"){_5bb.series.stroke.width=1;}else{_5bb.series.stroke.color="#fff";}}return _5bb;};})();}if(!_4._hasResource["dijit.Tooltip"]){_4._hasResource["dijit.Tooltip"]=true;_4.provide("dijit.Tooltip");_4.declare("dijit._MasterTooltip",[_5._Widget,_5._Templated],{duration:_5.defaultDuration,templateString:_4.cache("dijit","templates/Tooltip.html","<div class=\"dijitTooltip dijitTooltipLeft\" id=\"dojoTooltip\"\r\n\t><div class=\"dijitTooltipContainer dijitTooltipContents\" dojoAttachPoint=\"containerNode\" role='alert'></div\r\n\t><div class=\"dijitTooltipConnector\" dojoAttachPoint=\"connectorNode\"></div\r\n></div>\r\n"),postCreate:function(){_4.body().appendChild(this.domNode);this.bgIframe=new _5.BackgroundIframe(this.domNode);this.fadeIn=_4.fadeIn({node:this.domNode,duration:this.duration,onEnd:_4.hitch(this,"_onShow")});this.fadeOut=_4.fadeOut({node:this.domNode,duration:this.duration,onEnd:_4.hitch(this,"_onHide")});},show:function(_5bc,_5bd,_5be,rtl){if(this.aroundNode&&this.aroundNode===_5bd){return;}this.domNode.width="auto";if(this.fadeOut.status()=="playing"){this._onDeck=arguments;return;}this.containerNode.innerHTML=_5bc;var pos=_5.placeOnScreenAroundElement(this.domNode,_5bd,_5.getPopupAroundAlignment((_5be&&_5be.length)?_5be:_5.Tooltip.defaultPosition,!rtl),_4.hitch(this,"orient"));_4.style(this.domNode,"opacity",0);this.fadeIn.play();this.isShowingNow=true;this.aroundNode=_5bd;},orient:function(node,_5bf,_5c0,_5c1,_5c2){this.connectorNode.style.top="";var _5c3=_5c1.w-this.connectorNode.offsetWidth;node.className="dijitTooltip "+{"BL-TL":"dijitTooltipBelow dijitTooltipABLeft","TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[_5bf+"-"+_5c0];this.domNode.style.width="auto";var size=_4.contentBox(this.domNode);var _5c4=Math.min((Math.max(_5c3,1)),size.w);var _5c5=_5c4<size.w;this.domNode.style.width=_5c4+"px";if(_5c5){this.containerNode.style.overflow="auto";var _5c6=this.containerNode.scrollWidth;this.containerNode.style.overflow="visible";if(_5c6>_5c4){_5c6=_5c6+_4.style(this.domNode,"paddingLeft")+_4.style(this.domNode,"paddingRight");this.domNode.style.width=_5c6+"px";}}if(_5c0.charAt(0)=="B"&&_5bf.charAt(0)=="B"){var mb=_4.marginBox(node);var _5c7=this.connectorNode.offsetHeight;if(mb.h>_5c1.h){var _5c8=_5c1.h-(_5c2.h/2)-(_5c7/2);this.connectorNode.style.top=_5c8+"px";this.connectorNode.style.bottom="";}else{this.connectorNode.style.bottom=Math.min(Math.max(_5c2.h/2-_5c7/2,0),mb.h-_5c7)+"px";this.connectorNode.style.top="";}}else{this.connectorNode.style.top="";this.connectorNode.style.bottom="";}return Math.max(0,size.w-_5c3);},_onShow:function(){if(_4.isIE){this.domNode.style.filter="";}},hide:function(_5c9){if(this._onDeck&&this._onDeck[1]==_5c9){this._onDeck=null;}else{if(this.aroundNode===_5c9){this.fadeIn.stop();this.isShowingNow=false;this.aroundNode=null;this.fadeOut.play();}else{}}},_onHide:function(){this.domNode.style.cssText="";this.containerNode.innerHTML="";if(this._onDeck){this.show.apply(this,this._onDeck);this._onDeck=null;}}});_5.showTooltip=function(_5ca,_5cb,_5cc,rtl){if(!_5._masterTT){_5._masterTT=new _5._MasterTooltip();}return _5._masterTT.show(_5ca,_5cb,_5cc,rtl);};_5.hideTooltip=function(_5cd){if(!_5._masterTT){_5._masterTT=new _5._MasterTooltip();}return _5._masterTT.hide(_5cd);};_4.declare("dijit.Tooltip",_5._Widget,{label:"",showDelay:400,connectId:[],position:[],_setConnectIdAttr:function(_5ce){_4.forEach(this._connections||[],function(_5cf){_4.forEach(_5cf,_4.hitch(this,"disconnect"));},this);var ary=_4.isArrayLike(_5ce)?_5ce:(_5ce?[_5ce]:[]);this._connections=_4.map(ary,function(id){var node=_4.byId(id);return node?[this.connect(node,"onmouseenter","_onTargetMouseEnter"),this.connect(node,"onmouseleave","_onTargetMouseLeave"),this.connect(node,"onfocus","_onTargetFocus"),this.connect(node,"onblur","_onTargetBlur")]:[];},this);this._set("connectId",_5ce);this._connectIds=ary;},addTarget:function(node){var id=node.id||node;if(_4.indexOf(this._connectIds,id)==-1){this.set("connectId",this._connectIds.concat(id));}},removeTarget:function(node){var id=node.id||node,idx=_4.indexOf(this._connectIds,id);if(idx>=0){this._connectIds.splice(idx,1);this.set("connectId",this._connectIds);}},buildRendering:function(){this.inherited(arguments);_4.addClass(this.domNode,"dijitTooltipData");},startup:function(){this.inherited(arguments);var ids=this.connectId;_4.forEach(_4.isArrayLike(ids)?ids:[ids],this.addTarget,this);},_onTargetMouseEnter:function(e){this._onHover(e);},_onTargetMouseLeave:function(e){this._onUnHover(e);},_onTargetFocus:function(e){this._focus=true;this._onHover(e);},_onTargetBlur:function(e){this._focus=false;this._onUnHover(e);},_onHover:function(e){if(!this._showTimer){var _5d0=e.target;this._showTimer=setTimeout(_4.hitch(this,function(){this.open(_5d0);}),this.showDelay);}},_onUnHover:function(e){if(this._focus){return;}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}this.close();},open:function(_5d1){if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}_5.showTooltip(this.label||this.domNode.innerHTML,_5d1,this.position,!this.isLeftToRight());this._connectNode=_5d1;this.onShow(_5d1,this.position);},close:function(){if(this._connectNode){_5.hideTooltip(this._connectNode);delete this._connectNode;this.onHide();}if(this._showTimer){clearTimeout(this._showTimer);delete this._showTimer;}},onShow:function(_5d2,_5d3){},onHide:function(){},uninitialize:function(){this.close();this.inherited(arguments);}});_5.Tooltip.defaultPosition=["after","before"];}if(!_4._hasResource["dojox.charting.action2d.Base"]){_4._hasResource["dojox.charting.action2d.Base"]=true;_4.provide("dojox.charting.action2d.Base");(function(){var _5d4=400,_5d5=_4.fx.easing.backOut,df=_6.lang.functional;_4.declare("dojox.charting.action2d.Base",null,{overOutEvents:{onmouseover:1,onmouseout:1},constructor:function(_5d6,plot,_5d7){this.chart=_5d6;this.plot=plot||"default";this.anim={};if(!_5d7){_5d7={};}this.duration=_5d7.duration?_5d7.duration:_5d4;this.easing=_5d7.easing?_5d7.easing:_5d5;},connect:function(){this.handle=this.chart.connectToPlot(this.plot,this,"process");},disconnect:function(){if(this.handle){_4.disconnect(this.handle);this.handle=null;}},reset:function(){},destroy:function(){this.disconnect();df.forIn(this.anim,function(o){df.forIn(o,function(anim){anim.action.stop(true);});});this.anim={};}});})();}if(!_4._hasResource["dojox.lang.functional.scan"]){_4._hasResource["dojox.lang.functional.scan"]=true;_4.provide("dojox.lang.functional.scan");(function(){var d=_4,df=_6.lang.functional,_5d8={};d.mixin(df,{scanl:function(a,f,z,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var t,n,i;if(d.isArray(a)){t=new Array((n=a.length)+1);t[0]=z;for(i=0;i<n;z=f.call(o,z,a[i],i,a),t[++i]=z){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){t=[z];for(i=0;a.hasNext();t.push(z=f.call(o,z,a.next(),i++,a))){}}else{t=[z];for(i in a){if(!(i in _5d8)){t.push(z=f.call(o,z,a[i],i,a));}}}}return t;},scanl1:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var t,n,z,_5d9=true;if(d.isArray(a)){t=new Array(n=a.length);t[0]=z=a[0];for(var i=1;i<n;t[i]=z=f.call(o,z,a[i],i,a),++i){}}else{if(typeof a.hasNext=="function"&&typeof a.next=="function"){if(a.hasNext()){t=[z=a.next()];for(var i=1;a.hasNext();t.push(z=f.call(o,z,a.next(),i++,a))){}}}else{for(var i in a){if(!(i in _5d8)){if(_5d9){t=[z=a[i]];_5d9=false;}else{t.push(z=f.call(o,z,a[i],i,a));}}}}}return t;},scanr:function(a,f,z,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var n=a.length,t=new Array(n+1),i=n;t[n]=z;for(;i>0;--i,z=f.call(o,z,a[i],i,a),t[i]=z){}return t;},scanr1:function(a,f,o){if(typeof a=="string"){a=a.split("");}o=o||d.global;f=df.lambda(f);var n=a.length,t=new Array(n),z=a[n-1],i=n-1;t[i]=z;for(;i>0;--i,z=f.call(o,z,a[i],i,a),t[i]=z){}return t;}});})();}if(!_4._hasResource["dojox.charting.action2d.Tooltip"]){_4._hasResource["dojox.charting.action2d.Tooltip"]=true;_4.provide("dojox.charting.action2d.Tooltip");(function(){var _5da=function(o){var t=o.run&&o.run.data&&o.run.data[o.index];if(t&&typeof t!="number"&&(t.tooltip||t.text)){return t.tooltip||t.text;}if(o.element=="candlestick"){return "<table cellpadding=\"1\" cellspacing=\"0\" border=\"0\" style=\"font-size:0.9em;\">"+"<tr><td>Open:</td><td align=\"right\"><strong>"+o.data.open+"</strong></td></tr>"+"<tr><td>High:</td><td align=\"right\"><strong>"+o.data.high+"</strong></td></tr>"+"<tr><td>Low:</td><td align=\"right\"><strong>"+o.data.low+"</strong></td></tr>"+"<tr><td>Close:</td><td align=\"right\"><strong>"+o.data.close+"</strong></td></tr>"+(o.data.mid!==undefined?"<tr><td>Mid:</td><td align=\"right\"><strong>"+o.data.mid+"</strong></td></tr>":"")+"</table>";}return o.element=="bar"?o.x:o.y;};var df=_6.lang.functional,m=_6.gfx.matrix,pi4=Math.PI/4,pi2=Math.PI/2;_4.declare("dojox.charting.action2d.Tooltip",_6.charting.action2d.Base,{defaultParams:{text:_5da},optionalParams:{},constructor:function(_5db,plot,_5dc){this.text=_5dc&&_5dc.text?_5dc.text:_5da;this.connect();},process:function(o){if(o.type==="onplotreset"||o.type==="onmouseout"){_5.hideTooltip(this.aroundRect);this.aroundRect=null;if(o.type==="onplotreset"){delete this.angles;}return;}if(!o.shape||o.type!=="onmouseover"){return;}var _5dd={type:"rect"},_5de=["after","before"];switch(o.element){case "marker":_5dd.x=o.cx;_5dd.y=o.cy;_5dd.width=_5dd.height=1;break;case "circle":_5dd.x=o.cx-o.cr;_5dd.y=o.cy-o.cr;_5dd.width=_5dd.height=2*o.cr;break;case "column":_5de=["above","below"];case "bar":_5dd=_4.clone(o.shape.getShape());break;case "candlestick":_5dd.x=o.x;_5dd.y=o.y;_5dd.width=o.width;_5dd.height=o.height;break;default:if(!this.angles){if(typeof o.run.data[0]=="number"){this.angles=df.map(df.scanl(o.run.data,"+",0),"* 2 * Math.PI / this",df.foldl(o.run.data,"+",0));}else{this.angles=df.map(df.scanl(o.run.data,"a + b.y",0),"* 2 * Math.PI / this",df.foldl(o.run.data,"a + b.y",0));}}var _5df=m._degToRad(o.plot.opt.startAngle),_5e0=(this.angles[o.index]+this.angles[o.index+1])/2+_5df;_5dd.x=o.cx+o.cr*Math.cos(_5e0);_5dd.y=o.cy+o.cr*Math.sin(_5e0);_5dd.width=_5dd.height=1;if(_5e0<pi4){}else{if(_5e0<pi2+pi4){_5de=["below","above"];}else{if(_5e0<Math.PI+pi4){_5de=["before","after"];}else{if(_5e0<2*Math.PI-pi4){_5de=["above","below"];}}}}break;}var lt=_4.coords(this.chart.node,true);_5dd.x+=lt.x;_5dd.y+=lt.y;_5dd.x=Math.round(_5dd.x);_5dd.y=Math.round(_5dd.y);_5dd.width=Math.ceil(_5dd.width);_5dd.height=Math.ceil(_5dd.height);this.aroundRect=_5dd;var _5e1=this.text(o);if(_5e1){_5.showTooltip(_5e1,this.aroundRect,_5de);}}});})();}if(!_4._hasResource["esri.dijit.Popup"]){_4._hasResource["esri.dijit.Popup"]=true;_4.provide("esri.dijit.Popup");(function(){var dc=_6.charting,pk=dc.themes.PlotKit;pk.popup=pk.base.clone();pk.popup.chart.fill=pk.popup.plotarea.fill="#e7eef6";pk.popup.colors=["#284B70","#702828","#5F7143","#F6BC0C","#382C6C","#50224F","#1D7554","#4C4C4C","#0271AE","#706E41","#446A73","#0C3E69","#757575","#B7B7B7","#A3A3A3"];pk.popup.series.stroke.width=1;pk.popup.marker.stroke.width=1;}());_4.declare("esri.dijit.Popup",[esri.InfoWindowBase,esri.PopupBase],{offsetX:3,offsetY:3,zoomFactor:4,marginLeft:10,marginTop:10,highlight:true,constructor:function(_5e2,_5e3){this.initialize();_4.mixin(this,_5e2);this.domNode=_4.byId(_5e3);var nls=this._nls=_4.mixin({},esri.bundle.widgets.popup);var _5e4=this.domNode;_4.addClass(_5e4,"esriPopup");var _5e5="<div class='sizer'>"+"<div class='titlePane'>"+"<div class='spinner hidden' title='"+nls.NLS_searching+"...'></div>"+"<div class='title'></div>"+"<div class='titleButton prev hidden' title='"+nls.NLS_prevFeature+"'></div>"+"<div class='titleButton next hidden' title='"+nls.NLS_nextFeature+"'></div>"+"<div class='titleButton maximize' title='"+nls.NLS_maximize+"'></div>"+"<div class='titleButton close' title='"+nls.NLS_close+"'></div>"+"</div>"+"</div>"+"<div class='sizer content'>"+"<div class='contentPane'>"+"</div>"+"</div>"+"<div class='sizer'>"+"<div class='actionsPane'>"+"<div class='actionList hidden'>"+"<a class='action zoomTo' href='javascript:void(0);'>Zoom to</a>"+"</div>"+"</div>"+"</div>"+"<div class='pointer top hidden'></div>"+"<div class='pointer bottom hidden'></div>"+"<div class='pointer left hidden'></div>"+"<div class='pointer right hidden'></div>"+"<div class='pointer topLeft hidden'></div>"+"<div class='pointer topRight hidden'></div>"+"<div class='pointer bottomLeft hidden'></div>"+"<div class='pointer bottomRight hidden'></div>";_4.attr(_5e4,"innerHTML",_5e5);this._sizers=_4.query(".sizer",_5e4);var _5e6=_4.query(".titlePane",_5e4)[0];_4.setSelectable(_5e6,false);this._title=_4.query(".title",_5e6)[0];this._prevFeatureButton=_4.query(".prev",_5e6)[0];this._nextFeatureButton=_4.query(".next",_5e6)[0];this._maxButton=_4.query(".maximize",_5e6)[0];this._spinner=_4.query(".spinner",_5e6)[0];this._contentPane=_4.query(".contentPane",_5e4)[0];this._actionList=_4.query(".actionsPane .actionList",_5e4)[0];this._eventConnections=[_4.connect(_4.query(".close",_5e6)[0],"onclick",this,this.hide),_4.connect(this._prevFeatureButton,"onclick",this,this.selectPrevious),_4.connect(this._nextFeatureButton,"onclick",this,this.selectNext),_4.connect(this._maxButton,"onclick",this,this._toggleSize),_4.connect(_4.query(".zoomTo",this._actionList)[0],"onclick",this,this._zoomToFeature)];if(esri.isTouchEnabled){var _5e7=esri.setScrollable(this._contentPane);this._eventConnections.push(_5e7[0],_5e7[1]);}esri.hide(_5e4);this.isShowing=false;},setMap:function(map){this.inherited(arguments);if(this.highlight){this.enableHighlight(map);}},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments);},setTitle:function(_5e8){this.destroyDijits(this._title);this.place(_5e8,this._title);if(this.isShowing){this.startupDijits(this._title);}},setContent:function(_5e9){this.destroyDijits(this._contentPane);this.place(_5e9,this._contentPane);if(this.isShowing){this.startupDijits(this._contentPane);}},show:function(_5ea){if(!_5ea){esri.show(this.domNode);this.isShowing=true;return;}var map=this.map,_5eb;if(_5ea.spatialReference){this._location=_5ea;_5eb=map.toScreen(_5ea);}else{this._location=map.toMap(_5ea);_5eb=_5ea;}var _5ec=map._getFrameWidth();if(_5ec!==-1){_5eb.x=_5eb.x%_5ec;if(_5eb.x<0){_5eb.x+=_5ec;}if(map.width>_5ec){var _5ed=(map.width-_5ec)/2;while(_5eb.x<_5ed){_5eb.x+=_5ec;}}}if(this._maximized){this.restore();}else{this._setPosition(_5eb);}if(!this.isShowing){esri.show(this.domNode);this.isShowing=true;this.onShow();}},hide:function(){if(this.isShowing){esri.hide(this.domNode);this.isShowing=false;this.onHide();}},resize:function(_5ee,_5ef){this._sizers.style({width:_5ee+"px"});_4.style(this._contentPane,"maxHeight",_5ef+"px");},onShow:function(){this._followMap();this.startupDijits(this._title);this.startupDijits(this._contentPane);this.showHighlight();},onHide:function(){this._unfollowMap();this.hideHighlight();},maximize:function(){var map=this.map;if(!map||this._maximized){return;}this._maximized=true;var max=this._maxButton;_4.removeClass(max,"maximize");_4.addClass(max,"restore");_4.attr(max,"title",this._nls.NLS_restore);var _5f0=this.marginLeft,_5f1=this.marginTop,_5f2=map.width-(2*_5f0),_5f3=map.height-(2*_5f1),_5f4=this.domNode;_4.style(_5f4,{left:_5f0+"px",right:null,top:_5f1+"px",bottom:null});this._savedWidth=_4.style(this._sizers[0],"width");this._savedHeight=_4.style(this._contentPane,"maxHeight");this._sizers.style({width:_5f2+"px"});_4.style(this._contentPane,{maxHeight:(_5f3-65)+"px",height:(_5f3-65)+"px"});this._showPointer("");this._unfollowMap();},restore:function(){var map=this.map;if(!map||!this._maximized){return;}this._maximized=false;var max=this._maxButton;_4.removeClass(max,"restore");_4.addClass(max,"maximize");_4.attr(max,"title",this._nls.NLS_maximize);_4.style(this._contentPane,"height",null);this.resize(this._savedWidth,this._savedHeight);this._savedWidth=this._savedHeight=null;this.show(this._location);this._followMap();},destroy:function(){if(this.map){this.unsetMap();}this.cleanup();if(this.isShowing){this.hide();}this.destroyDijits(this._title);this.destroyDijits(this._content);_4.forEach(this._eventConnections,_4.disconnect);_4.destroy(this.domNode);this._sizers=this._contentPane=this._actionList=this._title=this._prevFeatureButton=this._nextFeatureButton=this._spinner=this._eventConnections=this._pagerScope=this._targetLocation=this._nls=this._maxButton=null;},selectNext:function(){this.select(this.selectedIndex+1);},selectPrevious:function(){this.select(this.selectedIndex-1);},setFeatures:function(){this.inherited(arguments);this._updateUI();},onSetFeatures:function(){},onClearFeatures:function(){this.setTitle("&nbsp;");this.setContent("&nbsp;");this._setPagerCallbacks(this);this._updateUI();this.hideHighlight();},onSelectionChange:function(){var ptr=this.selectedIndex;this._updateUI();if(ptr>=0){this.setContent(this.features[ptr].getContent());this.updateHighlight(this.map,this.features[ptr]);if(this.isShowing){this.showHighlight();}}},onDfdComplete:function(){this._updateUI();},_followMap:function(){this._unfollowMap();var map=this.map;this._handles=[_4.connect(map,"onPanStart",this,this._onPanStart),_4.connect(map,"onPan",this,this._onPan),_4.connect(map,"onZoomStart",this,this._onZoomStart),_4.connect(map,"onExtentChange",this,this._onExtentChange)];},_unfollowMap:function(){var _5f5=this._handles;if(_5f5){_4.forEach(_5f5,_4.disconnect,_4);this._handles=null;}},_onPanStart:function(){var _5f6=this.domNode.style;this._panOrigin={left:_5f6.left,top:_5f6.top,right:_5f6.right,bottom:_5f6.bottom};},_onPan:function(_5f7,_5f8){var _5f9=this._panOrigin,dx=_5f8.x,dy=_5f8.y,left=_5f9.left,top=_5f9.top,_5fa=_5f9.right,_5fb=_5f9.bottom;if(left){left=(parseFloat(left)+dx)+"px";}if(top){top=(parseFloat(top)+dy)+"px";}if(_5fa){_5fa=(parseFloat(_5fa)-dx)+"px";}if(_5fb){_5fb=(parseFloat(_5fb)-dy)+"px";}_4.style(this.domNode,{left:left,top:top,right:_5fa,bottom:_5fb});},_onZoomStart:function(){esri.hide(this.domNode);},_onExtentChange:function(_5fc,_5fd,_5fe){if(_5fe){esri.show(this.domNode);}this.show(this._targetLocation||this._location);this._targetLocation=null;},_toggleSize:function(){if(this._maximized){this.restore();}else{this.maximize();}},_setPosition:function(_5ff){var posX=_5ff.x,posY=_5ff.y,offX=this.offsetX||0,offY=this.offsetY||0,_600=0,_601=_4.contentBox(this.map.container),_602=_601.w,_603=_601.h,_604="Right",_605="top",_606="Left",_607="bottom";if(posX<=_602/2){_604="Right";_606="Left";}else{if(posX<=_602){_604="Left";_606="Right";}}if(posY<=_603/2){_605="bottom";_607="top";}else{if(posY<=_603){_605="top";_607="bottom";}}var _608=_605+_604,_609=_607+_606;this._showPointer(_609);switch(_609){case "topLeft":case "topRight":case "bottomLeft":case "bottomRight":_600=45;break;}switch(_608){case "topLeft":_4.style(this.domNode,{left:null,right:(_602-posX+offX)+"px",top:null,bottom:(_603-posY+_600+offY)+"px"});break;case "topRight":_4.style(this.domNode,{left:(posX+offX)+"px",right:null,top:null,bottom:(_603-posY+_600+offY)+"px"});break;case "bottomLeft":_4.style(this.domNode,{left:null,right:(_602-posX+offX)+"px",top:(posY+_600+offY)+"px",bottom:null});break;case "bottomRight":_4.style(this.domNode,{left:(posX+offX)+"px",right:null,top:(posY+_600+offY)+"px",bottom:null});break;}},_showPointer:function(_60a){var _60b=["topLeft","topRight","bottomRight","bottomLeft"];_4.forEach(_60b,function(ptr){if(ptr===_60a){_4.query(".pointer."+ptr,this.domNode).removeClass("hidden");}else{_4.query(".pointer."+ptr,this.domNode).addClass("hidden");}},this);},_setPagerCallbacks:function(_60c,_60d,_60e){if(_60c===this&&(!this._pagerScope||this._pagerScope===this)){return;}if(_60c===this._pagerScope){return;}this._pagerScope=_60c;if(_60c===this){_60d=this.selectPrevious;_60e=this.selectNext;}var _60f=this._eventConnections;_4.disconnect(_60f[1]);_4.disconnect(_60f[2]);if(_60d){_60f[1]=_4.connect(this._prevFeatureButton,"onclick",_60c,_60d);}if(_60e){_60f[2]=_4.connect(this._nextFeatureButton,"onclick",_60c,_60e);}},_zoomToFeature:function(){var _610=this.features,ptr=this.selectedIndex,map=this.map;if(_610){var _611=_610[ptr].geometry,_612,_613,_614=0,_615;if(_611){switch(_611.type){case "point":_612=_611;break;case "multipoint":_612=_611.getPoint(0);_613=_611.getExtent();break;case "polyline":_612=_611.getPoint(0,0);_613=_611.getExtent();if(map._getFrameWidth()!==-1){_4.forEach(_611.paths,function(path){var _616={"paths":[path,map.spatialReference]},_617=new esri.geometry.Polyline(_616),_618=_617.getExtent(),_619=Math.abs(_618.ymax-_618.ymin),_61a=Math.abs(_618.xmax-_618.xmin),_61b=(_61a>_619)?_61a:_619;if(_61b>_614){_614=_61b;_615=_618;}});_613=_615;}break;case "polygon":_612=_611.getPoint(0,0);_613=_611.getExtent();if(map._getFrameWidth()!==-1){_4.forEach(_611.rings,function(ring){var _61c={"rings":[ring,map.spatialReference]},_61d=new esri.geometry.Polygon(_61c),_61e=_61d.getExtent(),_61f=Math.abs(_61e.ymax-_61e.ymin),_620=Math.abs(_61e.xmax-_61e.xmin),_621=(_620>_61f)?_620:_61f;if(_621>_614){_614=_621;_615=_61e;}});_613=_615;}break;}}if(!_612){_612=this._location;}if(!_613||!_613.intersects(this._location)){this._location=_612;}if(_613){map.setExtent(_613,true);}else{var _622=map.getNumLevels(),_623=map.getLevel(),last=_622-1,_624=this.zoomFactor||1;if(_622>0){if(_623===last){return;}var _625=_623+_624;if(_625>last){_625=last;}map._scrollZoomHandler({value:(_625-_623),mapPoint:_612});}else{map._scrollZoomHandler({value:(1/Math.pow(2,_624))*2,mapPoint:_612});}}}},_updateUI:function(){var _626="&nbsp;",ptr=this.selectedIndex,_627=this.features,_628=this.deferreds,prev=this._prevFeatureButton,next=this._nextFeatureButton,_629=this._spinner,_62a=this._actionList,nls=this._nls;if(_627&&_627.length>1){_626="("+(ptr+1)+" of "+_627.length+")";if(ptr===0){_4.addClass(prev,"hidden");}else{_4.removeClass(prev,"hidden");}if(ptr===_627.length-1){_4.addClass(next,"hidden");}else{_4.removeClass(next,"hidden");}}else{_4.addClass(prev,"hidden");_4.addClass(next,"hidden");}this.setTitle(_626);if(_628&&_628.length){if(_627){_4.removeClass(_629,"hidden");}else{this.setContent("<div style='text-align: center;'>"+nls.NLS_searching+"...</div>");}}else{_4.addClass(_629,"hidden");if(!_627||!_627.length){this.setContent("<div style='text-align: center;'>"+nls.NLS_noInfo+".</div>");}}if(_627&&_627.length){_4.removeClass(_62a,"hidden");}else{_4.addClass(_62a,"hidden");}}});_4.declare("esri.dijit.PopupTemplate",[esri.PopupInfoTemplate],{constructor:function(json){this.initialize(json);this._nls=_4.mixin({},esri.bundle.widgets.popup);},getTitle:function(_62b){return this.info?this.getComponents(_62b).title:"";},getContent:function(_62c){return this.info?new esri.dijit._PopupRenderer({template:this,graphic:_62c,_nls:this._nls},_4.create("div")).domNode:"";}});_4.declare("esri.dijit._PopupRenderer",[_5._Widget,_5._Templated],{templateString:"<div class='esriViewPopup'>"+"<div class='mainSection'>"+"<div class='header' dojoAttachPoint='_title'></div>"+"<div class='hzLine'></div>"+"<div dojoAttachPoint='_description'></div>"+"<div class='break'></div>"+"</div>"+"<div class='attachmentsSection hidden'>"+"<div>Attachments:</div>"+"<ul dojoAttachPoint='_attachmentsList'>"+"</ul>"+"<div class='break'></div>"+"</div>"+"<div class='mediaSection hidden'>"+"<div class='header' dojoAttachPoint='_mediaTitle'></div>"+"<div class='hzLine'></div>"+"<div class='caption' dojoAttachPoint='_mediaCaption'></div>"+"<div class='gallery' dojoAttachPoint='_gallery'>"+"<div class='mediaHandle prev' dojoAttachPoint='_prevMedia' dojoAttachEvent='onclick: _goToPrevMedia'></div>"+"<div class='mediaHandle next' dojoAttachPoint='_nextMedia' dojoAttachEvent='onclick: _goToNextMedia'></div>"+"<ul class='summary'>"+"<li class='image mediaCount hidden' dojoAttachPoint='_imageCount'>0</li>"+"<li class='image mediaIcon hidden'></li>"+"<li class='chart mediaCount hidden' dojoAttachPoint='_chartCount'>0</li>"+"<li class='chart mediaIcon hidden'></li>"+"</ul>"+"<div class='frame' dojoAttachPoint='_mediaFrame'></div>"+"</div>"+"</div>"+"</div>",startup:function(){this.inherited(arguments);var _62d=this.template,_62e=this.graphic,_62f=_62d.getComponents(_62e),_630=_62f.title,_631=_62f.description,_632=_62f.fields,_633=_62f.mediaInfos,_634=this.domNode,nls=this._nls;this._prevMedia.title=nls.NLS_prevMedia;this._nextMedia.title=nls.NLS_nextMedia;_4.attr(this._title,"innerHTML",_630);if(!_630){_4.addClass(this._title,"hidden");}if(!_631&&_632){_631="";_4.forEach(_632,function(row){_631+=("<tr valign='top'>");_631+=("<td class='attrName'>"+row[0]+"</td>");_631+=("<td class='attrValue'>"+row[1].replace(/^\s*(https?:\/\/[^\s]+)\s*$/i,"<a target='_blank' href='$1' title='$1'>More info</a>")+"</td>");_631+=("</tr>");});if(_631){_631="<table class='attrTable' cellpadding='0px' cellspacing='0px'>"+_631+"</table>";}}_4.attr(this._description,"innerHTML",_631);if(!_631){_4.addClass(this._description,"hidden");}_4.query("a",this._description).forEach(function(node){_4.attr(node,"target","_blank");});if(_630&&_631){_4.query(".mainSection .hzLine",_634).removeClass("hidden");}else{if(_630||_631){_4.query(".mainSection .hzLine",_634).addClass("hidden");}else{_4.query(".mainSection",_634).addClass("hidden");}}var dfd=(this._dfd=_62d.getAttachments(_62e));if(dfd){dfd.addBoth(_4.hitch(this,this._attListHandler,dfd));_4.attr(this._attachmentsList,"innerHTML","<li>"+nls.NLS_searching+"...</li>");_4.query(".attachmentsSection",_634).removeClass("hidden");}if(_633&&_633.length){_4.query(".mediaSection",_634).removeClass("hidden");_4.setSelectable(this._mediaFrame,false);this._mediaInfos=_633;this._mediaPtr=0;this._updateUI();this._displayMedia();}},destroy:function(){if(this._dfd){this._dfd.cancel();}this._destroyFrame();this.template=this.graphic=this._nls=this._mediaInfos=this._mediaPtr=this._dfd=null;this.inherited(arguments);},_goToPrevMedia:function(){var ptr=this._mediaPtr-1;if(ptr<0){return;}this._mediaPtr--;this._updateUI();this._displayMedia();},_goToNextMedia:function(){var ptr=this._mediaPtr+1;if(ptr===this._mediaInfos.length){return;}this._mediaPtr++;this._updateUI();this._displayMedia();},_updateUI:function(){var _635=this._mediaInfos,_636=_635.length,_637=this.domNode,_638=this._prevMedia,_639=this._nextMedia;if(_636>1){var _63a=0,_63b=0;_4.forEach(_635,function(info){if(info.type==="image"){_63a++;}else{if(info.type.indexOf("chart")!==-1){_63b++;}}});if(_63a){_4.attr(this._imageCount,"innerHTML",_63a);_4.query(".summary .image",_637).removeClass("hidden");}if(_63b){_4.attr(this._chartCount,"innerHTML",_63b);_4.query(".summary .chart",_637).removeClass("hidden");}}else{_4.query(".summary",_637).addClass("hidden");_4.addClass(_638,"hidden");_4.addClass(_639,"hidden");}var ptr=this._mediaPtr;if(ptr===0){_4.addClass(_638,"hidden");}else{_4.removeClass(_638,"hidden");}if(ptr===_636-1){_4.addClass(_639,"hidden");}else{_4.removeClass(_639,"hidden");}this._destroyFrame();},_displayMedia:function(){var info=this._mediaInfos[this._mediaPtr],_63c=info.title,_63d=info.caption,_63e=_4.query(".mediaSection .hzLine",this.domNode)[0];_4.attr(this._mediaTitle,"innerHTML",_63c);_4[_63c?"removeClass":"addClass"](this._mediaTitle,"hidden");_4.attr(this._mediaCaption,"innerHTML",_63d);_4[_63d?"removeClass":"addClass"](this._mediaCaption,"hidden");_4[(_63c&&_63d)?"removeClass":"addClass"](_63e,"hidden");if(info.type==="image"){this._showImage(info.value);}else{this._showChart(info.type,info.value);}},_showImage:function(_63f){_4.addClass(this._mediaFrame,"image");var _640=_4.style(this._gallery,"height"),html="<img src='"+_63f.sourceURL+"' onload='esri.dijit._PopupRenderer.prototype._imageLoaded(this,"+_640+");' />";if(_63f.linkURL){html="<a target='_blank' href='"+_63f.linkURL+"'>"+html+"</a>";}_4.attr(this._mediaFrame,"innerHTML",html);},_showChart:function(type,_641){_4.removeClass(this._mediaFrame,"image");var _642=this._chart=new _6.charting.Chart2D(_4.create("div",{"class":"chart"},this._mediaFrame),{margins:{l:4,t:4,r:4,b:4}});_642.setTheme(_4.getObject("dojox.charting.themes."+(_641.theme||"PlotKit.popup")));switch(type){case "piechart":_642.addPlot("default",{type:"Pie",labels:false});_642.addSeries("Series A",_641.fields);break;case "linechart":_642.addPlot("default",{type:"Markers"});_642.addAxis("x",{min:0,majorTicks:false,minorTicks:false,majorLabels:false,minorLabels:false});_642.addAxis("y",{includeZero:true,vertical:true,fixUpper:"minor"});_4.forEach(_641.fields,function(info,idx){info.x=idx+1;});_642.addSeries("Series A",_641.fields);break;case "columnchart":_642.addPlot("default",{type:"Columns",gap:3});_642.addAxis("y",{includeZero:true,vertical:true,fixUpper:"minor"});_642.addSeries("Series A",_641.fields);break;case "barchart":_642.addPlot("default",{type:"Bars",gap:3});_642.addAxis("x",{includeZero:true,fixUpper:"minor",minorLabels:false});_642.addAxis("y",{vertical:true,majorTicks:false,minorTicks:false,majorLabels:false,minorLabels:false});_642.addSeries("Series A",_641.fields);break;}this._action=new _6.charting.action2d.Tooltip(_642);_642.render();},_destroyFrame:function(){if(this._chart){this._chart.destroy();this._chart=null;}if(this._action){this._action.destroy();this._action=null;}_4.attr(this._mediaFrame,"innerHTML","");},_imageLoaded:function(img,_643){var _644=img.height;if(_644<_643){var diff=Math.round((_643-_644)/2);_4.style(img,"marginTop",diff+"px");}},_attListHandler:function(dfd,_645){if(dfd===this._dfd){this._dfd=null;var html="";if(!(_645 instanceof Error)&&_645&&_645.length){_4.forEach(_645,function(info){html+=("<li>");html+=("<a href='"+info.url+"' target='_blank'>"+(info.name||"[No name]")+"</a>");html+=("</li>");});}_4.attr(this._attachmentsList,"innerHTML",html||"<li>"+this._nls.NLS_noAttach+"</li>");}}});}if(!_4._hasResource["esri.layers.KMLLayer"]){_4._hasResource["esri.layers.KMLLayer"]=true;_4.provide("esri.layers.KMLLayer");_4.declare("esri.layers.KMLLayer",[esri.layers.Layer],{serviceUrl:"http://utility.arcgis.com/sharing/kml",constructor:function(url,_646){if(!url){console.log("KMLLayer:constructor - please provide url for the KML file");}this._outSR=null;if(_646&&_646.outSR){this._outSR=_646.outSR;this._outSR=(this._outSR)?this._outSR.wkid:null;}this._options=_646;if(esri.config.defaults.kmlService){this.serviceUrl=esri.config.defaults.kmlService;}var link=(this.linkInfo=_646&&_646.linkInfo);if(link){this.visible=!!link.visibility;}if(!link||(link&&link.visibility)){this._parseKml();}},getFeature:function(_647){if(!_647){return;}var type=_647.type,id=_647.id,_648,i,len;switch(type){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryPolygon":var _649=this["_"+type];if(_649){_648=_4.getObject("_mode._featureMap."+id,false,_649);}break;case "GroundOverlay":var _64a=this._groundLyr;if(_64a){var _64b=_64a.getImages();len=_64b.length;for(i=0;i<len;i++){if(_64b[i].id===id){_648=_64b[i];break;}}}break;case "ScreenOverlay":break;case "NetworkLink":_4.some(this._links,function(link){if(link.linkInfo.id===id){_648=link;return true;}else{return false;}});break;case "Folder":var _64c=this.folders;len=_64c?_64c.length:0;for(i=0;i<len;i++){if(_64c[i].id===id){_648=_64c[i];break;}}break;default:console.log("KMLLayer:getFeature - unknown feature type");break;}return _648;},getLayers:function(){var _64d=[];if(this._groundLyr){_64d.push(this._groundLyr);}if(this._fLayers){_64d=_64d.concat(this._fLayers);}return _64d;},setFolderVisibility:function(_64e,_64f){if(!_64e){return;}_64e.visible=_64f;if(_64f){var _650=this._getParentFolders(_64e,[]);if(_650.length>0){_64f=_4.every(_650,function(_651){return _651.visible;});}}this._setState(_64e,_64f);},_parseKml:function(){var self=this;esri.request({url:this.serviceUrl,content:{url:this.url,model:"simple",folders:"",outSR:this._outSR},callbackParamName:"callback",load:function(_652){self._initLayer(_652);},error:function(err){self.onError("Error reading kml document. ("+_4.toJson(err)+")");}});},_initLayer:function(json){this.name=json.name;this.description=json.description;this.snippet=json.snippet;this.visibility=json.visibility;this.featureInfos=json.featureInfos;var i,len;var _653=(this._links=json.networkLinks);len=_653?_653.length:0;var _654=this;for(i=0;i<len;i++){var _655={linkInfo:_653[i]};_655=_4.mixin(_655,this._options);if(_655.id){_655.id=_655.id+"_"+i;}if(_653[i].viewRefreshMode==="never"){_653[i]=new esri.layers.KMLLayer(_653[i].href,_655);_4.connect(_653[i],"onLoad",function(a){_654._map.addLayer(a);});}}var _656=json.groundOverlays;if(_656&&_656.length>0){var _655=_4.mixin({},this._options);if(_655.id){_655.id=_655.id+"_"+"mapImage";}var _657=(this._groundLyr=new esri.layers.MapImageLayer(_655));len=_656.length;for(i=0;i<len;i++){_657.addImage(new esri.layers.KMLGroundOverlay(_656[i]));}}var _658=_4.getObject("featureCollection.layers",false,json);if(_658&&_658.length>0){this._fLayers=[];_4.forEach(_658,function(_659,i){var _65a=_4.getObject("featureSet.features",false,_659),_65b;if(_65a&&_65a.length>0){_659.layerDefinition.capabilities="Query,Data";var _65c={outFields:["*"],infoTemplate:_659.popupInfo?new esri.dijit.PopupTemplate(_659.popupInfo):null,editable:false};_65c=_4.mixin(_65c,this._options);if(_65c.id){_65c.id=_65c.id+"_"+i;}_65b=new esri.layers.FeatureLayer(_659,_65c);if(_65b.geometryType){this["_"+_65b.geometryType]=_65b;}this._fLayers.push(_65b);}},this);if(this._fLayers.length===0){delete this._fLayers;}}var _65d=(this.folders=json.folders),_65e=[],fldr;if(_65d){len=_65d.length;for(i=0;i<len;i++){fldr=(_65d[i]=new esri.layers.KMLFolder(_65d[i]));if(fldr.parentFolderId===-1){_65e.push(fldr);}}}len=_65e.length;for(i=0;i<len;i++){fldr=_65e[i];this._setState(fldr,fldr.visible);}this.loaded=true;this.onLoad(this);},_setState:function(_65f,_660){var _661=_65f.featureInfos,info,_662,i,len=_661?_661.length:0,_663=_660?"show":"hide";for(i=0;i<len;i++){info=_661[i];_662=this.getFeature(info);if(!_662){continue;}if(info.type==="Folder"){this._setState(_662,_660&&_662.visible);}else{_662[_663]();}}},_getParentFolders:function(_664,_665){var _666=_664.parentFolderId;if(_666!==-1){var _667=this.getFeature({type:"Folder",id:_666});_665.push(_667);return this._getParentFolders(_667,_665);}return _665;},_setMap:function(map,_668){this._map=map;var div=this._div=_4.create("div",null,_668);_4.style(div,"position","absolute");if(this._groundLyr){var _669=map.spatialReference._isWebMercator();if(_669){var _66a=esri.geometry.geographicToWebMercator;_4.forEach(this._groundLyr.getImages(),function(_66b){_66b.extent=_66a(_66b.extent);});}map.addLayer(this._groundLyr,map.layerIds.length);}var _66c=this._fLayers;if(_66c&&_66c.length>0){var _669=map.spatialReference._isWebMercator();_4.forEach(_66c,function(_66d){if(_669){var _66e=_66d.graphics,i,geom,len=_66e?_66e.length:0,_66a=esri.geometry.geographicToWebMercator;for(i=0;i<len;i++){geom=_66e[i].geometry;if(geom){_66e[i].setGeometry(_66a(geom));}}}map.addLayer(_66d);});}this.onVisibilityChange(this.visible);return div;},_unsetMap:function(map,_66f){if(this._groundLyr){map.removeLayer(this._groundLyr);}if(this._fLayers){_4.forEach(this._fLayers,function(_670){map.removeLayer(_670);});}var div=this._div;if(div){_66f.removeChild(div);_4.destroy(div);}this._map=this._div=null;},onVisibilityChange:function(_671){var _672=_671?"show":"hide";if(_671&&this.linkInfo&&!this.loaded){this._parseKml();}else{if(this._groundLyr){this._groundLyr[_672]();}if(this._fLayers){_4.forEach(this._fLayers,function(_673){_673[_672]();});}}}});_4.declare("esri.layers.KMLGroundOverlay",[esri.layers.MapImage],{constructor:function(json){if(esri._isDefined(this.visibility)){this.visible=!!this.visibility;}}});_4.declare("esri.layers.KMLFolder",null,{constructor:function(json){_4.mixin(this,json);if(esri._isDefined(this.visibility)){this.visible=!!this.visibility;}}});}if(!_4._hasResource["esri.layers.wms"]){_4._hasResource["esri.layers.wms"]=true;_4.provide("esri.layers.wms");_4.declare("esri.layers.WMSLayer",[esri.layers.DynamicMapServiceLayer],{_CRS_TO_EPSG:{84:4326,83:4269,27:4267},_REVERSED_LAT_LONG_RANGES:[[4001,4999],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],_WEB_MERCATOR:[102100,3857,102113,900913],_WORLD_MERCATOR:[3395,54004],allExtents:[],constructor:function(url,_674){this._getCapabilitiesURL=url;this._initLayer=_4.hitch(this,this._initLayer);this._parseCapabilities=_4.hitch(this,this._parseCapabilities);this._getCapabilitiesError=_4.hitch(this,this._getCapabilitiesError);if(_674){this.imageFormat=this._getImageFormat(_674.format);this.imageTransparency=(_674.transparent===false)?false:true;this.visibleLayers=_674.visibleLayers?_674.visibleLayers:[];if(_674.resourceInfo){this._readResourceInfo(_674.resourceInfo);}else{this._getCapabilities();}}else{this.imageFormat="image/png";this.imageTransparency=true;this.visibleLayers=[];this._getCapabilities();}this._blankImageURL=_4.moduleUrl("esri","../../images/pixel.png").uri;},setVisibleLayers:function(_675){_675=this._checkVisibleLayersList(_675);this.visibleLayers=(_675)?_675:[];this.refresh(true);},setImageFormat:function(_676){this.imageFormat=this._getImageFormat(_676);this.refresh(true);},setImageTransparency:function(_677){this.imageTransparency=_677;this.refresh(true);},getImageUrl:function(_678,_679,_67a,_67b){if(!this.visibleLayers||this.visibleLayers.length===0){_67b(this._blankImageURL);return;}var wkid=_678.spatialReference.wkid;if(_4.some(this._WEB_MERCATOR,function(el){return el==wkid;})){var _67c=_4.filter(this.spatialReferences,function(el){return (_4.some(this._WEB_MERCATOR,function(el2){return el2==el;}));},this);if(_67c.length==0){_67c=_4.filter(this.spatialReferences,function(el){return (_4.some(this._WORLD_MERCATOR,function(el2){return el2==el;}));},this);}if(_67c.length>0){wkid=_67c[0];}else{wkid=this._WEB_MERCATOR[0];}}var list=_4.filter(this.spatialReferences,function(el){return el!==wkid;});this.spatialReferences=list;this.spatialReferences.unshift(wkid);var xmin=_678.xmin;var xmax=_678.xmax;var ymin=_678.ymin;var ymax=_678.ymax;var _67d={};_67d.SERVICE="WMS";_67d.REQUEST="GetMap";_67d.FORMAT=this.imageFormat;_67d.TRANSPARENT=this.imageTransparency?"TRUE":"FALSE";_67d.STYLES="";_67d.VERSION=this.version;_67d.LAYERS=this.visibleLayers?this.visibleLayers.toString():null;_67d.WIDTH=_679;_67d.HEIGHT=_67a;if(this.maxWidth<_679){_67d.WIDTH=this.maxWidth;}if(this.maxHeight<_67a){_67d.HEIGHT=this.maxHeight;}var _67e=wkid?wkid:NaN;if(!isNaN(_67e)){if(this.version=="1.3.0"){_67d.CRS="EPSG:"+_67e;}else{_67d.SRS="EPSG:"+_67e;}}if(this.version=="1.3.0"&&this._useLatLong(_67e)){_67d.BBOX=ymin+","+xmin+","+ymax+","+xmax;}else{_67d.BBOX=xmin+","+ymin+","+xmax+","+ymax;}var _67f=this.getMapURL;_67f+=(_67f.indexOf("?")==-1)?"?":"";for(var key in _67d){_67f+=(_67f.substring(_67f.length-1,_67f.length)=="?")?"":"&";_67f+=key+"="+_67d[key];}_67b(_67f);},_initLayer:function(_680,io){this.spatialReference=new esri.SpatialReference(this.extent.spatialReference);this.initialExtent=new esri.geometry.Extent(this.extent);this.fullExtent=new esri.geometry.Extent(this.extent);this.visibleLayers=this._checkVisibleLayersList(this.visibleLayers);this.loaded=true;this.onLoad(this);var _681=this._loadCallback;if(_681){delete this._loadCallback;_681(this);}},_readResourceInfo:function(_682){if(!_682.extent){console.error("esri.layers.WMSLayer: unable to find the 'extent' property in resourceInfo");return;}if(!_682.layerInfos){console.error("esri.layers.WMSLayer: unable to find the 'layerInfos' property in resourceInfo");return;}this.extent=_682.extent;this.layerInfos=_682.layerInfos;this.description=_682.description?_682.description:"";this.copyright=_682.copyright?_682.copyright:"";this.title=_682.title?_682.title:"";this.getMapURL=_682.getMapURL?_682.getMapURL:this._getCapabilitiesURL;this.version=_682.version?_682.version:"1.3.0";this.maxWidth=_682.maxWidth?_682.maxWidth:5000;this.maxHeight=_682.maxHeight?_682.maxHeight:5000;this.spatialReferences=_682.spatialReferences?_682.spatialReferences:[];this._initLayer();},_getCapabilities:function(){var _683=this._url.query?this._url.query:{};_683.SERVICE="WMS";_683.REQUEST="GetCapabilities";var uri=this._url.path+"?";for(var key in _683){uri+=(uri.substring(uri.length-1,uri.length)=="?")?"":"&";uri+=key+"="+_683[key];}var _684=esri.request({url:uri,handleAs:"xml",load:this._parseCapabilities,error:this._getCapabilitiesError},{usePost:false});},_parseCapabilities:function(xml){if(!xml){this.onError("GetCapabilities request for "+this._getCapabilitiesURL+" failed. (Response is null.)");return;}this.version=this._getAttributeValue("WMS_Capabilities","version",xml,null);if(!this.version){this.version=this._getAttributeValue("WMT_MS_Capabilities","version",xml,"1.3.0");}var _685=this._getTag("Service",xml);this.title=this._getTagValue("Title",_685,"");if(this.title.length==0){this.title=this._getTagValue("Name",_685,"");}this.copyright=this._getTagValue("AccessConstraints",_685,"");this.description=this._getTagValue("Abstract",_685,"");this.maxWidth=parseInt(this._getTagValue("MaxWidth",_685,5000));this.maxHeight=parseInt(this._getTagValue("MaxHeight",_685,5000));var _686=this._getTag("Layer",xml);if(!_686){this._getCapabilitiesError({"error":{"message":"Response does not contain any layers."}});return;}var _687=this._getLayerInfo(_686);if(_687){this.layerInfos=_687.subLayers;this.extent=_687.extent;this.spatialReferences=_687.spatialReferences;this.allExtents=_687.allExtents;}this.getMapURL=this._getCapabilitiesURL;var _688=_4.query("DCPType",this._getTag("GetMap",xml));if(_688&&_688.length>0){var _689=_4.query("HTTP",_688[0]);if(_689&&_689.length>0){var _68a=_4.query("Get",_689[0]);if(_68a&&_68a.length>0){var _68b=this._getAttributeValue("OnlineResource","xlink:href",_68a[0],null);if(_68b){if(_68b.indexOf("&")==(_68b.length-1)){_68b=_68b.substring(0,_68b.length-1);}this.getMapURL=_68b;}}}}this.getMapFormats=[];_4.forEach(_4.query("Format",this._getTag("GetMap",xml)),function(_68c){if(_4.isIE){this.getMapFormats.push(_68c.text);}else{this.getMapFormats.push(_68c.textContent);}},this);this._initLayer();},_getCapabilitiesError:function(_68d,io){this.onError("GetCapabilities request for "+this._getCapabilitiesURL+" failed. ("+_4.toJson(_68d)+")");},_getLayerInfo:function(_68e){var _68f;if(_68e){_68f=new esri.layers.WMSLayerInfo();_68f.name="";_68f.title="";_68f.description="";_4.forEach(_68e.childNodes,function(_690){if(_690.nodeName=="Name"){_68f.name=(_4.isIE?_690.text:_690.textContent)||"";}else{if(_690.nodeName=="Title"){_68f.title=(_4.isIE?_690.text:_690.textContent)||"";}else{if(_690.nodeName=="Abstract"){_68f.description=(_4.isIE?_690.text:_690.textContent)||"";}}}},this);_68f.allExtents=[];var _691=this._getTag("LatLonBoundingBox",_68e);if(_691){_68f.allExtents[0]=this._getExtent(_691,4326);}var _692=this._getTag("EX_GeographicBoundingBox",_68e);if(_692){var _693=new esri.geometry.Extent(0,0,0,0,new esri.SpatialReference({wkid:4326}));_693.xmin=parseFloat(this._getTagValue("westBoundLongitude",_692,0));_693.ymin=parseFloat(this._getTagValue("southBoundLatitude",_692,0));_693.xmax=parseFloat(this._getTagValue("eastBoundLongitude",_692,0));_693.ymax=parseFloat(this._getTagValue("northBoundLatitude",_692,0));_68f.allExtents[0]=_693;}var _694=_4.query("BoundingBox",_68e);if(_694.length===0){_68f.extent=_68f.allExtents[0];}else{var _695=(this.version=="1.3.0")?"CRS":"SRS";var bb,_696,wkid;for(var i=0;i<_694.length;i++){bb=_694[i];var tag=bb.parentNode.nodeName;if(tag!=="Layer"){continue;}var name="";var _697="";_4.forEach(bb.parentNode.childNodes,function(_698){if(_698.nodeName=="Name"){name=(_4.isIE?_698.text:_698.textContent)||"";}if(_698.nodeName=="Title"){_697=(_4.isIE?_698.text:_698.textContent)||"";}},this);if(name!==_68f.name||_697!==_68f.title){continue;}_696=bb.getAttribute(_695);if(_696&&_696.indexOf("EPSG:")===0){wkid=parseInt(_696.substring(5));if(wkid==0){continue;}var _693;if(this.version=="1.3.0"){_693=this._getExtent(bb,wkid,this._useLatLong(wkid));}else{_693=this._getExtent(bb,wkid);}_68f.allExtents[wkid]=_693;if(!_68f.extent){_68f.extent=_693;}}else{if(_696&&_696.indexOf("CRS:")===0){wkid=parseInt(_696.substring(4));if(wkid==0){continue;}if(this._CRS_TO_EPSG[wkid]){wkid=this._CRS_TO_EPSG[wkid];}_68f.allExtents[wkid]=this._getExtent(bb,wkid);}else{wkid=parseInt(_696);_68f.allExtents[wkid]=this._getExtent(bb,wkid);}}}if(!_68f.extent){bb=_694[0];_696=bb.getAttribute(_695)[0];if(_696){if(_696.indexOf("CRS:")===0){wkid=parseInt(_696.substring(4));if(this._CRS_TO_EPSG[wkid]){wkid=this._CRS_TO_EPSG[wkid];}_68f.extent=_68f.allExtents[wkid];}else{wkid=parseInt(_696);_68f.extent=_68f.allExtents[wkid];}}}}if(!_68f.extent){_68f.extent=_68f.allExtents[0];}_68f.spatialReferences=[];var _699=(this.version=="1.3.0")?"CRS":"SRS";_4.forEach(_4.query(_699,_68e),function(crs){var _69a;if(_4.isIE){_69a=crs.text;}else{_69a=crs.textContent;}var arr=_69a.split(" ");_4.forEach(arr,function(val){if(val.indexOf(":")>-1){val=parseInt(val.split(":")[1]);}else{val=parseInt(val);}if(val!=84&&val!=0){if(!_4.some(_68f.spatialReferences,function(el){return el==val;})){_68f.spatialReferences.push(val);}}});},this);var _69b=this._getTag("Style",_68e);if(_69b){var _69c=this._getTag("LegendURL",_69b);if(_69c){var _69d=this._getTag("OnlineResource",_69c);if(_69d){_68f.legendURL=_69d.getAttribute("xlink:href");}}}var _69e=_4.query("Layer",_68e);var _69f="||";if(_69e.length>0){_68f.subLayers=[];_4.forEach(_69e,function(_6a0){var l=this._getLayerInfo(_6a0);if(l.subLayers&&l.subLayers.length>0&&l.name===l.subLayers[0].name){l.name=null;}if(_69f.indexOf("||"+l.name+"||")==-1){_68f.subLayers.push(l);if(l.subLayers&&l.subLayers.length>0){_4.forEach(l.subLayers,function(_6a1){_69f+=_6a1.name+"||";},this);}}},this);}}return _68f;},_getImageFormat:function(_6a2){var _6a3=_6a2?_6a2.toLowerCase():"";switch(_6a3){case "jpg":return "image/jpeg";case "bmp":return "image/bmp";case "gif":return "image/gif";case "svg":return "image/svg+xml";default:return "image/png";}},_getExtent:function(_6a4,wkid,_6a5){var _6a6;if(_6a4){_6a6=new esri.geometry.Extent();var minx=parseFloat(_6a4.getAttribute("minx"));var miny=parseFloat(_6a4.getAttribute("miny"));var maxx=parseFloat(_6a4.getAttribute("maxx"));var maxy=parseFloat(_6a4.getAttribute("maxy"));if(_6a5){_6a6.xmin=isNaN(miny)?Number.MIN_VALUE:miny;_6a6.ymin=isNaN(minx)?Number.MIN_VALUE:minx;_6a6.xmax=isNaN(maxy)?Number.MAX_VALUE:maxy;_6a6.ymax=isNaN(maxx)?Number.MAX_VALUE:maxx;}else{_6a6.xmin=isNaN(minx)?Number.MIN_VALUE:minx;_6a6.ymin=isNaN(miny)?Number.MIN_VALUE:miny;_6a6.xmax=isNaN(maxx)?Number.MAX_VALUE:maxx;_6a6.ymax=isNaN(maxy)?Number.MAX_VALUE:maxy;}_6a6.spatialReference=new esri.SpatialReference({wkid:wkid});}return _6a6;},_useLatLong:function(wkid){var _6a7;for(var i=0;i<this._REVERSED_LAT_LONG_RANGES.length;i++){var _6a8=this._REVERSED_LAT_LONG_RANGES[i];if(wkid>=_6a8[0]&&wkid<=_6a8[1]){_6a7=true;break;}}return _6a7;},_getTag:function(_6a9,xml){var tags=_4.query(_6a9,xml);if(tags&&tags.length>0){return tags[0];}else{return null;}},_getTagValue:function(_6aa,xml,_6ab){var _6ac=_4.query(_6aa,xml);if(_6ac&&_6ac.length>0){if(_4.isIE){return _6ac[0].text;}else{return _6ac[0].textContent;}}else{return _6ab;}},_getAttributeValue:function(_6ad,_6ae,xml,_6af){var _6b0=_4.query(_6ad,xml);if(_6b0&&_6b0.length>0){return _6b0[0].getAttribute(_6ae);}else{return _6af;}},_checkVisibleLayersList:function(_6b1){if(_6b1&&_6b1.length>0&&this.layerInfos&&this.layerInfos.length>0){if((typeof _6b1[0])=="number"){var list=[];_4.forEach(_6b1,function(pos){if(pos<this.layerInfos.length){list.push(this.layerInfos[pos].name);}},this);_6b1=list;}}return _6b1;}});_4.declare("esri.layers.WMSLayerInfo",null,{name:null,title:null,description:null,extent:null,legendURL:null,subLayers:[],constructor:function(_6b2){if(_6b2){this.name=_6b2.name;this.title=_6b2.title;this.description=_6b2.description;this.extent=_6b2.extent;this.legendURL=_6b2.legendURL;}}});}if(!_4._hasResource["dojo.DeferredList"]){_4._hasResource["dojo.DeferredList"]=true;_4.provide("dojo.DeferredList");_4.DeferredList=function(list,_6b3,_6b4,_6b5,_6b6){var _6b7=[];_4.Deferred.call(this);var self=this;if(list.length===0&&!_6b3){this.resolve([0,[]]);}var _6b8=0;_4.forEach(list,function(item,i){item.then(function(_6b9){if(_6b3){self.resolve([i,_6b9]);}else{_6ba(true,_6b9);}},function(_6bb){if(_6b4){self.reject(_6bb);}else{_6ba(false,_6bb);}if(_6b5){return null;}throw _6bb;});function _6ba(_6bc,_6bd){_6b7[i]=[_6bc,_6bd];_6b8++;if(_6b8===list.length){self.resolve(_6b7);}};});};_4.DeferredList.prototype=new _4.Deferred();_4.DeferredList.prototype.gatherResults=function(_6be){var d=new _4.DeferredList(_6be,false,true,false);d.addCallback(function(_6bf){var ret=[];_4.forEach(_6bf,function(_6c0){ret.push(_6c0[1]);});return ret;});return d;};}if(!_4._hasResource["esri.arcgis.utils"]){_4._hasResource["esri.arcgis.utils"]=true;_4.provide("esri.arcgis.utils");(function(){var EAU=esri.arcgis.utils;EAU.arcgisUrl="http://www.arcgis.com/sharing/content/items";EAU.getItem=function(_6c1){if(EAU._arcgisUrl&&EAU._arcgisUrl.length>0){EAU.arcgisUrl=EAU._arcgisUrl;}var url=EAU.arcgisUrl+"/"+_6c1;var _6c2={},_6c3=new _4.Deferred();esri.request({url:url,content:{f:"json"},callbackParamName:"callback",load:function(_6c4){_6c2.item=_6c4;esri.request({url:url+"/data",content:{f:"json"},callbackParamName:"callback",load:function(_6c5){_6c2.itemData=_6c5;_6c3.callback(_6c2);},error:function(_6c6){_6c3.errback(_6c6);}});},error:function(_6c7){_6c3.errback(_6c7);}});return _6c3;};EAU.createMap=function(arg1,_6c8,_6c9){var _6ca=new _4.Deferred();_6c9=_6c9||{};var _6cb=_6c9.infoTemplateClass;_6c9._clazz=(_6cb&&_4.getObject(_6cb))||esri.dijit.PopupTemplate;if(_4.isString(arg1)){EAU.getItem(arg1).addCallback(function(_6cc){EAU._getPopups(_6cc,_6c9).addCallback(function(_6cd){EAU._getLayers(_6cd.itemData,_6c9).addCallback(_4.hitch(null,EAU._preCreateMap,_6cd,_6c8,_6c9,_6ca));});}).addErrback(_4.hitch(_6ca,_6ca.errback));}else{EAU._getPopups(arg1,_6c9).addCallback(function(_6ce){EAU._getLayers(_6ce.itemData,_6c9).addCallback(_4.hitch(null,EAU._preCreateMap,_6ce,_6c8,_6c9,_6ca));});}return _6ca;};EAU._arcgisUrl=null;EAU._getPopups=function(_6cf,_6d0){var _6d1=new _4.Deferred();if(_6d0.ignorePopups){_6d1.callback(_6cf);return _6d1;}var _6d2=_6cf.itemData;var _6d3=[];var _6d4=[];_4.forEach(_6d2.operationalLayers,function(_6d5){if(_6d5.itemId&&!_6d5.type&&!_6d5.layers&&_6d5.url.indexOf("/MapServer")>-1&&_6d5.url.indexOf("/MapServer/")===-1){_6d4.push(_6d5);_6d3.push(EAU._getItemData(_6d5));}});if(_6d3.length>0){var _6d6=new _4.DeferredList(_6d3);_6d6.addCallback(function(_6d7){_4.forEach(_6d4,function(_6d8,i){var _6d9=_6d3[i].ioArgs.json;if(_6d9&&_6d9.layers){_6d8.layers=_6d9.layers;}});_6d1.callback(_6cf);});}else{_6d1.callback(_6cf);}return _6d1;};EAU._getItemData=function(_6da){var url=EAU.arcgisUrl+"/"+_6da.itemId+"/data";var _6db=esri.request({url:url,content:{f:"json"},callbackParamName:"callback"});return _6db;};EAU._getLayers=function(_6dc,_6dd){var _6de=[];var _6df=[];var _6e0=[];var _6e1=new _4.Deferred();_4.forEach(_6dc.operationalLayers,function(_6e2,_6e3){if(_6e2.featureCollection){_4.forEach(_6e2.featureCollection.layers,function(_6e4,idx){_6e4.opacity=_6e2.opacity;_6e4.visibility=_6e2.visibility;_6e4.id=(_6e2.id?_6e2.id:("operational"+_6e3))+"_"+idx;_6e0.push(_6e4);});}else{_6e0.push(_6e2);}});_4.forEach(_6dc.baseMap.baseMapLayers,function(_6e5,_6e6){_6e5.baseMapLayer=true;_6e5.id=_6e5.id?_6e5.id:"base"+_6e6;_6de.push(_6e5);});_4.forEach(_6e0,function(_6e7,_6e8){_6e7.id=_6e7.id?_6e7.id:"operational"+_6e8;_6de.push(_6e7);});_4.forEach(_6de,function(_6e9,i){if(_6e9.url&&!_6e9.type){_6e9.deferredsPos=_6df.length;_6e9.errors=[];_6df.push(EAU._getServiceInfo(_6e9.url,_6e9.errors));}else{_6e9.layerObject=EAU._initLayer(_6e9,_6de,_6dd);}});var _6ea=new _4.DeferredList(_6df);_6ea.addCallback(function(_6eb){_4.forEach(_6de,function(_6ec,_6ed){if(_6ec.url&&!_6ec.type){_6ec.resourceInfo=_6df[_6ec.deferredsPos].ioArgs.json;if(_6ed===0||_6de[0].layerObject){_6ec.layerObject=EAU._initLayer(_6ec,_6de,_6dd);}}});var _6ee=_4.filter(_6de,function(lyr){return !lyr.isReference;});var _6ef=_4.filter(_6de,function(lyr){return !!lyr.isReference;});_6de=_6ee.concat(_6ef);_6e1.callback(_6de);});return _6e1;};EAU._preCreateMap=function(_6f0,_6f1,_6f2,_6f3,_6f4){try{var _6f5=_6f2.mapOptions||{};var card=_6f0.item;var _6f6=[];_4.forEach(_6f4,function(_6f7){if(_4.isArray(_6f7.layerObject)){_4.forEach(_6f7.layerObject,function(l){_6f6.push(l);});}else{_6f6.push(_6f7.layerObject);}});if(!_6f6[0]){_6f3.errback(new Error(esri.bundle.arcgis.utils.baseLayerError));return;}_6f6=_4.filter(_6f6,esri._isDefined);if(card){if(card.extent){if(!_6f5.extent){var _6f8=new esri.geometry.Extent(card.extent[0][0],card.extent[0][1],card.extent[1][0],card.extent[1][1],new esri.SpatialReference({wkid:4326}));var _6f9=_6f6[0].spatialReference;if(_6f9.wkid===4326){_6f5.extent=_6f8;EAU._createMap(_6f6,_6f4,_6f0,_6f1,_6f2,_6f3);}else{if(_6f9.wkid===102100||_6f9.wkid===102113||_6f9.wkid===3857){_6f5.extent=esri.geometry.geographicToWebMercator(_6f8);EAU._createMap(_6f6,_6f4,_6f0,_6f1,_6f2,_6f3);}else{if(_6f2.geometryServiceURL||esri.config.defaults.geometryService){var gs;if(_6f2.geometryServiceURL){gs=new esri.tasks.GeometryService(_6f2.geometryServiceURL);}else{gs=esri.config.defaults.geometryService;}gs.project([_6f8],_6f9,function(_6fa){var _6fb=_6fa[0];_6f5.extent=_6f5.extent||_6fb;EAU._createMap(_6f6,_6f4,_6f0,_6f1,_6f2,_6f3);});}else{_6f3.errback(new Error(esri.bundle.arcgis.utils.geometryServiceError));}}}}else{EAU._createMap(_6f6,_6f4,_6f0,_6f1,_6f2,_6f3);}}else{EAU._createMap(_6f6,_6f4,_6f0,_6f1,_6f2,_6f3);}}else{EAU._createMap(_6f6,_6f4,_6f0,_6f1,_6f2,_6f3);}}catch(err){_6f3.errback(err);}};EAU._createMap=function(_6fc,_6fd,_6fe,_6ff,_700,_701){var _702=_700.mapOptions,_703,_704;if(!_702.infoWindow){_703=new esri.dijit.Popup(null,_4.create("div"));_702.infoWindow=_703;}if(!esri._isDefined(_702.showInfoWindowOnClick)){_702.showInfoWindowOnClick=false;}var map=new esri.Map(_6ff,_702);_4.connect(map,"onZoomEnd",EAU._onZoomEnd);if(_703){_4.place(_703.domNode,map.root);}var _705=Math.floor(_702.extent.getWidth()/map.width);_4.forEach(_6fc,function(_706){if(_706&&_706.declaredClass&&_706.declaredClass.indexOf("FeatureLayer")!==-1&&!_706.isEditable()){_706.setMaxAllowableOffset(_705);}});if(_700.ignorePopups){_4.forEach(_6fc,function(_707){delete _707.infoTemplate;});}if(!(_700.ignorePopups||_700.disableClickBehavior)){_704=_4.connect(map,"onClick",EAU._showPopup);}_4.connect(map,"onLayersAddResult",EAU._onLayersAddResult);map.addLayers(_6fc);if(!_700.ignorePopups){EAU._addSelectionLayers(_6fc,_705,map,_700._clazz);}var _708=[];_4.forEach(_6fd,function(_709){_708=_708.concat(_709.errors);},this);_701.callback({map:map,itemInfo:_6fe,errors:_708,clickEventHandle:_704,clickEventListener:EAU._showPopup});};EAU._addSelectionLayers=function(_70a,_70b,map,_70c){var _70d=[];_4.forEach(_70a,function(_70e){var _70f=_70e.__popups;if(_70f&&_70f.length>1&&_70e.version>=10){_70e.__deferredsPos=_70d.length;_70d.push(EAU._getLayersInfo(_70e));}});var _710=[];if(_70d.length>0){var _711=new _4.DeferredList(_70d);_711.addCallback(function(_712){_4.forEach(_70a,function(_713,_714){if(_713.__popups&&_713.__popups.length>0){if(_713.__deferredsPos||_713.__deferredsPos===0){var _715=_70d[_713.__deferredsPos].ioArgs.json;_710=_710.concat(EAU._createSelectionFeatureLayers(_713,_715.layers,_70b,_70c));delete _713.__deferredsPos;}else{_710=_710.concat(EAU._createSelectionFeatureLayers(_713,null,_70b,_70c));}}});map.addLayers(_710);});}else{_4.forEach(_70a,function(_716,_717){if(_716.__popups&&_716.__popups.length>0){_710=_710.concat(EAU._createSelectionFeatureLayers(_716,null,_70b,_70c));}});map.addLayers(_710);}};EAU._createSelectionFeatureLayers=function(_718,_719,_71a,_71b){var url=_718.url;var _71c=_718.__popups;var ids=_718.__popupIds;var _71d=_718.__resourceInfo;var _71e=[];_4.forEach(_71c,function(_71f,_720){var i,_721=null;if(_719){for(i=0;i<_719.length;i++){if(_719[i].id===ids[_720]){_721=_719[i];break;}}}var _722=new esri.layers.FeatureLayer(url+"/"+ids[_720],{id:_718.id+"_"+ids[_720],outFields:["*"],mode:esri.layers.FeatureLayer.MODE_SELECTION,infoTemplate:_71f&&new _71b(_71f),drawMode:false,visible:_718.visible,resourceInfo:_721,maxAllowableOffset:_71a});_4.connect(_722,"onLoad",function(_723){EAU._updateLayerScaleInfo(_71d.layers,_723);});_71e.push(_722);});delete _718.__popups;delete _718.__popupIds;delete _718.__resourceInfo;return _71e;};EAU._getServiceInfo=function(url,_724){return esri.request({url:url,content:{f:"json"},callbackParamName:"callback",error:function(_725,io){if(_725.message){_725.message+=" [url:"+url+"]";}else{_725.message="[url:"+url+"]";}_724.push(_725);esri.config.defaults.io.errorHandler(_725,io);}});};EAU._getLayersInfo=function(_726){return esri.request({url:_726.url+"/layers",content:{f:"json"},callbackParamName:"callback",error:function(_727,io){}});};EAU._initLayer=function(_728,_729,_72a){var _72b,_72c=_72a._clazz;if(_728.type==="OpenStreetMap"){_72b=new esri.layers.OpenStreetMapLayer({id:_728.id});}else{if(_728.type==="WMS"){var _72d=[];var _72e=[];_4.forEach(_728.layers,function(_72f){_72e.push(new esri.layers.WMSLayerInfo({name:_72f.name,title:_72f.title,legendURL:_72f.legendURL}));_72d.push(_72f.name);},this);if(_728.visibleLayers){_72d=_728.visibleLayers;}var _730=new esri.geometry.Extent(_728.extent[0][0],_728.extent[0][1],_728.extent[1][0],_728.extent[1][1],new esri.SpatialReference({wkid:4326}));var _731={extent:_730,layerInfos:_72e,version:_728.version,maxWidth:_728.maxWidth,maxHeight:_728.maxHeight,getMapUrl:_728.mapUrl,spatialReferences:_728.spatialReferences,title:_728.title,copyright:_728.copyright};_72b=new esri.layers.WMSLayer(_728.url,{id:_728.id,visibleLayers:_72d,format:"png",transparent:_728.baseMapLayer?false:true,opacity:_728.opacity,resourceInfo:_731});}else{if(_728.type==="KML"){_72b=new esri.layers.KMLLayer(_728.url,{id:_728.id});_4.connect(_72b,"onLoad",function(){if(_728.opacity!==null){var _732=_72b.getLayers();_4.forEach(_732,function(_733){if(_733.declaredClass=="esri.layers.FeatureLayer"||_733.declaredClass=="esri.layers.MapImageLayer"){_733.setOpacity(_728.opacity);}});}if(_728.visibleFolders){_4.forEach(_72b.folders,function(_734){if(_4.indexOf(_728.visibleFolders,_734.id)>-1){_72b.setFolderVisibility(_734,true);}else{_72b.setFolderVisibility(_734,false);}},this);}});}else{if(_728.layerDefinition&&!_728.url){var _735=_4.fromJson(_4.toJson(_728));delete _735.id;delete _735.opacity;delete _735.visibility;_72b=new esri.layers.FeatureLayer(_735,{id:_728.id,opacity:_728.opacity,visible:_728.visibility,outFields:["*"],infoTemplate:_735.popupInfo&&new _72c(_735.popupInfo)});}else{if(_728.type==="BingMapsAerial"||_728.type==="BingMapsRoad"||_728.type==="BingMapsHybrid"){var _736=esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL_WITH_LABELS;if(_728.type==="BingMapsAerial"){_736=esri.virtualearth.VETiledLayer.MAP_STYLE_AERIAL;}else{if(_728.type==="BingMapsRoad"){_736=esri.virtualearth.VETiledLayer.MAP_STYLE_ROAD;}}_72b=new esri.virtualearth.VETiledLayer({bingMapsKey:_72a.bingMapsKey,mapStyle:_736,id:_728.id});}else{if(_728.resourceInfo&&_728.resourceInfo.mapName){if(_728.resourceInfo.singleFusedMapCache===true){if(!_728.baseMapLayer){if(EAU._sameSpatialReferenceAsBasemap(_728,_729)){if(EAU._sameTilingSchemeAsBasemap(_728,_729)){_72b=EAU._loadAsCached(_728);}else{_72b=EAU._loadAsDynamic(_728);}}else{_72b=EAU._loadAsDynamic(_728);}}else{_72b=EAU._loadAsCached(_728);}}else{_72b=EAU._loadAsDynamic(_728);}}else{if(_728.resourceInfo&&_728.resourceInfo.pixelSizeX){var _737=new esri.layers.ImageServiceParameters();_737.bandIds=_728.bandIds;if(!_728.bandIds&&_728.resourceInfo.bandCount&&parseInt(_728.resourceInfo.bandCount,10)>3){_737.bandIds=[0,1,2];}_72b=new esri.layers.ArcGISImageServiceLayer(_728.url,{resourceInfo:_728.resourceInfo,opacity:_728.opacity,visible:_728.visibility,id:_728.id,imageServiceParameters:_737});}else{if(_728.resourceInfo&&_728.resourceInfo.type==="Feature Layer"){_72b=new esri.layers.FeatureLayer(_728.url,{resourceInfo:_728.resourceInfo,opacity:_728.opacity,visible:_728.visibility,id:_728.id,mode:esri._isDefined(_728.mode)?_728.mode:esri.layers.FeatureLayer.MODE_ONDEMAND,outFields:["*"],infoTemplate:_728.popupInfo&&new _72c(_728.popupInfo)});if(_728.layerDefinition){if(_728.layerDefinition.drawingInfo&&_728.layerDefinition.drawingInfo.renderer){var _738=esri.renderer.fromJson(_728.layerDefinition.drawingInfo.renderer);_72b.setRenderer(_738);}if(_728.layerDefinition.definitionExpression){_72b.setDefinitionExpression(_728.layerDefinition.definitionExpression);}if(_728.layerDefinition.minScale!==null){_72b.minScale=_728.layerDefinition.minScale;}if(_728.layerDefinition.maxScale!==null){_72b.maxScale=_728.layerDefinition.maxScale;}}}}}}}}}}return _72b;};EAU._loadAsCached=function(_739){var _73a=[];if(!_739.displayLevels){_73a=_4.map(_739.resourceInfo.tileInfo.lods,function(lod){return lod.level;});}var _73b=new esri.layers.ArcGISTiledMapServiceLayer(_739.url,{resourceInfo:_739.resourceInfo,opacity:_739.opacity,visible:_739.visibility,displayLevels:(_739.displayLevels)?_739.displayLevels:_73a,id:_739.id});EAU._processPopups(_73b,_739);return _73b;};EAU._loadAsDynamic=function(_73c){var _73d=new esri.layers.ImageParameters();_73d.format="png24";if(_73c.resourceInfo&&_73c.resourceInfo.supportedImageFormatTypes&&_73c.resourceInfo.supportedImageFormatTypes.indexOf("PNG32")>-1){_73d.format="png32";}var _73e=new esri.layers.ArcGISDynamicMapServiceLayer(_73c.url,{resourceInfo:_73c.resourceInfo,opacity:_73c.opacity,visible:_73c.visibility,id:_73c.id,imageParameters:_73d});if(!_73c.visibleLayers){var _73f="";var _740=_73e.layerInfos;_4.forEach(_740,function(_741){if(_741.defaultVisibility){_73f+=(_73f.length>0?",":"")+_741.id;}});_73c.visibleLayers=_73f;}var _742=EAU._getVisibleFeatureLayers(_73e.layerInfos,_73c.visibleLayers);_73e.setVisibleLayers(_742);if(_73c.layers&&_73c.layers.length>0){var _743=[];_4.forEach(_73c.layers,function(_744){if(_744.layerDefinition&&_744.layerDefinition.definitionExpression){_743[_744.id]=_744.layerDefinition.definitionExpression;}},this);if(_743.length>0){_73e.setLayerDefinitions(_743);}}EAU._processPopups(_73e,_73c);return _73e;};EAU._processPopups=function(_745,_746){var _747=_745.layerInfos;var _748=_746.layers;if(_748&&_747){var _749=[],ids=[];_4.forEach(_747,function(_74a){var id=_74a.id,i;if(!_74a.subLayerIds&&_4.indexOf(_745.visibleLayers,id)!==-1){for(i=0;i<_748.length;i++){var _74b=_748[i];if(_74b.id===id){ids.push(id);_749.push(_74b.popupInfo);break;}}}});if(_749.length){_745.__popups=_749;_745.__popupIds=ids;_745.__resourceInfo=_746.resourceInfo;}}};EAU._onZoomEnd=function(){var map=this;var _74c=Math.floor(map.extent.getWidth()/map.width);_4.forEach(map.graphicsLayerIds,function(id){var _74d=map.getLayer(id);if(_74d&&_74d.declaredClass==="esri.layers.FeatureLayer"&&!_74d.isEditable()){_74d.setMaxAllowableOffset(_74c);}});};EAU._onLayersAddResult=function(_74e){_4.forEach(_74e,function(_74f){var _750=_74f.layer;if(_750.toJson){var json=_750.toJson();if(json.featureSet&&_750.name.indexOf("Text")>-1){_4.forEach(json.featureSet.features,function(_751,idx){if(_751.attributes.TEXT){var _752=_750.graphics[idx];_752.symbol.setText(_751.attributes.TEXT);if(_751.symbol.horizontalAlignment){_752.symbol.align=_751.symbol.horizontalAlignment;}_752.setSymbol(_752.symbol);_752.setAttributes(_751.attributes);}},this);}}});};EAU._sameSpatialReferenceAsBasemap=function(_753,_754){var _755=[102113,102100,3857];var sp1=_754[0].layerObject.fullExtent.spatialReference;var sp2=new esri.SpatialReference(_753.resourceInfo.fullExtent.spatialReference);if(_4.toJson(sp1.toJson())===_4.toJson(sp2.toJson())){return true;}else{if(_4.some(_755,function(wkid){return wkid===sp2.wkid;})&&_4.some(_755,function(wkid){return wkid===sp1.wkid;})){return true;}}return false;};EAU._sameTilingSchemeAsBasemap=function(_756,_757){if(!_757[0].layerObject.tileInfo){return false;}var _758=[];_4.forEach(_757,function(_759){if(_759.baseMapLayer){if(_759.layerObject.tileInfo){_758=_758.concat(_4.map(_759.layerObject.tileInfo.lods,function(lod){return lod.scale;}));}}});var _75a=_4.some(_756.resourceInfo.tileInfo.lods,function(lod){return _4.some(_758,function(_75b){return _75b===lod.scale;});});return _75a;};EAU._showPopup=function(evt){var map=this,_75c=map.infoWindow,_75d=evt.graphic;if(!map.loaded){return;}_75c.hide();_75c.clearFeatures();var _75e=[];_4.forEach(map.graphicsLayerIds,function(_75f){var _760=map.getLayer(_75f);if(_760&&_760.declaredClass.indexOf("FeatureLayer")!==-1&&_760.loaded&&_760.visible){_760.clearSelection();if(_760.infoTemplate&&!_760._suspended){_75e.push(_760);}}});_75d=(_75d&&_75d._getEffInfoTemplate())?_75d:null;if(!_75e.length&&!_75d){return;}var _761=EAU._calculateClickTolerance(_75e);var _762=evt.screenPoint,_763=map.toMap(new esri.geometry.Point(_762.x-_761,_762.y+_761)),_764=map.toMap(new esri.geometry.Point(_762.x+_761,_762.y-_761)),_765=new esri.geometry.Extent(_763.x,_763.y,_764.x,_764.y,map.spatialReference);var _766=new esri.tasks.Query();_766.geometry=_765;_766.timeExtent=map.timeExtent;var _767=_4.map(_75e,function(_768){var dfd=_768.selectFeatures(_766);dfd.addCallback(function(){var _769=_768.getSelectedFeatures();return _769;});return dfd;});if(_75d){var dfd=new _4.Deferred();dfd.callback([_75d]);_767.splice(0,0,dfd);}var _76a=_4.some(_767,function(dfd){return dfd.fired===-1;});if(!_76a){var _76b=_75d?1:0;_4.forEach(_75e,function(_76c){_76b=_76b+_76c.getSelectedFeatures().length;});if(!_76b){return;}}_75c.setFeatures(_767);_75c.show(evt.mapPoint);};EAU._calculateClickTolerance=function(_76d){var _76e=6;_4.forEach(_76d,function(_76f){var _770=_76f.renderer;if(_770.declaredClass==="esri.renderer.SimpleRenderer"){var _771=_770.symbol;if(_771.xoffset){_76e=Math.max(_76e,Math.abs(_771.xoffset));}if(_771.yoffset){_76e=Math.max(_76e,Math.abs(_771.yoffset));}}else{if(_770.declaredClass==="esri.renderer.UniqueValueRenderer"||_770.declaredClass==="esri.renderer.ClassBreaksRenderer"){_4.forEach(_770.infos,function(info){var _772=info.symbol;if(_772.xoffset){_76e=Math.max(_76e,Math.abs(_772.xoffset));}if(_772.yoffset){_76e=Math.max(_76e,Math.abs(_772.yoffset));}});}}});return _76e;};EAU._getVisibleFeatureLayers=function(_773,_774){if(!_773||!_774||_774.length===0){return [];}var _775=","+_774+",";var _776=[];var _777="";var k,_778=",";for(k=0;k<_773.length;k++){if(_773[k].subLayerIds!==null){if(_775.indexOf(","+_773[k].id+",")===-1||_778.indexOf(","+_773[k].id+",")>-1){_778+=_773[k].subLayerIds.toString()+",";}}else{if(_775.indexOf(","+_773[k].id+",")>-1&&_778.indexOf(","+_773[k].id+",")===-1){_776.push(_773[k].id);_777=",";}}}return _776;};EAU._updateLayerScaleInfo=function(_779,_77a){if(_77a.version<=10.1&&_779){var i,id=parseInt(_77a.url.substring(_77a.url.lastIndexOf("/")+1,_77a.url.length));for(i=_779.length-1;i>=0;i--){if(_779[i].id==id){if(_77a.minScale==0&&_779[i].minScale>0){_77a.minScale=_779[i].minScale;}else{if(_77a.minScale>0&&_779[i].minScale==0){_77a.minScale=_77a.minScale;}else{if(_77a.minScale>0&&_779[i].minScale>0){_77a.minScale=Math.min(_77a.minScale,_779[i].minScale);}}}_77a.maxScale=Math.max(_77a.maxScale,_779[i].maxScale);if(_779[i].parentLayerId>-1){id=_779[i].parentLayerId;}else{break;}}}}};}());}}};});
