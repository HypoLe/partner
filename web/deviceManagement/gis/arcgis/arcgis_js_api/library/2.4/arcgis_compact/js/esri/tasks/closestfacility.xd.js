/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */

window[esri._dojoScopeName||"dojo"]._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","esri.tasks.closestfacility"],["require","esri.tasks._task"],["require","esri.tasks.na"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["esri.tasks.closestfacility"]){_4._hasResource["esri.tasks.closestfacility"]=true;_4.provide("esri.tasks.closestfacility");_4.require("esri.tasks._task");_4.require("esri.tasks.na");_4.declare("esri.tasks.ClosestFacilityTask",esri.tasks._Task,{constructor:function(_7){this._url.path+="/solveClosestFacility";this._handler=_4.hitch(this,this._handler);},__msigns:[{n:"solve",c:3,a:[{i:0,p:["incidents.features","facilities.features","pointBarriers.features","polylineBarriers.features","polygonBarriers.features"]}],e:2}],_handler:function(_8,io,_9,_a,_b){try{var _c=new esri.tasks.ClosestFacilitySolveResult(_8);this._successHandler([_c],"onSolveComplete",_9,_b);}catch(err){this._errorHandler(err,_a,_b);}},solve:function(_d,_e,_f,_10){var _11=_10.assembly,_12=this._encode(_4.mixin({},this._url.query,{f:"json"},_d.toJson(_11&&_11[0]))),_13=this._handler,_14=this._errorHandler;return esri.request({url:this._url.path,content:_12,callbackParamName:"callback",load:function(r,i){_13(r,i,_e,_f,_10.dfd);},error:function(r){_14(r,_f,_10.dfd);}});},onSolveComplete:function(){}});esri._createWrappers("esri.tasks.ClosestFacilityTask");_4.declare("esri.tasks.ClosestFacilityParameters",null,{accumulateAttributes:null,attributeParameterValues:null,defaultCutoff:null,defaultTargetFacilityCount:null,directionsLanguage:null,directionsLengthUnits:null,directionsTimeAttribute:false,facilities:null,impedanceAttribute:null,incidents:null,outputGeometryPrecision:null,outputGeometryPrecisionUnits:null,outputLines:null,outSpatialReference:null,pointBarriers:null,polygonBarriers:null,polylineBarriers:null,restrictionAttributes:null,restrictUTurns:null,returnDirections:false,returnFacilities:false,returnIncidents:false,returnPointBarriers:false,returnPolylgonBarriers:false,returnPolylineBarriers:false,returnRoutes:true,travelDirection:null,useHierarchy:false,toJson:function(_15){var _16={returnDirections:this.returnDirections,returnFacilities:this.returnFacilities,returnIncidents:this.returnIncidents,returnBarriers:this.returnPointBarriers,returnPolygonBarriers:this.returnPolygonBarriers,returnPolylineBarriers:this.returnPolylineBarriers,returnRoutes:this.returnRoutes,useHierarchy:this.useHierarchy,attributeParameterValues:this.attributeParameterValues&&_4.toJson(this.attributeParameterValues),defaultCutoff:this.defaultCutoff,defaultTargetFacilityCount:this.defaultTargetFacilityCount,directionsLanguage:this.directionsLanguage,directionsLengthUnits:esri.tasks._NALengthUnit[this.directionsLengthUnits],directionsTimeAttributeName:this.directionsTimeAttribute,impedanceAttributeName:this.impedanceAttribute,outputGeometryPrecision:this.outputGeometryPrecision,outputGeometryPrecisionUnits:this.outputGeometryPrecisionUnits,outputLines:this.outputLines,outSR:this.outSpatialReference?(this.outSpatialReference.wkid||_4.toJson(this.outSpatialReference.toJson())):null,restrictionAttributeNames:this.restrictionAttributes?this.restrictionAttributes.join(","):null,restrictUTurns:this.restrictUTurns,accumulateAttributeNames:this.accumulateAttributes?this.accumulateAttributes.join(","):null,travelDirection:this.travelDirection};var _17=this.incidents;if(_17 instanceof esri.tasks.FeatureSet&&_17.features.length>0){_16.incidents=_4.toJson({type:"features",features:esri._encodeGraphics(_17.features,_15&&_15["incidents.features"])});}else{if(_17 instanceof esri.tasks.DataLayer){_16.incidents=_17;}}var _18=this.facilities;if(_18 instanceof esri.tasks.FeatureSet&&_18.features.length>0){_16.facilities=_4.toJson({type:"features",features:esri._encodeGraphics(_18.features,_15&&_15["facilities.features"])});}else{if(_18 instanceof esri.tasks.DataLayer){_16.facilities=_18;}}var _19=function(_1a,_1b){if(!_1a){return null;}if(_1a instanceof esri.tasks.FeatureSet){if(_1a.features.length>0){return _4.toJson({type:"features",features:esri._encodeGraphics(_1a.features,_15&&_15[_1b])});}else{return null;}}else{if(_1a instanceof esri.tasks.DataLayer){return _1a;}}return _4.toJson(_1a);};_16.barriers=_19(this.pointBarriers,"pointBarriers.features");_16.polygonBarriers=_19(this.polygonBarriers,"polygonBarriers.features");_16.polylineBarriers=_19(this.polylineBarriers,"polylineBarriers.features");return esri.filter(_16,function(_1c){if(_1c!==null){return true;}});}});_4.declare("esri.tasks.ClosestFacilitySolveResult",null,{constructor:function(_1d){if(_1d.directions){this.directions=[];_4.forEach(_1d.directions,function(_1e,idx){var cgs=[];_4.forEach(_1e.features,function(f,i){cgs[i]=f.compressedGeometry;});this.directions[idx]=new esri.tasks.DirectionsFeatureSet(_1e,cgs);},this);}if(_1d.routes){this.routes=this._graphicsFromJson(_1d.routes);}if(_1d.facilities){this.facilities=this._graphicsFromJson(_1d.facilities);}if(_1d.incidents){this.incidents=this._graphicsFromJson(_1d.incidents);}if(_1d.barriers){this.pointBarriers=this._graphicsFromJson(_1d.barriers);}if(_1d.polylineBarriers){this.polylineBarriers=this._graphicsFromJson(_1d.polylineBarriers);}if(_1d.polygonBarriers){this.polygonBarriers=this._graphicsFromJson(_1d.polygonBarriers);}if(_1d.messages){this.messages=_4.map(_1d.messages,function(_1f,i){return new esri.tasks.NAMessage(_1f);});}},routes:null,facilities:null,incidents:null,pointBarriers:null,polylineBarriers:null,polygonBarriers:null,directions:null,messages:null,_graphicsFromJson:function(_20){var sr=new esri.SpatialReference(_20.spatialReference);var _21=_20.features;return _4.map(_21,function(_22,i){return new esri.Graphic(_22).geometry.setSpatialReference(sr);});}});}}};});