/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */

window[esri._dojoScopeName||"dojo"]._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","esri.dijit.editing.Editor"],["require","dijit.ProgressBar"],["require","dijit._Widget"],["require","dijit._Templated"],["require","esri.toolbars.edit"],["require","esri.toolbars.draw"],["require","esri.layers.FeatureLayer"],["require","esri.dijit.editing.Util"],["require","esri.dijit.editing.toolbars.Drawing"],["require","esri.dijit.editing.TemplatePicker"],["require","esri.dijit.AttributeInspector"],["require","esri.dijit.editing.SelectionHelper"],["require","esri.undoManager"],["require","esri.dijit.editing.editOperation"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["esri.dijit.editing.Editor"]){_4._hasResource["esri.dijit.editing.Editor"]=true;_4.provide("esri.dijit.editing.Editor");_4.require("dijit.ProgressBar");_4.require("dijit._Widget");_4.require("dijit._Templated");_4.require("esri.toolbars.edit");_4.require("esri.toolbars.draw");_4.require("esri.layers.FeatureLayer");_4.require("esri.dijit.editing.Util");_4.require("esri.dijit.editing.toolbars.Drawing");_4.require("esri.dijit.editing.TemplatePicker");_4.require("esri.dijit.AttributeInspector");_4.require("esri.dijit.editing.SelectionHelper");_4.require("esri.undoManager");_4.require("esri.dijit.editing.editOperation");(function(){var _7=[_4.moduleUrl("esri.dijit.editing","css/editor.css")];var _8=document.getElementsByTagName("head").item(0),_9;for(var i=0,il=_7.length;i<il;i++){_9=document.createElement("link");_9.type="text/css";_9.rel="stylesheet";_9.href=_7[i].toString();_8.appendChild(_9);}}());_4.declare("esri.dijit.editing.Editor",[_5._Widget,_5._Templated],{widgetsInTemplate:true,templateString:"<div class=\"esriEditor\">\r\n    <div class=\"esriTemplatePicker\" dojoAttachPoint=\"templatePickerDiv\"></div>\r\n    <div class=\"esriDrawingToolbar\" dojoAttachPoint=\"drawingToolbarDiv\"></div>\r\n    <div class=\"progressBar\" dojoAttachPoint=\"progressBar\" indeterminate=\"true\" dojoType=\"dijit.ProgressBar\" />\r\n</div>\r\n",constructor:function(_a,_b){_a=_a||{};if(!_a.settings){console.error("Editor: please provide 'settings' parameter in the constructor");}if(!_a.settings.layerInfos){console.error("Editor: please provide 'layerInfos' parameter in the constructor");}this._settings=_a.settings;this._eConnects=[];},postCreate:function(){this._setDefaultOptions();this._initLayers();this._connectEvents();this._createWidgets();this._reset();this._enableMapClickHandler();},destroy:function(){if(this.drawingToolbar){this.drawingToolbar.destroy();}if(this.attributeInspector){this.attributeInspector.destroy();}if(this.templatePicker){this.templatePicker.destroy();}if(this._selectionHelper){this._selectionHelper.destroy();}if(this._drawToolbar){this._drawToolbar.deactivate();}this._reset();this._disableMapClickHandler();_4.forEach(this._eConnects,"dojo.disconnect(item);");_4.disconnect(this._dtConnect);this._layer=this._currentGraphic=this._activeType=this._activeTemplate=this._drawingTool=this._drawToolbar=this._editToolbar=this.drawingToolbar=this.attributeInspector=this.templatePicker=this.undoManager=null;if(this._settings.map.infoWindow&&this._settings.map.infoWindow.clearFeatures){this._settings.map.infoWindow.clearFeatures();}this.inherited(arguments);},_setDefaultOptions:function(){this._drawToolbar=this._settings.drawToolbar||new esri.toolbars.Draw(this._settings.map);this._settings.drawToolbar=this._drawToolbar;this._editToolbar=this._settings.editToolbar||new esri.toolbars.Edit(this._settings.map);this._settings.editToolbar=this._editToolbar;this._settings.toolbarVisible=this._settings.toolbarVisible||false;this._settings.toolbarOptions=_4.mixin({reshapeVisible:false,cutVisible:false,mergeVisible:false},this._settings.toolbarOptions);this._settings.createOptions=_4.mixin({polylineDrawTools:[esri.dijit.editing.Editor.CREATE_TOOL_POLYLINE],polygonDrawTools:[esri.dijit.editing.Editor.CREATE_TOOL_POLYGON],editAttributesImmediately:true},this._settings.createOptions);this._settings.singleSelectionTolerance=this._settings.singleSelectionTolerance||3;this._settings.maxUndoRedoOperations=this._settings.maxUndoRedoOperations||10;this._settings.editor=this;this._usePopup=this._settings.usePopup=this._settings.map.infoWindow._setPagerCallbacks?true:false;var _c=esri.config.defaults;this._settings.geometryService=this._settings.geometryService||_c.geometryService;_c.geometryService=_c.geometryService||this._settings.geometryService;},_initLayers:function(){this._settings.layers=[];var _d=this._settings.layerInfos;_4.forEach(_d,function(_e){if(_e.featureLayer&&_e.featureLayer.loaded){this._settings.layers.push(_e.featureLayer);}},this);},_reset:function(){this._editVertices=true;this._layer=null;this._currentGraphic=null;this._activeType=null;this._activeTemplate=null;this._drawingTool=null;this._attributeChanged=false;this._hideAttributeInspector();this._editToolbar.deactivate();},_createFeature:function(_f){this._editClickPoint=this._findCenterPoint(_f);if(!_f.rings){this._applyEdits([{layer:this._layer,adds:[this._createGraphic(_f)]}]);return;}this._simplify(_f,_4.hitch(this,function(_10){if(this._drawingTool!==esri.layers.FeatureTemplate.TOOL_AUTO_COMPLETE_POLYGON){this._applyEdits([{layer:this._layer,adds:[this._createGraphic(_10)]}]);}else{this._autoComplete(_10,_4.hitch(this,function(_11){if(_11&&_11.length){this._applyEdits([{layer:this._layer,adds:_4.map(_11,_4.hitch(this,function(_12){return this._createGraphic(_12);}))}]);}}));}}));},_updateCurrentFeature:function(_13){var _14=this._isModified();if(_14){this._updateFeature(_14,_13);}else{if(_13){_13(false);}}},_updateFeature:function(_15,_16){var _17=_15.geometry;if(!_17.rings){this._applyEdits([{layer:_15.getLayer(),updates:[_15]}],_16);}else{this._simplify(_17,_4.hitch(this,function(_18){this._applyEdits([{layer:_15.getLayer(),updates:[_4.mixin(_15,{geometry:_18})]}],_16);}));}},_deleteFeature:function(_19,_1a){var _1b=[];if(!_19){var _1c=this._settings.layers;_1b=_4.map(_4.filter(_1c,function(_1d){return _1d.getSelectedFeatures().length>0;}),"return {layer:item, deletes: item.getSelectedFeatures()}");if((!_1b||!_1b.length)&&this._currentGraphic){_1b.push({layer:this._layer,deletes:[this._currentGraphic]});}}else{_1b.push({layer:_19.getLayer(),deletes:[_19]});}this._applyEdits(_1b,(_1a));},_stopEditing:function(_1e,_1f,_20,_21){esri.hide(this.progressBar.domNode);this._undoRedoAdd();var _22;if(_1e._isSelOnly===true){if(_1f&&_1f.length){this.templatePicker.clearSelection();var _23=new esri.tasks.Query();_23.objectIds=[_1f[0].objectId];this._selectFeatures([_1e],_23,_4.hitch(this,"_onEditFeature"));}}else{_22=this._selectionHelper.findMapService(this._settings.map,_1e);if(_22){_22.refresh();}if(_1f&&_1f.length){this.templatePicker.clearSelection();esri.dijit.editing.Util.LayerHelper.findFeatures(_1f,_1e,_4.hitch(this,"_onEditFeature"));}}if(_21&&_21.length){this._clearSelection(true);if(this._undoRedo){_22=this._selectionHelper.findMapService(_1e,this._settings.map);if(_22){_22.refresh();}}}if(this._undoRedo&&_20&&_20.length){_22=this._selectionHelper.findMapService(_1e,this._settings.map);if(_22){_22.refresh();}this.attributeInspector.refresh();this._undoRedo=false;}if(this.drawingToolbar){this.drawingToolbar._updateUI();}this._undoRedo=false;},_undoRedoAdd:function(){this._settings._isApplyEditsCall=false;if(!this._settings.undoManager){return;}if(this._activeTool==="CUT"||this._activeTool==="UNION"){return;}var _24=(this._edits&&this._edits.length)?this._edits[0]:null;if(!_24){return;}var _25=_24.adds||[];var _26=_24.updates||[];var _27=_24.deletes||[];var _28={featureLayer:_24.layer};if(_25.length){this.undoManager.add(new esri.dijit.editing.Add(_4.mixin(_28,{addedGraphics:_25})));}else{if(_27.length){this.undoManager.add(new esri.dijit.editing.Delete(_4.mixin(_28,{deletedGraphics:_27})));}else{if(_26.length){this.undoManager.add(new esri.dijit.editing.Update(_4.mixin(_28,{preUpdatedGraphics:[this._preUpdates],postUpdatedGraphics:_26})));}}}this._edits=null;this._preUpdates=null;},_activateDrawToolbar:function(_29){this._layer=_29.featureLayer;this._activeType=_29.type;this._activeTemplate=_29.template;this._drawingTool=this._activeTemplate?this._activeTemplate.drawingTool:null;this._drawTool=this._toDrawTool(this._drawingTool,_29.featureLayer);_4.disconnect(this._dtConnect);this._dtConnect=_4.connect(this._drawToolbar,"onDrawEnd",this,"_createFeature");this._editToolbar.deactivate();this._disableMapClickHandler();if(!this.drawingToolbar){this._drawToolbar.activate(this._drawTool);}else{this.drawingToolbar.activateEditing(this._drawTool,this._layer);}},_activateEditToolbar:function(_2a,_2b){var _2c=_2a.getLayer();var _2d=_2c?_2c.geometryType:null;var _2e=esri.toolbars.Edit.MOVE;if(_2d!=="esriGeometryPoint"&&this._isNotesFeature(_2a)===true){_2e=_2e|esri.toolbars.Edit.ROTATE|esri.toolbars.Edit.SCALE;this._editVertices=false;}else{if(_2d!=="esriGeometryPoint"&&this._editVertices===true){_2e=_2e|esri.toolbars.Edit.ROTATE|esri.toolbars.Edit.SCALE;this._editVertices=false;}else{_2e=_2e|esri.toolbars.Edit.EDIT_VERTICES;this._editVertices=true;}}this._attributeChanged=this._isModified();this._preUpdates=new esri.Graphic(_4.clone(_2a.toJson()));this._editToolbar.activate(_2e,_2a);if(!this._settings.map.infoWindow.isShowing){var _2f=(_2b&&_2b.screenPoint)||this._findCenterPoint(_2a);this._settings.map.infoWindow.show(_2f,this._settings.map.getInfoWindowAnchor(_2f));}},_createGraphic:function(_30){var _31=(this._activeType&&this._activeType.symbol)||this._layer.defaultSymbol;var _32=new esri.Graphic(_30,_31);if(this._activeTemplate){_32.attributes=_4.mixin({},this._activeTemplate.prototype.attributes);}else{_32.attributes=_32.attributes||[];_4.forEach(this._layer.fields,function(_33){_32.attributes[_33.name]=null;},this);}return _32;},_connectEvents:function(){var _34=this._settings.layers;_4.forEach(_34,"this._connect(item, 'onEditsComplete', dojo.hitch(this, '_stopEditing', item))",this);_4.forEach(_34,"this._connect(item, 'onBeforeApplyEdits', dojo.hitch(this, function() { esri.show(this.progressBar.domNode); this._settings._isApplyEditsCall = true;  }))",this);this._connect(this._editToolbar,"onGraphicClick",_4.hitch(this,"_activateEditToolbar"));this._connect(this._editToolbar,"onGraphicFirstMove",_4.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onVertexFirstMove",_4.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onScaleStart",_4.hitch(this,"_hideAttributeInspector"));this._connect(this._editToolbar,"onRotateStart",_4.hitch(this,"_hideAttributeInspector"));},_connect:function(_35,evt,_36){this._eConnects.push(_4.connect(_35,evt,_36));},_createWidgets:function(){this._selectionHelper=new esri.dijit.editing.SelectionHelper(this._settings);this._createTemplatePicker();this._createAttributeInspector();this._createDrawingToolbar();this._createUndoRedoManager();},_createTemplatePicker:function(){if(!this._settings.templatePicker){this.templatePicker=new esri.dijit.editing.TemplatePicker({"class":"esriTemplatePicker",featureLayers:this._settings.layers,showTooltip:true,maxLabelLength:this._settings.typesCharacterLimit,columns:"auto",rows:"auto"},this.templatePickerDiv);this.templatePicker.startup();this._settings.templatePicker=this.templatePicker;}else{this.templatePicker=this._settings.templatePicker;esri.hide(this.templatePickerDiv);}this._connect(this.templatePicker,"onSelectionChange",_4.hitch(this,"_onCreateFeature"));},_createAttributeInspector:function(){if(!this._settings.attributeInspector){this._customAttributeInspector=false;var map=this._settings.map;this.attributeInspector=new esri.dijit.AttributeInspector({layerInfos:this._settings.layerInfos,hideNavButtons:this._usePopup},_4.create("div"));this.attributeInspector.startup();map.infoWindow.setContent(this.attributeInspector.domNode);map.infoWindow.setTitle(esri.bundle.widgets.attributeInspector.NLS_title);map.infoWindow.resize(350,375);_4.query(".esriAttributeInspector .atiLayerName").style({display:"none"});}else{this._customAttributeInspector=true;this.attributeInspector=this._settings.attributeInspector;}this._connect(this.attributeInspector,"onDelete",_4.hitch(this,"_deleteFeature"));this._connect(this.attributeInspector,"onNext",_4.hitch(this,function(_37){this._updateCurrentFeature(_4.hitch(this,function(){this._attributeChanged=false;this._onEditFeature(_37);}));}));if(this._usePopup){this._settings.map.infoWindow._setPagerCallbacks(this.attributeInspector,_4.hitch(this.attributeInspector,"next"),_4.hitch(this.attributeInspector,"previous"));}this._connect(this.attributeInspector,"onAttributeChange",_4.hitch(this,function(_38,_39,_3a){this._preUpdates=new esri.Graphic(_4.clone(_38.toJson()));this._currentGraphic.attributes[_39]=_3a;this._updateFeature(this._currentGraphic,null);this._attributeChanged=false;}));},_createDrawingToolbar:function(){if(this._settings.toolbarVisible===true){this.drawingToolbar=new esri.dijit.editing.toolbars.Drawing({"class":"esriDrawingToolbar",drawToolbar:this._drawToolbar,editToolbar:this._editToolbar,settings:this._settings,onDelete:_4.hitch(this,"_deleteFeature"),onApplyEdits:_4.hitch(this,"_applyEdits"),onShowAttributeInspector:_4.hitch(this,"_onEditFeature")},this.drawingToolbarDiv);}},_createUndoRedoManager:function(){if(!this._settings.enableUndoRedo&&!this._settings.undoManager){return;}this._settings.enableUndoRedo=true;this.undoManager=this._settings.undoManager;if(!this.undoManager){this.undoManager=this._settings.undoManager=new esri.UndoManager({maxOperations:this._settings.maxUndoRedoOperations});}this._connect(document,"onkeypress",_4.hitch(this,function(evt){if(evt.metaKey||evt.ctrlKey){if(evt.charOrCode==="z"){this._undo();}if(evt.charOrCode==="y"){this._redo();}}}));},_enableMapClickHandler:function(){this._mapClickHandler=_4.connect(this._settings.map,"onClick",_4.hitch(this,function(evt){if(this._drawToolbar._geometryType){return;}if(this._activeTool==="SELECT"){this._activeTool="";return;}this._updateCurrentFeature(_4.hitch(this,function(){this._reset();this._updateSelection(evt);}));}));},_disableMapClickHandler:function(){_4.disconnect(this._mapClickHandler);},_onCreateFeature:function(){var _3b=this.templatePicker.getSelected();if(_3b){this._updateCurrentFeature(_4.hitch(this,function(){if(this._currentGraphic){this._clearSelection(false);}this._reset();this._activateDrawToolbar(_3b);}));}else{this._reset();_4.disconnect(this._dtConnect);this._drawToolbar.deactivate();this._enableMapClickHandler();if(this.drawingToolbar){this.drawingToolbar.deactivate();}}},_onEditFeature:function(_3c,_3d){_3c=(_4.isArray(_3c)?_3c[0]:_3c)||null;if(!_3c){return;}if(!this._customAttributeInspector){_3d=_3d||this._editClickPoint||this._findCenterPoint(_3c);var _3e=_3c.getLayer();this._settings.map.infoWindow.setTitle(_3e?_3e.name:esri.bundle.widgets.attributeInspector.NLS_title);if(this.drawingToolbar||!this._settings.map.infoWindow.isShowing){this._settings.map.infoWindow.show(_3d,this._settings.map.getInfoWindowAnchor(_3d));}this._editClickPoint=null;}if(_3c===this._currentGraphic){return;}this._editVertices=true;this._layer=_3c.getLayer();this._currentGraphic=_3c;if(_3c.getDojoShape()){_3c.getDojoShape().moveToFront();}this._activateEditToolbar(_3c);},_applyEdits:function(_3f,_40){_3f=_3f||[];if(_3f.length<=0){return;}this._edits=_3f;var _41=_4.map(_3f,function(_42){return _42.layer.applyEdits(_42.adds,_42.updates,_42.deletes);});this._deferredsList=new _4.DeferredList(_41).addCallback(_4.hitch(this,function(){esri.hide(this.progressBar.domNode);if(_40){_40();}}));},_undo:function(){if(this._settings.undoManager&&!this._settings._isApplyEditsCall){this._editToolbar.deactivate();this._undoRedo=true;this._settings.undoManager.undo();}},_redo:function(){if(this._settings.undoManager&&!this._settings._isApplyEditsCall){this._editToolbar.deactivate();this._undoRedo=true;this._settings.undoManager.redo();}},_simplify:function(_43,_44){if(esri.geometry.polygonSelfIntersecting(_43)){this._settings.geometryService.simplify([_43],function(_45){var _46=(_45&&_45.length)?_45[0]:_46;if(_44){_44(_46);}});}else{if(_44){_44(_43);}}},_autoComplete:function(_47,_48){var _49=this._getLayers("esriGeometryPolygon");var _4a=new esri.tasks.Query();_4a.geometry=_47;_4a.returnGeometry=true;this._selectFeatures(_49,_4a,_4.hitch(this,function(_4b){if(!_4b||_4b.length<=0){if(_48){_48([_47]);}}else{this._settings.geometryService.autoComplete(esri.getGeometries(_4b),this._toPolylines([_4a.geometry]),function(_4c){if(_48){_48(_4c);}});}}));},_getLayers:function(_4d){var _4e=this._settings.layers;return _4.filter(_4e,function(_4f){return _4f.geometryType===_4d;});},_selectFeatures:function(_50,_51,_52,_53){this._selectionHelper.selectFeatures(_50,_51,_53||esri.layers.FeatureLayer.SELECTION_NEW,_52);},_updateSelection:function(evt){var _54=evt.mapPoint;var _55=evt.graphic;this._selectionHelper.selectFeaturesByGeometry(this._settings.layers,_54,esri.layers.FeatureLayer.SELECTION_NEW,_4.hitch(this,function(_56){var _57=_4.some(_56,_4.hitch(this,function(_58){return _58==_55;}));if(_55&&!_57){var _59=_55.getLayer();if(this._isValidLayer(_59)){var _5a=new esri.tasks.Query();_5a.objectIds=[_55.attributes[_59.objectIdField]];this._selectionHelper.selectFeatures([_59],_5a,esri.layers.FeatureLayer.SELECTION_ADD,_4.hitch(this,function(_5b){this._updatePopupButtons(_5b);this._onEditFeature(_5b,_54);}));}else{this._clearSelection();}}else{if(_56&&_56.length){this._updatePopupButtons(_56);this._onEditFeature(_56,_54);}else{this._clearSelection();}}}));},_updatePopupButtons:function(_5c){if(!this._usePopup||!_5c){return;}var _5d=_5c.length;var _5e=[this._settings.map.infoWindow._prevFeatureButton,this._settings.map.infoWindow._nextFeatureButton];_4.forEach(_5e,_4.hitch(this,function(_5f){(_5d>1)?_4.removeClass(_5f,"hidden"):_4.addClass(_5f,"hidden");}));},_clearSelection:function(_60){this._selectionHelper.clearSelection(_60||false);this._reset();},_findCenterPoint:function(_61){var _62=_61.geometry||_61;var _63;switch(_62.type){case "point":_63=_62;break;case "polyline":var _64=_62.paths[0].length;_63=_62.getPoint(0,Math.ceil(_64/2));break;case "polygon":var _65=_62.rings.length-1;var _66=_62.rings[_65].length-1;_63=_62.getPoint(_65,_66);break;}return this._settings.map.toScreen(_63);},_hideAttributeInspector:function(){if(!this._customAttributeInspector){this._settings.map.infoWindow.hide();}},_toPolylines:function(_67){var _68=_4.map(_67,function(_69){var _6a=new esri.geometry.Polyline(_69.spatialReference);_4.forEach(_69.rings,function(_6b){_6a.addPath(_6b);});return _6a;});return _68;},_isNotesFeature:function(_6c){var _6d=_6c.getLayer();var _6e=_6d?_6d.types||null:null;if(!_6e){return false;}var _6f=_6c.attributes[_6d.typeIdField];var _70;_4.some(_6e,function(_71){if(_71.id===_6f){_70=_71.templates;return true;}return false;});if(!_70){return false;}var _72=_70[0]||null;if(!_72){return false;}var _73=this._isShapeTool(_72.drawingTool)||null;return _73?true:false;},_isValidLayer:function(_74){var _75=this._settings.layerInfos;for(var i=0;i<_75.length;i++){var _76=_75[i];if(_74.id==_76.id){return true;}}return false;},_isShapeTool:function(_77){switch(_77){case esri.layers.FeatureTemplate.TOOL_ARROW:return esri.toolbars.Draw.ARROW;case esri.layers.FeatureTemplate.TOOL_LEFT_ARROW:return esri.toolbars.Draw.LEFT_ARROW;case esri.layers.FeatureTemplate.TOOL_RIGHT_ARROW:return esri.toolbars.Draw.RIGHT_ARROW;case esri.layers.FeatureTemplate.TOOL_UP_ARROW:return esri.toolbars.Draw.UP_ARROW;case esri.layers.FeatureTemplate.TOOL_DOWN_ARROW:return esri.toolbars.Draw.DOWN_ARROW;case esri.layers.FeatureTemplate.TOOL_CIRCLE:return esri.toolbars.Draw.CIRCLE;case esri.layers.FeatureTemplate.TOOL_ELLIPSE:return esri.toolbars.Draw.ELLIPSE;case esri.layers.FeatureTemplate.TOOL_TRIANGLE:return esri.toolbars.Draw.TRIANGLE;case esri.layers.FeatureTemplate.TOOL_RECTANGLE:return esri.toolbars.Draw.RECTANGLE;default:return null;}},_toDrawTool:function(_78,_79){var _7a=_79.geometryType;switch(_78){case esri.layers.FeatureTemplate.TOOL_POINT:return esri.toolbars.Draw.POINT;case esri.layers.FeatureTemplate.TOOL_ARROW:return esri.toolbars.Draw.ARROW;case esri.layers.FeatureTemplate.TOOL_LEFT_ARROW:return esri.toolbars.Draw.LEFT_ARROW;case esri.layers.FeatureTemplate.TOOL_RIGHT_ARROW:return esri.toolbars.Draw.RIGHT_ARROW;case esri.layers.FeatureTemplate.TOOL_UP_ARROW:return esri.toolbars.Draw.UP_ARROW;case esri.layers.FeatureTemplate.TOOL_DOWN_ARROW:return esri.toolbars.Draw.DOWN_ARROW;case esri.layers.FeatureTemplate.TOOL_CIRCLE:return esri.toolbars.Draw.CIRCLE;case esri.layers.FeatureTemplate.TOOL_ELLIPSE:return esri.toolbars.Draw.ELLIPSE;case esri.layers.FeatureTemplate.TOOL_TRIANGLE:return esri.toolbars.Draw.TRIANGLE;case esri.layers.FeatureTemplate.TOOL_RECTANGLE:return esri.toolbars.Draw.RECTANGLE;case esri.layers.FeatureTemplate.TOOL_LINE:return esri.toolbars.Draw.POLYLINE;case esri.layers.FeatureTemplate.TOOL_POLYGON:return esri.toolbars.Draw.POLYGON;case esri.layers.FeatureTemplate.TOOL_FREEHAND:if(_7a==="esriGeometryPolyline"){return esri.toolbars.Draw.FREEHAND_POLYLINE;}else{return esri.toolbars.Draw.FREEHAND_POLYGON;}break;default:var _7b=esri.toolbars.Draw.POINT;if(_7a==="esriGeometryPolyline"){_7b=esri.toolbars.Draw.POLYLINE;if(this._settings.createOptions.polylineDrawTools[0]===esri.dijit.editing.Editor.CREATE_TOOL_FREEHAND_POLYLINE){_7b=esri.toolbars.Draw.FREEHAND_POLYLINE;}}else{if(_7a==="esriGeometryPolygon"){_7b=esri.toolbars.Draw.POLYGON;if(this._settings.createOptions.polygonDrawTools[0]===esri.dijit.editing.Editor.CREATE_TOOL_FREEHAND_POLYGON){_7b=esri.toolbars.Draw.FREEHAND_POLYGON;}}}return _7b;}},_isModified:function(){var _7c=this._editToolbar.getCurrentState();return ((_7c.isModified||this._attributeChanged)&&_7c.graphic)?_7c.graphic:null;}});_4.mixin(esri.dijit.editing.Editor,{CREATE_TOOL_POLYLINE:"polyline",CREATE_TOOL_FREEHAND_POLYLINE:"freehandpolyline",CREATE_TOOL_POLYGON:"polygon",CREATE_TOOL_FREEHAND_POLYGON:"freehandpolygon",CREATE_TOOL_AUTOCOMPLETE:"autocomplete",CREATE_TOOL_RECTANGLE:"rectangle",CREATE_TOOL_TRIANGLE:"triangle",CREATE_TOOL_CIRCLE:"circle",CREATE_TOOL_ELLIPSE:"ellipse",CREATE_TOOL_ARROW:"arrow",CREATE_TOOL_UP_ARROW:"uparrow",CREATE_TOOL_DOWN_ARROW:"downarrow",CREATE_TOOL_RIGHT_ARROW:"rightarrow",CREATE_TOOL_LEFT_ARROW:"leftarrow"});}}};});