/*
 COPYRIGHT 2009 ESRI

 TRADE SECRETS: ESRI PROPRIETARY AND CONFIDENTIAL
 Unpublished material - all rights reserved under the
 Copyright Laws of the United States and applicable international
 laws, treaties, and conventions.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts and Legal Services Department
 380 New York Street
 Redlands, California, 92373
 USA

 email: contracts@esri.com
 */

if(!dojo._hasResource["esri.layers.agscommon"]){dojo._hasResource["esri.layers.agscommon"]=true;dojo.provide("esri.layers.agscommon");dojo.require("esri.geometry");dojo.require("esri.utils");dojo.declare("esri.layers.ArcGISMapServiceLayer",null,{constructor:function(_1,_2){this.layerInfos=[];var _3=(this._params={}),_4=this._url.query?this._url.query.token:null;if(_4){_3.token=_4;}},_load:function(){esri.request({url:this._url.path,content:dojo.mixin({f:"json"},this._params),callbackParamName:"callback",load:this._initLayer,error:this._errorHandler});},spatialReference:null,initialExtent:null,fullExtent:null,description:null,units:null,_initLayer:function(_5,io){try{this.description=_5.description;this.copyright=_5.copyrightText;this.spatialReference=new esri.SpatialReference(_5.spatialReference);this.initialExtent=new esri.geometry.Extent(_5.initialExtent);this.fullExtent=new esri.geometry.Extent(_5.fullExtent);this.units=_5.units;var _6=(this.layerInfos=[]),_7=_5.layers,_8=(this._defaultVisibleLayers=[]);dojo.forEach(_7,function(_9,i){_6[i]=new esri.layers.LayerInfo(_9);if(_9.defaultVisibility){_8.push(_9.id);}});if(!this.visibleLayers){this.visibleLayers=_8;}this.version=_5.currentVersion;if(!this.version){var _a;if("capabilities" in _5||"tables" in _5){_a=10;}else{if("supportedImageFormatTypes" in _5){_a=9.31;}else{_a=9.3;}}this.version=_a;}this.capabilities=_5.capabilities;}catch(e){this._errorHandler(e);}}});dojo.declare("esri.layers.LayerInfo",null,{constructor:function(_b){dojo.mixin(this,_b);}});dojo.declare("esri.layers.TimeInfo",null,{constructor:function(_c){if(_c!==null){dojo.mixin(this,_c);if(_c.exportOptions){this.exportOptions=new esri.layers.LayerTimeOptions(_c.exportOptions);}this.timeExtent=new esri.TimeExtent(_c.timeExtent);this.timeReference=new esri.layers.TimeReference(_c.timeReference);}}});dojo.mixin(esri.layers.TimeInfo,{UNIT_CENTURIES:"esriTimeUnitsCenturies",UNIT_DAYS:"esriTimeUnitsDays",UNIT_DECADES:"esriTimeUnitsDecades",UNIT_HOURS:"esriTimeUnitsHours",UNIT_MILLISECONDS:"esriTimeUnitsMilliseconds",UNIT_MINUTES:"esriTimeUnitsMinutes",UNIT_MONTHS:"esriTimeUnitsMonths",UNIT_SECONDS:"esriTimeUnitsSeconds",UNIT_UNKNOWN:"esriTimeUnitsUnknown",UNIT_WEEKS:"esriTimeUnitsWeeks",UNIT_YEARS:"esriTimeUnitsYears"});dojo.declare("esri.layers.LayerTimeOptions",null,{constructor:function(_d){if(_d){dojo.mixin(this,_d);}},toJson:function(){var _e={timeDataCumulative:this.timeDataCumulative,timeOffset:this.timeOffset,timeOffsetUnits:this.timeOffsetUnits,useTime:this.useTime};return esri._sanitize(_e);}});dojo.declare("esri.layers.TimeReference",null,{constructor:function(_f){if(_f){dojo.mixin(this,_f);}}});dojo.declare("esri.layers.Field",null,{constructor:function(_10){if(_10&&dojo.isObject(_10)){this.name=_10.name;this.type=_10.type;this.alias=_10.alias;this.length=_10.length;this.editable=_10.editable;var _11=_10.domain;if(_11&&dojo.isObject(_11)){switch(_11.type){case "range":this.domain=new esri.layers.RangeDomain(_11);break;case "codedValue":this.domain=new esri.layers.CodedValueDomain(_11);break;}}}}});dojo.declare("esri.layers.Domain",null,{constructor:function(_12){if(_12&&dojo.isObject(_12)){this.name=_12.name;this.type=_12.type;}},toJson:function(){return esri._sanitize({name:this.name,type:this.type});}});dojo.declare("esri.layers.RangeDomain",[esri.layers.Domain],{constructor:function(_13){if(_13&&dojo.isObject(_13)){this.minValue=_13.range[0];this.maxValue=_13.range[1];}},toJson:function(){var _14=this.inherited(arguments);_14.range=[this.minValue,this.maxValue];return esri._sanitize(_14);}});dojo.declare("esri.layers.CodedValueDomain",[esri.layers.Domain],{constructor:function(_15){if(_15&&dojo.isObject(_15)){this.codedValues=_15.codedValues;}},toJson:function(){var _16=this.inherited(arguments);_16.codedValues=dojo.clone(this.codedValues);return esri._sanitize(_16);}});dojo.declare("esri.layers.InheritedDomain",[esri.layers.Domain],{});}